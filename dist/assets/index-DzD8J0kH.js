(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))l(o);new MutationObserver(o=>{for(const d of o)if(d.type==="childList")for(const u of d.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&l(u)}).observe(document,{childList:!0,subtree:!0});function a(o){const d={};return o.integrity&&(d.integrity=o.integrity),o.referrerPolicy&&(d.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?d.credentials="include":o.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function l(o){if(o.ep)return;o.ep=!0;const d=a(o);fetch(o.href,d)}})();function _0(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}function k0(i){if(Object.prototype.hasOwnProperty.call(i,"__esModule"))return i;var r=i.default;if(typeof r=="function"){var a=function l(){var o=!1;try{o=this instanceof l}catch{}return o?Reflect.construct(r,arguments,this.constructor):r.apply(this,arguments)};a.prototype=r.prototype}else a={};return Object.defineProperty(a,"__esModule",{value:!0}),Object.keys(i).forEach(function(l){var o=Object.getOwnPropertyDescriptor(i,l);Object.defineProperty(a,l,o.get?o:{enumerable:!0,get:function(){return i[l]}})}),a}var yo={exports:{}},An={},jo={exports:{}},de={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xu;function S0(){if(Xu)return de;Xu=1;var i=Symbol.for("react.element"),r=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),l=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),d=Symbol.for("react.provider"),u=Symbol.for("react.context"),h=Symbol.for("react.forward_ref"),p=Symbol.for("react.suspense"),g=Symbol.for("react.memo"),v=Symbol.for("react.lazy"),x=Symbol.iterator;function N(O){return O===null||typeof O!="object"?null:(O=x&&O[x]||O["@@iterator"],typeof O=="function"?O:null)}var y={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},b=Object.assign,j={};function _(O,$,ie){this.props=O,this.context=$,this.refs=j,this.updater=ie||y}_.prototype.isReactComponent={},_.prototype.setState=function(O,$){if(typeof O!="object"&&typeof O!="function"&&O!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,O,$,"setState")},_.prototype.forceUpdate=function(O){this.updater.enqueueForceUpdate(this,O,"forceUpdate")};function T(){}T.prototype=_.prototype;function I(O,$,ie){this.props=O,this.context=$,this.refs=j,this.updater=ie||y}var C=I.prototype=new T;C.constructor=I,b(C,_.prototype),C.isPureReactComponent=!0;var D=Array.isArray,R=Object.prototype.hasOwnProperty,F={current:null},H={key:!0,ref:!0,__self:!0,__source:!0};function ae(O,$,ie){var ue,fe={},xe=null,ke=null;if($!=null)for(ue in $.ref!==void 0&&(ke=$.ref),$.key!==void 0&&(xe=""+$.key),$)R.call($,ue)&&!H.hasOwnProperty(ue)&&(fe[ue]=$[ue]);var ye=arguments.length-2;if(ye===1)fe.children=ie;else if(1<ye){for(var Le=Array(ye),wt=0;wt<ye;wt++)Le[wt]=arguments[wt+2];fe.children=Le}if(O&&O.defaultProps)for(ue in ye=O.defaultProps,ye)fe[ue]===void 0&&(fe[ue]=ye[ue]);return{$$typeof:i,type:O,key:xe,ref:ke,props:fe,_owner:F.current}}function _e(O,$){return{$$typeof:i,type:O.type,key:$,ref:O.ref,props:O.props,_owner:O._owner}}function He(O){return typeof O=="object"&&O!==null&&O.$$typeof===i}function U(O){var $={"=":"=0",":":"=2"};return"$"+O.replace(/[=:]/g,function(ie){return $[ie]})}var ce=/\/+/g;function be(O,$){return typeof O=="object"&&O!==null&&O.key!=null?U(""+O.key):$.toString(36)}function Oe(O,$,ie,ue,fe){var xe=typeof O;(xe==="undefined"||xe==="boolean")&&(O=null);var ke=!1;if(O===null)ke=!0;else switch(xe){case"string":case"number":ke=!0;break;case"object":switch(O.$$typeof){case i:case r:ke=!0}}if(ke)return ke=O,fe=fe(ke),O=ue===""?"."+be(ke,0):ue,D(fe)?(ie="",O!=null&&(ie=O.replace(ce,"$&/")+"/"),Oe(fe,$,ie,"",function(wt){return wt})):fe!=null&&(He(fe)&&(fe=_e(fe,ie+(!fe.key||ke&&ke.key===fe.key?"":(""+fe.key).replace(ce,"$&/")+"/")+O)),$.push(fe)),1;if(ke=0,ue=ue===""?".":ue+":",D(O))for(var ye=0;ye<O.length;ye++){xe=O[ye];var Le=ue+be(xe,ye);ke+=Oe(xe,$,ie,Le,fe)}else if(Le=N(O),typeof Le=="function")for(O=Le.call(O),ye=0;!(xe=O.next()).done;)xe=xe.value,Le=ue+be(xe,ye++),ke+=Oe(xe,$,ie,Le,fe);else if(xe==="object")throw $=String(O),Error("Objects are not valid as a React child (found: "+($==="[object Object]"?"object with keys {"+Object.keys(O).join(", ")+"}":$)+"). If you meant to render a collection of children, use an array instead.");return ke}function Re(O,$,ie){if(O==null)return O;var ue=[],fe=0;return Oe(O,ue,"","",function(xe){return $.call(ie,xe,fe++)}),ue}function qe(O){if(O._status===-1){var $=O._result;$=$(),$.then(function(ie){(O._status===0||O._status===-1)&&(O._status=1,O._result=ie)},function(ie){(O._status===0||O._status===-1)&&(O._status=2,O._result=ie)}),O._status===-1&&(O._status=0,O._result=$)}if(O._status===1)return O._result.default;throw O._result}var G={current:null},V={transition:null},se={ReactCurrentDispatcher:G,ReactCurrentBatchConfig:V,ReactCurrentOwner:F};function K(){throw Error("act(...) is not supported in production builds of React.")}return de.Children={map:Re,forEach:function(O,$,ie){Re(O,function(){$.apply(this,arguments)},ie)},count:function(O){var $=0;return Re(O,function(){$++}),$},toArray:function(O){return Re(O,function($){return $})||[]},only:function(O){if(!He(O))throw Error("React.Children.only expected to receive a single React element child.");return O}},de.Component=_,de.Fragment=a,de.Profiler=o,de.PureComponent=I,de.StrictMode=l,de.Suspense=p,de.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=se,de.act=K,de.cloneElement=function(O,$,ie){if(O==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+O+".");var ue=b({},O.props),fe=O.key,xe=O.ref,ke=O._owner;if($!=null){if($.ref!==void 0&&(xe=$.ref,ke=F.current),$.key!==void 0&&(fe=""+$.key),O.type&&O.type.defaultProps)var ye=O.type.defaultProps;for(Le in $)R.call($,Le)&&!H.hasOwnProperty(Le)&&(ue[Le]=$[Le]===void 0&&ye!==void 0?ye[Le]:$[Le])}var Le=arguments.length-2;if(Le===1)ue.children=ie;else if(1<Le){ye=Array(Le);for(var wt=0;wt<Le;wt++)ye[wt]=arguments[wt+2];ue.children=ye}return{$$typeof:i,type:O.type,key:fe,ref:xe,props:ue,_owner:ke}},de.createContext=function(O){return O={$$typeof:u,_currentValue:O,_currentValue2:O,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},O.Provider={$$typeof:d,_context:O},O.Consumer=O},de.createElement=ae,de.createFactory=function(O){var $=ae.bind(null,O);return $.type=O,$},de.createRef=function(){return{current:null}},de.forwardRef=function(O){return{$$typeof:h,render:O}},de.isValidElement=He,de.lazy=function(O){return{$$typeof:v,_payload:{_status:-1,_result:O},_init:qe}},de.memo=function(O,$){return{$$typeof:g,type:O,compare:$===void 0?null:$}},de.startTransition=function(O){var $=V.transition;V.transition={};try{O()}finally{V.transition=$}},de.unstable_act=K,de.useCallback=function(O,$){return G.current.useCallback(O,$)},de.useContext=function(O){return G.current.useContext(O)},de.useDebugValue=function(){},de.useDeferredValue=function(O){return G.current.useDeferredValue(O)},de.useEffect=function(O,$){return G.current.useEffect(O,$)},de.useId=function(){return G.current.useId()},de.useImperativeHandle=function(O,$,ie){return G.current.useImperativeHandle(O,$,ie)},de.useInsertionEffect=function(O,$){return G.current.useInsertionEffect(O,$)},de.useLayoutEffect=function(O,$){return G.current.useLayoutEffect(O,$)},de.useMemo=function(O,$){return G.current.useMemo(O,$)},de.useReducer=function(O,$,ie){return G.current.useReducer(O,$,ie)},de.useRef=function(O){return G.current.useRef(O)},de.useState=function(O){return G.current.useState(O)},de.useSyncExternalStore=function(O,$,ie){return G.current.useSyncExternalStore(O,$,ie)},de.useTransition=function(){return G.current.useTransition()},de.version="18.3.1",de}var Zu;function Yo(){return Zu||(Zu=1,jo.exports=S0()),jo.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var em;function C0(){if(em)return An;em=1;var i=Yo(),r=Symbol.for("react.element"),a=Symbol.for("react.fragment"),l=Object.prototype.hasOwnProperty,o=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,d={key:!0,ref:!0,__self:!0,__source:!0};function u(h,p,g){var v,x={},N=null,y=null;g!==void 0&&(N=""+g),p.key!==void 0&&(N=""+p.key),p.ref!==void 0&&(y=p.ref);for(v in p)l.call(p,v)&&!d.hasOwnProperty(v)&&(x[v]=p[v]);if(h&&h.defaultProps)for(v in p=h.defaultProps,p)x[v]===void 0&&(x[v]=p[v]);return{$$typeof:r,type:h,key:N,ref:y,props:x,_owner:o.current}}return An.Fragment=a,An.jsx=u,An.jsxs=u,An}var tm;function T0(){return tm||(tm=1,yo.exports=C0()),yo.exports}var e=T0(),k=Yo(),il={},wo={exports:{}},yt={},No={exports:{}},_o={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sm;function E0(){return sm||(sm=1,(function(i){function r(V,se){var K=V.length;V.push(se);e:for(;0<K;){var O=K-1>>>1,$=V[O];if(0<o($,se))V[O]=se,V[K]=$,K=O;else break e}}function a(V){return V.length===0?null:V[0]}function l(V){if(V.length===0)return null;var se=V[0],K=V.pop();if(K!==se){V[0]=K;e:for(var O=0,$=V.length,ie=$>>>1;O<ie;){var ue=2*(O+1)-1,fe=V[ue],xe=ue+1,ke=V[xe];if(0>o(fe,K))xe<$&&0>o(ke,fe)?(V[O]=ke,V[xe]=K,O=xe):(V[O]=fe,V[ue]=K,O=ue);else if(xe<$&&0>o(ke,K))V[O]=ke,V[xe]=K,O=xe;else break e}}return se}function o(V,se){var K=V.sortIndex-se.sortIndex;return K!==0?K:V.id-se.id}if(typeof performance=="object"&&typeof performance.now=="function"){var d=performance;i.unstable_now=function(){return d.now()}}else{var u=Date,h=u.now();i.unstable_now=function(){return u.now()-h}}var p=[],g=[],v=1,x=null,N=3,y=!1,b=!1,j=!1,_=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,I=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function C(V){for(var se=a(g);se!==null;){if(se.callback===null)l(g);else if(se.startTime<=V)l(g),se.sortIndex=se.expirationTime,r(p,se);else break;se=a(g)}}function D(V){if(j=!1,C(V),!b)if(a(p)!==null)b=!0,qe(R);else{var se=a(g);se!==null&&G(D,se.startTime-V)}}function R(V,se){b=!1,j&&(j=!1,T(ae),ae=-1),y=!0;var K=N;try{for(C(se),x=a(p);x!==null&&(!(x.expirationTime>se)||V&&!U());){var O=x.callback;if(typeof O=="function"){x.callback=null,N=x.priorityLevel;var $=O(x.expirationTime<=se);se=i.unstable_now(),typeof $=="function"?x.callback=$:x===a(p)&&l(p),C(se)}else l(p);x=a(p)}if(x!==null)var ie=!0;else{var ue=a(g);ue!==null&&G(D,ue.startTime-se),ie=!1}return ie}finally{x=null,N=K,y=!1}}var F=!1,H=null,ae=-1,_e=5,He=-1;function U(){return!(i.unstable_now()-He<_e)}function ce(){if(H!==null){var V=i.unstable_now();He=V;var se=!0;try{se=H(!0,V)}finally{se?be():(F=!1,H=null)}}else F=!1}var be;if(typeof I=="function")be=function(){I(ce)};else if(typeof MessageChannel<"u"){var Oe=new MessageChannel,Re=Oe.port2;Oe.port1.onmessage=ce,be=function(){Re.postMessage(null)}}else be=function(){_(ce,0)};function qe(V){H=V,F||(F=!0,be())}function G(V,se){ae=_(function(){V(i.unstable_now())},se)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(V){V.callback=null},i.unstable_continueExecution=function(){b||y||(b=!0,qe(R))},i.unstable_forceFrameRate=function(V){0>V||125<V?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_e=0<V?Math.floor(1e3/V):5},i.unstable_getCurrentPriorityLevel=function(){return N},i.unstable_getFirstCallbackNode=function(){return a(p)},i.unstable_next=function(V){switch(N){case 1:case 2:case 3:var se=3;break;default:se=N}var K=N;N=se;try{return V()}finally{N=K}},i.unstable_pauseExecution=function(){},i.unstable_requestPaint=function(){},i.unstable_runWithPriority=function(V,se){switch(V){case 1:case 2:case 3:case 4:case 5:break;default:V=3}var K=N;N=V;try{return se()}finally{N=K}},i.unstable_scheduleCallback=function(V,se,K){var O=i.unstable_now();switch(typeof K=="object"&&K!==null?(K=K.delay,K=typeof K=="number"&&0<K?O+K:O):K=O,V){case 1:var $=-1;break;case 2:$=250;break;case 5:$=1073741823;break;case 4:$=1e4;break;default:$=5e3}return $=K+$,V={id:v++,callback:se,priorityLevel:V,startTime:K,expirationTime:$,sortIndex:-1},K>O?(V.sortIndex=K,r(g,V),a(p)===null&&V===a(g)&&(j?(T(ae),ae=-1):j=!0,G(D,K-O))):(V.sortIndex=$,r(p,V),b||y||(b=!0,qe(R))),V},i.unstable_shouldYield=U,i.unstable_wrapCallback=function(V){var se=N;return function(){var K=N;N=se;try{return V.apply(this,arguments)}finally{N=K}}}})(_o)),_o}var rm;function P0(){return rm||(rm=1,No.exports=E0()),No.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var nm;function D0(){if(nm)return yt;nm=1;var i=Yo(),r=P0();function a(t){for(var s="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)s+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var l=new Set,o={};function d(t,s){u(t,s),u(t+"Capture",s)}function u(t,s){for(o[t]=s,t=0;t<s.length;t++)l.add(s[t])}var h=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),p=Object.prototype.hasOwnProperty,g=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,v={},x={};function N(t){return p.call(x,t)?!0:p.call(v,t)?!1:g.test(t)?x[t]=!0:(v[t]=!0,!1)}function y(t,s,n,c){if(n!==null&&n.type===0)return!1;switch(typeof s){case"function":case"symbol":return!0;case"boolean":return c?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function b(t,s,n,c){if(s===null||typeof s>"u"||y(t,s,n,c))return!0;if(c)return!1;if(n!==null)switch(n.type){case 3:return!s;case 4:return s===!1;case 5:return isNaN(s);case 6:return isNaN(s)||1>s}return!1}function j(t,s,n,c,m,f,w){this.acceptsBooleans=s===2||s===3||s===4,this.attributeName=c,this.attributeNamespace=m,this.mustUseProperty=n,this.propertyName=t,this.type=s,this.sanitizeURL=f,this.removeEmptyString=w}var _={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){_[t]=new j(t,0,!1,t,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var s=t[0];_[s]=new j(s,1,!1,t[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(t){_[t]=new j(t,2,!1,t.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){_[t]=new j(t,2,!1,t,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){_[t]=new j(t,3,!1,t.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(t){_[t]=new j(t,3,!0,t,null,!1,!1)}),["capture","download"].forEach(function(t){_[t]=new j(t,4,!1,t,null,!1,!1)}),["cols","rows","size","span"].forEach(function(t){_[t]=new j(t,6,!1,t,null,!1,!1)}),["rowSpan","start"].forEach(function(t){_[t]=new j(t,5,!1,t.toLowerCase(),null,!1,!1)});var T=/[\-:]([a-z])/g;function I(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var s=t.replace(T,I);_[s]=new j(s,1,!1,t,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var s=t.replace(T,I);_[s]=new j(s,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(t){var s=t.replace(T,I);_[s]=new j(s,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(t){_[t]=new j(t,1,!1,t.toLowerCase(),null,!1,!1)}),_.xlinkHref=new j("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(t){_[t]=new j(t,1,!1,t.toLowerCase(),null,!0,!0)});function C(t,s,n,c){var m=_.hasOwnProperty(s)?_[s]:null;(m!==null?m.type!==0:c||!(2<s.length)||s[0]!=="o"&&s[0]!=="O"||s[1]!=="n"&&s[1]!=="N")&&(b(s,n,m,c)&&(n=null),c||m===null?N(s)&&(n===null?t.removeAttribute(s):t.setAttribute(s,""+n)):m.mustUseProperty?t[m.propertyName]=n===null?m.type===3?!1:"":n:(s=m.attributeName,c=m.attributeNamespace,n===null?t.removeAttribute(s):(m=m.type,n=m===3||m===4&&n===!0?"":""+n,c?t.setAttributeNS(c,s,n):t.setAttribute(s,n))))}var D=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,R=Symbol.for("react.element"),F=Symbol.for("react.portal"),H=Symbol.for("react.fragment"),ae=Symbol.for("react.strict_mode"),_e=Symbol.for("react.profiler"),He=Symbol.for("react.provider"),U=Symbol.for("react.context"),ce=Symbol.for("react.forward_ref"),be=Symbol.for("react.suspense"),Oe=Symbol.for("react.suspense_list"),Re=Symbol.for("react.memo"),qe=Symbol.for("react.lazy"),G=Symbol.for("react.offscreen"),V=Symbol.iterator;function se(t){return t===null||typeof t!="object"?null:(t=V&&t[V]||t["@@iterator"],typeof t=="function"?t:null)}var K=Object.assign,O;function $(t){if(O===void 0)try{throw Error()}catch(n){var s=n.stack.trim().match(/\n( *(at )?)/);O=s&&s[1]||""}return`
`+O+t}var ie=!1;function ue(t,s){if(!t||ie)return"";ie=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(s)if(s=function(){throw Error()},Object.defineProperty(s.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(s,[])}catch(M){var c=M}Reflect.construct(t,[],s)}else{try{s.call()}catch(M){c=M}t.call(s.prototype)}else{try{throw Error()}catch(M){c=M}t()}}catch(M){if(M&&c&&typeof M.stack=="string"){for(var m=M.stack.split(`
`),f=c.stack.split(`
`),w=m.length-1,S=f.length-1;1<=w&&0<=S&&m[w]!==f[S];)S--;for(;1<=w&&0<=S;w--,S--)if(m[w]!==f[S]){if(w!==1||S!==1)do if(w--,S--,0>S||m[w]!==f[S]){var E=`
`+m[w].replace(" at new "," at ");return t.displayName&&E.includes("<anonymous>")&&(E=E.replace("<anonymous>",t.displayName)),E}while(1<=w&&0<=S);break}}}finally{ie=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?$(t):""}function fe(t){switch(t.tag){case 5:return $(t.type);case 16:return $("Lazy");case 13:return $("Suspense");case 19:return $("SuspenseList");case 0:case 2:case 15:return t=ue(t.type,!1),t;case 11:return t=ue(t.type.render,!1),t;case 1:return t=ue(t.type,!0),t;default:return""}}function xe(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case H:return"Fragment";case F:return"Portal";case _e:return"Profiler";case ae:return"StrictMode";case be:return"Suspense";case Oe:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case U:return(t.displayName||"Context")+".Consumer";case He:return(t._context.displayName||"Context")+".Provider";case ce:var s=t.render;return t=t.displayName,t||(t=s.displayName||s.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Re:return s=t.displayName||null,s!==null?s:xe(t.type)||"Memo";case qe:s=t._payload,t=t._init;try{return xe(t(s))}catch{}}return null}function ke(t){var s=t.type;switch(t.tag){case 24:return"Cache";case 9:return(s.displayName||"Context")+".Consumer";case 10:return(s._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=s.render,t=t.displayName||t.name||"",s.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return s;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return xe(s);case 8:return s===ae?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof s=="function")return s.displayName||s.name||null;if(typeof s=="string")return s}return null}function ye(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Le(t){var s=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function wt(t){var s=Le(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,s),c=""+t[s];if(!t.hasOwnProperty(s)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var m=n.get,f=n.set;return Object.defineProperty(t,s,{configurable:!0,get:function(){return m.call(this)},set:function(w){c=""+w,f.call(this,w)}}),Object.defineProperty(t,s,{enumerable:n.enumerable}),{getValue:function(){return c},setValue:function(w){c=""+w},stopTracking:function(){t._valueTracker=null,delete t[s]}}}}function Jn(t){t._valueTracker||(t._valueTracker=wt(t))}function nc(t){if(!t)return!1;var s=t._valueTracker;if(!s)return!0;var n=s.getValue(),c="";return t&&(c=Le(t)?t.checked?"true":"false":t.value),t=c,t!==n?(s.setValue(t),!0):!1}function Xn(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Sl(t,s){var n=s.checked;return K({},s,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function ac(t,s){var n=s.defaultValue==null?"":s.defaultValue,c=s.checked!=null?s.checked:s.defaultChecked;n=ye(s.value!=null?s.value:n),t._wrapperState={initialChecked:c,initialValue:n,controlled:s.type==="checkbox"||s.type==="radio"?s.checked!=null:s.value!=null}}function lc(t,s){s=s.checked,s!=null&&C(t,"checked",s,!1)}function Cl(t,s){lc(t,s);var n=ye(s.value),c=s.type;if(n!=null)c==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(c==="submit"||c==="reset"){t.removeAttribute("value");return}s.hasOwnProperty("value")?Tl(t,s.type,n):s.hasOwnProperty("defaultValue")&&Tl(t,s.type,ye(s.defaultValue)),s.checked==null&&s.defaultChecked!=null&&(t.defaultChecked=!!s.defaultChecked)}function ic(t,s,n){if(s.hasOwnProperty("value")||s.hasOwnProperty("defaultValue")){var c=s.type;if(!(c!=="submit"&&c!=="reset"||s.value!==void 0&&s.value!==null))return;s=""+t._wrapperState.initialValue,n||s===t.value||(t.value=s),t.defaultValue=s}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Tl(t,s,n){(s!=="number"||Xn(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Yr=Array.isArray;function ir(t,s,n,c){if(t=t.options,s){s={};for(var m=0;m<n.length;m++)s["$"+n[m]]=!0;for(n=0;n<t.length;n++)m=s.hasOwnProperty("$"+t[n].value),t[n].selected!==m&&(t[n].selected=m),m&&c&&(t[n].defaultSelected=!0)}else{for(n=""+ye(n),s=null,m=0;m<t.length;m++){if(t[m].value===n){t[m].selected=!0,c&&(t[m].defaultSelected=!0);return}s!==null||t[m].disabled||(s=t[m])}s!==null&&(s.selected=!0)}}function El(t,s){if(s.dangerouslySetInnerHTML!=null)throw Error(a(91));return K({},s,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function oc(t,s){var n=s.value;if(n==null){if(n=s.children,s=s.defaultValue,n!=null){if(s!=null)throw Error(a(92));if(Yr(n)){if(1<n.length)throw Error(a(93));n=n[0]}s=n}s==null&&(s=""),n=s}t._wrapperState={initialValue:ye(n)}}function cc(t,s){var n=ye(s.value),c=ye(s.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),s.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),c!=null&&(t.defaultValue=""+c)}function dc(t){var s=t.textContent;s===t._wrapperState.initialValue&&s!==""&&s!==null&&(t.value=s)}function uc(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Pl(t,s){return t==null||t==="http://www.w3.org/1999/xhtml"?uc(s):t==="http://www.w3.org/2000/svg"&&s==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Zn,mc=(function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(s,n,c,m){MSApp.execUnsafeLocalFunction(function(){return t(s,n,c,m)})}:t})(function(t,s){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=s;else{for(Zn=Zn||document.createElement("div"),Zn.innerHTML="<svg>"+s.valueOf().toString()+"</svg>",s=Zn.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;s.firstChild;)t.appendChild(s.firstChild)}});function Jr(t,s){if(s){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=s;return}}t.textContent=s}var Xr={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Ch=["Webkit","ms","Moz","O"];Object.keys(Xr).forEach(function(t){Ch.forEach(function(s){s=s+t.charAt(0).toUpperCase()+t.substring(1),Xr[s]=Xr[t]})});function hc(t,s,n){return s==null||typeof s=="boolean"||s===""?"":n||typeof s!="number"||s===0||Xr.hasOwnProperty(t)&&Xr[t]?(""+s).trim():s+"px"}function fc(t,s){t=t.style;for(var n in s)if(s.hasOwnProperty(n)){var c=n.indexOf("--")===0,m=hc(n,s[n],c);n==="float"&&(n="cssFloat"),c?t.setProperty(n,m):t[n]=m}}var Th=K({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Dl(t,s){if(s){if(Th[t]&&(s.children!=null||s.dangerouslySetInnerHTML!=null))throw Error(a(137,t));if(s.dangerouslySetInnerHTML!=null){if(s.children!=null)throw Error(a(60));if(typeof s.dangerouslySetInnerHTML!="object"||!("__html"in s.dangerouslySetInnerHTML))throw Error(a(61))}if(s.style!=null&&typeof s.style!="object")throw Error(a(62))}}function Ol(t,s){if(t.indexOf("-")===-1)return typeof s.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Rl=null;function Ll(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Il=null,or=null,cr=null;function xc(t){if(t=jn(t)){if(typeof Il!="function")throw Error(a(280));var s=t.stateNode;s&&(s=wa(s),Il(t.stateNode,t.type,s))}}function pc(t){or?cr?cr.push(t):cr=[t]:or=t}function gc(){if(or){var t=or,s=cr;if(cr=or=null,xc(t),s)for(t=0;t<s.length;t++)xc(s[t])}}function vc(t,s){return t(s)}function bc(){}var Al=!1;function yc(t,s,n){if(Al)return t(s,n);Al=!0;try{return vc(t,s,n)}finally{Al=!1,(or!==null||cr!==null)&&(bc(),gc())}}function Zr(t,s){var n=t.stateNode;if(n===null)return null;var c=wa(n);if(c===null)return null;n=c[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(t=t.type,c=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!c;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(a(231,s,typeof n));return n}var Ml=!1;if(h)try{var en={};Object.defineProperty(en,"passive",{get:function(){Ml=!0}}),window.addEventListener("test",en,en),window.removeEventListener("test",en,en)}catch{Ml=!1}function Eh(t,s,n,c,m,f,w,S,E){var M=Array.prototype.slice.call(arguments,3);try{s.apply(n,M)}catch(B){this.onError(B)}}var tn=!1,ea=null,ta=!1,Fl=null,Ph={onError:function(t){tn=!0,ea=t}};function Dh(t,s,n,c,m,f,w,S,E){tn=!1,ea=null,Eh.apply(Ph,arguments)}function Oh(t,s,n,c,m,f,w,S,E){if(Dh.apply(this,arguments),tn){if(tn){var M=ea;tn=!1,ea=null}else throw Error(a(198));ta||(ta=!0,Fl=M)}}function qs(t){var s=t,n=t;if(t.alternate)for(;s.return;)s=s.return;else{t=s;do s=t,(s.flags&4098)!==0&&(n=s.return),t=s.return;while(t)}return s.tag===3?n:null}function jc(t){if(t.tag===13){var s=t.memoizedState;if(s===null&&(t=t.alternate,t!==null&&(s=t.memoizedState)),s!==null)return s.dehydrated}return null}function wc(t){if(qs(t)!==t)throw Error(a(188))}function Rh(t){var s=t.alternate;if(!s){if(s=qs(t),s===null)throw Error(a(188));return s!==t?null:t}for(var n=t,c=s;;){var m=n.return;if(m===null)break;var f=m.alternate;if(f===null){if(c=m.return,c!==null){n=c;continue}break}if(m.child===f.child){for(f=m.child;f;){if(f===n)return wc(m),t;if(f===c)return wc(m),s;f=f.sibling}throw Error(a(188))}if(n.return!==c.return)n=m,c=f;else{for(var w=!1,S=m.child;S;){if(S===n){w=!0,n=m,c=f;break}if(S===c){w=!0,c=m,n=f;break}S=S.sibling}if(!w){for(S=f.child;S;){if(S===n){w=!0,n=f,c=m;break}if(S===c){w=!0,c=f,n=m;break}S=S.sibling}if(!w)throw Error(a(189))}}if(n.alternate!==c)throw Error(a(190))}if(n.tag!==3)throw Error(a(188));return n.stateNode.current===n?t:s}function Nc(t){return t=Rh(t),t!==null?_c(t):null}function _c(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var s=_c(t);if(s!==null)return s;t=t.sibling}return null}var kc=r.unstable_scheduleCallback,Sc=r.unstable_cancelCallback,Lh=r.unstable_shouldYield,Ih=r.unstable_requestPaint,Be=r.unstable_now,Ah=r.unstable_getCurrentPriorityLevel,$l=r.unstable_ImmediatePriority,Cc=r.unstable_UserBlockingPriority,sa=r.unstable_NormalPriority,Mh=r.unstable_LowPriority,Tc=r.unstable_IdlePriority,ra=null,Yt=null;function Fh(t){if(Yt&&typeof Yt.onCommitFiberRoot=="function")try{Yt.onCommitFiberRoot(ra,t,void 0,(t.current.flags&128)===128)}catch{}}var Ft=Math.clz32?Math.clz32:Uh,$h=Math.log,qh=Math.LN2;function Uh(t){return t>>>=0,t===0?32:31-($h(t)/qh|0)|0}var na=64,aa=4194304;function sn(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function la(t,s){var n=t.pendingLanes;if(n===0)return 0;var c=0,m=t.suspendedLanes,f=t.pingedLanes,w=n&268435455;if(w!==0){var S=w&~m;S!==0?c=sn(S):(f&=w,f!==0&&(c=sn(f)))}else w=n&~m,w!==0?c=sn(w):f!==0&&(c=sn(f));if(c===0)return 0;if(s!==0&&s!==c&&(s&m)===0&&(m=c&-c,f=s&-s,m>=f||m===16&&(f&4194240)!==0))return s;if((c&4)!==0&&(c|=n&16),s=t.entangledLanes,s!==0)for(t=t.entanglements,s&=c;0<s;)n=31-Ft(s),m=1<<n,c|=t[n],s&=~m;return c}function Bh(t,s){switch(t){case 1:case 2:case 4:return s+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function zh(t,s){for(var n=t.suspendedLanes,c=t.pingedLanes,m=t.expirationTimes,f=t.pendingLanes;0<f;){var w=31-Ft(f),S=1<<w,E=m[w];E===-1?((S&n)===0||(S&c)!==0)&&(m[w]=Bh(S,s)):E<=s&&(t.expiredLanes|=S),f&=~S}}function ql(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Ec(){var t=na;return na<<=1,(na&4194240)===0&&(na=64),t}function Ul(t){for(var s=[],n=0;31>n;n++)s.push(t);return s}function rn(t,s,n){t.pendingLanes|=s,s!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,s=31-Ft(s),t[s]=n}function Wh(t,s){var n=t.pendingLanes&~s;t.pendingLanes=s,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=s,t.mutableReadLanes&=s,t.entangledLanes&=s,s=t.entanglements;var c=t.eventTimes;for(t=t.expirationTimes;0<n;){var m=31-Ft(n),f=1<<m;s[m]=0,c[m]=-1,t[m]=-1,n&=~f}}function Bl(t,s){var n=t.entangledLanes|=s;for(t=t.entanglements;n;){var c=31-Ft(n),m=1<<c;m&s|t[c]&s&&(t[c]|=s),n&=~m}}var je=0;function Pc(t){return t&=-t,1<t?4<t?(t&268435455)!==0?16:536870912:4:1}var Dc,zl,Oc,Rc,Lc,Wl=!1,ia=[],xs=null,ps=null,gs=null,nn=new Map,an=new Map,vs=[],Hh="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ic(t,s){switch(t){case"focusin":case"focusout":xs=null;break;case"dragenter":case"dragleave":ps=null;break;case"mouseover":case"mouseout":gs=null;break;case"pointerover":case"pointerout":nn.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":an.delete(s.pointerId)}}function ln(t,s,n,c,m,f){return t===null||t.nativeEvent!==f?(t={blockedOn:s,domEventName:n,eventSystemFlags:c,nativeEvent:f,targetContainers:[m]},s!==null&&(s=jn(s),s!==null&&zl(s)),t):(t.eventSystemFlags|=c,s=t.targetContainers,m!==null&&s.indexOf(m)===-1&&s.push(m),t)}function Vh(t,s,n,c,m){switch(s){case"focusin":return xs=ln(xs,t,s,n,c,m),!0;case"dragenter":return ps=ln(ps,t,s,n,c,m),!0;case"mouseover":return gs=ln(gs,t,s,n,c,m),!0;case"pointerover":var f=m.pointerId;return nn.set(f,ln(nn.get(f)||null,t,s,n,c,m)),!0;case"gotpointercapture":return f=m.pointerId,an.set(f,ln(an.get(f)||null,t,s,n,c,m)),!0}return!1}function Ac(t){var s=Us(t.target);if(s!==null){var n=qs(s);if(n!==null){if(s=n.tag,s===13){if(s=jc(n),s!==null){t.blockedOn=s,Lc(t.priority,function(){Oc(n)});return}}else if(s===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function oa(t){if(t.blockedOn!==null)return!1;for(var s=t.targetContainers;0<s.length;){var n=Vl(t.domEventName,t.eventSystemFlags,s[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var c=new n.constructor(n.type,n);Rl=c,n.target.dispatchEvent(c),Rl=null}else return s=jn(n),s!==null&&zl(s),t.blockedOn=n,!1;s.shift()}return!0}function Mc(t,s,n){oa(t)&&n.delete(s)}function Qh(){Wl=!1,xs!==null&&oa(xs)&&(xs=null),ps!==null&&oa(ps)&&(ps=null),gs!==null&&oa(gs)&&(gs=null),nn.forEach(Mc),an.forEach(Mc)}function on(t,s){t.blockedOn===s&&(t.blockedOn=null,Wl||(Wl=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,Qh)))}function cn(t){function s(m){return on(m,t)}if(0<ia.length){on(ia[0],t);for(var n=1;n<ia.length;n++){var c=ia[n];c.blockedOn===t&&(c.blockedOn=null)}}for(xs!==null&&on(xs,t),ps!==null&&on(ps,t),gs!==null&&on(gs,t),nn.forEach(s),an.forEach(s),n=0;n<vs.length;n++)c=vs[n],c.blockedOn===t&&(c.blockedOn=null);for(;0<vs.length&&(n=vs[0],n.blockedOn===null);)Ac(n),n.blockedOn===null&&vs.shift()}var dr=D.ReactCurrentBatchConfig,ca=!0;function Gh(t,s,n,c){var m=je,f=dr.transition;dr.transition=null;try{je=1,Hl(t,s,n,c)}finally{je=m,dr.transition=f}}function Kh(t,s,n,c){var m=je,f=dr.transition;dr.transition=null;try{je=4,Hl(t,s,n,c)}finally{je=m,dr.transition=f}}function Hl(t,s,n,c){if(ca){var m=Vl(t,s,n,c);if(m===null)ci(t,s,c,da,n),Ic(t,c);else if(Vh(m,t,s,n,c))c.stopPropagation();else if(Ic(t,c),s&4&&-1<Hh.indexOf(t)){for(;m!==null;){var f=jn(m);if(f!==null&&Dc(f),f=Vl(t,s,n,c),f===null&&ci(t,s,c,da,n),f===m)break;m=f}m!==null&&c.stopPropagation()}else ci(t,s,c,null,n)}}var da=null;function Vl(t,s,n,c){if(da=null,t=Ll(c),t=Us(t),t!==null)if(s=qs(t),s===null)t=null;else if(n=s.tag,n===13){if(t=jc(s),t!==null)return t;t=null}else if(n===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;t=null}else s!==t&&(t=null);return da=t,null}function Fc(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Ah()){case $l:return 1;case Cc:return 4;case sa:case Mh:return 16;case Tc:return 536870912;default:return 16}default:return 16}}var bs=null,Ql=null,ua=null;function $c(){if(ua)return ua;var t,s=Ql,n=s.length,c,m="value"in bs?bs.value:bs.textContent,f=m.length;for(t=0;t<n&&s[t]===m[t];t++);var w=n-t;for(c=1;c<=w&&s[n-c]===m[f-c];c++);return ua=m.slice(t,1<c?1-c:void 0)}function ma(t){var s=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&s===13&&(t=13)):t=s,t===10&&(t=13),32<=t||t===13?t:0}function ha(){return!0}function qc(){return!1}function Nt(t){function s(n,c,m,f,w){this._reactName=n,this._targetInst=m,this.type=c,this.nativeEvent=f,this.target=w,this.currentTarget=null;for(var S in t)t.hasOwnProperty(S)&&(n=t[S],this[S]=n?n(f):f[S]);return this.isDefaultPrevented=(f.defaultPrevented!=null?f.defaultPrevented:f.returnValue===!1)?ha:qc,this.isPropagationStopped=qc,this}return K(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=ha)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=ha)},persist:function(){},isPersistent:ha}),s}var ur={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Gl=Nt(ur),dn=K({},ur,{view:0,detail:0}),Yh=Nt(dn),Kl,Yl,un,fa=K({},dn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Xl,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==un&&(un&&t.type==="mousemove"?(Kl=t.screenX-un.screenX,Yl=t.screenY-un.screenY):Yl=Kl=0,un=t),Kl)},movementY:function(t){return"movementY"in t?t.movementY:Yl}}),Uc=Nt(fa),Jh=K({},fa,{dataTransfer:0}),Xh=Nt(Jh),Zh=K({},dn,{relatedTarget:0}),Jl=Nt(Zh),ef=K({},ur,{animationName:0,elapsedTime:0,pseudoElement:0}),tf=Nt(ef),sf=K({},ur,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),rf=Nt(sf),nf=K({},ur,{data:0}),Bc=Nt(nf),af={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},lf={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},of={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function cf(t){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(t):(t=of[t])?!!s[t]:!1}function Xl(){return cf}var df=K({},dn,{key:function(t){if(t.key){var s=af[t.key]||t.key;if(s!=="Unidentified")return s}return t.type==="keypress"?(t=ma(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?lf[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Xl,charCode:function(t){return t.type==="keypress"?ma(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?ma(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),uf=Nt(df),mf=K({},fa,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),zc=Nt(mf),hf=K({},dn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Xl}),ff=Nt(hf),xf=K({},ur,{propertyName:0,elapsedTime:0,pseudoElement:0}),pf=Nt(xf),gf=K({},fa,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),vf=Nt(gf),bf=[9,13,27,32],Zl=h&&"CompositionEvent"in window,mn=null;h&&"documentMode"in document&&(mn=document.documentMode);var yf=h&&"TextEvent"in window&&!mn,Wc=h&&(!Zl||mn&&8<mn&&11>=mn),Hc=" ",Vc=!1;function Qc(t,s){switch(t){case"keyup":return bf.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Gc(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var mr=!1;function jf(t,s){switch(t){case"compositionend":return Gc(s);case"keypress":return s.which!==32?null:(Vc=!0,Hc);case"textInput":return t=s.data,t===Hc&&Vc?null:t;default:return null}}function wf(t,s){if(mr)return t==="compositionend"||!Zl&&Qc(t,s)?(t=$c(),ua=Ql=bs=null,mr=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return Wc&&s.locale!=="ko"?null:s.data;default:return null}}var Nf={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Kc(t){var s=t&&t.nodeName&&t.nodeName.toLowerCase();return s==="input"?!!Nf[t.type]:s==="textarea"}function Yc(t,s,n,c){pc(c),s=ba(s,"onChange"),0<s.length&&(n=new Gl("onChange","change",null,n,c),t.push({event:n,listeners:s}))}var hn=null,fn=null;function _f(t){fd(t,0)}function xa(t){var s=gr(t);if(nc(s))return t}function kf(t,s){if(t==="change")return s}var Jc=!1;if(h){var ei;if(h){var ti="oninput"in document;if(!ti){var Xc=document.createElement("div");Xc.setAttribute("oninput","return;"),ti=typeof Xc.oninput=="function"}ei=ti}else ei=!1;Jc=ei&&(!document.documentMode||9<document.documentMode)}function Zc(){hn&&(hn.detachEvent("onpropertychange",ed),fn=hn=null)}function ed(t){if(t.propertyName==="value"&&xa(fn)){var s=[];Yc(s,fn,t,Ll(t)),yc(_f,s)}}function Sf(t,s,n){t==="focusin"?(Zc(),hn=s,fn=n,hn.attachEvent("onpropertychange",ed)):t==="focusout"&&Zc()}function Cf(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return xa(fn)}function Tf(t,s){if(t==="click")return xa(s)}function Ef(t,s){if(t==="input"||t==="change")return xa(s)}function Pf(t,s){return t===s&&(t!==0||1/t===1/s)||t!==t&&s!==s}var $t=typeof Object.is=="function"?Object.is:Pf;function xn(t,s){if($t(t,s))return!0;if(typeof t!="object"||t===null||typeof s!="object"||s===null)return!1;var n=Object.keys(t),c=Object.keys(s);if(n.length!==c.length)return!1;for(c=0;c<n.length;c++){var m=n[c];if(!p.call(s,m)||!$t(t[m],s[m]))return!1}return!0}function td(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function sd(t,s){var n=td(t);t=0;for(var c;n;){if(n.nodeType===3){if(c=t+n.textContent.length,t<=s&&c>=s)return{node:n,offset:s-t};t=c}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=td(n)}}function rd(t,s){return t&&s?t===s?!0:t&&t.nodeType===3?!1:s&&s.nodeType===3?rd(t,s.parentNode):"contains"in t?t.contains(s):t.compareDocumentPosition?!!(t.compareDocumentPosition(s)&16):!1:!1}function nd(){for(var t=window,s=Xn();s instanceof t.HTMLIFrameElement;){try{var n=typeof s.contentWindow.location.href=="string"}catch{n=!1}if(n)t=s.contentWindow;else break;s=Xn(t.document)}return s}function si(t){var s=t&&t.nodeName&&t.nodeName.toLowerCase();return s&&(s==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||s==="textarea"||t.contentEditable==="true")}function Df(t){var s=nd(),n=t.focusedElem,c=t.selectionRange;if(s!==n&&n&&n.ownerDocument&&rd(n.ownerDocument.documentElement,n)){if(c!==null&&si(n)){if(s=c.start,t=c.end,t===void 0&&(t=s),"selectionStart"in n)n.selectionStart=s,n.selectionEnd=Math.min(t,n.value.length);else if(t=(s=n.ownerDocument||document)&&s.defaultView||window,t.getSelection){t=t.getSelection();var m=n.textContent.length,f=Math.min(c.start,m);c=c.end===void 0?f:Math.min(c.end,m),!t.extend&&f>c&&(m=c,c=f,f=m),m=sd(n,f);var w=sd(n,c);m&&w&&(t.rangeCount!==1||t.anchorNode!==m.node||t.anchorOffset!==m.offset||t.focusNode!==w.node||t.focusOffset!==w.offset)&&(s=s.createRange(),s.setStart(m.node,m.offset),t.removeAllRanges(),f>c?(t.addRange(s),t.extend(w.node,w.offset)):(s.setEnd(w.node,w.offset),t.addRange(s)))}}for(s=[],t=n;t=t.parentNode;)t.nodeType===1&&s.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<s.length;n++)t=s[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var Of=h&&"documentMode"in document&&11>=document.documentMode,hr=null,ri=null,pn=null,ni=!1;function ad(t,s,n){var c=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;ni||hr==null||hr!==Xn(c)||(c=hr,"selectionStart"in c&&si(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),pn&&xn(pn,c)||(pn=c,c=ba(ri,"onSelect"),0<c.length&&(s=new Gl("onSelect","select",null,s,n),t.push({event:s,listeners:c}),s.target=hr)))}function pa(t,s){var n={};return n[t.toLowerCase()]=s.toLowerCase(),n["Webkit"+t]="webkit"+s,n["Moz"+t]="moz"+s,n}var fr={animationend:pa("Animation","AnimationEnd"),animationiteration:pa("Animation","AnimationIteration"),animationstart:pa("Animation","AnimationStart"),transitionend:pa("Transition","TransitionEnd")},ai={},ld={};h&&(ld=document.createElement("div").style,"AnimationEvent"in window||(delete fr.animationend.animation,delete fr.animationiteration.animation,delete fr.animationstart.animation),"TransitionEvent"in window||delete fr.transitionend.transition);function ga(t){if(ai[t])return ai[t];if(!fr[t])return t;var s=fr[t],n;for(n in s)if(s.hasOwnProperty(n)&&n in ld)return ai[t]=s[n];return t}var id=ga("animationend"),od=ga("animationiteration"),cd=ga("animationstart"),dd=ga("transitionend"),ud=new Map,md="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ys(t,s){ud.set(t,s),d(s,[t])}for(var li=0;li<md.length;li++){var ii=md[li],Rf=ii.toLowerCase(),Lf=ii[0].toUpperCase()+ii.slice(1);ys(Rf,"on"+Lf)}ys(id,"onAnimationEnd"),ys(od,"onAnimationIteration"),ys(cd,"onAnimationStart"),ys("dblclick","onDoubleClick"),ys("focusin","onFocus"),ys("focusout","onBlur"),ys(dd,"onTransitionEnd"),u("onMouseEnter",["mouseout","mouseover"]),u("onMouseLeave",["mouseout","mouseover"]),u("onPointerEnter",["pointerout","pointerover"]),u("onPointerLeave",["pointerout","pointerover"]),d("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),d("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),d("onBeforeInput",["compositionend","keypress","textInput","paste"]),d("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),d("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),d("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var gn="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),If=new Set("cancel close invalid load scroll toggle".split(" ").concat(gn));function hd(t,s,n){var c=t.type||"unknown-event";t.currentTarget=n,Oh(c,s,void 0,t),t.currentTarget=null}function fd(t,s){s=(s&4)!==0;for(var n=0;n<t.length;n++){var c=t[n],m=c.event;c=c.listeners;e:{var f=void 0;if(s)for(var w=c.length-1;0<=w;w--){var S=c[w],E=S.instance,M=S.currentTarget;if(S=S.listener,E!==f&&m.isPropagationStopped())break e;hd(m,S,M),f=E}else for(w=0;w<c.length;w++){if(S=c[w],E=S.instance,M=S.currentTarget,S=S.listener,E!==f&&m.isPropagationStopped())break e;hd(m,S,M),f=E}}}if(ta)throw t=Fl,ta=!1,Fl=null,t}function Pe(t,s){var n=s[xi];n===void 0&&(n=s[xi]=new Set);var c=t+"__bubble";n.has(c)||(xd(s,t,2,!1),n.add(c))}function oi(t,s,n){var c=0;s&&(c|=4),xd(n,t,c,s)}var va="_reactListening"+Math.random().toString(36).slice(2);function vn(t){if(!t[va]){t[va]=!0,l.forEach(function(n){n!=="selectionchange"&&(If.has(n)||oi(n,!1,t),oi(n,!0,t))});var s=t.nodeType===9?t:t.ownerDocument;s===null||s[va]||(s[va]=!0,oi("selectionchange",!1,s))}}function xd(t,s,n,c){switch(Fc(s)){case 1:var m=Gh;break;case 4:m=Kh;break;default:m=Hl}n=m.bind(null,s,n,t),m=void 0,!Ml||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(m=!0),c?m!==void 0?t.addEventListener(s,n,{capture:!0,passive:m}):t.addEventListener(s,n,!0):m!==void 0?t.addEventListener(s,n,{passive:m}):t.addEventListener(s,n,!1)}function ci(t,s,n,c,m){var f=c;if((s&1)===0&&(s&2)===0&&c!==null)e:for(;;){if(c===null)return;var w=c.tag;if(w===3||w===4){var S=c.stateNode.containerInfo;if(S===m||S.nodeType===8&&S.parentNode===m)break;if(w===4)for(w=c.return;w!==null;){var E=w.tag;if((E===3||E===4)&&(E=w.stateNode.containerInfo,E===m||E.nodeType===8&&E.parentNode===m))return;w=w.return}for(;S!==null;){if(w=Us(S),w===null)return;if(E=w.tag,E===5||E===6){c=f=w;continue e}S=S.parentNode}}c=c.return}yc(function(){var M=f,B=Ll(n),W=[];e:{var q=ud.get(t);if(q!==void 0){var Y=Gl,X=t;switch(t){case"keypress":if(ma(n)===0)break e;case"keydown":case"keyup":Y=uf;break;case"focusin":X="focus",Y=Jl;break;case"focusout":X="blur",Y=Jl;break;case"beforeblur":case"afterblur":Y=Jl;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Y=Uc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Y=Xh;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Y=ff;break;case id:case od:case cd:Y=tf;break;case dd:Y=pf;break;case"scroll":Y=Yh;break;case"wheel":Y=vf;break;case"copy":case"cut":case"paste":Y=rf;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Y=zc}var ee=(s&4)!==0,ze=!ee&&t==="scroll",L=ee?q!==null?q+"Capture":null:q;ee=[];for(var P=M,A;P!==null;){A=P;var Q=A.stateNode;if(A.tag===5&&Q!==null&&(A=Q,L!==null&&(Q=Zr(P,L),Q!=null&&ee.push(bn(P,Q,A)))),ze)break;P=P.return}0<ee.length&&(q=new Y(q,X,null,n,B),W.push({event:q,listeners:ee}))}}if((s&7)===0){e:{if(q=t==="mouseover"||t==="pointerover",Y=t==="mouseout"||t==="pointerout",q&&n!==Rl&&(X=n.relatedTarget||n.fromElement)&&(Us(X)||X[ns]))break e;if((Y||q)&&(q=B.window===B?B:(q=B.ownerDocument)?q.defaultView||q.parentWindow:window,Y?(X=n.relatedTarget||n.toElement,Y=M,X=X?Us(X):null,X!==null&&(ze=qs(X),X!==ze||X.tag!==5&&X.tag!==6)&&(X=null)):(Y=null,X=M),Y!==X)){if(ee=Uc,Q="onMouseLeave",L="onMouseEnter",P="mouse",(t==="pointerout"||t==="pointerover")&&(ee=zc,Q="onPointerLeave",L="onPointerEnter",P="pointer"),ze=Y==null?q:gr(Y),A=X==null?q:gr(X),q=new ee(Q,P+"leave",Y,n,B),q.target=ze,q.relatedTarget=A,Q=null,Us(B)===M&&(ee=new ee(L,P+"enter",X,n,B),ee.target=A,ee.relatedTarget=ze,Q=ee),ze=Q,Y&&X)t:{for(ee=Y,L=X,P=0,A=ee;A;A=xr(A))P++;for(A=0,Q=L;Q;Q=xr(Q))A++;for(;0<P-A;)ee=xr(ee),P--;for(;0<A-P;)L=xr(L),A--;for(;P--;){if(ee===L||L!==null&&ee===L.alternate)break t;ee=xr(ee),L=xr(L)}ee=null}else ee=null;Y!==null&&pd(W,q,Y,ee,!1),X!==null&&ze!==null&&pd(W,ze,X,ee,!0)}}e:{if(q=M?gr(M):window,Y=q.nodeName&&q.nodeName.toLowerCase(),Y==="select"||Y==="input"&&q.type==="file")var te=kf;else if(Kc(q))if(Jc)te=Ef;else{te=Cf;var re=Sf}else(Y=q.nodeName)&&Y.toLowerCase()==="input"&&(q.type==="checkbox"||q.type==="radio")&&(te=Tf);if(te&&(te=te(t,M))){Yc(W,te,n,B);break e}re&&re(t,q,M),t==="focusout"&&(re=q._wrapperState)&&re.controlled&&q.type==="number"&&Tl(q,"number",q.value)}switch(re=M?gr(M):window,t){case"focusin":(Kc(re)||re.contentEditable==="true")&&(hr=re,ri=M,pn=null);break;case"focusout":pn=ri=hr=null;break;case"mousedown":ni=!0;break;case"contextmenu":case"mouseup":case"dragend":ni=!1,ad(W,n,B);break;case"selectionchange":if(Of)break;case"keydown":case"keyup":ad(W,n,B)}var ne;if(Zl)e:{switch(t){case"compositionstart":var le="onCompositionStart";break e;case"compositionend":le="onCompositionEnd";break e;case"compositionupdate":le="onCompositionUpdate";break e}le=void 0}else mr?Qc(t,n)&&(le="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(le="onCompositionStart");le&&(Wc&&n.locale!=="ko"&&(mr||le!=="onCompositionStart"?le==="onCompositionEnd"&&mr&&(ne=$c()):(bs=B,Ql="value"in bs?bs.value:bs.textContent,mr=!0)),re=ba(M,le),0<re.length&&(le=new Bc(le,t,null,n,B),W.push({event:le,listeners:re}),ne?le.data=ne:(ne=Gc(n),ne!==null&&(le.data=ne)))),(ne=yf?jf(t,n):wf(t,n))&&(M=ba(M,"onBeforeInput"),0<M.length&&(B=new Bc("onBeforeInput","beforeinput",null,n,B),W.push({event:B,listeners:M}),B.data=ne))}fd(W,s)})}function bn(t,s,n){return{instance:t,listener:s,currentTarget:n}}function ba(t,s){for(var n=s+"Capture",c=[];t!==null;){var m=t,f=m.stateNode;m.tag===5&&f!==null&&(m=f,f=Zr(t,n),f!=null&&c.unshift(bn(t,f,m)),f=Zr(t,s),f!=null&&c.push(bn(t,f,m))),t=t.return}return c}function xr(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function pd(t,s,n,c,m){for(var f=s._reactName,w=[];n!==null&&n!==c;){var S=n,E=S.alternate,M=S.stateNode;if(E!==null&&E===c)break;S.tag===5&&M!==null&&(S=M,m?(E=Zr(n,f),E!=null&&w.unshift(bn(n,E,S))):m||(E=Zr(n,f),E!=null&&w.push(bn(n,E,S)))),n=n.return}w.length!==0&&t.push({event:s,listeners:w})}var Af=/\r\n?/g,Mf=/\u0000|\uFFFD/g;function gd(t){return(typeof t=="string"?t:""+t).replace(Af,`
`).replace(Mf,"")}function ya(t,s,n){if(s=gd(s),gd(t)!==s&&n)throw Error(a(425))}function ja(){}var di=null,ui=null;function mi(t,s){return t==="textarea"||t==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var hi=typeof setTimeout=="function"?setTimeout:void 0,Ff=typeof clearTimeout=="function"?clearTimeout:void 0,vd=typeof Promise=="function"?Promise:void 0,$f=typeof queueMicrotask=="function"?queueMicrotask:typeof vd<"u"?function(t){return vd.resolve(null).then(t).catch(qf)}:hi;function qf(t){setTimeout(function(){throw t})}function fi(t,s){var n=s,c=0;do{var m=n.nextSibling;if(t.removeChild(n),m&&m.nodeType===8)if(n=m.data,n==="/$"){if(c===0){t.removeChild(m),cn(s);return}c--}else n!=="$"&&n!=="$?"&&n!=="$!"||c++;n=m}while(n);cn(s)}function js(t){for(;t!=null;t=t.nextSibling){var s=t.nodeType;if(s===1||s===3)break;if(s===8){if(s=t.data,s==="$"||s==="$!"||s==="$?")break;if(s==="/$")return null}}return t}function bd(t){t=t.previousSibling;for(var s=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(s===0)return t;s--}else n==="/$"&&s++}t=t.previousSibling}return null}var pr=Math.random().toString(36).slice(2),Jt="__reactFiber$"+pr,yn="__reactProps$"+pr,ns="__reactContainer$"+pr,xi="__reactEvents$"+pr,Uf="__reactListeners$"+pr,Bf="__reactHandles$"+pr;function Us(t){var s=t[Jt];if(s)return s;for(var n=t.parentNode;n;){if(s=n[ns]||n[Jt]){if(n=s.alternate,s.child!==null||n!==null&&n.child!==null)for(t=bd(t);t!==null;){if(n=t[Jt])return n;t=bd(t)}return s}t=n,n=t.parentNode}return null}function jn(t){return t=t[Jt]||t[ns],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function gr(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(a(33))}function wa(t){return t[yn]||null}var pi=[],vr=-1;function ws(t){return{current:t}}function De(t){0>vr||(t.current=pi[vr],pi[vr]=null,vr--)}function Se(t,s){vr++,pi[vr]=t.current,t.current=s}var Ns={},nt=ws(Ns),xt=ws(!1),Bs=Ns;function br(t,s){var n=t.type.contextTypes;if(!n)return Ns;var c=t.stateNode;if(c&&c.__reactInternalMemoizedUnmaskedChildContext===s)return c.__reactInternalMemoizedMaskedChildContext;var m={},f;for(f in n)m[f]=s[f];return c&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=m),m}function pt(t){return t=t.childContextTypes,t!=null}function Na(){De(xt),De(nt)}function yd(t,s,n){if(nt.current!==Ns)throw Error(a(168));Se(nt,s),Se(xt,n)}function jd(t,s,n){var c=t.stateNode;if(s=s.childContextTypes,typeof c.getChildContext!="function")return n;c=c.getChildContext();for(var m in c)if(!(m in s))throw Error(a(108,ke(t)||"Unknown",m));return K({},n,c)}function _a(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Ns,Bs=nt.current,Se(nt,t),Se(xt,xt.current),!0}function wd(t,s,n){var c=t.stateNode;if(!c)throw Error(a(169));n?(t=jd(t,s,Bs),c.__reactInternalMemoizedMergedChildContext=t,De(xt),De(nt),Se(nt,t)):De(xt),Se(xt,n)}var as=null,ka=!1,gi=!1;function Nd(t){as===null?as=[t]:as.push(t)}function zf(t){ka=!0,Nd(t)}function _s(){if(!gi&&as!==null){gi=!0;var t=0,s=je;try{var n=as;for(je=1;t<n.length;t++){var c=n[t];do c=c(!0);while(c!==null)}as=null,ka=!1}catch(m){throw as!==null&&(as=as.slice(t+1)),kc($l,_s),m}finally{je=s,gi=!1}}return null}var yr=[],jr=0,Sa=null,Ca=0,Et=[],Pt=0,zs=null,ls=1,is="";function Ws(t,s){yr[jr++]=Ca,yr[jr++]=Sa,Sa=t,Ca=s}function _d(t,s,n){Et[Pt++]=ls,Et[Pt++]=is,Et[Pt++]=zs,zs=t;var c=ls;t=is;var m=32-Ft(c)-1;c&=~(1<<m),n+=1;var f=32-Ft(s)+m;if(30<f){var w=m-m%5;f=(c&(1<<w)-1).toString(32),c>>=w,m-=w,ls=1<<32-Ft(s)+m|n<<m|c,is=f+t}else ls=1<<f|n<<m|c,is=t}function vi(t){t.return!==null&&(Ws(t,1),_d(t,1,0))}function bi(t){for(;t===Sa;)Sa=yr[--jr],yr[jr]=null,Ca=yr[--jr],yr[jr]=null;for(;t===zs;)zs=Et[--Pt],Et[Pt]=null,is=Et[--Pt],Et[Pt]=null,ls=Et[--Pt],Et[Pt]=null}var _t=null,kt=null,Ie=!1,qt=null;function kd(t,s){var n=Lt(5,null,null,0);n.elementType="DELETED",n.stateNode=s,n.return=t,s=t.deletions,s===null?(t.deletions=[n],t.flags|=16):s.push(n)}function Sd(t,s){switch(t.tag){case 5:var n=t.type;return s=s.nodeType!==1||n.toLowerCase()!==s.nodeName.toLowerCase()?null:s,s!==null?(t.stateNode=s,_t=t,kt=js(s.firstChild),!0):!1;case 6:return s=t.pendingProps===""||s.nodeType!==3?null:s,s!==null?(t.stateNode=s,_t=t,kt=null,!0):!1;case 13:return s=s.nodeType!==8?null:s,s!==null?(n=zs!==null?{id:ls,overflow:is}:null,t.memoizedState={dehydrated:s,treeContext:n,retryLane:1073741824},n=Lt(18,null,null,0),n.stateNode=s,n.return=t,t.child=n,_t=t,kt=null,!0):!1;default:return!1}}function yi(t){return(t.mode&1)!==0&&(t.flags&128)===0}function ji(t){if(Ie){var s=kt;if(s){var n=s;if(!Sd(t,s)){if(yi(t))throw Error(a(418));s=js(n.nextSibling);var c=_t;s&&Sd(t,s)?kd(c,n):(t.flags=t.flags&-4097|2,Ie=!1,_t=t)}}else{if(yi(t))throw Error(a(418));t.flags=t.flags&-4097|2,Ie=!1,_t=t}}}function Cd(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;_t=t}function Ta(t){if(t!==_t)return!1;if(!Ie)return Cd(t),Ie=!0,!1;var s;if((s=t.tag!==3)&&!(s=t.tag!==5)&&(s=t.type,s=s!=="head"&&s!=="body"&&!mi(t.type,t.memoizedProps)),s&&(s=kt)){if(yi(t))throw Td(),Error(a(418));for(;s;)kd(t,s),s=js(s.nextSibling)}if(Cd(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(a(317));e:{for(t=t.nextSibling,s=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(s===0){kt=js(t.nextSibling);break e}s--}else n!=="$"&&n!=="$!"&&n!=="$?"||s++}t=t.nextSibling}kt=null}}else kt=_t?js(t.stateNode.nextSibling):null;return!0}function Td(){for(var t=kt;t;)t=js(t.nextSibling)}function wr(){kt=_t=null,Ie=!1}function wi(t){qt===null?qt=[t]:qt.push(t)}var Wf=D.ReactCurrentBatchConfig;function wn(t,s,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(a(309));var c=n.stateNode}if(!c)throw Error(a(147,t));var m=c,f=""+t;return s!==null&&s.ref!==null&&typeof s.ref=="function"&&s.ref._stringRef===f?s.ref:(s=function(w){var S=m.refs;w===null?delete S[f]:S[f]=w},s._stringRef=f,s)}if(typeof t!="string")throw Error(a(284));if(!n._owner)throw Error(a(290,t))}return t}function Ea(t,s){throw t=Object.prototype.toString.call(s),Error(a(31,t==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":t))}function Ed(t){var s=t._init;return s(t._payload)}function Pd(t){function s(L,P){if(t){var A=L.deletions;A===null?(L.deletions=[P],L.flags|=16):A.push(P)}}function n(L,P){if(!t)return null;for(;P!==null;)s(L,P),P=P.sibling;return null}function c(L,P){for(L=new Map;P!==null;)P.key!==null?L.set(P.key,P):L.set(P.index,P),P=P.sibling;return L}function m(L,P){return L=Os(L,P),L.index=0,L.sibling=null,L}function f(L,P,A){return L.index=A,t?(A=L.alternate,A!==null?(A=A.index,A<P?(L.flags|=2,P):A):(L.flags|=2,P)):(L.flags|=1048576,P)}function w(L){return t&&L.alternate===null&&(L.flags|=2),L}function S(L,P,A,Q){return P===null||P.tag!==6?(P=fo(A,L.mode,Q),P.return=L,P):(P=m(P,A),P.return=L,P)}function E(L,P,A,Q){var te=A.type;return te===H?B(L,P,A.props.children,Q,A.key):P!==null&&(P.elementType===te||typeof te=="object"&&te!==null&&te.$$typeof===qe&&Ed(te)===P.type)?(Q=m(P,A.props),Q.ref=wn(L,P,A),Q.return=L,Q):(Q=Za(A.type,A.key,A.props,null,L.mode,Q),Q.ref=wn(L,P,A),Q.return=L,Q)}function M(L,P,A,Q){return P===null||P.tag!==4||P.stateNode.containerInfo!==A.containerInfo||P.stateNode.implementation!==A.implementation?(P=xo(A,L.mode,Q),P.return=L,P):(P=m(P,A.children||[]),P.return=L,P)}function B(L,P,A,Q,te){return P===null||P.tag!==7?(P=Xs(A,L.mode,Q,te),P.return=L,P):(P=m(P,A),P.return=L,P)}function W(L,P,A){if(typeof P=="string"&&P!==""||typeof P=="number")return P=fo(""+P,L.mode,A),P.return=L,P;if(typeof P=="object"&&P!==null){switch(P.$$typeof){case R:return A=Za(P.type,P.key,P.props,null,L.mode,A),A.ref=wn(L,null,P),A.return=L,A;case F:return P=xo(P,L.mode,A),P.return=L,P;case qe:var Q=P._init;return W(L,Q(P._payload),A)}if(Yr(P)||se(P))return P=Xs(P,L.mode,A,null),P.return=L,P;Ea(L,P)}return null}function q(L,P,A,Q){var te=P!==null?P.key:null;if(typeof A=="string"&&A!==""||typeof A=="number")return te!==null?null:S(L,P,""+A,Q);if(typeof A=="object"&&A!==null){switch(A.$$typeof){case R:return A.key===te?E(L,P,A,Q):null;case F:return A.key===te?M(L,P,A,Q):null;case qe:return te=A._init,q(L,P,te(A._payload),Q)}if(Yr(A)||se(A))return te!==null?null:B(L,P,A,Q,null);Ea(L,A)}return null}function Y(L,P,A,Q,te){if(typeof Q=="string"&&Q!==""||typeof Q=="number")return L=L.get(A)||null,S(P,L,""+Q,te);if(typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case R:return L=L.get(Q.key===null?A:Q.key)||null,E(P,L,Q,te);case F:return L=L.get(Q.key===null?A:Q.key)||null,M(P,L,Q,te);case qe:var re=Q._init;return Y(L,P,A,re(Q._payload),te)}if(Yr(Q)||se(Q))return L=L.get(A)||null,B(P,L,Q,te,null);Ea(P,Q)}return null}function X(L,P,A,Q){for(var te=null,re=null,ne=P,le=P=0,Xe=null;ne!==null&&le<A.length;le++){ne.index>le?(Xe=ne,ne=null):Xe=ne.sibling;var pe=q(L,ne,A[le],Q);if(pe===null){ne===null&&(ne=Xe);break}t&&ne&&pe.alternate===null&&s(L,ne),P=f(pe,P,le),re===null?te=pe:re.sibling=pe,re=pe,ne=Xe}if(le===A.length)return n(L,ne),Ie&&Ws(L,le),te;if(ne===null){for(;le<A.length;le++)ne=W(L,A[le],Q),ne!==null&&(P=f(ne,P,le),re===null?te=ne:re.sibling=ne,re=ne);return Ie&&Ws(L,le),te}for(ne=c(L,ne);le<A.length;le++)Xe=Y(ne,L,le,A[le],Q),Xe!==null&&(t&&Xe.alternate!==null&&ne.delete(Xe.key===null?le:Xe.key),P=f(Xe,P,le),re===null?te=Xe:re.sibling=Xe,re=Xe);return t&&ne.forEach(function(Rs){return s(L,Rs)}),Ie&&Ws(L,le),te}function ee(L,P,A,Q){var te=se(A);if(typeof te!="function")throw Error(a(150));if(A=te.call(A),A==null)throw Error(a(151));for(var re=te=null,ne=P,le=P=0,Xe=null,pe=A.next();ne!==null&&!pe.done;le++,pe=A.next()){ne.index>le?(Xe=ne,ne=null):Xe=ne.sibling;var Rs=q(L,ne,pe.value,Q);if(Rs===null){ne===null&&(ne=Xe);break}t&&ne&&Rs.alternate===null&&s(L,ne),P=f(Rs,P,le),re===null?te=Rs:re.sibling=Rs,re=Rs,ne=Xe}if(pe.done)return n(L,ne),Ie&&Ws(L,le),te;if(ne===null){for(;!pe.done;le++,pe=A.next())pe=W(L,pe.value,Q),pe!==null&&(P=f(pe,P,le),re===null?te=pe:re.sibling=pe,re=pe);return Ie&&Ws(L,le),te}for(ne=c(L,ne);!pe.done;le++,pe=A.next())pe=Y(ne,L,le,pe.value,Q),pe!==null&&(t&&pe.alternate!==null&&ne.delete(pe.key===null?le:pe.key),P=f(pe,P,le),re===null?te=pe:re.sibling=pe,re=pe);return t&&ne.forEach(function(N0){return s(L,N0)}),Ie&&Ws(L,le),te}function ze(L,P,A,Q){if(typeof A=="object"&&A!==null&&A.type===H&&A.key===null&&(A=A.props.children),typeof A=="object"&&A!==null){switch(A.$$typeof){case R:e:{for(var te=A.key,re=P;re!==null;){if(re.key===te){if(te=A.type,te===H){if(re.tag===7){n(L,re.sibling),P=m(re,A.props.children),P.return=L,L=P;break e}}else if(re.elementType===te||typeof te=="object"&&te!==null&&te.$$typeof===qe&&Ed(te)===re.type){n(L,re.sibling),P=m(re,A.props),P.ref=wn(L,re,A),P.return=L,L=P;break e}n(L,re);break}else s(L,re);re=re.sibling}A.type===H?(P=Xs(A.props.children,L.mode,Q,A.key),P.return=L,L=P):(Q=Za(A.type,A.key,A.props,null,L.mode,Q),Q.ref=wn(L,P,A),Q.return=L,L=Q)}return w(L);case F:e:{for(re=A.key;P!==null;){if(P.key===re)if(P.tag===4&&P.stateNode.containerInfo===A.containerInfo&&P.stateNode.implementation===A.implementation){n(L,P.sibling),P=m(P,A.children||[]),P.return=L,L=P;break e}else{n(L,P);break}else s(L,P);P=P.sibling}P=xo(A,L.mode,Q),P.return=L,L=P}return w(L);case qe:return re=A._init,ze(L,P,re(A._payload),Q)}if(Yr(A))return X(L,P,A,Q);if(se(A))return ee(L,P,A,Q);Ea(L,A)}return typeof A=="string"&&A!==""||typeof A=="number"?(A=""+A,P!==null&&P.tag===6?(n(L,P.sibling),P=m(P,A),P.return=L,L=P):(n(L,P),P=fo(A,L.mode,Q),P.return=L,L=P),w(L)):n(L,P)}return ze}var Nr=Pd(!0),Dd=Pd(!1),Pa=ws(null),Da=null,_r=null,Ni=null;function _i(){Ni=_r=Da=null}function ki(t){var s=Pa.current;De(Pa),t._currentValue=s}function Si(t,s,n){for(;t!==null;){var c=t.alternate;if((t.childLanes&s)!==s?(t.childLanes|=s,c!==null&&(c.childLanes|=s)):c!==null&&(c.childLanes&s)!==s&&(c.childLanes|=s),t===n)break;t=t.return}}function kr(t,s){Da=t,Ni=_r=null,t=t.dependencies,t!==null&&t.firstContext!==null&&((t.lanes&s)!==0&&(gt=!0),t.firstContext=null)}function Dt(t){var s=t._currentValue;if(Ni!==t)if(t={context:t,memoizedValue:s,next:null},_r===null){if(Da===null)throw Error(a(308));_r=t,Da.dependencies={lanes:0,firstContext:t}}else _r=_r.next=t;return s}var Hs=null;function Ci(t){Hs===null?Hs=[t]:Hs.push(t)}function Od(t,s,n,c){var m=s.interleaved;return m===null?(n.next=n,Ci(s)):(n.next=m.next,m.next=n),s.interleaved=n,os(t,c)}function os(t,s){t.lanes|=s;var n=t.alternate;for(n!==null&&(n.lanes|=s),n=t,t=t.return;t!==null;)t.childLanes|=s,n=t.alternate,n!==null&&(n.childLanes|=s),n=t,t=t.return;return n.tag===3?n.stateNode:null}var ks=!1;function Ti(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Rd(t,s){t=t.updateQueue,s.updateQueue===t&&(s.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function cs(t,s){return{eventTime:t,lane:s,tag:0,payload:null,callback:null,next:null}}function Ss(t,s,n){var c=t.updateQueue;if(c===null)return null;if(c=c.shared,(he&2)!==0){var m=c.pending;return m===null?s.next=s:(s.next=m.next,m.next=s),c.pending=s,os(t,n)}return m=c.interleaved,m===null?(s.next=s,Ci(c)):(s.next=m.next,m.next=s),c.interleaved=s,os(t,n)}function Oa(t,s,n){if(s=s.updateQueue,s!==null&&(s=s.shared,(n&4194240)!==0)){var c=s.lanes;c&=t.pendingLanes,n|=c,s.lanes=n,Bl(t,n)}}function Ld(t,s){var n=t.updateQueue,c=t.alternate;if(c!==null&&(c=c.updateQueue,n===c)){var m=null,f=null;if(n=n.firstBaseUpdate,n!==null){do{var w={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};f===null?m=f=w:f=f.next=w,n=n.next}while(n!==null);f===null?m=f=s:f=f.next=s}else m=f=s;n={baseState:c.baseState,firstBaseUpdate:m,lastBaseUpdate:f,shared:c.shared,effects:c.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=s:t.next=s,n.lastBaseUpdate=s}function Ra(t,s,n,c){var m=t.updateQueue;ks=!1;var f=m.firstBaseUpdate,w=m.lastBaseUpdate,S=m.shared.pending;if(S!==null){m.shared.pending=null;var E=S,M=E.next;E.next=null,w===null?f=M:w.next=M,w=E;var B=t.alternate;B!==null&&(B=B.updateQueue,S=B.lastBaseUpdate,S!==w&&(S===null?B.firstBaseUpdate=M:S.next=M,B.lastBaseUpdate=E))}if(f!==null){var W=m.baseState;w=0,B=M=E=null,S=f;do{var q=S.lane,Y=S.eventTime;if((c&q)===q){B!==null&&(B=B.next={eventTime:Y,lane:0,tag:S.tag,payload:S.payload,callback:S.callback,next:null});e:{var X=t,ee=S;switch(q=s,Y=n,ee.tag){case 1:if(X=ee.payload,typeof X=="function"){W=X.call(Y,W,q);break e}W=X;break e;case 3:X.flags=X.flags&-65537|128;case 0:if(X=ee.payload,q=typeof X=="function"?X.call(Y,W,q):X,q==null)break e;W=K({},W,q);break e;case 2:ks=!0}}S.callback!==null&&S.lane!==0&&(t.flags|=64,q=m.effects,q===null?m.effects=[S]:q.push(S))}else Y={eventTime:Y,lane:q,tag:S.tag,payload:S.payload,callback:S.callback,next:null},B===null?(M=B=Y,E=W):B=B.next=Y,w|=q;if(S=S.next,S===null){if(S=m.shared.pending,S===null)break;q=S,S=q.next,q.next=null,m.lastBaseUpdate=q,m.shared.pending=null}}while(!0);if(B===null&&(E=W),m.baseState=E,m.firstBaseUpdate=M,m.lastBaseUpdate=B,s=m.shared.interleaved,s!==null){m=s;do w|=m.lane,m=m.next;while(m!==s)}else f===null&&(m.shared.lanes=0);Gs|=w,t.lanes=w,t.memoizedState=W}}function Id(t,s,n){if(t=s.effects,s.effects=null,t!==null)for(s=0;s<t.length;s++){var c=t[s],m=c.callback;if(m!==null){if(c.callback=null,c=n,typeof m!="function")throw Error(a(191,m));m.call(c)}}}var Nn={},Xt=ws(Nn),_n=ws(Nn),kn=ws(Nn);function Vs(t){if(t===Nn)throw Error(a(174));return t}function Ei(t,s){switch(Se(kn,s),Se(_n,t),Se(Xt,Nn),t=s.nodeType,t){case 9:case 11:s=(s=s.documentElement)?s.namespaceURI:Pl(null,"");break;default:t=t===8?s.parentNode:s,s=t.namespaceURI||null,t=t.tagName,s=Pl(s,t)}De(Xt),Se(Xt,s)}function Sr(){De(Xt),De(_n),De(kn)}function Ad(t){Vs(kn.current);var s=Vs(Xt.current),n=Pl(s,t.type);s!==n&&(Se(_n,t),Se(Xt,n))}function Pi(t){_n.current===t&&(De(Xt),De(_n))}var Fe=ws(0);function La(t){for(var s=t;s!==null;){if(s.tag===13){var n=s.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return s}else if(s.tag===19&&s.memoizedProps.revealOrder!==void 0){if((s.flags&128)!==0)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===t)break;for(;s.sibling===null;){if(s.return===null||s.return===t)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}var Di=[];function Oi(){for(var t=0;t<Di.length;t++)Di[t]._workInProgressVersionPrimary=null;Di.length=0}var Ia=D.ReactCurrentDispatcher,Ri=D.ReactCurrentBatchConfig,Qs=0,$e=null,Ve=null,Ye=null,Aa=!1,Sn=!1,Cn=0,Hf=0;function at(){throw Error(a(321))}function Li(t,s){if(s===null)return!1;for(var n=0;n<s.length&&n<t.length;n++)if(!$t(t[n],s[n]))return!1;return!0}function Ii(t,s,n,c,m,f){if(Qs=f,$e=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,Ia.current=t===null||t.memoizedState===null?Kf:Yf,t=n(c,m),Sn){f=0;do{if(Sn=!1,Cn=0,25<=f)throw Error(a(301));f+=1,Ye=Ve=null,s.updateQueue=null,Ia.current=Jf,t=n(c,m)}while(Sn)}if(Ia.current=$a,s=Ve!==null&&Ve.next!==null,Qs=0,Ye=Ve=$e=null,Aa=!1,s)throw Error(a(300));return t}function Ai(){var t=Cn!==0;return Cn=0,t}function Zt(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ye===null?$e.memoizedState=Ye=t:Ye=Ye.next=t,Ye}function Ot(){if(Ve===null){var t=$e.alternate;t=t!==null?t.memoizedState:null}else t=Ve.next;var s=Ye===null?$e.memoizedState:Ye.next;if(s!==null)Ye=s,Ve=t;else{if(t===null)throw Error(a(310));Ve=t,t={memoizedState:Ve.memoizedState,baseState:Ve.baseState,baseQueue:Ve.baseQueue,queue:Ve.queue,next:null},Ye===null?$e.memoizedState=Ye=t:Ye=Ye.next=t}return Ye}function Tn(t,s){return typeof s=="function"?s(t):s}function Mi(t){var s=Ot(),n=s.queue;if(n===null)throw Error(a(311));n.lastRenderedReducer=t;var c=Ve,m=c.baseQueue,f=n.pending;if(f!==null){if(m!==null){var w=m.next;m.next=f.next,f.next=w}c.baseQueue=m=f,n.pending=null}if(m!==null){f=m.next,c=c.baseState;var S=w=null,E=null,M=f;do{var B=M.lane;if((Qs&B)===B)E!==null&&(E=E.next={lane:0,action:M.action,hasEagerState:M.hasEagerState,eagerState:M.eagerState,next:null}),c=M.hasEagerState?M.eagerState:t(c,M.action);else{var W={lane:B,action:M.action,hasEagerState:M.hasEagerState,eagerState:M.eagerState,next:null};E===null?(S=E=W,w=c):E=E.next=W,$e.lanes|=B,Gs|=B}M=M.next}while(M!==null&&M!==f);E===null?w=c:E.next=S,$t(c,s.memoizedState)||(gt=!0),s.memoizedState=c,s.baseState=w,s.baseQueue=E,n.lastRenderedState=c}if(t=n.interleaved,t!==null){m=t;do f=m.lane,$e.lanes|=f,Gs|=f,m=m.next;while(m!==t)}else m===null&&(n.lanes=0);return[s.memoizedState,n.dispatch]}function Fi(t){var s=Ot(),n=s.queue;if(n===null)throw Error(a(311));n.lastRenderedReducer=t;var c=n.dispatch,m=n.pending,f=s.memoizedState;if(m!==null){n.pending=null;var w=m=m.next;do f=t(f,w.action),w=w.next;while(w!==m);$t(f,s.memoizedState)||(gt=!0),s.memoizedState=f,s.baseQueue===null&&(s.baseState=f),n.lastRenderedState=f}return[f,c]}function Md(){}function Fd(t,s){var n=$e,c=Ot(),m=s(),f=!$t(c.memoizedState,m);if(f&&(c.memoizedState=m,gt=!0),c=c.queue,$i(Ud.bind(null,n,c,t),[t]),c.getSnapshot!==s||f||Ye!==null&&Ye.memoizedState.tag&1){if(n.flags|=2048,En(9,qd.bind(null,n,c,m,s),void 0,null),Je===null)throw Error(a(349));(Qs&30)!==0||$d(n,s,m)}return m}function $d(t,s,n){t.flags|=16384,t={getSnapshot:s,value:n},s=$e.updateQueue,s===null?(s={lastEffect:null,stores:null},$e.updateQueue=s,s.stores=[t]):(n=s.stores,n===null?s.stores=[t]:n.push(t))}function qd(t,s,n,c){s.value=n,s.getSnapshot=c,Bd(s)&&zd(t)}function Ud(t,s,n){return n(function(){Bd(s)&&zd(t)})}function Bd(t){var s=t.getSnapshot;t=t.value;try{var n=s();return!$t(t,n)}catch{return!0}}function zd(t){var s=os(t,1);s!==null&&Wt(s,t,1,-1)}function Wd(t){var s=Zt();return typeof t=="function"&&(t=t()),s.memoizedState=s.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Tn,lastRenderedState:t},s.queue=t,t=t.dispatch=Gf.bind(null,$e,t),[s.memoizedState,t]}function En(t,s,n,c){return t={tag:t,create:s,destroy:n,deps:c,next:null},s=$e.updateQueue,s===null?(s={lastEffect:null,stores:null},$e.updateQueue=s,s.lastEffect=t.next=t):(n=s.lastEffect,n===null?s.lastEffect=t.next=t:(c=n.next,n.next=t,t.next=c,s.lastEffect=t)),t}function Hd(){return Ot().memoizedState}function Ma(t,s,n,c){var m=Zt();$e.flags|=t,m.memoizedState=En(1|s,n,void 0,c===void 0?null:c)}function Fa(t,s,n,c){var m=Ot();c=c===void 0?null:c;var f=void 0;if(Ve!==null){var w=Ve.memoizedState;if(f=w.destroy,c!==null&&Li(c,w.deps)){m.memoizedState=En(s,n,f,c);return}}$e.flags|=t,m.memoizedState=En(1|s,n,f,c)}function Vd(t,s){return Ma(8390656,8,t,s)}function $i(t,s){return Fa(2048,8,t,s)}function Qd(t,s){return Fa(4,2,t,s)}function Gd(t,s){return Fa(4,4,t,s)}function Kd(t,s){if(typeof s=="function")return t=t(),s(t),function(){s(null)};if(s!=null)return t=t(),s.current=t,function(){s.current=null}}function Yd(t,s,n){return n=n!=null?n.concat([t]):null,Fa(4,4,Kd.bind(null,s,t),n)}function qi(){}function Jd(t,s){var n=Ot();s=s===void 0?null:s;var c=n.memoizedState;return c!==null&&s!==null&&Li(s,c[1])?c[0]:(n.memoizedState=[t,s],t)}function Xd(t,s){var n=Ot();s=s===void 0?null:s;var c=n.memoizedState;return c!==null&&s!==null&&Li(s,c[1])?c[0]:(t=t(),n.memoizedState=[t,s],t)}function Zd(t,s,n){return(Qs&21)===0?(t.baseState&&(t.baseState=!1,gt=!0),t.memoizedState=n):($t(n,s)||(n=Ec(),$e.lanes|=n,Gs|=n,t.baseState=!0),s)}function Vf(t,s){var n=je;je=n!==0&&4>n?n:4,t(!0);var c=Ri.transition;Ri.transition={};try{t(!1),s()}finally{je=n,Ri.transition=c}}function eu(){return Ot().memoizedState}function Qf(t,s,n){var c=Ps(t);if(n={lane:c,action:n,hasEagerState:!1,eagerState:null,next:null},tu(t))su(s,n);else if(n=Od(t,s,n,c),n!==null){var m=mt();Wt(n,t,c,m),ru(n,s,c)}}function Gf(t,s,n){var c=Ps(t),m={lane:c,action:n,hasEagerState:!1,eagerState:null,next:null};if(tu(t))su(s,m);else{var f=t.alternate;if(t.lanes===0&&(f===null||f.lanes===0)&&(f=s.lastRenderedReducer,f!==null))try{var w=s.lastRenderedState,S=f(w,n);if(m.hasEagerState=!0,m.eagerState=S,$t(S,w)){var E=s.interleaved;E===null?(m.next=m,Ci(s)):(m.next=E.next,E.next=m),s.interleaved=m;return}}catch{}finally{}n=Od(t,s,m,c),n!==null&&(m=mt(),Wt(n,t,c,m),ru(n,s,c))}}function tu(t){var s=t.alternate;return t===$e||s!==null&&s===$e}function su(t,s){Sn=Aa=!0;var n=t.pending;n===null?s.next=s:(s.next=n.next,n.next=s),t.pending=s}function ru(t,s,n){if((n&4194240)!==0){var c=s.lanes;c&=t.pendingLanes,n|=c,s.lanes=n,Bl(t,n)}}var $a={readContext:Dt,useCallback:at,useContext:at,useEffect:at,useImperativeHandle:at,useInsertionEffect:at,useLayoutEffect:at,useMemo:at,useReducer:at,useRef:at,useState:at,useDebugValue:at,useDeferredValue:at,useTransition:at,useMutableSource:at,useSyncExternalStore:at,useId:at,unstable_isNewReconciler:!1},Kf={readContext:Dt,useCallback:function(t,s){return Zt().memoizedState=[t,s===void 0?null:s],t},useContext:Dt,useEffect:Vd,useImperativeHandle:function(t,s,n){return n=n!=null?n.concat([t]):null,Ma(4194308,4,Kd.bind(null,s,t),n)},useLayoutEffect:function(t,s){return Ma(4194308,4,t,s)},useInsertionEffect:function(t,s){return Ma(4,2,t,s)},useMemo:function(t,s){var n=Zt();return s=s===void 0?null:s,t=t(),n.memoizedState=[t,s],t},useReducer:function(t,s,n){var c=Zt();return s=n!==void 0?n(s):s,c.memoizedState=c.baseState=s,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:s},c.queue=t,t=t.dispatch=Qf.bind(null,$e,t),[c.memoizedState,t]},useRef:function(t){var s=Zt();return t={current:t},s.memoizedState=t},useState:Wd,useDebugValue:qi,useDeferredValue:function(t){return Zt().memoizedState=t},useTransition:function(){var t=Wd(!1),s=t[0];return t=Vf.bind(null,t[1]),Zt().memoizedState=t,[s,t]},useMutableSource:function(){},useSyncExternalStore:function(t,s,n){var c=$e,m=Zt();if(Ie){if(n===void 0)throw Error(a(407));n=n()}else{if(n=s(),Je===null)throw Error(a(349));(Qs&30)!==0||$d(c,s,n)}m.memoizedState=n;var f={value:n,getSnapshot:s};return m.queue=f,Vd(Ud.bind(null,c,f,t),[t]),c.flags|=2048,En(9,qd.bind(null,c,f,n,s),void 0,null),n},useId:function(){var t=Zt(),s=Je.identifierPrefix;if(Ie){var n=is,c=ls;n=(c&~(1<<32-Ft(c)-1)).toString(32)+n,s=":"+s+"R"+n,n=Cn++,0<n&&(s+="H"+n.toString(32)),s+=":"}else n=Hf++,s=":"+s+"r"+n.toString(32)+":";return t.memoizedState=s},unstable_isNewReconciler:!1},Yf={readContext:Dt,useCallback:Jd,useContext:Dt,useEffect:$i,useImperativeHandle:Yd,useInsertionEffect:Qd,useLayoutEffect:Gd,useMemo:Xd,useReducer:Mi,useRef:Hd,useState:function(){return Mi(Tn)},useDebugValue:qi,useDeferredValue:function(t){var s=Ot();return Zd(s,Ve.memoizedState,t)},useTransition:function(){var t=Mi(Tn)[0],s=Ot().memoizedState;return[t,s]},useMutableSource:Md,useSyncExternalStore:Fd,useId:eu,unstable_isNewReconciler:!1},Jf={readContext:Dt,useCallback:Jd,useContext:Dt,useEffect:$i,useImperativeHandle:Yd,useInsertionEffect:Qd,useLayoutEffect:Gd,useMemo:Xd,useReducer:Fi,useRef:Hd,useState:function(){return Fi(Tn)},useDebugValue:qi,useDeferredValue:function(t){var s=Ot();return Ve===null?s.memoizedState=t:Zd(s,Ve.memoizedState,t)},useTransition:function(){var t=Fi(Tn)[0],s=Ot().memoizedState;return[t,s]},useMutableSource:Md,useSyncExternalStore:Fd,useId:eu,unstable_isNewReconciler:!1};function Ut(t,s){if(t&&t.defaultProps){s=K({},s),t=t.defaultProps;for(var n in t)s[n]===void 0&&(s[n]=t[n]);return s}return s}function Ui(t,s,n,c){s=t.memoizedState,n=n(c,s),n=n==null?s:K({},s,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var qa={isMounted:function(t){return(t=t._reactInternals)?qs(t)===t:!1},enqueueSetState:function(t,s,n){t=t._reactInternals;var c=mt(),m=Ps(t),f=cs(c,m);f.payload=s,n!=null&&(f.callback=n),s=Ss(t,f,m),s!==null&&(Wt(s,t,m,c),Oa(s,t,m))},enqueueReplaceState:function(t,s,n){t=t._reactInternals;var c=mt(),m=Ps(t),f=cs(c,m);f.tag=1,f.payload=s,n!=null&&(f.callback=n),s=Ss(t,f,m),s!==null&&(Wt(s,t,m,c),Oa(s,t,m))},enqueueForceUpdate:function(t,s){t=t._reactInternals;var n=mt(),c=Ps(t),m=cs(n,c);m.tag=2,s!=null&&(m.callback=s),s=Ss(t,m,c),s!==null&&(Wt(s,t,c,n),Oa(s,t,c))}};function nu(t,s,n,c,m,f,w){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(c,f,w):s.prototype&&s.prototype.isPureReactComponent?!xn(n,c)||!xn(m,f):!0}function au(t,s,n){var c=!1,m=Ns,f=s.contextType;return typeof f=="object"&&f!==null?f=Dt(f):(m=pt(s)?Bs:nt.current,c=s.contextTypes,f=(c=c!=null)?br(t,m):Ns),s=new s(n,f),t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,s.updater=qa,t.stateNode=s,s._reactInternals=t,c&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=m,t.__reactInternalMemoizedMaskedChildContext=f),s}function lu(t,s,n,c){t=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(n,c),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(n,c),s.state!==t&&qa.enqueueReplaceState(s,s.state,null)}function Bi(t,s,n,c){var m=t.stateNode;m.props=n,m.state=t.memoizedState,m.refs={},Ti(t);var f=s.contextType;typeof f=="object"&&f!==null?m.context=Dt(f):(f=pt(s)?Bs:nt.current,m.context=br(t,f)),m.state=t.memoizedState,f=s.getDerivedStateFromProps,typeof f=="function"&&(Ui(t,s,f,n),m.state=t.memoizedState),typeof s.getDerivedStateFromProps=="function"||typeof m.getSnapshotBeforeUpdate=="function"||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(s=m.state,typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount(),s!==m.state&&qa.enqueueReplaceState(m,m.state,null),Ra(t,n,m,c),m.state=t.memoizedState),typeof m.componentDidMount=="function"&&(t.flags|=4194308)}function Cr(t,s){try{var n="",c=s;do n+=fe(c),c=c.return;while(c);var m=n}catch(f){m=`
Error generating stack: `+f.message+`
`+f.stack}return{value:t,source:s,stack:m,digest:null}}function zi(t,s,n){return{value:t,source:null,stack:n??null,digest:s??null}}function Wi(t,s){try{console.error(s.value)}catch(n){setTimeout(function(){throw n})}}var Xf=typeof WeakMap=="function"?WeakMap:Map;function iu(t,s,n){n=cs(-1,n),n.tag=3,n.payload={element:null};var c=s.value;return n.callback=function(){Qa||(Qa=!0,ao=c),Wi(t,s)},n}function ou(t,s,n){n=cs(-1,n),n.tag=3;var c=t.type.getDerivedStateFromError;if(typeof c=="function"){var m=s.value;n.payload=function(){return c(m)},n.callback=function(){Wi(t,s)}}var f=t.stateNode;return f!==null&&typeof f.componentDidCatch=="function"&&(n.callback=function(){Wi(t,s),typeof c!="function"&&(Ts===null?Ts=new Set([this]):Ts.add(this));var w=s.stack;this.componentDidCatch(s.value,{componentStack:w!==null?w:""})}),n}function cu(t,s,n){var c=t.pingCache;if(c===null){c=t.pingCache=new Xf;var m=new Set;c.set(s,m)}else m=c.get(s),m===void 0&&(m=new Set,c.set(s,m));m.has(n)||(m.add(n),t=m0.bind(null,t,s,n),s.then(t,t))}function du(t){do{var s;if((s=t.tag===13)&&(s=t.memoizedState,s=s!==null?s.dehydrated!==null:!0),s)return t;t=t.return}while(t!==null);return null}function uu(t,s,n,c,m){return(t.mode&1)===0?(t===s?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(s=cs(-1,1),s.tag=2,Ss(n,s,1))),n.lanes|=1),t):(t.flags|=65536,t.lanes=m,t)}var Zf=D.ReactCurrentOwner,gt=!1;function ut(t,s,n,c){s.child=t===null?Dd(s,null,n,c):Nr(s,t.child,n,c)}function mu(t,s,n,c,m){n=n.render;var f=s.ref;return kr(s,m),c=Ii(t,s,n,c,f,m),n=Ai(),t!==null&&!gt?(s.updateQueue=t.updateQueue,s.flags&=-2053,t.lanes&=~m,ds(t,s,m)):(Ie&&n&&vi(s),s.flags|=1,ut(t,s,c,m),s.child)}function hu(t,s,n,c,m){if(t===null){var f=n.type;return typeof f=="function"&&!ho(f)&&f.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(s.tag=15,s.type=f,fu(t,s,f,c,m)):(t=Za(n.type,null,c,s,s.mode,m),t.ref=s.ref,t.return=s,s.child=t)}if(f=t.child,(t.lanes&m)===0){var w=f.memoizedProps;if(n=n.compare,n=n!==null?n:xn,n(w,c)&&t.ref===s.ref)return ds(t,s,m)}return s.flags|=1,t=Os(f,c),t.ref=s.ref,t.return=s,s.child=t}function fu(t,s,n,c,m){if(t!==null){var f=t.memoizedProps;if(xn(f,c)&&t.ref===s.ref)if(gt=!1,s.pendingProps=c=f,(t.lanes&m)!==0)(t.flags&131072)!==0&&(gt=!0);else return s.lanes=t.lanes,ds(t,s,m)}return Hi(t,s,n,c,m)}function xu(t,s,n){var c=s.pendingProps,m=c.children,f=t!==null?t.memoizedState:null;if(c.mode==="hidden")if((s.mode&1)===0)s.memoizedState={baseLanes:0,cachePool:null,transitions:null},Se(Er,St),St|=n;else{if((n&1073741824)===0)return t=f!==null?f.baseLanes|n:n,s.lanes=s.childLanes=1073741824,s.memoizedState={baseLanes:t,cachePool:null,transitions:null},s.updateQueue=null,Se(Er,St),St|=t,null;s.memoizedState={baseLanes:0,cachePool:null,transitions:null},c=f!==null?f.baseLanes:n,Se(Er,St),St|=c}else f!==null?(c=f.baseLanes|n,s.memoizedState=null):c=n,Se(Er,St),St|=c;return ut(t,s,m,n),s.child}function pu(t,s){var n=s.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(s.flags|=512,s.flags|=2097152)}function Hi(t,s,n,c,m){var f=pt(n)?Bs:nt.current;return f=br(s,f),kr(s,m),n=Ii(t,s,n,c,f,m),c=Ai(),t!==null&&!gt?(s.updateQueue=t.updateQueue,s.flags&=-2053,t.lanes&=~m,ds(t,s,m)):(Ie&&c&&vi(s),s.flags|=1,ut(t,s,n,m),s.child)}function gu(t,s,n,c,m){if(pt(n)){var f=!0;_a(s)}else f=!1;if(kr(s,m),s.stateNode===null)Ba(t,s),au(s,n,c),Bi(s,n,c,m),c=!0;else if(t===null){var w=s.stateNode,S=s.memoizedProps;w.props=S;var E=w.context,M=n.contextType;typeof M=="object"&&M!==null?M=Dt(M):(M=pt(n)?Bs:nt.current,M=br(s,M));var B=n.getDerivedStateFromProps,W=typeof B=="function"||typeof w.getSnapshotBeforeUpdate=="function";W||typeof w.UNSAFE_componentWillReceiveProps!="function"&&typeof w.componentWillReceiveProps!="function"||(S!==c||E!==M)&&lu(s,w,c,M),ks=!1;var q=s.memoizedState;w.state=q,Ra(s,c,w,m),E=s.memoizedState,S!==c||q!==E||xt.current||ks?(typeof B=="function"&&(Ui(s,n,B,c),E=s.memoizedState),(S=ks||nu(s,n,S,c,q,E,M))?(W||typeof w.UNSAFE_componentWillMount!="function"&&typeof w.componentWillMount!="function"||(typeof w.componentWillMount=="function"&&w.componentWillMount(),typeof w.UNSAFE_componentWillMount=="function"&&w.UNSAFE_componentWillMount()),typeof w.componentDidMount=="function"&&(s.flags|=4194308)):(typeof w.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=c,s.memoizedState=E),w.props=c,w.state=E,w.context=M,c=S):(typeof w.componentDidMount=="function"&&(s.flags|=4194308),c=!1)}else{w=s.stateNode,Rd(t,s),S=s.memoizedProps,M=s.type===s.elementType?S:Ut(s.type,S),w.props=M,W=s.pendingProps,q=w.context,E=n.contextType,typeof E=="object"&&E!==null?E=Dt(E):(E=pt(n)?Bs:nt.current,E=br(s,E));var Y=n.getDerivedStateFromProps;(B=typeof Y=="function"||typeof w.getSnapshotBeforeUpdate=="function")||typeof w.UNSAFE_componentWillReceiveProps!="function"&&typeof w.componentWillReceiveProps!="function"||(S!==W||q!==E)&&lu(s,w,c,E),ks=!1,q=s.memoizedState,w.state=q,Ra(s,c,w,m);var X=s.memoizedState;S!==W||q!==X||xt.current||ks?(typeof Y=="function"&&(Ui(s,n,Y,c),X=s.memoizedState),(M=ks||nu(s,n,M,c,q,X,E)||!1)?(B||typeof w.UNSAFE_componentWillUpdate!="function"&&typeof w.componentWillUpdate!="function"||(typeof w.componentWillUpdate=="function"&&w.componentWillUpdate(c,X,E),typeof w.UNSAFE_componentWillUpdate=="function"&&w.UNSAFE_componentWillUpdate(c,X,E)),typeof w.componentDidUpdate=="function"&&(s.flags|=4),typeof w.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof w.componentDidUpdate!="function"||S===t.memoizedProps&&q===t.memoizedState||(s.flags|=4),typeof w.getSnapshotBeforeUpdate!="function"||S===t.memoizedProps&&q===t.memoizedState||(s.flags|=1024),s.memoizedProps=c,s.memoizedState=X),w.props=c,w.state=X,w.context=E,c=M):(typeof w.componentDidUpdate!="function"||S===t.memoizedProps&&q===t.memoizedState||(s.flags|=4),typeof w.getSnapshotBeforeUpdate!="function"||S===t.memoizedProps&&q===t.memoizedState||(s.flags|=1024),c=!1)}return Vi(t,s,n,c,f,m)}function Vi(t,s,n,c,m,f){pu(t,s);var w=(s.flags&128)!==0;if(!c&&!w)return m&&wd(s,n,!1),ds(t,s,f);c=s.stateNode,Zf.current=s;var S=w&&typeof n.getDerivedStateFromError!="function"?null:c.render();return s.flags|=1,t!==null&&w?(s.child=Nr(s,t.child,null,f),s.child=Nr(s,null,S,f)):ut(t,s,S,f),s.memoizedState=c.state,m&&wd(s,n,!0),s.child}function vu(t){var s=t.stateNode;s.pendingContext?yd(t,s.pendingContext,s.pendingContext!==s.context):s.context&&yd(t,s.context,!1),Ei(t,s.containerInfo)}function bu(t,s,n,c,m){return wr(),wi(m),s.flags|=256,ut(t,s,n,c),s.child}var Qi={dehydrated:null,treeContext:null,retryLane:0};function Gi(t){return{baseLanes:t,cachePool:null,transitions:null}}function yu(t,s,n){var c=s.pendingProps,m=Fe.current,f=!1,w=(s.flags&128)!==0,S;if((S=w)||(S=t!==null&&t.memoizedState===null?!1:(m&2)!==0),S?(f=!0,s.flags&=-129):(t===null||t.memoizedState!==null)&&(m|=1),Se(Fe,m&1),t===null)return ji(s),t=s.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?((s.mode&1)===0?s.lanes=1:t.data==="$!"?s.lanes=8:s.lanes=1073741824,null):(w=c.children,t=c.fallback,f?(c=s.mode,f=s.child,w={mode:"hidden",children:w},(c&1)===0&&f!==null?(f.childLanes=0,f.pendingProps=w):f=el(w,c,0,null),t=Xs(t,c,n,null),f.return=s,t.return=s,f.sibling=t,s.child=f,s.child.memoizedState=Gi(n),s.memoizedState=Qi,t):Ki(s,w));if(m=t.memoizedState,m!==null&&(S=m.dehydrated,S!==null))return e0(t,s,w,c,S,m,n);if(f){f=c.fallback,w=s.mode,m=t.child,S=m.sibling;var E={mode:"hidden",children:c.children};return(w&1)===0&&s.child!==m?(c=s.child,c.childLanes=0,c.pendingProps=E,s.deletions=null):(c=Os(m,E),c.subtreeFlags=m.subtreeFlags&14680064),S!==null?f=Os(S,f):(f=Xs(f,w,n,null),f.flags|=2),f.return=s,c.return=s,c.sibling=f,s.child=c,c=f,f=s.child,w=t.child.memoizedState,w=w===null?Gi(n):{baseLanes:w.baseLanes|n,cachePool:null,transitions:w.transitions},f.memoizedState=w,f.childLanes=t.childLanes&~n,s.memoizedState=Qi,c}return f=t.child,t=f.sibling,c=Os(f,{mode:"visible",children:c.children}),(s.mode&1)===0&&(c.lanes=n),c.return=s,c.sibling=null,t!==null&&(n=s.deletions,n===null?(s.deletions=[t],s.flags|=16):n.push(t)),s.child=c,s.memoizedState=null,c}function Ki(t,s){return s=el({mode:"visible",children:s},t.mode,0,null),s.return=t,t.child=s}function Ua(t,s,n,c){return c!==null&&wi(c),Nr(s,t.child,null,n),t=Ki(s,s.pendingProps.children),t.flags|=2,s.memoizedState=null,t}function e0(t,s,n,c,m,f,w){if(n)return s.flags&256?(s.flags&=-257,c=zi(Error(a(422))),Ua(t,s,w,c)):s.memoizedState!==null?(s.child=t.child,s.flags|=128,null):(f=c.fallback,m=s.mode,c=el({mode:"visible",children:c.children},m,0,null),f=Xs(f,m,w,null),f.flags|=2,c.return=s,f.return=s,c.sibling=f,s.child=c,(s.mode&1)!==0&&Nr(s,t.child,null,w),s.child.memoizedState=Gi(w),s.memoizedState=Qi,f);if((s.mode&1)===0)return Ua(t,s,w,null);if(m.data==="$!"){if(c=m.nextSibling&&m.nextSibling.dataset,c)var S=c.dgst;return c=S,f=Error(a(419)),c=zi(f,c,void 0),Ua(t,s,w,c)}if(S=(w&t.childLanes)!==0,gt||S){if(c=Je,c!==null){switch(w&-w){case 4:m=2;break;case 16:m=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:m=32;break;case 536870912:m=268435456;break;default:m=0}m=(m&(c.suspendedLanes|w))!==0?0:m,m!==0&&m!==f.retryLane&&(f.retryLane=m,os(t,m),Wt(c,t,m,-1))}return mo(),c=zi(Error(a(421))),Ua(t,s,w,c)}return m.data==="$?"?(s.flags|=128,s.child=t.child,s=h0.bind(null,t),m._reactRetry=s,null):(t=f.treeContext,kt=js(m.nextSibling),_t=s,Ie=!0,qt=null,t!==null&&(Et[Pt++]=ls,Et[Pt++]=is,Et[Pt++]=zs,ls=t.id,is=t.overflow,zs=s),s=Ki(s,c.children),s.flags|=4096,s)}function ju(t,s,n){t.lanes|=s;var c=t.alternate;c!==null&&(c.lanes|=s),Si(t.return,s,n)}function Yi(t,s,n,c,m){var f=t.memoizedState;f===null?t.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:c,tail:n,tailMode:m}:(f.isBackwards=s,f.rendering=null,f.renderingStartTime=0,f.last=c,f.tail=n,f.tailMode=m)}function wu(t,s,n){var c=s.pendingProps,m=c.revealOrder,f=c.tail;if(ut(t,s,c.children,n),c=Fe.current,(c&2)!==0)c=c&1|2,s.flags|=128;else{if(t!==null&&(t.flags&128)!==0)e:for(t=s.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&ju(t,n,s);else if(t.tag===19)ju(t,n,s);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===s)break e;for(;t.sibling===null;){if(t.return===null||t.return===s)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}c&=1}if(Se(Fe,c),(s.mode&1)===0)s.memoizedState=null;else switch(m){case"forwards":for(n=s.child,m=null;n!==null;)t=n.alternate,t!==null&&La(t)===null&&(m=n),n=n.sibling;n=m,n===null?(m=s.child,s.child=null):(m=n.sibling,n.sibling=null),Yi(s,!1,m,n,f);break;case"backwards":for(n=null,m=s.child,s.child=null;m!==null;){if(t=m.alternate,t!==null&&La(t)===null){s.child=m;break}t=m.sibling,m.sibling=n,n=m,m=t}Yi(s,!0,n,null,f);break;case"together":Yi(s,!1,null,null,void 0);break;default:s.memoizedState=null}return s.child}function Ba(t,s){(s.mode&1)===0&&t!==null&&(t.alternate=null,s.alternate=null,s.flags|=2)}function ds(t,s,n){if(t!==null&&(s.dependencies=t.dependencies),Gs|=s.lanes,(n&s.childLanes)===0)return null;if(t!==null&&s.child!==t.child)throw Error(a(153));if(s.child!==null){for(t=s.child,n=Os(t,t.pendingProps),s.child=n,n.return=s;t.sibling!==null;)t=t.sibling,n=n.sibling=Os(t,t.pendingProps),n.return=s;n.sibling=null}return s.child}function t0(t,s,n){switch(s.tag){case 3:vu(s),wr();break;case 5:Ad(s);break;case 1:pt(s.type)&&_a(s);break;case 4:Ei(s,s.stateNode.containerInfo);break;case 10:var c=s.type._context,m=s.memoizedProps.value;Se(Pa,c._currentValue),c._currentValue=m;break;case 13:if(c=s.memoizedState,c!==null)return c.dehydrated!==null?(Se(Fe,Fe.current&1),s.flags|=128,null):(n&s.child.childLanes)!==0?yu(t,s,n):(Se(Fe,Fe.current&1),t=ds(t,s,n),t!==null?t.sibling:null);Se(Fe,Fe.current&1);break;case 19:if(c=(n&s.childLanes)!==0,(t.flags&128)!==0){if(c)return wu(t,s,n);s.flags|=128}if(m=s.memoizedState,m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),Se(Fe,Fe.current),c)break;return null;case 22:case 23:return s.lanes=0,xu(t,s,n)}return ds(t,s,n)}var Nu,Ji,_u,ku;Nu=function(t,s){for(var n=s.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===s)break;for(;n.sibling===null;){if(n.return===null||n.return===s)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Ji=function(){},_u=function(t,s,n,c){var m=t.memoizedProps;if(m!==c){t=s.stateNode,Vs(Xt.current);var f=null;switch(n){case"input":m=Sl(t,m),c=Sl(t,c),f=[];break;case"select":m=K({},m,{value:void 0}),c=K({},c,{value:void 0}),f=[];break;case"textarea":m=El(t,m),c=El(t,c),f=[];break;default:typeof m.onClick!="function"&&typeof c.onClick=="function"&&(t.onclick=ja)}Dl(n,c);var w;n=null;for(M in m)if(!c.hasOwnProperty(M)&&m.hasOwnProperty(M)&&m[M]!=null)if(M==="style"){var S=m[M];for(w in S)S.hasOwnProperty(w)&&(n||(n={}),n[w]="")}else M!=="dangerouslySetInnerHTML"&&M!=="children"&&M!=="suppressContentEditableWarning"&&M!=="suppressHydrationWarning"&&M!=="autoFocus"&&(o.hasOwnProperty(M)?f||(f=[]):(f=f||[]).push(M,null));for(M in c){var E=c[M];if(S=m?.[M],c.hasOwnProperty(M)&&E!==S&&(E!=null||S!=null))if(M==="style")if(S){for(w in S)!S.hasOwnProperty(w)||E&&E.hasOwnProperty(w)||(n||(n={}),n[w]="");for(w in E)E.hasOwnProperty(w)&&S[w]!==E[w]&&(n||(n={}),n[w]=E[w])}else n||(f||(f=[]),f.push(M,n)),n=E;else M==="dangerouslySetInnerHTML"?(E=E?E.__html:void 0,S=S?S.__html:void 0,E!=null&&S!==E&&(f=f||[]).push(M,E)):M==="children"?typeof E!="string"&&typeof E!="number"||(f=f||[]).push(M,""+E):M!=="suppressContentEditableWarning"&&M!=="suppressHydrationWarning"&&(o.hasOwnProperty(M)?(E!=null&&M==="onScroll"&&Pe("scroll",t),f||S===E||(f=[])):(f=f||[]).push(M,E))}n&&(f=f||[]).push("style",n);var M=f;(s.updateQueue=M)&&(s.flags|=4)}},ku=function(t,s,n,c){n!==c&&(s.flags|=4)};function Pn(t,s){if(!Ie)switch(t.tailMode){case"hidden":s=t.tail;for(var n=null;s!==null;)s.alternate!==null&&(n=s),s=s.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var c=null;n!==null;)n.alternate!==null&&(c=n),n=n.sibling;c===null?s||t.tail===null?t.tail=null:t.tail.sibling=null:c.sibling=null}}function lt(t){var s=t.alternate!==null&&t.alternate.child===t.child,n=0,c=0;if(s)for(var m=t.child;m!==null;)n|=m.lanes|m.childLanes,c|=m.subtreeFlags&14680064,c|=m.flags&14680064,m.return=t,m=m.sibling;else for(m=t.child;m!==null;)n|=m.lanes|m.childLanes,c|=m.subtreeFlags,c|=m.flags,m.return=t,m=m.sibling;return t.subtreeFlags|=c,t.childLanes=n,s}function s0(t,s,n){var c=s.pendingProps;switch(bi(s),s.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return lt(s),null;case 1:return pt(s.type)&&Na(),lt(s),null;case 3:return c=s.stateNode,Sr(),De(xt),De(nt),Oi(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(t===null||t.child===null)&&(Ta(s)?s.flags|=4:t===null||t.memoizedState.isDehydrated&&(s.flags&256)===0||(s.flags|=1024,qt!==null&&(oo(qt),qt=null))),Ji(t,s),lt(s),null;case 5:Pi(s);var m=Vs(kn.current);if(n=s.type,t!==null&&s.stateNode!=null)_u(t,s,n,c,m),t.ref!==s.ref&&(s.flags|=512,s.flags|=2097152);else{if(!c){if(s.stateNode===null)throw Error(a(166));return lt(s),null}if(t=Vs(Xt.current),Ta(s)){c=s.stateNode,n=s.type;var f=s.memoizedProps;switch(c[Jt]=s,c[yn]=f,t=(s.mode&1)!==0,n){case"dialog":Pe("cancel",c),Pe("close",c);break;case"iframe":case"object":case"embed":Pe("load",c);break;case"video":case"audio":for(m=0;m<gn.length;m++)Pe(gn[m],c);break;case"source":Pe("error",c);break;case"img":case"image":case"link":Pe("error",c),Pe("load",c);break;case"details":Pe("toggle",c);break;case"input":ac(c,f),Pe("invalid",c);break;case"select":c._wrapperState={wasMultiple:!!f.multiple},Pe("invalid",c);break;case"textarea":oc(c,f),Pe("invalid",c)}Dl(n,f),m=null;for(var w in f)if(f.hasOwnProperty(w)){var S=f[w];w==="children"?typeof S=="string"?c.textContent!==S&&(f.suppressHydrationWarning!==!0&&ya(c.textContent,S,t),m=["children",S]):typeof S=="number"&&c.textContent!==""+S&&(f.suppressHydrationWarning!==!0&&ya(c.textContent,S,t),m=["children",""+S]):o.hasOwnProperty(w)&&S!=null&&w==="onScroll"&&Pe("scroll",c)}switch(n){case"input":Jn(c),ic(c,f,!0);break;case"textarea":Jn(c),dc(c);break;case"select":case"option":break;default:typeof f.onClick=="function"&&(c.onclick=ja)}c=m,s.updateQueue=c,c!==null&&(s.flags|=4)}else{w=m.nodeType===9?m:m.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=uc(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=w.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof c.is=="string"?t=w.createElement(n,{is:c.is}):(t=w.createElement(n),n==="select"&&(w=t,c.multiple?w.multiple=!0:c.size&&(w.size=c.size))):t=w.createElementNS(t,n),t[Jt]=s,t[yn]=c,Nu(t,s,!1,!1),s.stateNode=t;e:{switch(w=Ol(n,c),n){case"dialog":Pe("cancel",t),Pe("close",t),m=c;break;case"iframe":case"object":case"embed":Pe("load",t),m=c;break;case"video":case"audio":for(m=0;m<gn.length;m++)Pe(gn[m],t);m=c;break;case"source":Pe("error",t),m=c;break;case"img":case"image":case"link":Pe("error",t),Pe("load",t),m=c;break;case"details":Pe("toggle",t),m=c;break;case"input":ac(t,c),m=Sl(t,c),Pe("invalid",t);break;case"option":m=c;break;case"select":t._wrapperState={wasMultiple:!!c.multiple},m=K({},c,{value:void 0}),Pe("invalid",t);break;case"textarea":oc(t,c),m=El(t,c),Pe("invalid",t);break;default:m=c}Dl(n,m),S=m;for(f in S)if(S.hasOwnProperty(f)){var E=S[f];f==="style"?fc(t,E):f==="dangerouslySetInnerHTML"?(E=E?E.__html:void 0,E!=null&&mc(t,E)):f==="children"?typeof E=="string"?(n!=="textarea"||E!=="")&&Jr(t,E):typeof E=="number"&&Jr(t,""+E):f!=="suppressContentEditableWarning"&&f!=="suppressHydrationWarning"&&f!=="autoFocus"&&(o.hasOwnProperty(f)?E!=null&&f==="onScroll"&&Pe("scroll",t):E!=null&&C(t,f,E,w))}switch(n){case"input":Jn(t),ic(t,c,!1);break;case"textarea":Jn(t),dc(t);break;case"option":c.value!=null&&t.setAttribute("value",""+ye(c.value));break;case"select":t.multiple=!!c.multiple,f=c.value,f!=null?ir(t,!!c.multiple,f,!1):c.defaultValue!=null&&ir(t,!!c.multiple,c.defaultValue,!0);break;default:typeof m.onClick=="function"&&(t.onclick=ja)}switch(n){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break e;case"img":c=!0;break e;default:c=!1}}c&&(s.flags|=4)}s.ref!==null&&(s.flags|=512,s.flags|=2097152)}return lt(s),null;case 6:if(t&&s.stateNode!=null)ku(t,s,t.memoizedProps,c);else{if(typeof c!="string"&&s.stateNode===null)throw Error(a(166));if(n=Vs(kn.current),Vs(Xt.current),Ta(s)){if(c=s.stateNode,n=s.memoizedProps,c[Jt]=s,(f=c.nodeValue!==n)&&(t=_t,t!==null))switch(t.tag){case 3:ya(c.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&ya(c.nodeValue,n,(t.mode&1)!==0)}f&&(s.flags|=4)}else c=(n.nodeType===9?n:n.ownerDocument).createTextNode(c),c[Jt]=s,s.stateNode=c}return lt(s),null;case 13:if(De(Fe),c=s.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Ie&&kt!==null&&(s.mode&1)!==0&&(s.flags&128)===0)Td(),wr(),s.flags|=98560,f=!1;else if(f=Ta(s),c!==null&&c.dehydrated!==null){if(t===null){if(!f)throw Error(a(318));if(f=s.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(a(317));f[Jt]=s}else wr(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;lt(s),f=!1}else qt!==null&&(oo(qt),qt=null),f=!0;if(!f)return s.flags&65536?s:null}return(s.flags&128)!==0?(s.lanes=n,s):(c=c!==null,c!==(t!==null&&t.memoizedState!==null)&&c&&(s.child.flags|=8192,(s.mode&1)!==0&&(t===null||(Fe.current&1)!==0?Qe===0&&(Qe=3):mo())),s.updateQueue!==null&&(s.flags|=4),lt(s),null);case 4:return Sr(),Ji(t,s),t===null&&vn(s.stateNode.containerInfo),lt(s),null;case 10:return ki(s.type._context),lt(s),null;case 17:return pt(s.type)&&Na(),lt(s),null;case 19:if(De(Fe),f=s.memoizedState,f===null)return lt(s),null;if(c=(s.flags&128)!==0,w=f.rendering,w===null)if(c)Pn(f,!1);else{if(Qe!==0||t!==null&&(t.flags&128)!==0)for(t=s.child;t!==null;){if(w=La(t),w!==null){for(s.flags|=128,Pn(f,!1),c=w.updateQueue,c!==null&&(s.updateQueue=c,s.flags|=4),s.subtreeFlags=0,c=n,n=s.child;n!==null;)f=n,t=c,f.flags&=14680066,w=f.alternate,w===null?(f.childLanes=0,f.lanes=t,f.child=null,f.subtreeFlags=0,f.memoizedProps=null,f.memoizedState=null,f.updateQueue=null,f.dependencies=null,f.stateNode=null):(f.childLanes=w.childLanes,f.lanes=w.lanes,f.child=w.child,f.subtreeFlags=0,f.deletions=null,f.memoizedProps=w.memoizedProps,f.memoizedState=w.memoizedState,f.updateQueue=w.updateQueue,f.type=w.type,t=w.dependencies,f.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Se(Fe,Fe.current&1|2),s.child}t=t.sibling}f.tail!==null&&Be()>Pr&&(s.flags|=128,c=!0,Pn(f,!1),s.lanes=4194304)}else{if(!c)if(t=La(w),t!==null){if(s.flags|=128,c=!0,n=t.updateQueue,n!==null&&(s.updateQueue=n,s.flags|=4),Pn(f,!0),f.tail===null&&f.tailMode==="hidden"&&!w.alternate&&!Ie)return lt(s),null}else 2*Be()-f.renderingStartTime>Pr&&n!==1073741824&&(s.flags|=128,c=!0,Pn(f,!1),s.lanes=4194304);f.isBackwards?(w.sibling=s.child,s.child=w):(n=f.last,n!==null?n.sibling=w:s.child=w,f.last=w)}return f.tail!==null?(s=f.tail,f.rendering=s,f.tail=s.sibling,f.renderingStartTime=Be(),s.sibling=null,n=Fe.current,Se(Fe,c?n&1|2:n&1),s):(lt(s),null);case 22:case 23:return uo(),c=s.memoizedState!==null,t!==null&&t.memoizedState!==null!==c&&(s.flags|=8192),c&&(s.mode&1)!==0?(St&1073741824)!==0&&(lt(s),s.subtreeFlags&6&&(s.flags|=8192)):lt(s),null;case 24:return null;case 25:return null}throw Error(a(156,s.tag))}function r0(t,s){switch(bi(s),s.tag){case 1:return pt(s.type)&&Na(),t=s.flags,t&65536?(s.flags=t&-65537|128,s):null;case 3:return Sr(),De(xt),De(nt),Oi(),t=s.flags,(t&65536)!==0&&(t&128)===0?(s.flags=t&-65537|128,s):null;case 5:return Pi(s),null;case 13:if(De(Fe),t=s.memoizedState,t!==null&&t.dehydrated!==null){if(s.alternate===null)throw Error(a(340));wr()}return t=s.flags,t&65536?(s.flags=t&-65537|128,s):null;case 19:return De(Fe),null;case 4:return Sr(),null;case 10:return ki(s.type._context),null;case 22:case 23:return uo(),null;case 24:return null;default:return null}}var za=!1,it=!1,n0=typeof WeakSet=="function"?WeakSet:Set,J=null;function Tr(t,s){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(c){Ue(t,s,c)}else n.current=null}function Xi(t,s,n){try{n()}catch(c){Ue(t,s,c)}}var Su=!1;function a0(t,s){if(di=ca,t=nd(),si(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var c=n.getSelection&&n.getSelection();if(c&&c.rangeCount!==0){n=c.anchorNode;var m=c.anchorOffset,f=c.focusNode;c=c.focusOffset;try{n.nodeType,f.nodeType}catch{n=null;break e}var w=0,S=-1,E=-1,M=0,B=0,W=t,q=null;t:for(;;){for(var Y;W!==n||m!==0&&W.nodeType!==3||(S=w+m),W!==f||c!==0&&W.nodeType!==3||(E=w+c),W.nodeType===3&&(w+=W.nodeValue.length),(Y=W.firstChild)!==null;)q=W,W=Y;for(;;){if(W===t)break t;if(q===n&&++M===m&&(S=w),q===f&&++B===c&&(E=w),(Y=W.nextSibling)!==null)break;W=q,q=W.parentNode}W=Y}n=S===-1||E===-1?null:{start:S,end:E}}else n=null}n=n||{start:0,end:0}}else n=null;for(ui={focusedElem:t,selectionRange:n},ca=!1,J=s;J!==null;)if(s=J,t=s.child,(s.subtreeFlags&1028)!==0&&t!==null)t.return=s,J=t;else for(;J!==null;){s=J;try{var X=s.alternate;if((s.flags&1024)!==0)switch(s.tag){case 0:case 11:case 15:break;case 1:if(X!==null){var ee=X.memoizedProps,ze=X.memoizedState,L=s.stateNode,P=L.getSnapshotBeforeUpdate(s.elementType===s.type?ee:Ut(s.type,ee),ze);L.__reactInternalSnapshotBeforeUpdate=P}break;case 3:var A=s.stateNode.containerInfo;A.nodeType===1?A.textContent="":A.nodeType===9&&A.documentElement&&A.removeChild(A.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(a(163))}}catch(Q){Ue(s,s.return,Q)}if(t=s.sibling,t!==null){t.return=s.return,J=t;break}J=s.return}return X=Su,Su=!1,X}function Dn(t,s,n){var c=s.updateQueue;if(c=c!==null?c.lastEffect:null,c!==null){var m=c=c.next;do{if((m.tag&t)===t){var f=m.destroy;m.destroy=void 0,f!==void 0&&Xi(s,n,f)}m=m.next}while(m!==c)}}function Wa(t,s){if(s=s.updateQueue,s=s!==null?s.lastEffect:null,s!==null){var n=s=s.next;do{if((n.tag&t)===t){var c=n.create;n.destroy=c()}n=n.next}while(n!==s)}}function Zi(t){var s=t.ref;if(s!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof s=="function"?s(t):s.current=t}}function Cu(t){var s=t.alternate;s!==null&&(t.alternate=null,Cu(s)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(s=t.stateNode,s!==null&&(delete s[Jt],delete s[yn],delete s[xi],delete s[Uf],delete s[Bf])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function Tu(t){return t.tag===5||t.tag===3||t.tag===4}function Eu(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Tu(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function eo(t,s,n){var c=t.tag;if(c===5||c===6)t=t.stateNode,s?n.nodeType===8?n.parentNode.insertBefore(t,s):n.insertBefore(t,s):(n.nodeType===8?(s=n.parentNode,s.insertBefore(t,n)):(s=n,s.appendChild(t)),n=n._reactRootContainer,n!=null||s.onclick!==null||(s.onclick=ja));else if(c!==4&&(t=t.child,t!==null))for(eo(t,s,n),t=t.sibling;t!==null;)eo(t,s,n),t=t.sibling}function to(t,s,n){var c=t.tag;if(c===5||c===6)t=t.stateNode,s?n.insertBefore(t,s):n.appendChild(t);else if(c!==4&&(t=t.child,t!==null))for(to(t,s,n),t=t.sibling;t!==null;)to(t,s,n),t=t.sibling}var tt=null,Bt=!1;function Cs(t,s,n){for(n=n.child;n!==null;)Pu(t,s,n),n=n.sibling}function Pu(t,s,n){if(Yt&&typeof Yt.onCommitFiberUnmount=="function")try{Yt.onCommitFiberUnmount(ra,n)}catch{}switch(n.tag){case 5:it||Tr(n,s);case 6:var c=tt,m=Bt;tt=null,Cs(t,s,n),tt=c,Bt=m,tt!==null&&(Bt?(t=tt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):tt.removeChild(n.stateNode));break;case 18:tt!==null&&(Bt?(t=tt,n=n.stateNode,t.nodeType===8?fi(t.parentNode,n):t.nodeType===1&&fi(t,n),cn(t)):fi(tt,n.stateNode));break;case 4:c=tt,m=Bt,tt=n.stateNode.containerInfo,Bt=!0,Cs(t,s,n),tt=c,Bt=m;break;case 0:case 11:case 14:case 15:if(!it&&(c=n.updateQueue,c!==null&&(c=c.lastEffect,c!==null))){m=c=c.next;do{var f=m,w=f.destroy;f=f.tag,w!==void 0&&((f&2)!==0||(f&4)!==0)&&Xi(n,s,w),m=m.next}while(m!==c)}Cs(t,s,n);break;case 1:if(!it&&(Tr(n,s),c=n.stateNode,typeof c.componentWillUnmount=="function"))try{c.props=n.memoizedProps,c.state=n.memoizedState,c.componentWillUnmount()}catch(S){Ue(n,s,S)}Cs(t,s,n);break;case 21:Cs(t,s,n);break;case 22:n.mode&1?(it=(c=it)||n.memoizedState!==null,Cs(t,s,n),it=c):Cs(t,s,n);break;default:Cs(t,s,n)}}function Du(t){var s=t.updateQueue;if(s!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new n0),s.forEach(function(c){var m=f0.bind(null,t,c);n.has(c)||(n.add(c),c.then(m,m))})}}function zt(t,s){var n=s.deletions;if(n!==null)for(var c=0;c<n.length;c++){var m=n[c];try{var f=t,w=s,S=w;e:for(;S!==null;){switch(S.tag){case 5:tt=S.stateNode,Bt=!1;break e;case 3:tt=S.stateNode.containerInfo,Bt=!0;break e;case 4:tt=S.stateNode.containerInfo,Bt=!0;break e}S=S.return}if(tt===null)throw Error(a(160));Pu(f,w,m),tt=null,Bt=!1;var E=m.alternate;E!==null&&(E.return=null),m.return=null}catch(M){Ue(m,s,M)}}if(s.subtreeFlags&12854)for(s=s.child;s!==null;)Ou(s,t),s=s.sibling}function Ou(t,s){var n=t.alternate,c=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(zt(s,t),es(t),c&4){try{Dn(3,t,t.return),Wa(3,t)}catch(ee){Ue(t,t.return,ee)}try{Dn(5,t,t.return)}catch(ee){Ue(t,t.return,ee)}}break;case 1:zt(s,t),es(t),c&512&&n!==null&&Tr(n,n.return);break;case 5:if(zt(s,t),es(t),c&512&&n!==null&&Tr(n,n.return),t.flags&32){var m=t.stateNode;try{Jr(m,"")}catch(ee){Ue(t,t.return,ee)}}if(c&4&&(m=t.stateNode,m!=null)){var f=t.memoizedProps,w=n!==null?n.memoizedProps:f,S=t.type,E=t.updateQueue;if(t.updateQueue=null,E!==null)try{S==="input"&&f.type==="radio"&&f.name!=null&&lc(m,f),Ol(S,w);var M=Ol(S,f);for(w=0;w<E.length;w+=2){var B=E[w],W=E[w+1];B==="style"?fc(m,W):B==="dangerouslySetInnerHTML"?mc(m,W):B==="children"?Jr(m,W):C(m,B,W,M)}switch(S){case"input":Cl(m,f);break;case"textarea":cc(m,f);break;case"select":var q=m._wrapperState.wasMultiple;m._wrapperState.wasMultiple=!!f.multiple;var Y=f.value;Y!=null?ir(m,!!f.multiple,Y,!1):q!==!!f.multiple&&(f.defaultValue!=null?ir(m,!!f.multiple,f.defaultValue,!0):ir(m,!!f.multiple,f.multiple?[]:"",!1))}m[yn]=f}catch(ee){Ue(t,t.return,ee)}}break;case 6:if(zt(s,t),es(t),c&4){if(t.stateNode===null)throw Error(a(162));m=t.stateNode,f=t.memoizedProps;try{m.nodeValue=f}catch(ee){Ue(t,t.return,ee)}}break;case 3:if(zt(s,t),es(t),c&4&&n!==null&&n.memoizedState.isDehydrated)try{cn(s.containerInfo)}catch(ee){Ue(t,t.return,ee)}break;case 4:zt(s,t),es(t);break;case 13:zt(s,t),es(t),m=t.child,m.flags&8192&&(f=m.memoizedState!==null,m.stateNode.isHidden=f,!f||m.alternate!==null&&m.alternate.memoizedState!==null||(no=Be())),c&4&&Du(t);break;case 22:if(B=n!==null&&n.memoizedState!==null,t.mode&1?(it=(M=it)||B,zt(s,t),it=M):zt(s,t),es(t),c&8192){if(M=t.memoizedState!==null,(t.stateNode.isHidden=M)&&!B&&(t.mode&1)!==0)for(J=t,B=t.child;B!==null;){for(W=J=B;J!==null;){switch(q=J,Y=q.child,q.tag){case 0:case 11:case 14:case 15:Dn(4,q,q.return);break;case 1:Tr(q,q.return);var X=q.stateNode;if(typeof X.componentWillUnmount=="function"){c=q,n=q.return;try{s=c,X.props=s.memoizedProps,X.state=s.memoizedState,X.componentWillUnmount()}catch(ee){Ue(c,n,ee)}}break;case 5:Tr(q,q.return);break;case 22:if(q.memoizedState!==null){Iu(W);continue}}Y!==null?(Y.return=q,J=Y):Iu(W)}B=B.sibling}e:for(B=null,W=t;;){if(W.tag===5){if(B===null){B=W;try{m=W.stateNode,M?(f=m.style,typeof f.setProperty=="function"?f.setProperty("display","none","important"):f.display="none"):(S=W.stateNode,E=W.memoizedProps.style,w=E!=null&&E.hasOwnProperty("display")?E.display:null,S.style.display=hc("display",w))}catch(ee){Ue(t,t.return,ee)}}}else if(W.tag===6){if(B===null)try{W.stateNode.nodeValue=M?"":W.memoizedProps}catch(ee){Ue(t,t.return,ee)}}else if((W.tag!==22&&W.tag!==23||W.memoizedState===null||W===t)&&W.child!==null){W.child.return=W,W=W.child;continue}if(W===t)break e;for(;W.sibling===null;){if(W.return===null||W.return===t)break e;B===W&&(B=null),W=W.return}B===W&&(B=null),W.sibling.return=W.return,W=W.sibling}}break;case 19:zt(s,t),es(t),c&4&&Du(t);break;case 21:break;default:zt(s,t),es(t)}}function es(t){var s=t.flags;if(s&2){try{e:{for(var n=t.return;n!==null;){if(Tu(n)){var c=n;break e}n=n.return}throw Error(a(160))}switch(c.tag){case 5:var m=c.stateNode;c.flags&32&&(Jr(m,""),c.flags&=-33);var f=Eu(t);to(t,f,m);break;case 3:case 4:var w=c.stateNode.containerInfo,S=Eu(t);eo(t,S,w);break;default:throw Error(a(161))}}catch(E){Ue(t,t.return,E)}t.flags&=-3}s&4096&&(t.flags&=-4097)}function l0(t,s,n){J=t,Ru(t)}function Ru(t,s,n){for(var c=(t.mode&1)!==0;J!==null;){var m=J,f=m.child;if(m.tag===22&&c){var w=m.memoizedState!==null||za;if(!w){var S=m.alternate,E=S!==null&&S.memoizedState!==null||it;S=za;var M=it;if(za=w,(it=E)&&!M)for(J=m;J!==null;)w=J,E=w.child,w.tag===22&&w.memoizedState!==null?Au(m):E!==null?(E.return=w,J=E):Au(m);for(;f!==null;)J=f,Ru(f),f=f.sibling;J=m,za=S,it=M}Lu(t)}else(m.subtreeFlags&8772)!==0&&f!==null?(f.return=m,J=f):Lu(t)}}function Lu(t){for(;J!==null;){var s=J;if((s.flags&8772)!==0){var n=s.alternate;try{if((s.flags&8772)!==0)switch(s.tag){case 0:case 11:case 15:it||Wa(5,s);break;case 1:var c=s.stateNode;if(s.flags&4&&!it)if(n===null)c.componentDidMount();else{var m=s.elementType===s.type?n.memoizedProps:Ut(s.type,n.memoizedProps);c.componentDidUpdate(m,n.memoizedState,c.__reactInternalSnapshotBeforeUpdate)}var f=s.updateQueue;f!==null&&Id(s,f,c);break;case 3:var w=s.updateQueue;if(w!==null){if(n=null,s.child!==null)switch(s.child.tag){case 5:n=s.child.stateNode;break;case 1:n=s.child.stateNode}Id(s,w,n)}break;case 5:var S=s.stateNode;if(n===null&&s.flags&4){n=S;var E=s.memoizedProps;switch(s.type){case"button":case"input":case"select":case"textarea":E.autoFocus&&n.focus();break;case"img":E.src&&(n.src=E.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(s.memoizedState===null){var M=s.alternate;if(M!==null){var B=M.memoizedState;if(B!==null){var W=B.dehydrated;W!==null&&cn(W)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(a(163))}it||s.flags&512&&Zi(s)}catch(q){Ue(s,s.return,q)}}if(s===t){J=null;break}if(n=s.sibling,n!==null){n.return=s.return,J=n;break}J=s.return}}function Iu(t){for(;J!==null;){var s=J;if(s===t){J=null;break}var n=s.sibling;if(n!==null){n.return=s.return,J=n;break}J=s.return}}function Au(t){for(;J!==null;){var s=J;try{switch(s.tag){case 0:case 11:case 15:var n=s.return;try{Wa(4,s)}catch(E){Ue(s,n,E)}break;case 1:var c=s.stateNode;if(typeof c.componentDidMount=="function"){var m=s.return;try{c.componentDidMount()}catch(E){Ue(s,m,E)}}var f=s.return;try{Zi(s)}catch(E){Ue(s,f,E)}break;case 5:var w=s.return;try{Zi(s)}catch(E){Ue(s,w,E)}}}catch(E){Ue(s,s.return,E)}if(s===t){J=null;break}var S=s.sibling;if(S!==null){S.return=s.return,J=S;break}J=s.return}}var i0=Math.ceil,Ha=D.ReactCurrentDispatcher,so=D.ReactCurrentOwner,Rt=D.ReactCurrentBatchConfig,he=0,Je=null,We=null,st=0,St=0,Er=ws(0),Qe=0,On=null,Gs=0,Va=0,ro=0,Rn=null,vt=null,no=0,Pr=1/0,us=null,Qa=!1,ao=null,Ts=null,Ga=!1,Es=null,Ka=0,Ln=0,lo=null,Ya=-1,Ja=0;function mt(){return(he&6)!==0?Be():Ya!==-1?Ya:Ya=Be()}function Ps(t){return(t.mode&1)===0?1:(he&2)!==0&&st!==0?st&-st:Wf.transition!==null?(Ja===0&&(Ja=Ec()),Ja):(t=je,t!==0||(t=window.event,t=t===void 0?16:Fc(t.type)),t)}function Wt(t,s,n,c){if(50<Ln)throw Ln=0,lo=null,Error(a(185));rn(t,n,c),((he&2)===0||t!==Je)&&(t===Je&&((he&2)===0&&(Va|=n),Qe===4&&Ds(t,st)),bt(t,c),n===1&&he===0&&(s.mode&1)===0&&(Pr=Be()+500,ka&&_s()))}function bt(t,s){var n=t.callbackNode;zh(t,s);var c=la(t,t===Je?st:0);if(c===0)n!==null&&Sc(n),t.callbackNode=null,t.callbackPriority=0;else if(s=c&-c,t.callbackPriority!==s){if(n!=null&&Sc(n),s===1)t.tag===0?zf(Fu.bind(null,t)):Nd(Fu.bind(null,t)),$f(function(){(he&6)===0&&_s()}),n=null;else{switch(Pc(c)){case 1:n=$l;break;case 4:n=Cc;break;case 16:n=sa;break;case 536870912:n=Tc;break;default:n=sa}n=Vu(n,Mu.bind(null,t))}t.callbackPriority=s,t.callbackNode=n}}function Mu(t,s){if(Ya=-1,Ja=0,(he&6)!==0)throw Error(a(327));var n=t.callbackNode;if(Dr()&&t.callbackNode!==n)return null;var c=la(t,t===Je?st:0);if(c===0)return null;if((c&30)!==0||(c&t.expiredLanes)!==0||s)s=Xa(t,c);else{s=c;var m=he;he|=2;var f=qu();(Je!==t||st!==s)&&(us=null,Pr=Be()+500,Ys(t,s));do try{d0();break}catch(S){$u(t,S)}while(!0);_i(),Ha.current=f,he=m,We!==null?s=0:(Je=null,st=0,s=Qe)}if(s!==0){if(s===2&&(m=ql(t),m!==0&&(c=m,s=io(t,m))),s===1)throw n=On,Ys(t,0),Ds(t,c),bt(t,Be()),n;if(s===6)Ds(t,c);else{if(m=t.current.alternate,(c&30)===0&&!o0(m)&&(s=Xa(t,c),s===2&&(f=ql(t),f!==0&&(c=f,s=io(t,f))),s===1))throw n=On,Ys(t,0),Ds(t,c),bt(t,Be()),n;switch(t.finishedWork=m,t.finishedLanes=c,s){case 0:case 1:throw Error(a(345));case 2:Js(t,vt,us);break;case 3:if(Ds(t,c),(c&130023424)===c&&(s=no+500-Be(),10<s)){if(la(t,0)!==0)break;if(m=t.suspendedLanes,(m&c)!==c){mt(),t.pingedLanes|=t.suspendedLanes&m;break}t.timeoutHandle=hi(Js.bind(null,t,vt,us),s);break}Js(t,vt,us);break;case 4:if(Ds(t,c),(c&4194240)===c)break;for(s=t.eventTimes,m=-1;0<c;){var w=31-Ft(c);f=1<<w,w=s[w],w>m&&(m=w),c&=~f}if(c=m,c=Be()-c,c=(120>c?120:480>c?480:1080>c?1080:1920>c?1920:3e3>c?3e3:4320>c?4320:1960*i0(c/1960))-c,10<c){t.timeoutHandle=hi(Js.bind(null,t,vt,us),c);break}Js(t,vt,us);break;case 5:Js(t,vt,us);break;default:throw Error(a(329))}}}return bt(t,Be()),t.callbackNode===n?Mu.bind(null,t):null}function io(t,s){var n=Rn;return t.current.memoizedState.isDehydrated&&(Ys(t,s).flags|=256),t=Xa(t,s),t!==2&&(s=vt,vt=n,s!==null&&oo(s)),t}function oo(t){vt===null?vt=t:vt.push.apply(vt,t)}function o0(t){for(var s=t;;){if(s.flags&16384){var n=s.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var c=0;c<n.length;c++){var m=n[c],f=m.getSnapshot;m=m.value;try{if(!$t(f(),m))return!1}catch{return!1}}}if(n=s.child,s.subtreeFlags&16384&&n!==null)n.return=s,s=n;else{if(s===t)break;for(;s.sibling===null;){if(s.return===null||s.return===t)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function Ds(t,s){for(s&=~ro,s&=~Va,t.suspendedLanes|=s,t.pingedLanes&=~s,t=t.expirationTimes;0<s;){var n=31-Ft(s),c=1<<n;t[n]=-1,s&=~c}}function Fu(t){if((he&6)!==0)throw Error(a(327));Dr();var s=la(t,0);if((s&1)===0)return bt(t,Be()),null;var n=Xa(t,s);if(t.tag!==0&&n===2){var c=ql(t);c!==0&&(s=c,n=io(t,c))}if(n===1)throw n=On,Ys(t,0),Ds(t,s),bt(t,Be()),n;if(n===6)throw Error(a(345));return t.finishedWork=t.current.alternate,t.finishedLanes=s,Js(t,vt,us),bt(t,Be()),null}function co(t,s){var n=he;he|=1;try{return t(s)}finally{he=n,he===0&&(Pr=Be()+500,ka&&_s())}}function Ks(t){Es!==null&&Es.tag===0&&(he&6)===0&&Dr();var s=he;he|=1;var n=Rt.transition,c=je;try{if(Rt.transition=null,je=1,t)return t()}finally{je=c,Rt.transition=n,he=s,(he&6)===0&&_s()}}function uo(){St=Er.current,De(Er)}function Ys(t,s){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,Ff(n)),We!==null)for(n=We.return;n!==null;){var c=n;switch(bi(c),c.tag){case 1:c=c.type.childContextTypes,c!=null&&Na();break;case 3:Sr(),De(xt),De(nt),Oi();break;case 5:Pi(c);break;case 4:Sr();break;case 13:De(Fe);break;case 19:De(Fe);break;case 10:ki(c.type._context);break;case 22:case 23:uo()}n=n.return}if(Je=t,We=t=Os(t.current,null),st=St=s,Qe=0,On=null,ro=Va=Gs=0,vt=Rn=null,Hs!==null){for(s=0;s<Hs.length;s++)if(n=Hs[s],c=n.interleaved,c!==null){n.interleaved=null;var m=c.next,f=n.pending;if(f!==null){var w=f.next;f.next=m,c.next=w}n.pending=c}Hs=null}return t}function $u(t,s){do{var n=We;try{if(_i(),Ia.current=$a,Aa){for(var c=$e.memoizedState;c!==null;){var m=c.queue;m!==null&&(m.pending=null),c=c.next}Aa=!1}if(Qs=0,Ye=Ve=$e=null,Sn=!1,Cn=0,so.current=null,n===null||n.return===null){Qe=1,On=s,We=null;break}e:{var f=t,w=n.return,S=n,E=s;if(s=st,S.flags|=32768,E!==null&&typeof E=="object"&&typeof E.then=="function"){var M=E,B=S,W=B.tag;if((B.mode&1)===0&&(W===0||W===11||W===15)){var q=B.alternate;q?(B.updateQueue=q.updateQueue,B.memoizedState=q.memoizedState,B.lanes=q.lanes):(B.updateQueue=null,B.memoizedState=null)}var Y=du(w);if(Y!==null){Y.flags&=-257,uu(Y,w,S,f,s),Y.mode&1&&cu(f,M,s),s=Y,E=M;var X=s.updateQueue;if(X===null){var ee=new Set;ee.add(E),s.updateQueue=ee}else X.add(E);break e}else{if((s&1)===0){cu(f,M,s),mo();break e}E=Error(a(426))}}else if(Ie&&S.mode&1){var ze=du(w);if(ze!==null){(ze.flags&65536)===0&&(ze.flags|=256),uu(ze,w,S,f,s),wi(Cr(E,S));break e}}f=E=Cr(E,S),Qe!==4&&(Qe=2),Rn===null?Rn=[f]:Rn.push(f),f=w;do{switch(f.tag){case 3:f.flags|=65536,s&=-s,f.lanes|=s;var L=iu(f,E,s);Ld(f,L);break e;case 1:S=E;var P=f.type,A=f.stateNode;if((f.flags&128)===0&&(typeof P.getDerivedStateFromError=="function"||A!==null&&typeof A.componentDidCatch=="function"&&(Ts===null||!Ts.has(A)))){f.flags|=65536,s&=-s,f.lanes|=s;var Q=ou(f,S,s);Ld(f,Q);break e}}f=f.return}while(f!==null)}Bu(n)}catch(te){s=te,We===n&&n!==null&&(We=n=n.return);continue}break}while(!0)}function qu(){var t=Ha.current;return Ha.current=$a,t===null?$a:t}function mo(){(Qe===0||Qe===3||Qe===2)&&(Qe=4),Je===null||(Gs&268435455)===0&&(Va&268435455)===0||Ds(Je,st)}function Xa(t,s){var n=he;he|=2;var c=qu();(Je!==t||st!==s)&&(us=null,Ys(t,s));do try{c0();break}catch(m){$u(t,m)}while(!0);if(_i(),he=n,Ha.current=c,We!==null)throw Error(a(261));return Je=null,st=0,Qe}function c0(){for(;We!==null;)Uu(We)}function d0(){for(;We!==null&&!Lh();)Uu(We)}function Uu(t){var s=Hu(t.alternate,t,St);t.memoizedProps=t.pendingProps,s===null?Bu(t):We=s,so.current=null}function Bu(t){var s=t;do{var n=s.alternate;if(t=s.return,(s.flags&32768)===0){if(n=s0(n,s,St),n!==null){We=n;return}}else{if(n=r0(n,s),n!==null){n.flags&=32767,We=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Qe=6,We=null;return}}if(s=s.sibling,s!==null){We=s;return}We=s=t}while(s!==null);Qe===0&&(Qe=5)}function Js(t,s,n){var c=je,m=Rt.transition;try{Rt.transition=null,je=1,u0(t,s,n,c)}finally{Rt.transition=m,je=c}return null}function u0(t,s,n,c){do Dr();while(Es!==null);if((he&6)!==0)throw Error(a(327));n=t.finishedWork;var m=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(a(177));t.callbackNode=null,t.callbackPriority=0;var f=n.lanes|n.childLanes;if(Wh(t,f),t===Je&&(We=Je=null,st=0),(n.subtreeFlags&2064)===0&&(n.flags&2064)===0||Ga||(Ga=!0,Vu(sa,function(){return Dr(),null})),f=(n.flags&15990)!==0,(n.subtreeFlags&15990)!==0||f){f=Rt.transition,Rt.transition=null;var w=je;je=1;var S=he;he|=4,so.current=null,a0(t,n),Ou(n,t),Df(ui),ca=!!di,ui=di=null,t.current=n,l0(n),Ih(),he=S,je=w,Rt.transition=f}else t.current=n;if(Ga&&(Ga=!1,Es=t,Ka=m),f=t.pendingLanes,f===0&&(Ts=null),Fh(n.stateNode),bt(t,Be()),s!==null)for(c=t.onRecoverableError,n=0;n<s.length;n++)m=s[n],c(m.value,{componentStack:m.stack,digest:m.digest});if(Qa)throw Qa=!1,t=ao,ao=null,t;return(Ka&1)!==0&&t.tag!==0&&Dr(),f=t.pendingLanes,(f&1)!==0?t===lo?Ln++:(Ln=0,lo=t):Ln=0,_s(),null}function Dr(){if(Es!==null){var t=Pc(Ka),s=Rt.transition,n=je;try{if(Rt.transition=null,je=16>t?16:t,Es===null)var c=!1;else{if(t=Es,Es=null,Ka=0,(he&6)!==0)throw Error(a(331));var m=he;for(he|=4,J=t.current;J!==null;){var f=J,w=f.child;if((J.flags&16)!==0){var S=f.deletions;if(S!==null){for(var E=0;E<S.length;E++){var M=S[E];for(J=M;J!==null;){var B=J;switch(B.tag){case 0:case 11:case 15:Dn(8,B,f)}var W=B.child;if(W!==null)W.return=B,J=W;else for(;J!==null;){B=J;var q=B.sibling,Y=B.return;if(Cu(B),B===M){J=null;break}if(q!==null){q.return=Y,J=q;break}J=Y}}}var X=f.alternate;if(X!==null){var ee=X.child;if(ee!==null){X.child=null;do{var ze=ee.sibling;ee.sibling=null,ee=ze}while(ee!==null)}}J=f}}if((f.subtreeFlags&2064)!==0&&w!==null)w.return=f,J=w;else e:for(;J!==null;){if(f=J,(f.flags&2048)!==0)switch(f.tag){case 0:case 11:case 15:Dn(9,f,f.return)}var L=f.sibling;if(L!==null){L.return=f.return,J=L;break e}J=f.return}}var P=t.current;for(J=P;J!==null;){w=J;var A=w.child;if((w.subtreeFlags&2064)!==0&&A!==null)A.return=w,J=A;else e:for(w=P;J!==null;){if(S=J,(S.flags&2048)!==0)try{switch(S.tag){case 0:case 11:case 15:Wa(9,S)}}catch(te){Ue(S,S.return,te)}if(S===w){J=null;break e}var Q=S.sibling;if(Q!==null){Q.return=S.return,J=Q;break e}J=S.return}}if(he=m,_s(),Yt&&typeof Yt.onPostCommitFiberRoot=="function")try{Yt.onPostCommitFiberRoot(ra,t)}catch{}c=!0}return c}finally{je=n,Rt.transition=s}}return!1}function zu(t,s,n){s=Cr(n,s),s=iu(t,s,1),t=Ss(t,s,1),s=mt(),t!==null&&(rn(t,1,s),bt(t,s))}function Ue(t,s,n){if(t.tag===3)zu(t,t,n);else for(;s!==null;){if(s.tag===3){zu(s,t,n);break}else if(s.tag===1){var c=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(Ts===null||!Ts.has(c))){t=Cr(n,t),t=ou(s,t,1),s=Ss(s,t,1),t=mt(),s!==null&&(rn(s,1,t),bt(s,t));break}}s=s.return}}function m0(t,s,n){var c=t.pingCache;c!==null&&c.delete(s),s=mt(),t.pingedLanes|=t.suspendedLanes&n,Je===t&&(st&n)===n&&(Qe===4||Qe===3&&(st&130023424)===st&&500>Be()-no?Ys(t,0):ro|=n),bt(t,s)}function Wu(t,s){s===0&&((t.mode&1)===0?s=1:(s=aa,aa<<=1,(aa&130023424)===0&&(aa=4194304)));var n=mt();t=os(t,s),t!==null&&(rn(t,s,n),bt(t,n))}function h0(t){var s=t.memoizedState,n=0;s!==null&&(n=s.retryLane),Wu(t,n)}function f0(t,s){var n=0;switch(t.tag){case 13:var c=t.stateNode,m=t.memoizedState;m!==null&&(n=m.retryLane);break;case 19:c=t.stateNode;break;default:throw Error(a(314))}c!==null&&c.delete(s),Wu(t,n)}var Hu;Hu=function(t,s,n){if(t!==null)if(t.memoizedProps!==s.pendingProps||xt.current)gt=!0;else{if((t.lanes&n)===0&&(s.flags&128)===0)return gt=!1,t0(t,s,n);gt=(t.flags&131072)!==0}else gt=!1,Ie&&(s.flags&1048576)!==0&&_d(s,Ca,s.index);switch(s.lanes=0,s.tag){case 2:var c=s.type;Ba(t,s),t=s.pendingProps;var m=br(s,nt.current);kr(s,n),m=Ii(null,s,c,t,m,n);var f=Ai();return s.flags|=1,typeof m=="object"&&m!==null&&typeof m.render=="function"&&m.$$typeof===void 0?(s.tag=1,s.memoizedState=null,s.updateQueue=null,pt(c)?(f=!0,_a(s)):f=!1,s.memoizedState=m.state!==null&&m.state!==void 0?m.state:null,Ti(s),m.updater=qa,s.stateNode=m,m._reactInternals=s,Bi(s,c,t,n),s=Vi(null,s,c,!0,f,n)):(s.tag=0,Ie&&f&&vi(s),ut(null,s,m,n),s=s.child),s;case 16:c=s.elementType;e:{switch(Ba(t,s),t=s.pendingProps,m=c._init,c=m(c._payload),s.type=c,m=s.tag=p0(c),t=Ut(c,t),m){case 0:s=Hi(null,s,c,t,n);break e;case 1:s=gu(null,s,c,t,n);break e;case 11:s=mu(null,s,c,t,n);break e;case 14:s=hu(null,s,c,Ut(c.type,t),n);break e}throw Error(a(306,c,""))}return s;case 0:return c=s.type,m=s.pendingProps,m=s.elementType===c?m:Ut(c,m),Hi(t,s,c,m,n);case 1:return c=s.type,m=s.pendingProps,m=s.elementType===c?m:Ut(c,m),gu(t,s,c,m,n);case 3:e:{if(vu(s),t===null)throw Error(a(387));c=s.pendingProps,f=s.memoizedState,m=f.element,Rd(t,s),Ra(s,c,null,n);var w=s.memoizedState;if(c=w.element,f.isDehydrated)if(f={element:c,isDehydrated:!1,cache:w.cache,pendingSuspenseBoundaries:w.pendingSuspenseBoundaries,transitions:w.transitions},s.updateQueue.baseState=f,s.memoizedState=f,s.flags&256){m=Cr(Error(a(423)),s),s=bu(t,s,c,n,m);break e}else if(c!==m){m=Cr(Error(a(424)),s),s=bu(t,s,c,n,m);break e}else for(kt=js(s.stateNode.containerInfo.firstChild),_t=s,Ie=!0,qt=null,n=Dd(s,null,c,n),s.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(wr(),c===m){s=ds(t,s,n);break e}ut(t,s,c,n)}s=s.child}return s;case 5:return Ad(s),t===null&&ji(s),c=s.type,m=s.pendingProps,f=t!==null?t.memoizedProps:null,w=m.children,mi(c,m)?w=null:f!==null&&mi(c,f)&&(s.flags|=32),pu(t,s),ut(t,s,w,n),s.child;case 6:return t===null&&ji(s),null;case 13:return yu(t,s,n);case 4:return Ei(s,s.stateNode.containerInfo),c=s.pendingProps,t===null?s.child=Nr(s,null,c,n):ut(t,s,c,n),s.child;case 11:return c=s.type,m=s.pendingProps,m=s.elementType===c?m:Ut(c,m),mu(t,s,c,m,n);case 7:return ut(t,s,s.pendingProps,n),s.child;case 8:return ut(t,s,s.pendingProps.children,n),s.child;case 12:return ut(t,s,s.pendingProps.children,n),s.child;case 10:e:{if(c=s.type._context,m=s.pendingProps,f=s.memoizedProps,w=m.value,Se(Pa,c._currentValue),c._currentValue=w,f!==null)if($t(f.value,w)){if(f.children===m.children&&!xt.current){s=ds(t,s,n);break e}}else for(f=s.child,f!==null&&(f.return=s);f!==null;){var S=f.dependencies;if(S!==null){w=f.child;for(var E=S.firstContext;E!==null;){if(E.context===c){if(f.tag===1){E=cs(-1,n&-n),E.tag=2;var M=f.updateQueue;if(M!==null){M=M.shared;var B=M.pending;B===null?E.next=E:(E.next=B.next,B.next=E),M.pending=E}}f.lanes|=n,E=f.alternate,E!==null&&(E.lanes|=n),Si(f.return,n,s),S.lanes|=n;break}E=E.next}}else if(f.tag===10)w=f.type===s.type?null:f.child;else if(f.tag===18){if(w=f.return,w===null)throw Error(a(341));w.lanes|=n,S=w.alternate,S!==null&&(S.lanes|=n),Si(w,n,s),w=f.sibling}else w=f.child;if(w!==null)w.return=f;else for(w=f;w!==null;){if(w===s){w=null;break}if(f=w.sibling,f!==null){f.return=w.return,w=f;break}w=w.return}f=w}ut(t,s,m.children,n),s=s.child}return s;case 9:return m=s.type,c=s.pendingProps.children,kr(s,n),m=Dt(m),c=c(m),s.flags|=1,ut(t,s,c,n),s.child;case 14:return c=s.type,m=Ut(c,s.pendingProps),m=Ut(c.type,m),hu(t,s,c,m,n);case 15:return fu(t,s,s.type,s.pendingProps,n);case 17:return c=s.type,m=s.pendingProps,m=s.elementType===c?m:Ut(c,m),Ba(t,s),s.tag=1,pt(c)?(t=!0,_a(s)):t=!1,kr(s,n),au(s,c,m),Bi(s,c,m,n),Vi(null,s,c,!0,t,n);case 19:return wu(t,s,n);case 22:return xu(t,s,n)}throw Error(a(156,s.tag))};function Vu(t,s){return kc(t,s)}function x0(t,s,n,c){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Lt(t,s,n,c){return new x0(t,s,n,c)}function ho(t){return t=t.prototype,!(!t||!t.isReactComponent)}function p0(t){if(typeof t=="function")return ho(t)?1:0;if(t!=null){if(t=t.$$typeof,t===ce)return 11;if(t===Re)return 14}return 2}function Os(t,s){var n=t.alternate;return n===null?(n=Lt(t.tag,s,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=s,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,s=t.dependencies,n.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Za(t,s,n,c,m,f){var w=2;if(c=t,typeof t=="function")ho(t)&&(w=1);else if(typeof t=="string")w=5;else e:switch(t){case H:return Xs(n.children,m,f,s);case ae:w=8,m|=8;break;case _e:return t=Lt(12,n,s,m|2),t.elementType=_e,t.lanes=f,t;case be:return t=Lt(13,n,s,m),t.elementType=be,t.lanes=f,t;case Oe:return t=Lt(19,n,s,m),t.elementType=Oe,t.lanes=f,t;case G:return el(n,m,f,s);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case He:w=10;break e;case U:w=9;break e;case ce:w=11;break e;case Re:w=14;break e;case qe:w=16,c=null;break e}throw Error(a(130,t==null?t:typeof t,""))}return s=Lt(w,n,s,m),s.elementType=t,s.type=c,s.lanes=f,s}function Xs(t,s,n,c){return t=Lt(7,t,c,s),t.lanes=n,t}function el(t,s,n,c){return t=Lt(22,t,c,s),t.elementType=G,t.lanes=n,t.stateNode={isHidden:!1},t}function fo(t,s,n){return t=Lt(6,t,null,s),t.lanes=n,t}function xo(t,s,n){return s=Lt(4,t.children!==null?t.children:[],t.key,s),s.lanes=n,s.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},s}function g0(t,s,n,c,m){this.tag=s,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ul(0),this.expirationTimes=Ul(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ul(0),this.identifierPrefix=c,this.onRecoverableError=m,this.mutableSourceEagerHydrationData=null}function po(t,s,n,c,m,f,w,S,E){return t=new g0(t,s,n,S,E),s===1?(s=1,f===!0&&(s|=8)):s=0,f=Lt(3,null,null,s),t.current=f,f.stateNode=t,f.memoizedState={element:c,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ti(f),t}function v0(t,s,n){var c=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:F,key:c==null?null:""+c,children:t,containerInfo:s,implementation:n}}function Qu(t){if(!t)return Ns;t=t._reactInternals;e:{if(qs(t)!==t||t.tag!==1)throw Error(a(170));var s=t;do{switch(s.tag){case 3:s=s.stateNode.context;break e;case 1:if(pt(s.type)){s=s.stateNode.__reactInternalMemoizedMergedChildContext;break e}}s=s.return}while(s!==null);throw Error(a(171))}if(t.tag===1){var n=t.type;if(pt(n))return jd(t,n,s)}return s}function Gu(t,s,n,c,m,f,w,S,E){return t=po(n,c,!0,t,m,f,w,S,E),t.context=Qu(null),n=t.current,c=mt(),m=Ps(n),f=cs(c,m),f.callback=s??null,Ss(n,f,m),t.current.lanes=m,rn(t,m,c),bt(t,c),t}function tl(t,s,n,c){var m=s.current,f=mt(),w=Ps(m);return n=Qu(n),s.context===null?s.context=n:s.pendingContext=n,s=cs(f,w),s.payload={element:t},c=c===void 0?null:c,c!==null&&(s.callback=c),t=Ss(m,s,w),t!==null&&(Wt(t,m,w,f),Oa(t,m,w)),w}function sl(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Ku(t,s){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<s?n:s}}function go(t,s){Ku(t,s),(t=t.alternate)&&Ku(t,s)}function b0(){return null}var Yu=typeof reportError=="function"?reportError:function(t){console.error(t)};function vo(t){this._internalRoot=t}rl.prototype.render=vo.prototype.render=function(t){var s=this._internalRoot;if(s===null)throw Error(a(409));tl(t,s,null,null)},rl.prototype.unmount=vo.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var s=t.containerInfo;Ks(function(){tl(null,t,null,null)}),s[ns]=null}};function rl(t){this._internalRoot=t}rl.prototype.unstable_scheduleHydration=function(t){if(t){var s=Rc();t={blockedOn:null,target:t,priority:s};for(var n=0;n<vs.length&&s!==0&&s<vs[n].priority;n++);vs.splice(n,0,t),n===0&&Ac(t)}};function bo(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function nl(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Ju(){}function y0(t,s,n,c,m){if(m){if(typeof c=="function"){var f=c;c=function(){var M=sl(w);f.call(M)}}var w=Gu(s,c,t,0,null,!1,!1,"",Ju);return t._reactRootContainer=w,t[ns]=w.current,vn(t.nodeType===8?t.parentNode:t),Ks(),w}for(;m=t.lastChild;)t.removeChild(m);if(typeof c=="function"){var S=c;c=function(){var M=sl(E);S.call(M)}}var E=po(t,0,!1,null,null,!1,!1,"",Ju);return t._reactRootContainer=E,t[ns]=E.current,vn(t.nodeType===8?t.parentNode:t),Ks(function(){tl(s,E,n,c)}),E}function al(t,s,n,c,m){var f=n._reactRootContainer;if(f){var w=f;if(typeof m=="function"){var S=m;m=function(){var E=sl(w);S.call(E)}}tl(s,w,t,m)}else w=y0(n,s,t,m,c);return sl(w)}Dc=function(t){switch(t.tag){case 3:var s=t.stateNode;if(s.current.memoizedState.isDehydrated){var n=sn(s.pendingLanes);n!==0&&(Bl(s,n|1),bt(s,Be()),(he&6)===0&&(Pr=Be()+500,_s()))}break;case 13:Ks(function(){var c=os(t,1);if(c!==null){var m=mt();Wt(c,t,1,m)}}),go(t,1)}},zl=function(t){if(t.tag===13){var s=os(t,134217728);if(s!==null){var n=mt();Wt(s,t,134217728,n)}go(t,134217728)}},Oc=function(t){if(t.tag===13){var s=Ps(t),n=os(t,s);if(n!==null){var c=mt();Wt(n,t,s,c)}go(t,s)}},Rc=function(){return je},Lc=function(t,s){var n=je;try{return je=t,s()}finally{je=n}},Il=function(t,s,n){switch(s){case"input":if(Cl(t,n),s=n.name,n.type==="radio"&&s!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+s)+'][type="radio"]'),s=0;s<n.length;s++){var c=n[s];if(c!==t&&c.form===t.form){var m=wa(c);if(!m)throw Error(a(90));nc(c),Cl(c,m)}}}break;case"textarea":cc(t,n);break;case"select":s=n.value,s!=null&&ir(t,!!n.multiple,s,!1)}},vc=co,bc=Ks;var j0={usingClientEntryPoint:!1,Events:[jn,gr,wa,pc,gc,co]},In={findFiberByHostInstance:Us,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},w0={bundleType:In.bundleType,version:In.version,rendererPackageName:In.rendererPackageName,rendererConfig:In.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:D.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Nc(t),t===null?null:t.stateNode},findFiberByHostInstance:In.findFiberByHostInstance||b0,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ll=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ll.isDisabled&&ll.supportsFiber)try{ra=ll.inject(w0),Yt=ll}catch{}}return yt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=j0,yt.createPortal=function(t,s){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!bo(s))throw Error(a(200));return v0(t,s,null,n)},yt.createRoot=function(t,s){if(!bo(t))throw Error(a(299));var n=!1,c="",m=Yu;return s!=null&&(s.unstable_strictMode===!0&&(n=!0),s.identifierPrefix!==void 0&&(c=s.identifierPrefix),s.onRecoverableError!==void 0&&(m=s.onRecoverableError)),s=po(t,1,!1,null,null,n,!1,c,m),t[ns]=s.current,vn(t.nodeType===8?t.parentNode:t),new vo(s)},yt.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var s=t._reactInternals;if(s===void 0)throw typeof t.render=="function"?Error(a(188)):(t=Object.keys(t).join(","),Error(a(268,t)));return t=Nc(s),t=t===null?null:t.stateNode,t},yt.flushSync=function(t){return Ks(t)},yt.hydrate=function(t,s,n){if(!nl(s))throw Error(a(200));return al(null,t,s,!0,n)},yt.hydrateRoot=function(t,s,n){if(!bo(t))throw Error(a(405));var c=n!=null&&n.hydratedSources||null,m=!1,f="",w=Yu;if(n!=null&&(n.unstable_strictMode===!0&&(m=!0),n.identifierPrefix!==void 0&&(f=n.identifierPrefix),n.onRecoverableError!==void 0&&(w=n.onRecoverableError)),s=Gu(s,null,t,1,n??null,m,!1,f,w),t[ns]=s.current,vn(t),c)for(t=0;t<c.length;t++)n=c[t],m=n._getVersion,m=m(n._source),s.mutableSourceEagerHydrationData==null?s.mutableSourceEagerHydrationData=[n,m]:s.mutableSourceEagerHydrationData.push(n,m);return new rl(s)},yt.render=function(t,s,n){if(!nl(s))throw Error(a(200));return al(null,t,s,!1,n)},yt.unmountComponentAtNode=function(t){if(!nl(t))throw Error(a(40));return t._reactRootContainer?(Ks(function(){al(null,null,t,!1,function(){t._reactRootContainer=null,t[ns]=null})}),!0):!1},yt.unstable_batchedUpdates=co,yt.unstable_renderSubtreeIntoContainer=function(t,s,n,c){if(!nl(n))throw Error(a(200));if(t==null||t._reactInternals===void 0)throw Error(a(38));return al(t,s,n,!1,c)},yt.version="18.3.1-next-f1338f8080-20240426",yt}var am;function O0(){if(am)return wo.exports;am=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(r){console.error(r)}}return i(),wo.exports=D0(),wo.exports}var lm;function R0(){if(lm)return il;lm=1;var i=O0();return il.createRoot=i.createRoot,il.hydrateRoot=i.hydrateRoot,il}var L0=R0();const I0="modulepreload",A0=function(i){return"/"+i},im={},Gn=function(r,a,l){let o=Promise.resolve();if(a&&a.length>0){let g=function(v){return Promise.all(v.map(x=>Promise.resolve(x).then(N=>({status:"fulfilled",value:N}),N=>({status:"rejected",reason:N}))))};var u=g;document.getElementsByTagName("link");const h=document.querySelector("meta[property=csp-nonce]"),p=h?.nonce||h?.getAttribute("nonce");o=g(a.map(v=>{if(v=A0(v),v in im)return;im[v]=!0;const x=v.endsWith(".css"),N=x?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${v}"]${N}`))return;const y=document.createElement("link");if(y.rel=x?"stylesheet":I0,x||(y.as="script"),y.crossOrigin="",y.href=v,p&&y.setAttribute("nonce",p),document.head.appendChild(y),x)return new Promise((b,j)=>{y.addEventListener("load",b),y.addEventListener("error",()=>j(new Error(`Unable to preload CSS for ${v}`)))})}))}function d(h){const p=new Event("vite:preloadError",{cancelable:!0});if(p.payload=h,window.dispatchEvent(p),!p.defaultPrevented)throw h}return o.then(h=>{for(const p of h||[])p.status==="rejected"&&d(p.reason);return r().catch(d)})},M0=i=>{let r;return i?r=i:typeof fetch>"u"?r=(...a)=>Gn(async()=>{const{default:l}=await Promise.resolve().then(()=>Kr);return{default:l}},void 0).then(({default:l})=>l(...a)):r=fetch,(...a)=>r(...a)};class Jo extends Error{constructor(r,a="FunctionsError",l){super(r),this.name=a,this.context=l}}class F0 extends Jo{constructor(r){super("Failed to send a request to the Edge Function","FunctionsFetchError",r)}}class om extends Jo{constructor(r){super("Relay Error invoking the Edge Function","FunctionsRelayError",r)}}class cm extends Jo{constructor(r){super("Edge Function returned a non-2xx status code","FunctionsHttpError",r)}}var Io;(function(i){i.Any="any",i.ApNortheast1="ap-northeast-1",i.ApNortheast2="ap-northeast-2",i.ApSouth1="ap-south-1",i.ApSoutheast1="ap-southeast-1",i.ApSoutheast2="ap-southeast-2",i.CaCentral1="ca-central-1",i.EuCentral1="eu-central-1",i.EuWest1="eu-west-1",i.EuWest2="eu-west-2",i.EuWest3="eu-west-3",i.SaEast1="sa-east-1",i.UsEast1="us-east-1",i.UsWest1="us-west-1",i.UsWest2="us-west-2"})(Io||(Io={}));var $0=function(i,r,a,l){function o(d){return d instanceof a?d:new a(function(u){u(d)})}return new(a||(a=Promise))(function(d,u){function h(v){try{g(l.next(v))}catch(x){u(x)}}function p(v){try{g(l.throw(v))}catch(x){u(x)}}function g(v){v.done?d(v.value):o(v.value).then(h,p)}g((l=l.apply(i,r||[])).next())})};class q0{constructor(r,{headers:a={},customFetch:l,region:o=Io.Any}={}){this.url=r,this.headers=a,this.region=o,this.fetch=M0(l)}setAuth(r){this.headers.Authorization=`Bearer ${r}`}invoke(r,a={}){var l;return $0(this,void 0,void 0,function*(){try{const{headers:o,method:d,body:u}=a;let h={},{region:p}=a;p||(p=this.region);const g=new URL(`${this.url}/${r}`);p&&p!=="any"&&(h["x-region"]=p,g.searchParams.set("forceFunctionRegion",p));let v;u&&(o&&!Object.prototype.hasOwnProperty.call(o,"Content-Type")||!o)&&(typeof Blob<"u"&&u instanceof Blob||u instanceof ArrayBuffer?(h["Content-Type"]="application/octet-stream",v=u):typeof u=="string"?(h["Content-Type"]="text/plain",v=u):typeof FormData<"u"&&u instanceof FormData?v=u:(h["Content-Type"]="application/json",v=JSON.stringify(u)));const x=yield this.fetch(g.toString(),{method:d||"POST",headers:Object.assign(Object.assign(Object.assign({},h),this.headers),o),body:v}).catch(j=>{throw new F0(j)}),N=x.headers.get("x-relay-error");if(N&&N==="true")throw new om(x);if(!x.ok)throw new cm(x);let y=((l=x.headers.get("Content-Type"))!==null&&l!==void 0?l:"text/plain").split(";")[0].trim(),b;return y==="application/json"?b=yield x.json():y==="application/octet-stream"?b=yield x.blob():y==="text/event-stream"?b=x:y==="multipart/form-data"?b=yield x.formData():b=yield x.text(),{data:b,error:null,response:x}}catch(o){return{data:null,error:o,response:o instanceof cm||o instanceof om?o.context:void 0}}})}}var Ze={},Or={},Rr={},Lr={},Ir={},Ar={},U0=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Qr=U0();const B0=Qr.fetch,Ym=Qr.fetch.bind(Qr),Jm=Qr.Headers,z0=Qr.Request,W0=Qr.Response,Kr=Object.freeze(Object.defineProperty({__proto__:null,Headers:Jm,Request:z0,Response:W0,default:Ym,fetch:B0},Symbol.toStringTag,{value:"Module"})),H0=k0(Kr);var ol={},dm;function Xm(){if(dm)return ol;dm=1,Object.defineProperty(ol,"__esModule",{value:!0});class i extends Error{constructor(a){super(a.message),this.name="PostgrestError",this.details=a.details,this.hint=a.hint,this.code=a.code}}return ol.default=i,ol}var um;function Zm(){if(um)return Ar;um=1;var i=Ar&&Ar.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(Ar,"__esModule",{value:!0});const r=i(H0),a=i(Xm());class l{constructor(d){var u,h;this.shouldThrowOnError=!1,this.method=d.method,this.url=d.url,this.headers=new Headers(d.headers),this.schema=d.schema,this.body=d.body,this.shouldThrowOnError=(u=d.shouldThrowOnError)!==null&&u!==void 0?u:!1,this.signal=d.signal,this.isMaybeSingle=(h=d.isMaybeSingle)!==null&&h!==void 0?h:!1,d.fetch?this.fetch=d.fetch:typeof fetch>"u"?this.fetch=r.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(d,u){return this.headers=new Headers(this.headers),this.headers.set(d,u),this}then(d,u){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const h=this.fetch;let p=h(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async g=>{var v,x,N,y;let b=null,j=null,_=null,T=g.status,I=g.statusText;if(g.ok){if(this.method!=="HEAD"){const F=await g.text();F===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((v=this.headers.get("Accept"))===null||v===void 0)&&v.includes("application/vnd.pgrst.plan+text"))?j=F:j=JSON.parse(F))}const D=(x=this.headers.get("Prefer"))===null||x===void 0?void 0:x.match(/count=(exact|planned|estimated)/),R=(N=g.headers.get("content-range"))===null||N===void 0?void 0:N.split("/");D&&R&&R.length>1&&(_=parseInt(R[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(j)&&(j.length>1?(b={code:"PGRST116",details:`Results contain ${j.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},j=null,_=null,T=406,I="Not Acceptable"):j.length===1?j=j[0]:j=null)}else{const D=await g.text();try{b=JSON.parse(D),Array.isArray(b)&&g.status===404&&(j=[],b=null,T=200,I="OK")}catch{g.status===404&&D===""?(T=204,I="No Content"):b={message:D}}if(b&&this.isMaybeSingle&&(!((y=b?.details)===null||y===void 0)&&y.includes("0 rows"))&&(b=null,T=200,I="OK"),b&&this.shouldThrowOnError)throw new a.default(b)}return{error:b,data:j,count:_,status:T,statusText:I}});return this.shouldThrowOnError||(p=p.catch(g=>{var v,x,N;return{error:{message:`${(v=g?.name)!==null&&v!==void 0?v:"FetchError"}: ${g?.message}`,details:`${(x=g?.stack)!==null&&x!==void 0?x:""}`,hint:"",code:`${(N=g?.code)!==null&&N!==void 0?N:""}`},data:null,count:null,status:0,statusText:""}})),p.then(d,u)}returns(){return this}overrideTypes(){return this}}return Ar.default=l,Ar}var mm;function eh(){if(mm)return Ir;mm=1;var i=Ir&&Ir.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(Ir,"__esModule",{value:!0});const r=i(Zm());class a extends r.default{select(o){let d=!1;const u=(o??"*").split("").map(h=>/\s/.test(h)&&!d?"":(h==='"'&&(d=!d),h)).join("");return this.url.searchParams.set("select",u),this.headers.append("Prefer","return=representation"),this}order(o,{ascending:d=!0,nullsFirst:u,foreignTable:h,referencedTable:p=h}={}){const g=p?`${p}.order`:"order",v=this.url.searchParams.get(g);return this.url.searchParams.set(g,`${v?`${v},`:""}${o}.${d?"asc":"desc"}${u===void 0?"":u?".nullsfirst":".nullslast"}`),this}limit(o,{foreignTable:d,referencedTable:u=d}={}){const h=typeof u>"u"?"limit":`${u}.limit`;return this.url.searchParams.set(h,`${o}`),this}range(o,d,{foreignTable:u,referencedTable:h=u}={}){const p=typeof h>"u"?"offset":`${h}.offset`,g=typeof h>"u"?"limit":`${h}.limit`;return this.url.searchParams.set(p,`${o}`),this.url.searchParams.set(g,`${d-o+1}`),this}abortSignal(o){return this.signal=o,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:o=!1,verbose:d=!1,settings:u=!1,buffers:h=!1,wal:p=!1,format:g="text"}={}){var v;const x=[o?"analyze":null,d?"verbose":null,u?"settings":null,h?"buffers":null,p?"wal":null].filter(Boolean).join("|"),N=(v=this.headers.get("Accept"))!==null&&v!==void 0?v:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${g}; for="${N}"; options=${x};`),g==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(o){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${o}`),this}}return Ir.default=a,Ir}var hm;function Xo(){if(hm)return Lr;hm=1;var i=Lr&&Lr.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(Lr,"__esModule",{value:!0});const r=i(eh());class a extends r.default{eq(o,d){return this.url.searchParams.append(o,`eq.${d}`),this}neq(o,d){return this.url.searchParams.append(o,`neq.${d}`),this}gt(o,d){return this.url.searchParams.append(o,`gt.${d}`),this}gte(o,d){return this.url.searchParams.append(o,`gte.${d}`),this}lt(o,d){return this.url.searchParams.append(o,`lt.${d}`),this}lte(o,d){return this.url.searchParams.append(o,`lte.${d}`),this}like(o,d){return this.url.searchParams.append(o,`like.${d}`),this}likeAllOf(o,d){return this.url.searchParams.append(o,`like(all).{${d.join(",")}}`),this}likeAnyOf(o,d){return this.url.searchParams.append(o,`like(any).{${d.join(",")}}`),this}ilike(o,d){return this.url.searchParams.append(o,`ilike.${d}`),this}ilikeAllOf(o,d){return this.url.searchParams.append(o,`ilike(all).{${d.join(",")}}`),this}ilikeAnyOf(o,d){return this.url.searchParams.append(o,`ilike(any).{${d.join(",")}}`),this}is(o,d){return this.url.searchParams.append(o,`is.${d}`),this}in(o,d){const u=Array.from(new Set(d)).map(h=>typeof h=="string"&&new RegExp("[,()]").test(h)?`"${h}"`:`${h}`).join(",");return this.url.searchParams.append(o,`in.(${u})`),this}contains(o,d){return typeof d=="string"?this.url.searchParams.append(o,`cs.${d}`):Array.isArray(d)?this.url.searchParams.append(o,`cs.{${d.join(",")}}`):this.url.searchParams.append(o,`cs.${JSON.stringify(d)}`),this}containedBy(o,d){return typeof d=="string"?this.url.searchParams.append(o,`cd.${d}`):Array.isArray(d)?this.url.searchParams.append(o,`cd.{${d.join(",")}}`):this.url.searchParams.append(o,`cd.${JSON.stringify(d)}`),this}rangeGt(o,d){return this.url.searchParams.append(o,`sr.${d}`),this}rangeGte(o,d){return this.url.searchParams.append(o,`nxl.${d}`),this}rangeLt(o,d){return this.url.searchParams.append(o,`sl.${d}`),this}rangeLte(o,d){return this.url.searchParams.append(o,`nxr.${d}`),this}rangeAdjacent(o,d){return this.url.searchParams.append(o,`adj.${d}`),this}overlaps(o,d){return typeof d=="string"?this.url.searchParams.append(o,`ov.${d}`):this.url.searchParams.append(o,`ov.{${d.join(",")}}`),this}textSearch(o,d,{config:u,type:h}={}){let p="";h==="plain"?p="pl":h==="phrase"?p="ph":h==="websearch"&&(p="w");const g=u===void 0?"":`(${u})`;return this.url.searchParams.append(o,`${p}fts${g}.${d}`),this}match(o){return Object.entries(o).forEach(([d,u])=>{this.url.searchParams.append(d,`eq.${u}`)}),this}not(o,d,u){return this.url.searchParams.append(o,`not.${d}.${u}`),this}or(o,{foreignTable:d,referencedTable:u=d}={}){const h=u?`${u}.or`:"or";return this.url.searchParams.append(h,`(${o})`),this}filter(o,d,u){return this.url.searchParams.append(o,`${d}.${u}`),this}}return Lr.default=a,Lr}var fm;function th(){if(fm)return Rr;fm=1;var i=Rr&&Rr.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(Rr,"__esModule",{value:!0});const r=i(Xo());class a{constructor(o,{headers:d={},schema:u,fetch:h}){this.url=o,this.headers=new Headers(d),this.schema=u,this.fetch=h}select(o,{head:d=!1,count:u}={}){const h=d?"HEAD":"GET";let p=!1;const g=(o??"*").split("").map(v=>/\s/.test(v)&&!p?"":(v==='"'&&(p=!p),v)).join("");return this.url.searchParams.set("select",g),u&&this.headers.append("Prefer",`count=${u}`),new r.default({method:h,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(o,{count:d,defaultToNull:u=!0}={}){var h;const p="POST";if(d&&this.headers.append("Prefer",`count=${d}`),u||this.headers.append("Prefer","missing=default"),Array.isArray(o)){const g=o.reduce((v,x)=>v.concat(Object.keys(x)),[]);if(g.length>0){const v=[...new Set(g)].map(x=>`"${x}"`);this.url.searchParams.set("columns",v.join(","))}}return new r.default({method:p,url:this.url,headers:this.headers,schema:this.schema,body:o,fetch:(h=this.fetch)!==null&&h!==void 0?h:fetch})}upsert(o,{onConflict:d,ignoreDuplicates:u=!1,count:h,defaultToNull:p=!0}={}){var g;const v="POST";if(this.headers.append("Prefer",`resolution=${u?"ignore":"merge"}-duplicates`),d!==void 0&&this.url.searchParams.set("on_conflict",d),h&&this.headers.append("Prefer",`count=${h}`),p||this.headers.append("Prefer","missing=default"),Array.isArray(o)){const x=o.reduce((N,y)=>N.concat(Object.keys(y)),[]);if(x.length>0){const N=[...new Set(x)].map(y=>`"${y}"`);this.url.searchParams.set("columns",N.join(","))}}return new r.default({method:v,url:this.url,headers:this.headers,schema:this.schema,body:o,fetch:(g=this.fetch)!==null&&g!==void 0?g:fetch})}update(o,{count:d}={}){var u;const h="PATCH";return d&&this.headers.append("Prefer",`count=${d}`),new r.default({method:h,url:this.url,headers:this.headers,schema:this.schema,body:o,fetch:(u=this.fetch)!==null&&u!==void 0?u:fetch})}delete({count:o}={}){var d;const u="DELETE";return o&&this.headers.append("Prefer",`count=${o}`),new r.default({method:u,url:this.url,headers:this.headers,schema:this.schema,fetch:(d=this.fetch)!==null&&d!==void 0?d:fetch})}}return Rr.default=a,Rr}var xm;function V0(){if(xm)return Or;xm=1;var i=Or&&Or.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(Or,"__esModule",{value:!0});const r=i(th()),a=i(Xo());class l{constructor(d,{headers:u={},schema:h,fetch:p}={}){this.url=d,this.headers=new Headers(u),this.schemaName=h,this.fetch=p}from(d){const u=new URL(`${this.url}/${d}`);return new r.default(u,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(d){return new l(this.url,{headers:this.headers,schema:d,fetch:this.fetch})}rpc(d,u={},{head:h=!1,get:p=!1,count:g}={}){var v;let x;const N=new URL(`${this.url}/rpc/${d}`);let y;h||p?(x=h?"HEAD":"GET",Object.entries(u).filter(([j,_])=>_!==void 0).map(([j,_])=>[j,Array.isArray(_)?`{${_.join(",")}}`:`${_}`]).forEach(([j,_])=>{N.searchParams.append(j,_)})):(x="POST",y=u);const b=new Headers(this.headers);return g&&b.set("Prefer",`count=${g}`),new a.default({method:x,url:N,headers:b,schema:this.schemaName,body:y,fetch:(v=this.fetch)!==null&&v!==void 0?v:fetch})}}return Or.default=l,Or}var pm;function Q0(){if(pm)return Ze;pm=1;var i=Ze&&Ze.__importDefault||function(h){return h&&h.__esModule?h:{default:h}};Object.defineProperty(Ze,"__esModule",{value:!0}),Ze.PostgrestError=Ze.PostgrestBuilder=Ze.PostgrestTransformBuilder=Ze.PostgrestFilterBuilder=Ze.PostgrestQueryBuilder=Ze.PostgrestClient=void 0;const r=i(V0());Ze.PostgrestClient=r.default;const a=i(th());Ze.PostgrestQueryBuilder=a.default;const l=i(Xo());Ze.PostgrestFilterBuilder=l.default;const o=i(eh());Ze.PostgrestTransformBuilder=o.default;const d=i(Zm());Ze.PostgrestBuilder=d.default;const u=i(Xm());return Ze.PostgrestError=u.default,Ze.default={PostgrestClient:r.default,PostgrestQueryBuilder:a.default,PostgrestFilterBuilder:l.default,PostgrestTransformBuilder:o.default,PostgrestBuilder:d.default,PostgrestError:u.default},Ze}var G0=Q0();const K0=_0(G0),{PostgrestClient:Y0,PostgrestQueryBuilder:Hb,PostgrestFilterBuilder:Vb,PostgrestTransformBuilder:Qb,PostgrestBuilder:Gb,PostgrestError:Kb}=K0;class J0{static detectEnvironment(){var r;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((r=navigator.userAgent)===null||r===void 0)&&r.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const a=process.versions;if(a&&a.node){const l=a.node,o=parseInt(l.replace(/^v/,"").split(".")[0]);return o>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${o} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${o} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const r=this.detectEnvironment();if(r.constructor)return r.constructor;let a=r.error||"WebSocket not supported in this environment.";throw r.workaround&&(a+=`

Suggested solution: ${r.workaround}`),new Error(a)}static createWebSocket(r,a){const l=this.getWebSocketConstructor();return new l(r,a)}static isWebSocketSupported(){try{const r=this.detectEnvironment();return r.type==="native"||r.type==="ws"}catch{return!1}}}const X0="2.15.5",Z0=`realtime-js/${X0}`,ex="1.0.0",Ao=1e4,tx=1e3,sx=100;var qn;(function(i){i[i.connecting=0]="connecting",i[i.open=1]="open",i[i.closing=2]="closing",i[i.closed=3]="closed"})(qn||(qn={}));var Ge;(function(i){i.closed="closed",i.errored="errored",i.joined="joined",i.joining="joining",i.leaving="leaving"})(Ge||(Ge={}));var Vt;(function(i){i.close="phx_close",i.error="phx_error",i.join="phx_join",i.reply="phx_reply",i.leave="phx_leave",i.access_token="access_token"})(Vt||(Vt={}));var Mo;(function(i){i.websocket="websocket"})(Mo||(Mo={}));var rr;(function(i){i.Connecting="connecting",i.Open="open",i.Closing="closing",i.Closed="closed"})(rr||(rr={}));class rx{constructor(){this.HEADER_LENGTH=1}decode(r,a){return r.constructor===ArrayBuffer?a(this._binaryDecode(r)):a(typeof r=="string"?JSON.parse(r):{})}_binaryDecode(r){const a=new DataView(r),l=new TextDecoder;return this._decodeBroadcast(r,a,l)}_decodeBroadcast(r,a,l){const o=a.getUint8(1),d=a.getUint8(2);let u=this.HEADER_LENGTH+2;const h=l.decode(r.slice(u,u+o));u=u+o;const p=l.decode(r.slice(u,u+d));u=u+d;const g=JSON.parse(l.decode(r.slice(u,r.byteLength)));return{ref:null,topic:h,event:p,payload:g}}}class sh{constructor(r,a){this.callback=r,this.timerCalc=a,this.timer=void 0,this.tries=0,this.callback=r,this.timerCalc=a}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Ce;(function(i){i.abstime="abstime",i.bool="bool",i.date="date",i.daterange="daterange",i.float4="float4",i.float8="float8",i.int2="int2",i.int4="int4",i.int4range="int4range",i.int8="int8",i.int8range="int8range",i.json="json",i.jsonb="jsonb",i.money="money",i.numeric="numeric",i.oid="oid",i.reltime="reltime",i.text="text",i.time="time",i.timestamp="timestamp",i.timestamptz="timestamptz",i.timetz="timetz",i.tsrange="tsrange",i.tstzrange="tstzrange"})(Ce||(Ce={}));const gm=(i,r,a={})=>{var l;const o=(l=a.skipTypes)!==null&&l!==void 0?l:[];return Object.keys(r).reduce((d,u)=>(d[u]=nx(u,i,r,o),d),{})},nx=(i,r,a,l)=>{const o=r.find(h=>h.name===i),d=o?.type,u=a[i];return d&&!l.includes(d)?rh(d,u):Fo(u)},rh=(i,r)=>{if(i.charAt(0)==="_"){const a=i.slice(1,i.length);return ox(r,a)}switch(i){case Ce.bool:return ax(r);case Ce.float4:case Ce.float8:case Ce.int2:case Ce.int4:case Ce.int8:case Ce.numeric:case Ce.oid:return lx(r);case Ce.json:case Ce.jsonb:return ix(r);case Ce.timestamp:return cx(r);case Ce.abstime:case Ce.date:case Ce.daterange:case Ce.int4range:case Ce.int8range:case Ce.money:case Ce.reltime:case Ce.text:case Ce.time:case Ce.timestamptz:case Ce.timetz:case Ce.tsrange:case Ce.tstzrange:return Fo(r);default:return Fo(r)}},Fo=i=>i,ax=i=>{switch(i){case"t":return!0;case"f":return!1;default:return i}},lx=i=>{if(typeof i=="string"){const r=parseFloat(i);if(!Number.isNaN(r))return r}return i},ix=i=>{if(typeof i=="string")try{return JSON.parse(i)}catch(r){return console.log(`JSON parse error: ${r}`),i}return i},ox=(i,r)=>{if(typeof i!="string")return i;const a=i.length-1,l=i[a];if(i[0]==="{"&&l==="}"){let d;const u=i.slice(1,a);try{d=JSON.parse("["+u+"]")}catch{d=u?u.split(","):[]}return d.map(h=>rh(r,h))}return i},cx=i=>typeof i=="string"?i.replace(" ","T"):i,nh=i=>{let r=i;return r=r.replace(/^ws/i,"http"),r=r.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),r.replace(/\/+$/,"")+"/api/broadcast"};class ko{constructor(r,a,l={},o=Ao){this.channel=r,this.event=a,this.payload=l,this.timeout=o,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(r){this.timeout=r,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(r){this.payload=Object.assign(Object.assign({},this.payload),r)}receive(r,a){var l;return this._hasReceived(r)&&a((l=this.receivedResp)===null||l===void 0?void 0:l.response),this.recHooks.push({status:r,callback:a}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const r=a=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=a,this._matchReceive(a)};this.channel._on(this.refEvent,{},r),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(r,a){this.refEvent&&this.channel._trigger(this.refEvent,{status:r,response:a})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:r,response:a}){this.recHooks.filter(l=>l.status===r).forEach(l=>l.callback(a))}_hasReceived(r){return this.receivedResp&&this.receivedResp.status===r}}var vm;(function(i){i.SYNC="sync",i.JOIN="join",i.LEAVE="leave"})(vm||(vm={}));class Un{constructor(r,a){this.channel=r,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const l=a?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(l.state,{},o=>{const{onJoin:d,onLeave:u,onSync:h}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Un.syncState(this.state,o,d,u),this.pendingDiffs.forEach(p=>{this.state=Un.syncDiff(this.state,p,d,u)}),this.pendingDiffs=[],h()}),this.channel._on(l.diff,{},o=>{const{onJoin:d,onLeave:u,onSync:h}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(o):(this.state=Un.syncDiff(this.state,o,d,u),h())}),this.onJoin((o,d,u)=>{this.channel._trigger("presence",{event:"join",key:o,currentPresences:d,newPresences:u})}),this.onLeave((o,d,u)=>{this.channel._trigger("presence",{event:"leave",key:o,currentPresences:d,leftPresences:u})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(r,a,l,o){const d=this.cloneDeep(r),u=this.transformState(a),h={},p={};return this.map(d,(g,v)=>{u[g]||(p[g]=v)}),this.map(u,(g,v)=>{const x=d[g];if(x){const N=v.map(_=>_.presence_ref),y=x.map(_=>_.presence_ref),b=v.filter(_=>y.indexOf(_.presence_ref)<0),j=x.filter(_=>N.indexOf(_.presence_ref)<0);b.length>0&&(h[g]=b),j.length>0&&(p[g]=j)}else h[g]=v}),this.syncDiff(d,{joins:h,leaves:p},l,o)}static syncDiff(r,a,l,o){const{joins:d,leaves:u}={joins:this.transformState(a.joins),leaves:this.transformState(a.leaves)};return l||(l=()=>{}),o||(o=()=>{}),this.map(d,(h,p)=>{var g;const v=(g=r[h])!==null&&g!==void 0?g:[];if(r[h]=this.cloneDeep(p),v.length>0){const x=r[h].map(y=>y.presence_ref),N=v.filter(y=>x.indexOf(y.presence_ref)<0);r[h].unshift(...N)}l(h,v,p)}),this.map(u,(h,p)=>{let g=r[h];if(!g)return;const v=p.map(x=>x.presence_ref);g=g.filter(x=>v.indexOf(x.presence_ref)<0),r[h]=g,o(h,g,p),g.length===0&&delete r[h]}),r}static map(r,a){return Object.getOwnPropertyNames(r).map(l=>a(l,r[l]))}static transformState(r){return r=this.cloneDeep(r),Object.getOwnPropertyNames(r).reduce((a,l)=>{const o=r[l];return"metas"in o?a[l]=o.metas.map(d=>(d.presence_ref=d.phx_ref,delete d.phx_ref,delete d.phx_ref_prev,d)):a[l]=o,a},{})}static cloneDeep(r){return JSON.parse(JSON.stringify(r))}onJoin(r){this.caller.onJoin=r}onLeave(r){this.caller.onLeave=r}onSync(r){this.caller.onSync=r}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var bm;(function(i){i.ALL="*",i.INSERT="INSERT",i.UPDATE="UPDATE",i.DELETE="DELETE"})(bm||(bm={}));var Bn;(function(i){i.BROADCAST="broadcast",i.PRESENCE="presence",i.POSTGRES_CHANGES="postgres_changes",i.SYSTEM="system"})(Bn||(Bn={}));var hs;(function(i){i.SUBSCRIBED="SUBSCRIBED",i.TIMED_OUT="TIMED_OUT",i.CLOSED="CLOSED",i.CHANNEL_ERROR="CHANNEL_ERROR"})(hs||(hs={}));class Zo{constructor(r,a={config:{}},l){this.topic=r,this.params=a,this.socket=l,this.bindings={},this.state=Ge.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=r.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},a.config),this.timeout=this.socket.timeout,this.joinPush=new ko(this,Vt.join,this.params,this.timeout),this.rejoinTimer=new sh(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Ge.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(o=>o.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Ge.closed,this.socket._remove(this)}),this._onError(o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=Ge.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Ge.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=Ge.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Vt.reply,{},(o,d)=>{this._trigger(this._replyEventName(d),o)}),this.presence=new Un(this),this.broadcastEndpointURL=nh(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(r,a=this.timeout){var l,o,d;if(this.socket.isConnected()||this.socket.connect(),this.state==Ge.closed){const{config:{broadcast:u,presence:h,private:p}}=this.params,g=(o=(l=this.bindings.postgres_changes)===null||l===void 0?void 0:l.map(y=>y.filter))!==null&&o!==void 0?o:[],v=!!this.bindings[Bn.PRESENCE]&&this.bindings[Bn.PRESENCE].length>0||((d=this.params.config.presence)===null||d===void 0?void 0:d.enabled)===!0,x={},N={broadcast:u,presence:Object.assign(Object.assign({},h),{enabled:v}),postgres_changes:g,private:p};this.socket.accessTokenValue&&(x.access_token=this.socket.accessTokenValue),this._onError(y=>r?.(hs.CHANNEL_ERROR,y)),this._onClose(()=>r?.(hs.CLOSED)),this.updateJoinPayload(Object.assign({config:N},x)),this.joinedOnce=!0,this._rejoin(a),this.joinPush.receive("ok",async({postgres_changes:y})=>{var b;if(this.socket.setAuth(),y===void 0){r?.(hs.SUBSCRIBED);return}else{const j=this.bindings.postgres_changes,_=(b=j?.length)!==null&&b!==void 0?b:0,T=[];for(let I=0;I<_;I++){const C=j[I],{filter:{event:D,schema:R,table:F,filter:H}}=C,ae=y&&y[I];if(ae&&ae.event===D&&ae.schema===R&&ae.table===F&&ae.filter===H)T.push(Object.assign(Object.assign({},C),{id:ae.id}));else{this.unsubscribe(),this.state=Ge.errored,r?.(hs.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=T,r&&r(hs.SUBSCRIBED);return}}).receive("error",y=>{this.state=Ge.errored,r?.(hs.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(y).join(", ")||"error")))}).receive("timeout",()=>{r?.(hs.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(r,a={}){return await this.send({type:"presence",event:"track",payload:r},a.timeout||this.timeout)}async untrack(r={}){return await this.send({type:"presence",event:"untrack"},r)}on(r,a,l){return this.state===Ge.joined&&r===Bn.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(r,a,l)}async send(r,a={}){var l,o;if(!this._canPush()&&r.type==="broadcast"){const{event:d,payload:u}=r,p={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:d,payload:u,private:this.private}]})};try{const g=await this._fetchWithTimeout(this.broadcastEndpointURL,p,(l=a.timeout)!==null&&l!==void 0?l:this.timeout);return await((o=g.body)===null||o===void 0?void 0:o.cancel()),g.ok?"ok":"error"}catch(g){return g.name==="AbortError"?"timed out":"error"}}else return new Promise(d=>{var u,h,p;const g=this._push(r.type,r,a.timeout||this.timeout);r.type==="broadcast"&&!(!((p=(h=(u=this.params)===null||u===void 0?void 0:u.config)===null||h===void 0?void 0:h.broadcast)===null||p===void 0)&&p.ack)&&d("ok"),g.receive("ok",()=>d("ok")),g.receive("error",()=>d("error")),g.receive("timeout",()=>d("timed out"))})}updateJoinPayload(r){this.joinPush.updatePayload(r)}unsubscribe(r=this.timeout){this.state=Ge.leaving;const a=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Vt.close,"leave",this._joinRef())};this.joinPush.destroy();let l=null;return new Promise(o=>{l=new ko(this,Vt.leave,{},r),l.receive("ok",()=>{a(),o("ok")}).receive("timeout",()=>{a(),o("timed out")}).receive("error",()=>{o("error")}),l.send(),this._canPush()||l.trigger("ok",{})}).finally(()=>{l?.destroy()})}teardown(){this.pushBuffer.forEach(r=>r.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Ge.closed,this.bindings={}}async _fetchWithTimeout(r,a,l){const o=new AbortController,d=setTimeout(()=>o.abort(),l),u=await this.socket.fetch(r,Object.assign(Object.assign({},a),{signal:o.signal}));return clearTimeout(d),u}_push(r,a,l=this.timeout){if(!this.joinedOnce)throw`tried to push '${r}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let o=new ko(this,r,a,l);return this._canPush()?o.send():this._addToPushBuffer(o),o}_addToPushBuffer(r){if(r.startTimeout(),this.pushBuffer.push(r),this.pushBuffer.length>sx){const a=this.pushBuffer.shift();a&&(a.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${a.event}`,a.payload))}}_onMessage(r,a,l){return a}_isMember(r){return this.topic===r}_joinRef(){return this.joinPush.ref}_trigger(r,a,l){var o,d;const u=r.toLocaleLowerCase(),{close:h,error:p,leave:g,join:v}=Vt;if(l&&[h,p,g,v].indexOf(u)>=0&&l!==this._joinRef())return;let N=this._onMessage(u,a,l);if(a&&!N)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(u)?(o=this.bindings.postgres_changes)===null||o===void 0||o.filter(y=>{var b,j,_;return((b=y.filter)===null||b===void 0?void 0:b.event)==="*"||((_=(j=y.filter)===null||j===void 0?void 0:j.event)===null||_===void 0?void 0:_.toLocaleLowerCase())===u}).map(y=>y.callback(N,l)):(d=this.bindings[u])===null||d===void 0||d.filter(y=>{var b,j,_,T,I,C;if(["broadcast","presence","postgres_changes"].includes(u))if("id"in y){const D=y.id,R=(b=y.filter)===null||b===void 0?void 0:b.event;return D&&((j=a.ids)===null||j===void 0?void 0:j.includes(D))&&(R==="*"||R?.toLocaleLowerCase()===((_=a.data)===null||_===void 0?void 0:_.type.toLocaleLowerCase()))}else{const D=(I=(T=y?.filter)===null||T===void 0?void 0:T.event)===null||I===void 0?void 0:I.toLocaleLowerCase();return D==="*"||D===((C=a?.event)===null||C===void 0?void 0:C.toLocaleLowerCase())}else return y.type.toLocaleLowerCase()===u}).map(y=>{if(typeof N=="object"&&"ids"in N){const b=N.data,{schema:j,table:_,commit_timestamp:T,type:I,errors:C}=b;N=Object.assign(Object.assign({},{schema:j,table:_,commit_timestamp:T,eventType:I,new:{},old:{},errors:C}),this._getPayloadRecords(b))}y.callback(N,l)})}_isClosed(){return this.state===Ge.closed}_isJoined(){return this.state===Ge.joined}_isJoining(){return this.state===Ge.joining}_isLeaving(){return this.state===Ge.leaving}_replyEventName(r){return`chan_reply_${r}`}_on(r,a,l){const o=r.toLocaleLowerCase(),d={type:o,filter:a,callback:l};return this.bindings[o]?this.bindings[o].push(d):this.bindings[o]=[d],this}_off(r,a){const l=r.toLocaleLowerCase();return this.bindings[l]&&(this.bindings[l]=this.bindings[l].filter(o=>{var d;return!(((d=o.type)===null||d===void 0?void 0:d.toLocaleLowerCase())===l&&Zo.isEqual(o.filter,a))})),this}static isEqual(r,a){if(Object.keys(r).length!==Object.keys(a).length)return!1;for(const l in r)if(r[l]!==a[l])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(r){this._on(Vt.close,{},r)}_onError(r){this._on(Vt.error,{},a=>r(a))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(r=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Ge.joining,this.joinPush.resend(r))}_getPayloadRecords(r){const a={new:{},old:{}};return(r.type==="INSERT"||r.type==="UPDATE")&&(a.new=gm(r.columns,r.record)),(r.type==="UPDATE"||r.type==="DELETE")&&(a.old=gm(r.columns,r.old_record)),a}}const So=()=>{},cl={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},dx=[1e3,2e3,5e3,1e4],ux=1e4,mx=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class hx{constructor(r,a){var l;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Ao,this.transport=null,this.heartbeatIntervalMs=cl.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=So,this.ref=0,this.reconnectTimer=null,this.logger=So,this.conn=null,this.sendBuffer=[],this.serializer=new rx,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=o=>{let d;return o?d=o:typeof fetch>"u"?d=(...u)=>Gn(async()=>{const{default:h}=await Promise.resolve().then(()=>Kr);return{default:h}},void 0).then(({default:h})=>h(...u)).catch(h=>{throw new Error(`Failed to load @supabase/node-fetch: ${h.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):d=fetch,(...u)=>d(...u)},!(!((l=a?.params)===null||l===void 0)&&l.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=a.params.apikey,this.endPoint=`${r}/${Mo.websocket}`,this.httpEndpoint=nh(r),this._initializeOptions(a),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(a?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=J0.createWebSocket(this.endpointURL())}catch(r){this._setConnectionState("disconnected");const a=r.message;throw a.includes("Node.js")?new Error(`${a}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${a}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:ex}))}disconnect(r,a){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const l=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(l),this._setConnectionState("disconnected")},r?this.conn.close(r,a??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(r){const a=await r.unsubscribe();return this.channels.length===0&&this.disconnect(),a}async removeAllChannels(){const r=await Promise.all(this.channels.map(a=>a.unsubscribe()));return this.channels=[],this.disconnect(),r}log(r,a,l){this.logger(r,a,l)}connectionState(){switch(this.conn&&this.conn.readyState){case qn.connecting:return rr.Connecting;case qn.open:return rr.Open;case qn.closing:return rr.Closing;default:return rr.Closed}}isConnected(){return this.connectionState()===rr.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(r,a={config:{}}){const l=`realtime:${r}`,o=this.getChannels().find(d=>d.topic===l);if(o)return o;{const d=new Zo(`realtime:${r}`,a,this);return this.channels.push(d),d}}push(r){const{topic:a,event:l,payload:o,ref:d}=r,u=()=>{this.encode(r,h=>{var p;(p=this.conn)===null||p===void 0||p.send(h)})};this.log("push",`${a} ${l} (${d})`,o),this.isConnected()?u():this.sendBuffer.push(u)}async setAuth(r=null){this._authPromise=this._performAuth(r);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var r;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(a){this.log("error","error in heartbeat callback",a)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(a){this.log("error","error in heartbeat callback",a)}this._wasManualDisconnect=!1,(r=this.conn)===null||r===void 0||r.close(tx,"heartbeat timeout"),setTimeout(()=>{var a;this.isConnected()||(a=this.reconnectTimer)===null||a===void 0||a.scheduleTimeout()},cl.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(a){this.log("error","error in heartbeat callback",a)}this._setAuthSafely("heartbeat")}onHeartbeat(r){this.heartbeatCallback=r}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(r=>r()),this.sendBuffer=[])}_makeRef(){let r=this.ref+1;return r===this.ref?this.ref=0:this.ref=r,this.ref.toString()}_leaveOpenTopic(r){let a=this.channels.find(l=>l.topic===r&&(l._isJoined()||l._isJoining()));a&&(this.log("transport",`leaving duplicate topic "${r}"`),a.unsubscribe())}_remove(r){this.channels=this.channels.filter(a=>a.topic!==r.topic)}_onConnMessage(r){this.decode(r.data,a=>{if(a.topic==="phoenix"&&a.event==="phx_reply")try{this.heartbeatCallback(a.payload.status==="ok"?"ok":"error")}catch(g){this.log("error","error in heartbeat callback",g)}a.ref&&a.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:l,event:o,payload:d,ref:u}=a,h=u?`(${u})`:"",p=d.status||"";this.log("receive",`${p} ${l} ${o} ${h}`.trim(),d),this.channels.filter(g=>g._isMember(l)).forEach(g=>g._trigger(o,d,u)),this._triggerStateCallbacks("message",a)})}_clearTimer(r){var a;r==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):r==="reconnect"&&((a=this.reconnectTimer)===null||a===void 0||a.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=r=>this._onConnError(r),this.conn.onmessage=r=>this._onConnMessage(r),this.conn.onclose=r=>this._onConnClose(r))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(r=>r.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const r=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(r),this.workerRef.onerror=a=>{this.log("worker","worker error",a.message),this.workerRef.terminate()},this.workerRef.onmessage=a=>{a.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(r){var a;this._setConnectionState("disconnected"),this.log("transport","close",r),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(a=this.reconnectTimer)===null||a===void 0||a.scheduleTimeout(),this._triggerStateCallbacks("close",r)}_onConnError(r){this._setConnectionState("disconnected"),this.log("transport",`${r}`),this._triggerChanError(),this._triggerStateCallbacks("error",r)}_triggerChanError(){this.channels.forEach(r=>r._trigger(Vt.error))}_appendParams(r,a){if(Object.keys(a).length===0)return r;const l=r.match(/\?/)?"&":"?",o=new URLSearchParams(a);return`${r}${l}${o}`}_workerObjectUrl(r){let a;if(r)a=r;else{const l=new Blob([mx],{type:"application/javascript"});a=URL.createObjectURL(l)}return a}_setConnectionState(r,a=!1){this._connectionState=r,r==="connecting"?this._wasManualDisconnect=!1:r==="disconnecting"&&(this._wasManualDisconnect=a)}async _performAuth(r=null){let a;r?a=r:this.accessToken?a=await this.accessToken():a=this.accessTokenValue,this.accessTokenValue!=a&&(this.accessTokenValue=a,this.channels.forEach(l=>{const o={access_token:a,version:Z0};a&&l.updateJoinPayload(o),l.joinedOnce&&l._isJoined()&&l._push(Vt.access_token,{access_token:a})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(r="general"){this.setAuth().catch(a=>{this.log("error",`error setting auth in ${r}`,a)})}_triggerStateCallbacks(r,a){try{this.stateChangeCallbacks[r].forEach(l=>{try{l(a)}catch(o){this.log("error",`error in ${r} callback`,o)}})}catch(l){this.log("error",`error triggering ${r} callbacks`,l)}}_setupReconnectionTimer(){this.reconnectTimer=new sh(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},cl.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(r){var a,l,o,d,u,h,p,g,v;if(this.transport=(a=r?.transport)!==null&&a!==void 0?a:null,this.timeout=(l=r?.timeout)!==null&&l!==void 0?l:Ao,this.heartbeatIntervalMs=(o=r?.heartbeatIntervalMs)!==null&&o!==void 0?o:cl.HEARTBEAT_INTERVAL,this.worker=(d=r?.worker)!==null&&d!==void 0?d:!1,this.accessToken=(u=r?.accessToken)!==null&&u!==void 0?u:null,this.heartbeatCallback=(h=r?.heartbeatCallback)!==null&&h!==void 0?h:So,r?.params&&(this.params=r.params),r?.logger&&(this.logger=r.logger),(r?.logLevel||r?.log_level)&&(this.logLevel=r.logLevel||r.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(p=r?.reconnectAfterMs)!==null&&p!==void 0?p:(x=>dx[x-1]||ux),this.encode=(g=r?.encode)!==null&&g!==void 0?g:((x,N)=>N(JSON.stringify(x))),this.decode=(v=r?.decode)!==null&&v!==void 0?v:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=r?.workerUrl}}}class ec extends Error{constructor(r){super(r),this.__isStorageError=!0,this.name="StorageError"}}function Ke(i){return typeof i=="object"&&i!==null&&"__isStorageError"in i}class fx extends ec{constructor(r,a,l){super(r),this.name="StorageApiError",this.status=a,this.statusCode=l}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class $o extends ec{constructor(r,a){super(r),this.name="StorageUnknownError",this.originalError=a}}var xx=function(i,r,a,l){function o(d){return d instanceof a?d:new a(function(u){u(d)})}return new(a||(a=Promise))(function(d,u){function h(v){try{g(l.next(v))}catch(x){u(x)}}function p(v){try{g(l.throw(v))}catch(x){u(x)}}function g(v){v.done?d(v.value):o(v.value).then(h,p)}g((l=l.apply(i,r||[])).next())})};const ah=i=>{let r;return i?r=i:typeof fetch>"u"?r=(...a)=>Gn(async()=>{const{default:l}=await Promise.resolve().then(()=>Kr);return{default:l}},void 0).then(({default:l})=>l(...a)):r=fetch,(...a)=>r(...a)},px=()=>xx(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Gn(()=>Promise.resolve().then(()=>Kr),void 0)).Response:Response}),qo=i=>{if(Array.isArray(i))return i.map(a=>qo(a));if(typeof i=="function"||i!==Object(i))return i;const r={};return Object.entries(i).forEach(([a,l])=>{const o=a.replace(/([-_][a-z])/gi,d=>d.toUpperCase().replace(/[-_]/g,""));r[o]=qo(l)}),r},gx=i=>{if(typeof i!="object"||i===null)return!1;const r=Object.getPrototypeOf(i);return(r===null||r===Object.prototype||Object.getPrototypeOf(r)===null)&&!(Symbol.toStringTag in i)&&!(Symbol.iterator in i)};var lr=function(i,r,a,l){function o(d){return d instanceof a?d:new a(function(u){u(d)})}return new(a||(a=Promise))(function(d,u){function h(v){try{g(l.next(v))}catch(x){u(x)}}function p(v){try{g(l.throw(v))}catch(x){u(x)}}function g(v){v.done?d(v.value):o(v.value).then(h,p)}g((l=l.apply(i,r||[])).next())})};const Co=i=>i.msg||i.message||i.error_description||i.error||JSON.stringify(i),vx=(i,r,a)=>lr(void 0,void 0,void 0,function*(){const l=yield px();i instanceof l&&!a?.noResolveJson?i.json().then(o=>{const d=i.status||500,u=o?.statusCode||d+"";r(new fx(Co(o),d,u))}).catch(o=>{r(new $o(Co(o),o))}):r(new $o(Co(i),i))}),bx=(i,r,a,l)=>{const o={method:i,headers:r?.headers||{}};return i==="GET"||!l?o:(gx(l)?(o.headers=Object.assign({"Content-Type":"application/json"},r?.headers),o.body=JSON.stringify(l)):o.body=l,r?.duplex&&(o.duplex=r.duplex),Object.assign(Object.assign({},o),a))};function Kn(i,r,a,l,o,d){return lr(this,void 0,void 0,function*(){return new Promise((u,h)=>{i(a,bx(r,l,o,d)).then(p=>{if(!p.ok)throw p;return l?.noResolveJson?p:p.json()}).then(p=>u(p)).catch(p=>vx(p,h,l))})})}function fl(i,r,a,l){return lr(this,void 0,void 0,function*(){return Kn(i,"GET",r,a,l)})}function ts(i,r,a,l,o){return lr(this,void 0,void 0,function*(){return Kn(i,"POST",r,l,o,a)})}function Uo(i,r,a,l,o){return lr(this,void 0,void 0,function*(){return Kn(i,"PUT",r,l,o,a)})}function yx(i,r,a,l){return lr(this,void 0,void 0,function*(){return Kn(i,"HEAD",r,Object.assign(Object.assign({},a),{noResolveJson:!0}),l)})}function lh(i,r,a,l,o){return lr(this,void 0,void 0,function*(){return Kn(i,"DELETE",r,l,o,a)})}var ht=function(i,r,a,l){function o(d){return d instanceof a?d:new a(function(u){u(d)})}return new(a||(a=Promise))(function(d,u){function h(v){try{g(l.next(v))}catch(x){u(x)}}function p(v){try{g(l.throw(v))}catch(x){u(x)}}function g(v){v.done?d(v.value):o(v.value).then(h,p)}g((l=l.apply(i,r||[])).next())})};const jx={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},ym={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class wx{constructor(r,a={},l,o){this.shouldThrowOnError=!1,this.url=r,this.headers=a,this.bucketId=l,this.fetch=ah(o)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(r,a,l,o){return ht(this,void 0,void 0,function*(){try{let d;const u=Object.assign(Object.assign({},ym),o);let h=Object.assign(Object.assign({},this.headers),r==="POST"&&{"x-upsert":String(u.upsert)});const p=u.metadata;typeof Blob<"u"&&l instanceof Blob?(d=new FormData,d.append("cacheControl",u.cacheControl),p&&d.append("metadata",this.encodeMetadata(p)),d.append("",l)):typeof FormData<"u"&&l instanceof FormData?(d=l,d.append("cacheControl",u.cacheControl),p&&d.append("metadata",this.encodeMetadata(p))):(d=l,h["cache-control"]=`max-age=${u.cacheControl}`,h["content-type"]=u.contentType,p&&(h["x-metadata"]=this.toBase64(this.encodeMetadata(p)))),o?.headers&&(h=Object.assign(Object.assign({},h),o.headers));const g=this._removeEmptyFolders(a),v=this._getFinalPath(g),x=yield(r=="PUT"?Uo:ts)(this.fetch,`${this.url}/object/${v}`,d,Object.assign({headers:h},u?.duplex?{duplex:u.duplex}:{}));return{data:{path:g,id:x.Id,fullPath:x.Key},error:null}}catch(d){if(this.shouldThrowOnError)throw d;if(Ke(d))return{data:null,error:d};throw d}})}upload(r,a,l){return ht(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",r,a,l)})}uploadToSignedUrl(r,a,l,o){return ht(this,void 0,void 0,function*(){const d=this._removeEmptyFolders(r),u=this._getFinalPath(d),h=new URL(this.url+`/object/upload/sign/${u}`);h.searchParams.set("token",a);try{let p;const g=Object.assign({upsert:ym.upsert},o),v=Object.assign(Object.assign({},this.headers),{"x-upsert":String(g.upsert)});typeof Blob<"u"&&l instanceof Blob?(p=new FormData,p.append("cacheControl",g.cacheControl),p.append("",l)):typeof FormData<"u"&&l instanceof FormData?(p=l,p.append("cacheControl",g.cacheControl)):(p=l,v["cache-control"]=`max-age=${g.cacheControl}`,v["content-type"]=g.contentType);const x=yield Uo(this.fetch,h.toString(),p,{headers:v});return{data:{path:d,fullPath:x.Key},error:null}}catch(p){if(this.shouldThrowOnError)throw p;if(Ke(p))return{data:null,error:p};throw p}})}createSignedUploadUrl(r,a){return ht(this,void 0,void 0,function*(){try{let l=this._getFinalPath(r);const o=Object.assign({},this.headers);a?.upsert&&(o["x-upsert"]="true");const d=yield ts(this.fetch,`${this.url}/object/upload/sign/${l}`,{},{headers:o}),u=new URL(this.url+d.url),h=u.searchParams.get("token");if(!h)throw new ec("No token returned by API");return{data:{signedUrl:u.toString(),path:r,token:h},error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(Ke(l))return{data:null,error:l};throw l}})}update(r,a,l){return ht(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",r,a,l)})}move(r,a,l){return ht(this,void 0,void 0,function*(){try{return{data:yield ts(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:r,destinationKey:a,destinationBucket:l?.destinationBucket},{headers:this.headers}),error:null}}catch(o){if(this.shouldThrowOnError)throw o;if(Ke(o))return{data:null,error:o};throw o}})}copy(r,a,l){return ht(this,void 0,void 0,function*(){try{return{data:{path:(yield ts(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:r,destinationKey:a,destinationBucket:l?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(o){if(this.shouldThrowOnError)throw o;if(Ke(o))return{data:null,error:o};throw o}})}createSignedUrl(r,a,l){return ht(this,void 0,void 0,function*(){try{let o=this._getFinalPath(r),d=yield ts(this.fetch,`${this.url}/object/sign/${o}`,Object.assign({expiresIn:a},l?.transform?{transform:l.transform}:{}),{headers:this.headers});const u=l?.download?`&download=${l.download===!0?"":l.download}`:"";return d={signedUrl:encodeURI(`${this.url}${d.signedURL}${u}`)},{data:d,error:null}}catch(o){if(this.shouldThrowOnError)throw o;if(Ke(o))return{data:null,error:o};throw o}})}createSignedUrls(r,a,l){return ht(this,void 0,void 0,function*(){try{const o=yield ts(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:a,paths:r},{headers:this.headers}),d=l?.download?`&download=${l.download===!0?"":l.download}`:"";return{data:o.map(u=>Object.assign(Object.assign({},u),{signedUrl:u.signedURL?encodeURI(`${this.url}${u.signedURL}${d}`):null})),error:null}}catch(o){if(this.shouldThrowOnError)throw o;if(Ke(o))return{data:null,error:o};throw o}})}download(r,a){return ht(this,void 0,void 0,function*(){const o=typeof a?.transform<"u"?"render/image/authenticated":"object",d=this.transformOptsToQueryString(a?.transform||{}),u=d?`?${d}`:"";try{const h=this._getFinalPath(r);return{data:yield(yield fl(this.fetch,`${this.url}/${o}/${h}${u}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(h){if(this.shouldThrowOnError)throw h;if(Ke(h))return{data:null,error:h};throw h}})}info(r){return ht(this,void 0,void 0,function*(){const a=this._getFinalPath(r);try{const l=yield fl(this.fetch,`${this.url}/object/info/${a}`,{headers:this.headers});return{data:qo(l),error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(Ke(l))return{data:null,error:l};throw l}})}exists(r){return ht(this,void 0,void 0,function*(){const a=this._getFinalPath(r);try{return yield yx(this.fetch,`${this.url}/object/${a}`,{headers:this.headers}),{data:!0,error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(Ke(l)&&l instanceof $o){const o=l.originalError;if([400,404].includes(o?.status))return{data:!1,error:l}}throw l}})}getPublicUrl(r,a){const l=this._getFinalPath(r),o=[],d=a?.download?`download=${a.download===!0?"":a.download}`:"";d!==""&&o.push(d);const h=typeof a?.transform<"u"?"render/image":"object",p=this.transformOptsToQueryString(a?.transform||{});p!==""&&o.push(p);let g=o.join("&");return g!==""&&(g=`?${g}`),{data:{publicUrl:encodeURI(`${this.url}/${h}/public/${l}${g}`)}}}remove(r){return ht(this,void 0,void 0,function*(){try{return{data:yield lh(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:r},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Ke(a))return{data:null,error:a};throw a}})}list(r,a,l){return ht(this,void 0,void 0,function*(){try{const o=Object.assign(Object.assign(Object.assign({},jx),a),{prefix:r||""});return{data:yield ts(this.fetch,`${this.url}/object/list/${this.bucketId}`,o,{headers:this.headers},l),error:null}}catch(o){if(this.shouldThrowOnError)throw o;if(Ke(o))return{data:null,error:o};throw o}})}listV2(r,a){return ht(this,void 0,void 0,function*(){try{const l=Object.assign({},r);return{data:yield ts(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,l,{headers:this.headers},a),error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(Ke(l))return{data:null,error:l};throw l}})}encodeMetadata(r){return JSON.stringify(r)}toBase64(r){return typeof Buffer<"u"?Buffer.from(r).toString("base64"):btoa(r)}_getFinalPath(r){return`${this.bucketId}/${r.replace(/^\/+/,"")}`}_removeEmptyFolders(r){return r.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(r){const a=[];return r.width&&a.push(`width=${r.width}`),r.height&&a.push(`height=${r.height}`),r.resize&&a.push(`resize=${r.resize}`),r.format&&a.push(`format=${r.format}`),r.quality&&a.push(`quality=${r.quality}`),a.join("&")}}const Nx="2.12.1",_x={"X-Client-Info":`storage-js/${Nx}`};var Mr=function(i,r,a,l){function o(d){return d instanceof a?d:new a(function(u){u(d)})}return new(a||(a=Promise))(function(d,u){function h(v){try{g(l.next(v))}catch(x){u(x)}}function p(v){try{g(l.throw(v))}catch(x){u(x)}}function g(v){v.done?d(v.value):o(v.value).then(h,p)}g((l=l.apply(i,r||[])).next())})};class kx{constructor(r,a={},l,o){this.shouldThrowOnError=!1;const d=new URL(r);o?.useNewHostname&&/supabase\.(co|in|red)$/.test(d.hostname)&&!d.hostname.includes("storage.supabase.")&&(d.hostname=d.hostname.replace("supabase.","storage.supabase.")),this.url=d.href,this.headers=Object.assign(Object.assign({},_x),a),this.fetch=ah(l)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(){return Mr(this,void 0,void 0,function*(){try{return{data:yield fl(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ke(r))return{data:null,error:r};throw r}})}getBucket(r){return Mr(this,void 0,void 0,function*(){try{return{data:yield fl(this.fetch,`${this.url}/bucket/${r}`,{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Ke(a))return{data:null,error:a};throw a}})}createBucket(r,a={public:!1}){return Mr(this,void 0,void 0,function*(){try{return{data:yield ts(this.fetch,`${this.url}/bucket`,{id:r,name:r,type:a.type,public:a.public,file_size_limit:a.fileSizeLimit,allowed_mime_types:a.allowedMimeTypes},{headers:this.headers}),error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(Ke(l))return{data:null,error:l};throw l}})}updateBucket(r,a){return Mr(this,void 0,void 0,function*(){try{return{data:yield Uo(this.fetch,`${this.url}/bucket/${r}`,{id:r,name:r,public:a.public,file_size_limit:a.fileSizeLimit,allowed_mime_types:a.allowedMimeTypes},{headers:this.headers}),error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(Ke(l))return{data:null,error:l};throw l}})}emptyBucket(r){return Mr(this,void 0,void 0,function*(){try{return{data:yield ts(this.fetch,`${this.url}/bucket/${r}/empty`,{},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Ke(a))return{data:null,error:a};throw a}})}deleteBucket(r){return Mr(this,void 0,void 0,function*(){try{return{data:yield lh(this.fetch,`${this.url}/bucket/${r}`,{},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Ke(a))return{data:null,error:a};throw a}})}}class Sx extends kx{constructor(r,a={},l,o){super(r,a,l,o)}from(r){return new wx(this.url,this.headers,r,this.fetch)}}const Cx="2.57.4";let $n="";typeof Deno<"u"?$n="deno":typeof document<"u"?$n="web":typeof navigator<"u"&&navigator.product==="ReactNative"?$n="react-native":$n="node";const Tx={"X-Client-Info":`supabase-js-${$n}/${Cx}`},Ex={headers:Tx},Px={schema:"public"},Dx={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Ox={};var Rx=function(i,r,a,l){function o(d){return d instanceof a?d:new a(function(u){u(d)})}return new(a||(a=Promise))(function(d,u){function h(v){try{g(l.next(v))}catch(x){u(x)}}function p(v){try{g(l.throw(v))}catch(x){u(x)}}function g(v){v.done?d(v.value):o(v.value).then(h,p)}g((l=l.apply(i,r||[])).next())})};const Lx=i=>{let r;return i?r=i:typeof fetch>"u"?r=Ym:r=fetch,(...a)=>r(...a)},Ix=()=>typeof Headers>"u"?Jm:Headers,Ax=(i,r,a)=>{const l=Lx(a),o=Ix();return(d,u)=>Rx(void 0,void 0,void 0,function*(){var h;const p=(h=yield r())!==null&&h!==void 0?h:i;let g=new o(u?.headers);return g.has("apikey")||g.set("apikey",i),g.has("Authorization")||g.set("Authorization",`Bearer ${p}`),l(d,Object.assign(Object.assign({},u),{headers:g}))})};var Mx=function(i,r,a,l){function o(d){return d instanceof a?d:new a(function(u){u(d)})}return new(a||(a=Promise))(function(d,u){function h(v){try{g(l.next(v))}catch(x){u(x)}}function p(v){try{g(l.throw(v))}catch(x){u(x)}}function g(v){v.done?d(v.value):o(v.value).then(h,p)}g((l=l.apply(i,r||[])).next())})};function Fx(i){return i.endsWith("/")?i:i+"/"}function $x(i,r){var a,l;const{db:o,auth:d,realtime:u,global:h}=i,{db:p,auth:g,realtime:v,global:x}=r,N={db:Object.assign(Object.assign({},p),o),auth:Object.assign(Object.assign({},g),d),realtime:Object.assign(Object.assign({},v),u),storage:{},global:Object.assign(Object.assign(Object.assign({},x),h),{headers:Object.assign(Object.assign({},(a=x?.headers)!==null&&a!==void 0?a:{}),(l=h?.headers)!==null&&l!==void 0?l:{})}),accessToken:()=>Mx(this,void 0,void 0,function*(){return""})};return i.accessToken?N.accessToken=i.accessToken:delete N.accessToken,N}function qx(i){const r=i?.trim();if(!r)throw new Error("supabaseUrl is required.");if(!r.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(Fx(r))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const ih="2.71.1",zr=30*1e3,Bo=3,To=Bo*zr,Ux="http://localhost:9999",Bx="supabase.auth.token",zx={"X-Client-Info":`gotrue-js/${ih}`},zo="X-Supabase-Api-Version",oh={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},Wx=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,Hx=600*1e3;class tc extends Error{constructor(r,a,l){super(r),this.__isAuthError=!0,this.name="AuthError",this.status=a,this.code=l}}function oe(i){return typeof i=="object"&&i!==null&&"__isAuthError"in i}class Vx extends tc{constructor(r,a,l){super(r,a,l),this.name="AuthApiError",this.status=a,this.code=l}}function Qx(i){return oe(i)&&i.name==="AuthApiError"}class ch extends tc{constructor(r,a){super(r),this.name="AuthUnknownError",this.originalError=a}}class $s extends tc{constructor(r,a,l,o){super(r,l,o),this.name=a,this.status=l}}class As extends $s{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Gx(i){return oe(i)&&i.name==="AuthSessionMissingError"}class dl extends $s{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class ul extends $s{constructor(r){super(r,"AuthInvalidCredentialsError",400,void 0)}}class ml extends $s{constructor(r,a=null){super(r,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=a}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Kx(i){return oe(i)&&i.name==="AuthImplicitGrantRedirectError"}class jm extends $s{constructor(r,a=null){super(r,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=a}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Wo extends $s{constructor(r,a){super(r,"AuthRetryableFetchError",a,void 0)}}function Eo(i){return oe(i)&&i.name==="AuthRetryableFetchError"}class wm extends $s{constructor(r,a,l){super(r,"AuthWeakPasswordError",a,"weak_password"),this.reasons=l}}class Ho extends $s{constructor(r){super(r,"AuthInvalidJwtError",400,"invalid_jwt")}}const xl="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Nm=` 	
\r=`.split(""),Yx=(()=>{const i=new Array(128);for(let r=0;r<i.length;r+=1)i[r]=-1;for(let r=0;r<Nm.length;r+=1)i[Nm[r].charCodeAt(0)]=-2;for(let r=0;r<xl.length;r+=1)i[xl[r].charCodeAt(0)]=r;return i})();function _m(i,r,a){if(i!==null)for(r.queue=r.queue<<8|i,r.queuedBits+=8;r.queuedBits>=6;){const l=r.queue>>r.queuedBits-6&63;a(xl[l]),r.queuedBits-=6}else if(r.queuedBits>0)for(r.queue=r.queue<<6-r.queuedBits,r.queuedBits=6;r.queuedBits>=6;){const l=r.queue>>r.queuedBits-6&63;a(xl[l]),r.queuedBits-=6}}function dh(i,r,a){const l=Yx[i];if(l>-1)for(r.queue=r.queue<<6|l,r.queuedBits+=6;r.queuedBits>=8;)a(r.queue>>r.queuedBits-8&255),r.queuedBits-=8;else{if(l===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(i)}"`)}}function km(i){const r=[],a=u=>{r.push(String.fromCodePoint(u))},l={utf8seq:0,codepoint:0},o={queue:0,queuedBits:0},d=u=>{Zx(u,l,a)};for(let u=0;u<i.length;u+=1)dh(i.charCodeAt(u),o,d);return r.join("")}function Jx(i,r){if(i<=127){r(i);return}else if(i<=2047){r(192|i>>6),r(128|i&63);return}else if(i<=65535){r(224|i>>12),r(128|i>>6&63),r(128|i&63);return}else if(i<=1114111){r(240|i>>18),r(128|i>>12&63),r(128|i>>6&63),r(128|i&63);return}throw new Error(`Unrecognized Unicode codepoint: ${i.toString(16)}`)}function Xx(i,r){for(let a=0;a<i.length;a+=1){let l=i.charCodeAt(a);if(l>55295&&l<=56319){const o=(l-55296)*1024&65535;l=(i.charCodeAt(a+1)-56320&65535|o)+65536,a+=1}Jx(l,r)}}function Zx(i,r,a){if(r.utf8seq===0){if(i<=127){a(i);return}for(let l=1;l<6;l+=1)if((i>>7-l&1)===0){r.utf8seq=l;break}if(r.utf8seq===2)r.codepoint=i&31;else if(r.utf8seq===3)r.codepoint=i&15;else if(r.utf8seq===4)r.codepoint=i&7;else throw new Error("Invalid UTF-8 sequence");r.utf8seq-=1}else if(r.utf8seq>0){if(i<=127)throw new Error("Invalid UTF-8 sequence");r.codepoint=r.codepoint<<6|i&63,r.utf8seq-=1,r.utf8seq===0&&a(r.codepoint)}}function ep(i){const r=[],a={queue:0,queuedBits:0},l=o=>{r.push(o)};for(let o=0;o<i.length;o+=1)dh(i.charCodeAt(o),a,l);return new Uint8Array(r)}function tp(i){const r=[];return Xx(i,a=>r.push(a)),new Uint8Array(r)}function sp(i){const r=[],a={queue:0,queuedBits:0},l=o=>{r.push(o)};return i.forEach(o=>_m(o,a,l)),_m(null,a,l),r.join("")}function rp(i){return Math.round(Date.now()/1e3)+i}function np(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(i){const r=Math.random()*16|0;return(i=="x"?r:r&3|8).toString(16)})}const Ht=()=>typeof window<"u"&&typeof document<"u",Zs={tested:!1,writable:!1},uh=()=>{if(!Ht())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Zs.tested)return Zs.writable;const i=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(i,i),globalThis.localStorage.removeItem(i),Zs.tested=!0,Zs.writable=!0}catch{Zs.tested=!0,Zs.writable=!1}return Zs.writable};function ap(i){const r={},a=new URL(i);if(a.hash&&a.hash[0]==="#")try{new URLSearchParams(a.hash.substring(1)).forEach((o,d)=>{r[d]=o})}catch{}return a.searchParams.forEach((l,o)=>{r[o]=l}),r}const mh=i=>{let r;return i?r=i:typeof fetch>"u"?r=(...a)=>Gn(async()=>{const{default:l}=await Promise.resolve().then(()=>Kr);return{default:l}},void 0).then(({default:l})=>l(...a)):r=fetch,(...a)=>r(...a)},lp=i=>typeof i=="object"&&i!==null&&"status"in i&&"ok"in i&&"json"in i&&typeof i.json=="function",Wr=async(i,r,a)=>{await i.setItem(r,JSON.stringify(a))},er=async(i,r)=>{const a=await i.getItem(r);if(!a)return null;try{return JSON.parse(a)}catch{return a}},Ls=async(i,r)=>{await i.removeItem(r)};class yl{constructor(){this.promise=new yl.promiseConstructor((r,a)=>{this.resolve=r,this.reject=a})}}yl.promiseConstructor=Promise;function Po(i){const r=i.split(".");if(r.length!==3)throw new Ho("Invalid JWT structure");for(let l=0;l<r.length;l++)if(!Wx.test(r[l]))throw new Ho("JWT not in base64url format");return{header:JSON.parse(km(r[0])),payload:JSON.parse(km(r[1])),signature:ep(r[2]),raw:{header:r[0],payload:r[1]}}}async function ip(i){return await new Promise(r=>{setTimeout(()=>r(null),i)})}function op(i,r){return new Promise((l,o)=>{(async()=>{for(let d=0;d<1/0;d++)try{const u=await i(d);if(!r(d,null,u)){l(u);return}}catch(u){if(!r(d,u)){o(u);return}}})()})}function cp(i){return("0"+i.toString(16)).substr(-2)}function dp(){const r=new Uint32Array(56);if(typeof crypto>"u"){const a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",l=a.length;let o="";for(let d=0;d<56;d++)o+=a.charAt(Math.floor(Math.random()*l));return o}return crypto.getRandomValues(r),Array.from(r,cp).join("")}async function up(i){const a=new TextEncoder().encode(i),l=await crypto.subtle.digest("SHA-256",a),o=new Uint8Array(l);return Array.from(o).map(d=>String.fromCharCode(d)).join("")}async function mp(i){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),i;const a=await up(i);return btoa(a).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Fr(i,r,a=!1){const l=dp();let o=l;a&&(o+="/PASSWORD_RECOVERY"),await Wr(i,`${r}-code-verifier`,o);const d=await mp(l);return[d,l===d?"plain":"s256"]}const hp=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function fp(i){const r=i.headers.get(zo);if(!r||!r.match(hp))return null;try{return new Date(`${r}T00:00:00.0Z`)}catch{return null}}function xp(i){if(!i)throw new Error("Missing exp claim");const r=Math.floor(Date.now()/1e3);if(i<=r)throw new Error("JWT has expired")}function pp(i){switch(i){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const gp=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function $r(i){if(!gp.test(i))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Do(){const i={};return new Proxy(i,{get:(r,a)=>{if(a==="__isUserNotAvailableProxy")return!0;if(typeof a=="symbol"){const l=a.toString();if(l==="Symbol(Symbol.toPrimitive)"||l==="Symbol(Symbol.toStringTag)"||l==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${a}" property of the session object is not supported. Please use getUser() instead.`)},set:(r,a)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${a}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(r,a)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${a}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function Sm(i){return JSON.parse(JSON.stringify(i))}var vp=function(i,r){var a={};for(var l in i)Object.prototype.hasOwnProperty.call(i,l)&&r.indexOf(l)<0&&(a[l]=i[l]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,l=Object.getOwnPropertySymbols(i);o<l.length;o++)r.indexOf(l[o])<0&&Object.prototype.propertyIsEnumerable.call(i,l[o])&&(a[l[o]]=i[l[o]]);return a};const tr=i=>i.msg||i.message||i.error_description||i.error||JSON.stringify(i),bp=[502,503,504];async function Cm(i){var r;if(!lp(i))throw new Wo(tr(i),0);if(bp.includes(i.status))throw new Wo(tr(i),i.status);let a;try{a=await i.json()}catch(d){throw new ch(tr(d),d)}let l;const o=fp(i);if(o&&o.getTime()>=oh["2024-01-01"].timestamp&&typeof a=="object"&&a&&typeof a.code=="string"?l=a.code:typeof a=="object"&&a&&typeof a.error_code=="string"&&(l=a.error_code),l){if(l==="weak_password")throw new wm(tr(a),i.status,((r=a.weak_password)===null||r===void 0?void 0:r.reasons)||[]);if(l==="session_not_found")throw new As}else if(typeof a=="object"&&a&&typeof a.weak_password=="object"&&a.weak_password&&Array.isArray(a.weak_password.reasons)&&a.weak_password.reasons.length&&a.weak_password.reasons.reduce((d,u)=>d&&typeof u=="string",!0))throw new wm(tr(a),i.status,a.weak_password.reasons);throw new Vx(tr(a),i.status||500,l)}const yp=(i,r,a,l)=>{const o={method:i,headers:r?.headers||{}};return i==="GET"?o:(o.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},r?.headers),o.body=JSON.stringify(l),Object.assign(Object.assign({},o),a))};async function me(i,r,a,l){var o;const d=Object.assign({},l?.headers);d[zo]||(d[zo]=oh["2024-01-01"].name),l?.jwt&&(d.Authorization=`Bearer ${l.jwt}`);const u=(o=l?.query)!==null&&o!==void 0?o:{};l?.redirectTo&&(u.redirect_to=l.redirectTo);const h=Object.keys(u).length?"?"+new URLSearchParams(u).toString():"",p=await jp(i,r,a+h,{headers:d,noResolveJson:l?.noResolveJson},{},l?.body);return l?.xform?l?.xform(p):{data:Object.assign({},p),error:null}}async function jp(i,r,a,l,o,d){const u=yp(r,l,o,d);let h;try{h=await i(a,Object.assign({},u))}catch(p){throw console.error(p),new Wo(tr(p),0)}if(h.ok||await Cm(h),l?.noResolveJson)return h;try{return await h.json()}catch(p){await Cm(p)}}function ms(i){var r;let a=null;kp(i)&&(a=Object.assign({},i),i.expires_at||(a.expires_at=rp(i.expires_in)));const l=(r=i.user)!==null&&r!==void 0?r:i;return{data:{session:a,user:l},error:null}}function Tm(i){const r=ms(i);return!r.error&&i.weak_password&&typeof i.weak_password=="object"&&Array.isArray(i.weak_password.reasons)&&i.weak_password.reasons.length&&i.weak_password.message&&typeof i.weak_password.message=="string"&&i.weak_password.reasons.reduce((a,l)=>a&&typeof l=="string",!0)&&(r.data.weak_password=i.weak_password),r}function Fs(i){var r;return{data:{user:(r=i.user)!==null&&r!==void 0?r:i},error:null}}function wp(i){return{data:i,error:null}}function Np(i){const{action_link:r,email_otp:a,hashed_token:l,redirect_to:o,verification_type:d}=i,u=vp(i,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),h={action_link:r,email_otp:a,hashed_token:l,redirect_to:o,verification_type:d},p=Object.assign({},u);return{data:{properties:h,user:p},error:null}}function _p(i){return i}function kp(i){return i.access_token&&i.refresh_token&&i.expires_in}const Oo=["global","local","others"];var Sp=function(i,r){var a={};for(var l in i)Object.prototype.hasOwnProperty.call(i,l)&&r.indexOf(l)<0&&(a[l]=i[l]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,l=Object.getOwnPropertySymbols(i);o<l.length;o++)r.indexOf(l[o])<0&&Object.prototype.propertyIsEnumerable.call(i,l[o])&&(a[l[o]]=i[l[o]]);return a};class Cp{constructor({url:r="",headers:a={},fetch:l}){this.url=r,this.headers=a,this.fetch=mh(l),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(r,a=Oo[0]){if(Oo.indexOf(a)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Oo.join(", ")}`);try{return await me(this.fetch,"POST",`${this.url}/logout?scope=${a}`,{headers:this.headers,jwt:r,noResolveJson:!0}),{data:null,error:null}}catch(l){if(oe(l))return{data:null,error:l};throw l}}async inviteUserByEmail(r,a={}){try{return await me(this.fetch,"POST",`${this.url}/invite`,{body:{email:r,data:a.data},headers:this.headers,redirectTo:a.redirectTo,xform:Fs})}catch(l){if(oe(l))return{data:{user:null},error:l};throw l}}async generateLink(r){try{const{options:a}=r,l=Sp(r,["options"]),o=Object.assign(Object.assign({},l),a);return"newEmail"in l&&(o.new_email=l?.newEmail,delete o.newEmail),await me(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:o,headers:this.headers,xform:Np,redirectTo:a?.redirectTo})}catch(a){if(oe(a))return{data:{properties:null,user:null},error:a};throw a}}async createUser(r){try{return await me(this.fetch,"POST",`${this.url}/admin/users`,{body:r,headers:this.headers,xform:Fs})}catch(a){if(oe(a))return{data:{user:null},error:a};throw a}}async listUsers(r){var a,l,o,d,u,h,p;try{const g={nextPage:null,lastPage:0,total:0},v=await me(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(l=(a=r?.page)===null||a===void 0?void 0:a.toString())!==null&&l!==void 0?l:"",per_page:(d=(o=r?.perPage)===null||o===void 0?void 0:o.toString())!==null&&d!==void 0?d:""},xform:_p});if(v.error)throw v.error;const x=await v.json(),N=(u=v.headers.get("x-total-count"))!==null&&u!==void 0?u:0,y=(p=(h=v.headers.get("link"))===null||h===void 0?void 0:h.split(","))!==null&&p!==void 0?p:[];return y.length>0&&(y.forEach(b=>{const j=parseInt(b.split(";")[0].split("=")[1].substring(0,1)),_=JSON.parse(b.split(";")[1].split("=")[1]);g[`${_}Page`]=j}),g.total=parseInt(N)),{data:Object.assign(Object.assign({},x),g),error:null}}catch(g){if(oe(g))return{data:{users:[]},error:g};throw g}}async getUserById(r){$r(r);try{return await me(this.fetch,"GET",`${this.url}/admin/users/${r}`,{headers:this.headers,xform:Fs})}catch(a){if(oe(a))return{data:{user:null},error:a};throw a}}async updateUserById(r,a){$r(r);try{return await me(this.fetch,"PUT",`${this.url}/admin/users/${r}`,{body:a,headers:this.headers,xform:Fs})}catch(l){if(oe(l))return{data:{user:null},error:l};throw l}}async deleteUser(r,a=!1){$r(r);try{return await me(this.fetch,"DELETE",`${this.url}/admin/users/${r}`,{headers:this.headers,body:{should_soft_delete:a},xform:Fs})}catch(l){if(oe(l))return{data:{user:null},error:l};throw l}}async _listFactors(r){$r(r.userId);try{const{data:a,error:l}=await me(this.fetch,"GET",`${this.url}/admin/users/${r.userId}/factors`,{headers:this.headers,xform:o=>({data:{factors:o},error:null})});return{data:a,error:l}}catch(a){if(oe(a))return{data:null,error:a};throw a}}async _deleteFactor(r){$r(r.userId),$r(r.id);try{return{data:await me(this.fetch,"DELETE",`${this.url}/admin/users/${r.userId}/factors/${r.id}`,{headers:this.headers}),error:null}}catch(a){if(oe(a))return{data:null,error:a};throw a}}}function Em(i={}){return{getItem:r=>i[r]||null,setItem:(r,a)=>{i[r]=a},removeItem:r=>{delete i[r]}}}function Tp(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const qr={debug:!!(globalThis&&uh()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class hh extends Error{constructor(r){super(r),this.isAcquireTimeout=!0}}class Ep extends hh{}async function Pp(i,r,a){qr.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",i,r);const l=new globalThis.AbortController;return r>0&&setTimeout(()=>{l.abort(),qr.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",i)},r),await Promise.resolve().then(()=>globalThis.navigator.locks.request(i,r===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:l.signal},async o=>{if(o){qr.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",i,o.name);try{return await a()}finally{qr.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",i,o.name)}}else{if(r===0)throw qr.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",i),new Ep(`Acquiring an exclusive Navigator LockManager lock "${i}" immediately failed`);if(qr.debug)try{const d=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(d,null,"  "))}catch(d){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",d)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await a()}}))}Tp();const Dp={url:Ux,storageKey:Bx,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:zx,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Pm(i,r,a){return await a()}const Ur={};class Wn{constructor(r){var a,l;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Wn.nextInstanceID,Wn.nextInstanceID+=1,this.instanceID>0&&Ht()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const o=Object.assign(Object.assign({},Dp),r);if(this.logDebugMessages=!!o.debug,typeof o.debug=="function"&&(this.logger=o.debug),this.persistSession=o.persistSession,this.storageKey=o.storageKey,this.autoRefreshToken=o.autoRefreshToken,this.admin=new Cp({url:o.url,headers:o.headers,fetch:o.fetch}),this.url=o.url,this.headers=o.headers,this.fetch=mh(o.fetch),this.lock=o.lock||Pm,this.detectSessionInUrl=o.detectSessionInUrl,this.flowType=o.flowType,this.hasCustomAuthorizationHeader=o.hasCustomAuthorizationHeader,o.lock?this.lock=o.lock:Ht()&&(!((a=globalThis?.navigator)===null||a===void 0)&&a.locks)?this.lock=Pp:this.lock=Pm,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(o.storage?this.storage=o.storage:uh()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Em(this.memoryStorage)),o.userStorage&&(this.userStorage=o.userStorage)):(this.memoryStorage={},this.storage=Em(this.memoryStorage)),Ht()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(d){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",d)}(l=this.broadcastChannel)===null||l===void 0||l.addEventListener("message",async d=>{this._debug("received broadcast notification from other tab or client",d),await this._notifyAllSubscribers(d.data.event,d.data.session,!1)})}this.initialize()}get jwks(){var r,a;return(a=(r=Ur[this.storageKey])===null||r===void 0?void 0:r.jwks)!==null&&a!==void 0?a:{keys:[]}}set jwks(r){Ur[this.storageKey]=Object.assign(Object.assign({},Ur[this.storageKey]),{jwks:r})}get jwks_cached_at(){var r,a;return(a=(r=Ur[this.storageKey])===null||r===void 0?void 0:r.cachedAt)!==null&&a!==void 0?a:Number.MIN_SAFE_INTEGER}set jwks_cached_at(r){Ur[this.storageKey]=Object.assign(Object.assign({},Ur[this.storageKey]),{cachedAt:r})}_debug(...r){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${ih}) ${new Date().toISOString()}`,...r),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var r;try{const a=ap(window.location.href);let l="none";if(this._isImplicitGrantCallback(a)?l="implicit":await this._isPKCECallback(a)&&(l="pkce"),Ht()&&this.detectSessionInUrl&&l!=="none"){const{data:o,error:d}=await this._getSessionFromURL(a,l);if(d){if(this._debug("#_initialize()","error detecting session from URL",d),Kx(d)){const p=(r=d.details)===null||r===void 0?void 0:r.code;if(p==="identity_already_exists"||p==="identity_not_found"||p==="single_identity_not_deletable")return{error:d}}return await this._removeSession(),{error:d}}const{session:u,redirectType:h}=o;return this._debug("#_initialize()","detected session in URL",u,"redirect type",h),await this._saveSession(u),setTimeout(async()=>{h==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",u):await this._notifyAllSubscribers("SIGNED_IN",u)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(a){return oe(a)?{error:a}:{error:new ch("Unexpected error during initialization",a)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(r){var a,l,o;try{const d=await me(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(l=(a=r?.options)===null||a===void 0?void 0:a.data)!==null&&l!==void 0?l:{},gotrue_meta_security:{captcha_token:(o=r?.options)===null||o===void 0?void 0:o.captchaToken}},xform:ms}),{data:u,error:h}=d;if(h||!u)return{data:{user:null,session:null},error:h};const p=u.session,g=u.user;return u.session&&(await this._saveSession(u.session),await this._notifyAllSubscribers("SIGNED_IN",p)),{data:{user:g,session:p},error:null}}catch(d){if(oe(d))return{data:{user:null,session:null},error:d};throw d}}async signUp(r){var a,l,o;try{let d;if("email"in r){const{email:v,password:x,options:N}=r;let y=null,b=null;this.flowType==="pkce"&&([y,b]=await Fr(this.storage,this.storageKey)),d=await me(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:N?.emailRedirectTo,body:{email:v,password:x,data:(a=N?.data)!==null&&a!==void 0?a:{},gotrue_meta_security:{captcha_token:N?.captchaToken},code_challenge:y,code_challenge_method:b},xform:ms})}else if("phone"in r){const{phone:v,password:x,options:N}=r;d=await me(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:v,password:x,data:(l=N?.data)!==null&&l!==void 0?l:{},channel:(o=N?.channel)!==null&&o!==void 0?o:"sms",gotrue_meta_security:{captcha_token:N?.captchaToken}},xform:ms})}else throw new ul("You must provide either an email or phone number and a password");const{data:u,error:h}=d;if(h||!u)return{data:{user:null,session:null},error:h};const p=u.session,g=u.user;return u.session&&(await this._saveSession(u.session),await this._notifyAllSubscribers("SIGNED_IN",p)),{data:{user:g,session:p},error:null}}catch(d){if(oe(d))return{data:{user:null,session:null},error:d};throw d}}async signInWithPassword(r){try{let a;if("email"in r){const{email:d,password:u,options:h}=r;a=await me(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:d,password:u,gotrue_meta_security:{captcha_token:h?.captchaToken}},xform:Tm})}else if("phone"in r){const{phone:d,password:u,options:h}=r;a=await me(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:d,password:u,gotrue_meta_security:{captcha_token:h?.captchaToken}},xform:Tm})}else throw new ul("You must provide either an email or phone number and a password");const{data:l,error:o}=a;return o?{data:{user:null,session:null},error:o}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new dl}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:Object.assign({user:l.user,session:l.session},l.weak_password?{weakPassword:l.weak_password}:null),error:o})}catch(a){if(oe(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithOAuth(r){var a,l,o,d;return await this._handleProviderSignIn(r.provider,{redirectTo:(a=r.options)===null||a===void 0?void 0:a.redirectTo,scopes:(l=r.options)===null||l===void 0?void 0:l.scopes,queryParams:(o=r.options)===null||o===void 0?void 0:o.queryParams,skipBrowserRedirect:(d=r.options)===null||d===void 0?void 0:d.skipBrowserRedirect})}async exchangeCodeForSession(r){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(r))}async signInWithWeb3(r){const{chain:a}=r;if(a==="solana")return await this.signInWithSolana(r);throw new Error(`@supabase/auth-js: Unsupported chain "${a}"`)}async signInWithSolana(r){var a,l,o,d,u,h,p,g,v,x,N,y;let b,j;if("message"in r)b=r.message,j=r.signature;else{const{chain:_,wallet:T,statement:I,options:C}=r;let D;if(Ht())if(typeof T=="object")D=T;else{const F=window;if("solana"in F&&typeof F.solana=="object"&&("signIn"in F.solana&&typeof F.solana.signIn=="function"||"signMessage"in F.solana&&typeof F.solana.signMessage=="function"))D=F.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof T!="object"||!C?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");D=T}const R=new URL((a=C?.url)!==null&&a!==void 0?a:window.location.href);if("signIn"in D&&D.signIn){const F=await D.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},C?.signInWithSolana),{version:"1",domain:R.host,uri:R.href}),I?{statement:I}:null));let H;if(Array.isArray(F)&&F[0]&&typeof F[0]=="object")H=F[0];else if(F&&typeof F=="object"&&"signedMessage"in F&&"signature"in F)H=F;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in H&&"signature"in H&&(typeof H.signedMessage=="string"||H.signedMessage instanceof Uint8Array)&&H.signature instanceof Uint8Array)b=typeof H.signedMessage=="string"?H.signedMessage:new TextDecoder().decode(H.signedMessage),j=H.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in D)||typeof D.signMessage!="function"||!("publicKey"in D)||typeof D!="object"||!D.publicKey||!("toBase58"in D.publicKey)||typeof D.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");b=[`${R.host} wants you to sign in with your Solana account:`,D.publicKey.toBase58(),...I?["",I,""]:[""],"Version: 1",`URI: ${R.href}`,`Issued At: ${(o=(l=C?.signInWithSolana)===null||l===void 0?void 0:l.issuedAt)!==null&&o!==void 0?o:new Date().toISOString()}`,...!((d=C?.signInWithSolana)===null||d===void 0)&&d.notBefore?[`Not Before: ${C.signInWithSolana.notBefore}`]:[],...!((u=C?.signInWithSolana)===null||u===void 0)&&u.expirationTime?[`Expiration Time: ${C.signInWithSolana.expirationTime}`]:[],...!((h=C?.signInWithSolana)===null||h===void 0)&&h.chainId?[`Chain ID: ${C.signInWithSolana.chainId}`]:[],...!((p=C?.signInWithSolana)===null||p===void 0)&&p.nonce?[`Nonce: ${C.signInWithSolana.nonce}`]:[],...!((g=C?.signInWithSolana)===null||g===void 0)&&g.requestId?[`Request ID: ${C.signInWithSolana.requestId}`]:[],...!((x=(v=C?.signInWithSolana)===null||v===void 0?void 0:v.resources)===null||x===void 0)&&x.length?["Resources",...C.signInWithSolana.resources.map(H=>`- ${H}`)]:[]].join(`
`);const F=await D.signMessage(new TextEncoder().encode(b),"utf8");if(!F||!(F instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");j=F}}try{const{data:_,error:T}=await me(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:b,signature:sp(j)},!((N=r.options)===null||N===void 0)&&N.captchaToken?{gotrue_meta_security:{captcha_token:(y=r.options)===null||y===void 0?void 0:y.captchaToken}}:null),xform:ms});if(T)throw T;return!_||!_.session||!_.user?{data:{user:null,session:null},error:new dl}:(_.session&&(await this._saveSession(_.session),await this._notifyAllSubscribers("SIGNED_IN",_.session)),{data:Object.assign({},_),error:T})}catch(_){if(oe(_))return{data:{user:null,session:null},error:_};throw _}}async _exchangeCodeForSession(r){const a=await er(this.storage,`${this.storageKey}-code-verifier`),[l,o]=(a??"").split("/");try{const{data:d,error:u}=await me(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:r,code_verifier:l},xform:ms});if(await Ls(this.storage,`${this.storageKey}-code-verifier`),u)throw u;return!d||!d.session||!d.user?{data:{user:null,session:null,redirectType:null},error:new dl}:(d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("SIGNED_IN",d.session)),{data:Object.assign(Object.assign({},d),{redirectType:o??null}),error:u})}catch(d){if(oe(d))return{data:{user:null,session:null,redirectType:null},error:d};throw d}}async signInWithIdToken(r){try{const{options:a,provider:l,token:o,access_token:d,nonce:u}=r,h=await me(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:l,id_token:o,access_token:d,nonce:u,gotrue_meta_security:{captcha_token:a?.captchaToken}},xform:ms}),{data:p,error:g}=h;return g?{data:{user:null,session:null},error:g}:!p||!p.session||!p.user?{data:{user:null,session:null},error:new dl}:(p.session&&(await this._saveSession(p.session),await this._notifyAllSubscribers("SIGNED_IN",p.session)),{data:p,error:g})}catch(a){if(oe(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithOtp(r){var a,l,o,d,u;try{if("email"in r){const{email:h,options:p}=r;let g=null,v=null;this.flowType==="pkce"&&([g,v]=await Fr(this.storage,this.storageKey));const{error:x}=await me(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:h,data:(a=p?.data)!==null&&a!==void 0?a:{},create_user:(l=p?.shouldCreateUser)!==null&&l!==void 0?l:!0,gotrue_meta_security:{captcha_token:p?.captchaToken},code_challenge:g,code_challenge_method:v},redirectTo:p?.emailRedirectTo});return{data:{user:null,session:null},error:x}}if("phone"in r){const{phone:h,options:p}=r,{data:g,error:v}=await me(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:h,data:(o=p?.data)!==null&&o!==void 0?o:{},create_user:(d=p?.shouldCreateUser)!==null&&d!==void 0?d:!0,gotrue_meta_security:{captcha_token:p?.captchaToken},channel:(u=p?.channel)!==null&&u!==void 0?u:"sms"}});return{data:{user:null,session:null,messageId:g?.message_id},error:v}}throw new ul("You must provide either an email or phone number.")}catch(h){if(oe(h))return{data:{user:null,session:null},error:h};throw h}}async verifyOtp(r){var a,l;try{let o,d;"options"in r&&(o=(a=r.options)===null||a===void 0?void 0:a.redirectTo,d=(l=r.options)===null||l===void 0?void 0:l.captchaToken);const{data:u,error:h}=await me(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},r),{gotrue_meta_security:{captcha_token:d}}),redirectTo:o,xform:ms});if(h)throw h;if(!u)throw new Error("An error occurred on token verification.");const p=u.session,g=u.user;return p?.access_token&&(await this._saveSession(p),await this._notifyAllSubscribers(r.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",p)),{data:{user:g,session:p},error:null}}catch(o){if(oe(o))return{data:{user:null,session:null},error:o};throw o}}async signInWithSSO(r){var a,l,o;try{let d=null,u=null;return this.flowType==="pkce"&&([d,u]=await Fr(this.storage,this.storageKey)),await me(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in r?{provider_id:r.providerId}:null),"domain"in r?{domain:r.domain}:null),{redirect_to:(l=(a=r.options)===null||a===void 0?void 0:a.redirectTo)!==null&&l!==void 0?l:void 0}),!((o=r?.options)===null||o===void 0)&&o.captchaToken?{gotrue_meta_security:{captcha_token:r.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:d,code_challenge_method:u}),headers:this.headers,xform:wp})}catch(d){if(oe(d))return{data:null,error:d};throw d}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async r=>{const{data:{session:a},error:l}=r;if(l)throw l;if(!a)throw new As;const{error:o}=await me(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:a.access_token});return{data:{user:null,session:null},error:o}})}catch(r){if(oe(r))return{data:{user:null,session:null},error:r};throw r}}async resend(r){try{const a=`${this.url}/resend`;if("email"in r){const{email:l,type:o,options:d}=r,{error:u}=await me(this.fetch,"POST",a,{headers:this.headers,body:{email:l,type:o,gotrue_meta_security:{captcha_token:d?.captchaToken}},redirectTo:d?.emailRedirectTo});return{data:{user:null,session:null},error:u}}else if("phone"in r){const{phone:l,type:o,options:d}=r,{data:u,error:h}=await me(this.fetch,"POST",a,{headers:this.headers,body:{phone:l,type:o,gotrue_meta_security:{captcha_token:d?.captchaToken}}});return{data:{user:null,session:null,messageId:u?.message_id},error:h}}throw new ul("You must provide either an email or phone number and a type")}catch(a){if(oe(a))return{data:{user:null,session:null},error:a};throw a}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async a=>a))}async _acquireLock(r,a){this._debug("#_acquireLock","begin",r);try{if(this.lockAcquired){const l=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),o=(async()=>(await l,await a()))();return this.pendingInLock.push((async()=>{try{await o}catch{}})()),o}return await this.lock(`lock:${this.storageKey}`,r,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const l=a();for(this.pendingInLock.push((async()=>{try{await l}catch{}})()),await l;this.pendingInLock.length;){const o=[...this.pendingInLock];await Promise.all(o),this.pendingInLock.splice(0,o.length)}return await l}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(r){this._debug("#_useSession","begin");try{const a=await this.__loadSession();return await r(a)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let r=null;const a=await er(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",a),a!==null&&(this._isValidSession(a)?r=a:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!r)return{data:{session:null},error:null};const l=r.expires_at?r.expires_at*1e3-Date.now()<To:!1;if(this._debug("#__loadSession()",`session has${l?"":" not"} expired`,"expires_at",r.expires_at),!l){if(this.userStorage){const u=await er(this.userStorage,this.storageKey+"-user");u?.user?r.user=u.user:r.user=Do()}if(this.storage.isServer&&r.user){let u=this.suppressGetSessionWarning;r=new Proxy(r,{get:(p,g,v)=>(!u&&g==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),u=!0,this.suppressGetSessionWarning=!0),Reflect.get(p,g,v))})}return{data:{session:r},error:null}}const{session:o,error:d}=await this._callRefreshToken(r.refresh_token);return d?{data:{session:null},error:d}:{data:{session:o},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(r){return r?await this._getUser(r):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(r){try{return r?await me(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:r,xform:Fs}):await this._useSession(async a=>{var l,o,d;const{data:u,error:h}=a;if(h)throw h;return!(!((l=u.session)===null||l===void 0)&&l.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new As}:await me(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(d=(o=u.session)===null||o===void 0?void 0:o.access_token)!==null&&d!==void 0?d:void 0,xform:Fs})})}catch(a){if(oe(a))return Gx(a)&&(await this._removeSession(),await Ls(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:a};throw a}}async updateUser(r,a={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(r,a))}async _updateUser(r,a={}){try{return await this._useSession(async l=>{const{data:o,error:d}=l;if(d)throw d;if(!o.session)throw new As;const u=o.session;let h=null,p=null;this.flowType==="pkce"&&r.email!=null&&([h,p]=await Fr(this.storage,this.storageKey));const{data:g,error:v}=await me(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:a?.emailRedirectTo,body:Object.assign(Object.assign({},r),{code_challenge:h,code_challenge_method:p}),jwt:u.access_token,xform:Fs});if(v)throw v;return u.user=g.user,await this._saveSession(u),await this._notifyAllSubscribers("USER_UPDATED",u),{data:{user:u.user},error:null}})}catch(l){if(oe(l))return{data:{user:null},error:l};throw l}}async setSession(r){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(r))}async _setSession(r){try{if(!r.access_token||!r.refresh_token)throw new As;const a=Date.now()/1e3;let l=a,o=!0,d=null;const{payload:u}=Po(r.access_token);if(u.exp&&(l=u.exp,o=l<=a),o){const{session:h,error:p}=await this._callRefreshToken(r.refresh_token);if(p)return{data:{user:null,session:null},error:p};if(!h)return{data:{user:null,session:null},error:null};d=h}else{const{data:h,error:p}=await this._getUser(r.access_token);if(p)throw p;d={access_token:r.access_token,refresh_token:r.refresh_token,user:h.user,token_type:"bearer",expires_in:l-a,expires_at:l},await this._saveSession(d),await this._notifyAllSubscribers("SIGNED_IN",d)}return{data:{user:d.user,session:d},error:null}}catch(a){if(oe(a))return{data:{session:null,user:null},error:a};throw a}}async refreshSession(r){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(r))}async _refreshSession(r){try{return await this._useSession(async a=>{var l;if(!r){const{data:u,error:h}=a;if(h)throw h;r=(l=u.session)!==null&&l!==void 0?l:void 0}if(!r?.refresh_token)throw new As;const{session:o,error:d}=await this._callRefreshToken(r.refresh_token);return d?{data:{user:null,session:null},error:d}:o?{data:{user:o.user,session:o},error:null}:{data:{user:null,session:null},error:null}})}catch(a){if(oe(a))return{data:{user:null,session:null},error:a};throw a}}async _getSessionFromURL(r,a){try{if(!Ht())throw new ml("No browser detected.");if(r.error||r.error_description||r.error_code)throw new ml(r.error_description||"Error in URL with unspecified error_description",{error:r.error||"unspecified_error",code:r.error_code||"unspecified_code"});switch(a){case"implicit":if(this.flowType==="pkce")throw new jm("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new ml("Not a valid implicit grant flow url.");break;default:}if(a==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!r.code)throw new jm("No code detected.");const{data:I,error:C}=await this._exchangeCodeForSession(r.code);if(C)throw C;const D=new URL(window.location.href);return D.searchParams.delete("code"),window.history.replaceState(window.history.state,"",D.toString()),{data:{session:I.session,redirectType:null},error:null}}const{provider_token:l,provider_refresh_token:o,access_token:d,refresh_token:u,expires_in:h,expires_at:p,token_type:g}=r;if(!d||!h||!u||!g)throw new ml("No session defined in URL");const v=Math.round(Date.now()/1e3),x=parseInt(h);let N=v+x;p&&(N=parseInt(p));const y=N-v;y*1e3<=zr&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${y}s, should have been closer to ${x}s`);const b=N-x;v-b>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",b,N,v):v-b<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",b,N,v);const{data:j,error:_}=await this._getUser(d);if(_)throw _;const T={provider_token:l,provider_refresh_token:o,access_token:d,expires_in:x,expires_at:N,refresh_token:u,token_type:g,user:j.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:T,redirectType:r.type},error:null}}catch(l){if(oe(l))return{data:{session:null,redirectType:null},error:l};throw l}}_isImplicitGrantCallback(r){return!!(r.access_token||r.error_description)}async _isPKCECallback(r){const a=await er(this.storage,`${this.storageKey}-code-verifier`);return!!(r.code&&a)}async signOut(r={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(r))}async _signOut({scope:r}={scope:"global"}){return await this._useSession(async a=>{var l;const{data:o,error:d}=a;if(d)return{error:d};const u=(l=o.session)===null||l===void 0?void 0:l.access_token;if(u){const{error:h}=await this.admin.signOut(u,r);if(h&&!(Qx(h)&&(h.status===404||h.status===401||h.status===403)))return{error:h}}return r!=="others"&&(await this._removeSession(),await Ls(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(r){const a=np(),l={id:a,callback:r,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",a),this.stateChangeEmitters.delete(a)}};return this._debug("#onAuthStateChange()","registered callback with id",a),this.stateChangeEmitters.set(a,l),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(a)})))(),{data:{subscription:l}}}async _emitInitialSession(r){return await this._useSession(async a=>{var l,o;try{const{data:{session:d},error:u}=a;if(u)throw u;await((l=this.stateChangeEmitters.get(r))===null||l===void 0?void 0:l.callback("INITIAL_SESSION",d)),this._debug("INITIAL_SESSION","callback id",r,"session",d)}catch(d){await((o=this.stateChangeEmitters.get(r))===null||o===void 0?void 0:o.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",r,"error",d),console.error(d)}})}async resetPasswordForEmail(r,a={}){let l=null,o=null;this.flowType==="pkce"&&([l,o]=await Fr(this.storage,this.storageKey,!0));try{return await me(this.fetch,"POST",`${this.url}/recover`,{body:{email:r,code_challenge:l,code_challenge_method:o,gotrue_meta_security:{captcha_token:a.captchaToken}},headers:this.headers,redirectTo:a.redirectTo})}catch(d){if(oe(d))return{data:null,error:d};throw d}}async getUserIdentities(){var r;try{const{data:a,error:l}=await this.getUser();if(l)throw l;return{data:{identities:(r=a.user.identities)!==null&&r!==void 0?r:[]},error:null}}catch(a){if(oe(a))return{data:null,error:a};throw a}}async linkIdentity(r){var a;try{const{data:l,error:o}=await this._useSession(async d=>{var u,h,p,g,v;const{data:x,error:N}=d;if(N)throw N;const y=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,r.provider,{redirectTo:(u=r.options)===null||u===void 0?void 0:u.redirectTo,scopes:(h=r.options)===null||h===void 0?void 0:h.scopes,queryParams:(p=r.options)===null||p===void 0?void 0:p.queryParams,skipBrowserRedirect:!0});return await me(this.fetch,"GET",y,{headers:this.headers,jwt:(v=(g=x.session)===null||g===void 0?void 0:g.access_token)!==null&&v!==void 0?v:void 0})});if(o)throw o;return Ht()&&!(!((a=r.options)===null||a===void 0)&&a.skipBrowserRedirect)&&window.location.assign(l?.url),{data:{provider:r.provider,url:l?.url},error:null}}catch(l){if(oe(l))return{data:{provider:r.provider,url:null},error:l};throw l}}async unlinkIdentity(r){try{return await this._useSession(async a=>{var l,o;const{data:d,error:u}=a;if(u)throw u;return await me(this.fetch,"DELETE",`${this.url}/user/identities/${r.identity_id}`,{headers:this.headers,jwt:(o=(l=d.session)===null||l===void 0?void 0:l.access_token)!==null&&o!==void 0?o:void 0})})}catch(a){if(oe(a))return{data:null,error:a};throw a}}async _refreshAccessToken(r){const a=`#_refreshAccessToken(${r.substring(0,5)}...)`;this._debug(a,"begin");try{const l=Date.now();return await op(async o=>(o>0&&await ip(200*Math.pow(2,o-1)),this._debug(a,"refreshing attempt",o),await me(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:r},headers:this.headers,xform:ms})),(o,d)=>{const u=200*Math.pow(2,o);return d&&Eo(d)&&Date.now()+u-l<zr})}catch(l){if(this._debug(a,"error",l),oe(l))return{data:{session:null,user:null},error:l};throw l}finally{this._debug(a,"end")}}_isValidSession(r){return typeof r=="object"&&r!==null&&"access_token"in r&&"refresh_token"in r&&"expires_at"in r}async _handleProviderSignIn(r,a){const l=await this._getUrlForProvider(`${this.url}/authorize`,r,{redirectTo:a.redirectTo,scopes:a.scopes,queryParams:a.queryParams});return this._debug("#_handleProviderSignIn()","provider",r,"options",a,"url",l),Ht()&&!a.skipBrowserRedirect&&window.location.assign(l),{data:{provider:r,url:l},error:null}}async _recoverAndRefresh(){var r,a;const l="#_recoverAndRefresh()";this._debug(l,"begin");try{const o=await er(this.storage,this.storageKey);if(o&&this.userStorage){let u=await er(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!u&&(u={user:o.user},await Wr(this.userStorage,this.storageKey+"-user",u)),o.user=(r=u?.user)!==null&&r!==void 0?r:Do()}else if(o&&!o.user&&!o.user){const u=await er(this.storage,this.storageKey+"-user");u&&u?.user?(o.user=u.user,await Ls(this.storage,this.storageKey+"-user"),await Wr(this.storage,this.storageKey,o)):o.user=Do()}if(this._debug(l,"session from storage",o),!this._isValidSession(o)){this._debug(l,"session is not valid"),o!==null&&await this._removeSession();return}const d=((a=o.expires_at)!==null&&a!==void 0?a:1/0)*1e3-Date.now()<To;if(this._debug(l,`session has${d?"":" not"} expired with margin of ${To}s`),d){if(this.autoRefreshToken&&o.refresh_token){const{error:u}=await this._callRefreshToken(o.refresh_token);u&&(console.error(u),Eo(u)||(this._debug(l,"refresh failed with a non-retryable error, removing the session",u),await this._removeSession()))}}else if(o.user&&o.user.__isUserNotAvailableProxy===!0)try{const{data:u,error:h}=await this._getUser(o.access_token);!h&&u?.user?(o.user=u.user,await this._saveSession(o),await this._notifyAllSubscribers("SIGNED_IN",o)):this._debug(l,"could not get user data, skipping SIGNED_IN notification")}catch(u){console.error("Error getting user data:",u),this._debug(l,"error getting user data, skipping SIGNED_IN notification",u)}else await this._notifyAllSubscribers("SIGNED_IN",o)}catch(o){this._debug(l,"error",o),console.error(o);return}finally{this._debug(l,"end")}}async _callRefreshToken(r){var a,l;if(!r)throw new As;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const o=`#_callRefreshToken(${r.substring(0,5)}...)`;this._debug(o,"begin");try{this.refreshingDeferred=new yl;const{data:d,error:u}=await this._refreshAccessToken(r);if(u)throw u;if(!d.session)throw new As;await this._saveSession(d.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",d.session);const h={session:d.session,error:null};return this.refreshingDeferred.resolve(h),h}catch(d){if(this._debug(o,"error",d),oe(d)){const u={session:null,error:d};return Eo(d)||await this._removeSession(),(a=this.refreshingDeferred)===null||a===void 0||a.resolve(u),u}throw(l=this.refreshingDeferred)===null||l===void 0||l.reject(d),d}finally{this.refreshingDeferred=null,this._debug(o,"end")}}async _notifyAllSubscribers(r,a,l=!0){const o=`#_notifyAllSubscribers(${r})`;this._debug(o,"begin",a,`broadcast = ${l}`);try{this.broadcastChannel&&l&&this.broadcastChannel.postMessage({event:r,session:a});const d=[],u=Array.from(this.stateChangeEmitters.values()).map(async h=>{try{await h.callback(r,a)}catch(p){d.push(p)}});if(await Promise.all(u),d.length>0){for(let h=0;h<d.length;h+=1)console.error(d[h]);throw d[0]}}finally{this._debug(o,"end")}}async _saveSession(r){this._debug("#_saveSession()",r),this.suppressGetSessionWarning=!0;const a=Object.assign({},r),l=a.user&&a.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!l&&a.user&&await Wr(this.userStorage,this.storageKey+"-user",{user:a.user});const o=Object.assign({},a);delete o.user;const d=Sm(o);await Wr(this.storage,this.storageKey,d)}else{const o=Sm(a);await Wr(this.storage,this.storageKey,o)}}async _removeSession(){this._debug("#_removeSession()"),await Ls(this.storage,this.storageKey),await Ls(this.storage,this.storageKey+"-code-verifier"),await Ls(this.storage,this.storageKey+"-user"),this.userStorage&&await Ls(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const r=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{r&&Ht()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",r)}catch(a){console.error("removing visibilitychange callback failed",a)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const r=setInterval(()=>this._autoRefreshTokenTick(),zr);this.autoRefreshTicker=r,r&&typeof r=="object"&&typeof r.unref=="function"?r.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(r),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const r=this.autoRefreshTicker;this.autoRefreshTicker=null,r&&clearInterval(r)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const r=Date.now();try{return await this._useSession(async a=>{const{data:{session:l}}=a;if(!l||!l.refresh_token||!l.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const o=Math.floor((l.expires_at*1e3-r)/zr);this._debug("#_autoRefreshTokenTick()",`access token expires in ${o} ticks, a tick lasts ${zr}ms, refresh threshold is ${Bo} ticks`),o<=Bo&&await this._callRefreshToken(l.refresh_token)})}catch(a){console.error("Auto refresh tick failed with error. This is likely a transient error.",a)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(r){if(r.isAcquireTimeout||r instanceof hh)this._debug("auto refresh token tick lock not available");else throw r}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Ht()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(r){console.error("_handleVisibilityChange",r)}}async _onVisibilityChanged(r){const a=`#_onVisibilityChanged(${r})`;this._debug(a,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),r||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(a,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(r,a,l){const o=[`provider=${encodeURIComponent(a)}`];if(l?.redirectTo&&o.push(`redirect_to=${encodeURIComponent(l.redirectTo)}`),l?.scopes&&o.push(`scopes=${encodeURIComponent(l.scopes)}`),this.flowType==="pkce"){const[d,u]=await Fr(this.storage,this.storageKey),h=new URLSearchParams({code_challenge:`${encodeURIComponent(d)}`,code_challenge_method:`${encodeURIComponent(u)}`});o.push(h.toString())}if(l?.queryParams){const d=new URLSearchParams(l.queryParams);o.push(d.toString())}return l?.skipBrowserRedirect&&o.push(`skip_http_redirect=${l.skipBrowserRedirect}`),`${r}?${o.join("&")}`}async _unenroll(r){try{return await this._useSession(async a=>{var l;const{data:o,error:d}=a;return d?{data:null,error:d}:await me(this.fetch,"DELETE",`${this.url}/factors/${r.factorId}`,{headers:this.headers,jwt:(l=o?.session)===null||l===void 0?void 0:l.access_token})})}catch(a){if(oe(a))return{data:null,error:a};throw a}}async _enroll(r){try{return await this._useSession(async a=>{var l,o;const{data:d,error:u}=a;if(u)return{data:null,error:u};const h=Object.assign({friendly_name:r.friendlyName,factor_type:r.factorType},r.factorType==="phone"?{phone:r.phone}:{issuer:r.issuer}),{data:p,error:g}=await me(this.fetch,"POST",`${this.url}/factors`,{body:h,headers:this.headers,jwt:(l=d?.session)===null||l===void 0?void 0:l.access_token});return g?{data:null,error:g}:(r.factorType==="totp"&&(!((o=p?.totp)===null||o===void 0)&&o.qr_code)&&(p.totp.qr_code=`data:image/svg+xml;utf-8,${p.totp.qr_code}`),{data:p,error:null})})}catch(a){if(oe(a))return{data:null,error:a};throw a}}async _verify(r){return this._acquireLock(-1,async()=>{try{return await this._useSession(async a=>{var l;const{data:o,error:d}=a;if(d)return{data:null,error:d};const{data:u,error:h}=await me(this.fetch,"POST",`${this.url}/factors/${r.factorId}/verify`,{body:{code:r.code,challenge_id:r.challengeId},headers:this.headers,jwt:(l=o?.session)===null||l===void 0?void 0:l.access_token});return h?{data:null,error:h}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+u.expires_in},u)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",u),{data:u,error:h})})}catch(a){if(oe(a))return{data:null,error:a};throw a}})}async _challenge(r){return this._acquireLock(-1,async()=>{try{return await this._useSession(async a=>{var l;const{data:o,error:d}=a;return d?{data:null,error:d}:await me(this.fetch,"POST",`${this.url}/factors/${r.factorId}/challenge`,{body:{channel:r.channel},headers:this.headers,jwt:(l=o?.session)===null||l===void 0?void 0:l.access_token})})}catch(a){if(oe(a))return{data:null,error:a};throw a}})}async _challengeAndVerify(r){const{data:a,error:l}=await this._challenge({factorId:r.factorId});return l?{data:null,error:l}:await this._verify({factorId:r.factorId,challengeId:a.id,code:r.code})}async _listFactors(){const{data:{user:r},error:a}=await this.getUser();if(a)return{data:null,error:a};const l=r?.factors||[],o=l.filter(u=>u.factor_type==="totp"&&u.status==="verified"),d=l.filter(u=>u.factor_type==="phone"&&u.status==="verified");return{data:{all:l,totp:o,phone:d},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async r=>{var a,l;const{data:{session:o},error:d}=r;if(d)return{data:null,error:d};if(!o)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:u}=Po(o.access_token);let h=null;u.aal&&(h=u.aal);let p=h;((l=(a=o.user.factors)===null||a===void 0?void 0:a.filter(x=>x.status==="verified"))!==null&&l!==void 0?l:[]).length>0&&(p="aal2");const v=u.amr||[];return{data:{currentLevel:h,nextLevel:p,currentAuthenticationMethods:v},error:null}}))}async fetchJwk(r,a={keys:[]}){let l=a.keys.find(h=>h.kid===r);if(l)return l;const o=Date.now();if(l=this.jwks.keys.find(h=>h.kid===r),l&&this.jwks_cached_at+Hx>o)return l;const{data:d,error:u}=await me(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(u)throw u;return!d.keys||d.keys.length===0||(this.jwks=d,this.jwks_cached_at=o,l=d.keys.find(h=>h.kid===r),!l)?null:l}async getClaims(r,a={}){try{let l=r;if(!l){const{data:y,error:b}=await this.getSession();if(b||!y.session)return{data:null,error:b};l=y.session.access_token}const{header:o,payload:d,signature:u,raw:{header:h,payload:p}}=Po(l);a?.allowExpired||xp(d.exp);const g=!o.alg||o.alg.startsWith("HS")||!o.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(o.kid,a?.keys?{keys:a.keys}:a?.jwks);if(!g){const{error:y}=await this.getUser(l);if(y)throw y;return{data:{claims:d,header:o,signature:u},error:null}}const v=pp(o.alg),x=await crypto.subtle.importKey("jwk",g,v,!0,["verify"]);if(!await crypto.subtle.verify(v,x,u,tp(`${h}.${p}`)))throw new Ho("Invalid JWT signature");return{data:{claims:d,header:o,signature:u},error:null}}catch(l){if(oe(l))return{data:null,error:l};throw l}}}Wn.nextInstanceID=0;const Op=Wn;class Rp extends Op{constructor(r){super(r)}}var Lp=function(i,r,a,l){function o(d){return d instanceof a?d:new a(function(u){u(d)})}return new(a||(a=Promise))(function(d,u){function h(v){try{g(l.next(v))}catch(x){u(x)}}function p(v){try{g(l.throw(v))}catch(x){u(x)}}function g(v){v.done?d(v.value):o(v.value).then(h,p)}g((l=l.apply(i,r||[])).next())})};class Ip{constructor(r,a,l){var o,d,u;this.supabaseUrl=r,this.supabaseKey=a;const h=qx(r);if(!a)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",h),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",h),this.storageUrl=new URL("storage/v1",h),this.functionsUrl=new URL("functions/v1",h);const p=`sb-${h.hostname.split(".")[0]}-auth-token`,g={db:Px,realtime:Ox,auth:Object.assign(Object.assign({},Dx),{storageKey:p}),global:Ex},v=$x(l??{},g);this.storageKey=(o=v.auth.storageKey)!==null&&o!==void 0?o:"",this.headers=(d=v.global.headers)!==null&&d!==void 0?d:{},v.accessToken?(this.accessToken=v.accessToken,this.auth=new Proxy({},{get:(x,N)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(N)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((u=v.auth)!==null&&u!==void 0?u:{},this.headers,v.global.fetch),this.fetch=Ax(a,this._getAccessToken.bind(this),v.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},v.realtime)),this.rest=new Y0(new URL("rest/v1",h).href,{headers:this.headers,schema:v.db.schema,fetch:this.fetch}),this.storage=new Sx(this.storageUrl.href,this.headers,this.fetch,l?.storage),v.accessToken||this._listenForAuthEvents()}get functions(){return new q0(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(r){return this.rest.from(r)}schema(r){return this.rest.schema(r)}rpc(r,a={},l={}){return this.rest.rpc(r,a,l)}channel(r,a={config:{}}){return this.realtime.channel(r,a)}getChannels(){return this.realtime.getChannels()}removeChannel(r){return this.realtime.removeChannel(r)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var r,a;return Lp(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:l}=yield this.auth.getSession();return(a=(r=l.session)===null||r===void 0?void 0:r.access_token)!==null&&a!==void 0?a:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:r,persistSession:a,detectSessionInUrl:l,storage:o,userStorage:d,storageKey:u,flowType:h,lock:p,debug:g},v,x){const N={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Rp({url:this.authUrl.href,headers:Object.assign(Object.assign({},N),v),storageKey:u,autoRefreshToken:r,persistSession:a,detectSessionInUrl:l,storage:o,userStorage:d,flowType:h,lock:p,debug:g,fetch:x,hasCustomAuthorizationHeader:Object.keys(this.headers).some(y=>y.toLowerCase()==="authorization")})}_initRealtimeClient(r){return new hx(this.realtimeUrl.href,Object.assign(Object.assign({},r),{params:Object.assign({apikey:this.supabaseKey},r?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((a,l)=>{this._handleTokenChanged(a,"CLIENT",l?.access_token)})}_handleTokenChanged(r,a,l){(r==="TOKEN_REFRESHED"||r==="SIGNED_IN")&&this.changedAccessToken!==l?this.changedAccessToken=l:r==="SIGNED_OUT"&&(this.realtime.setAuth(),a=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const Ap=(i,r,a)=>new Ip(i,r,a);function Mp(){if(typeof window<"u"||typeof process>"u")return!1;const i=process.version;if(i==null)return!1;const r=i.match(/^v(\d+)\./);return r?parseInt(r[1],10)<=18:!1}Mp()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const Fp="https://exuiwldxpsezihvcoety.supabase.co",$p="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImV4dWl3bGR4cHNlemlodmNvZXR5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjAwNDk3NDYsImV4cCI6MjA3NTYyNTc0Nn0.qh9fmfTIrCrWtfS8lzqhW7Gv1X2rhfgwOiAV-CdYu2s",z=Ap(Fp,$p),fh=k.createContext(void 0);function qp({children:i}){const[r,a]=k.useState(null),[l,o]=k.useState(null),[d,u]=k.useState(!0);k.useEffect(()=>{z.auth.getSession().then(({data:{session:N}})=>{a(N),N?.user?h(N.user.id):u(!1)});const{data:{subscription:x}}=z.auth.onAuthStateChange((N,y)=>{(async()=>(a(y),y?.user?await h(y.user.id):(o(null),u(!1))))()});return()=>x.unsubscribe()},[]);const h=async x=>{try{const{data:N,error:y}=await z.from("users").select("*").eq("id",x).maybeSingle();if(y)throw y;o(N)}catch(N){console.error("Error loading user profile:",N)}finally{u(!1)}},p=async(x,N)=>{const{error:y}=await z.auth.signInWithPassword({email:x,password:N});return{error:y}},g=async(x,N,y,b)=>{const{data:j,error:_}=await z.auth.signUp({email:x,password:N});if(_)return{error:_};if(j.user){const{error:T}=await z.from("users").insert([{id:j.user.id,email:x,full_name:y,role:b,is_active:!0}]);if(T)return{error:T}}return{error:null}},v=async()=>{await z.auth.signOut(),o(null)};return e.jsx(fh.Provider,{value:{session:r,user:l,loading:d,signIn:p,signUp:g,signOut:v},children:i})}function Ne(){const i=k.useContext(fh);if(i===void 0)throw new Error("useAuth must be used within an AuthProvider");return i}class Dm extends k.Component{constructor(r){super(r),this.state={hasError:!1,error:null}}static getDerivedStateFromError(r){return{hasError:!0,error:r}}componentDidCatch(r,a){console.error("ErrorBoundary caught an error:",r,a)}render(){return this.state.hasError?this.props.fallback:this.props.children}}/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Up={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bp=i=>i.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),Z=(i,r)=>{const a=k.forwardRef(({color:l="currentColor",size:o=24,strokeWidth:d=2,absoluteStrokeWidth:u,className:h="",children:p,...g},v)=>k.createElement("svg",{ref:v,...Up,width:o,height:o,stroke:l,strokeWidth:u?Number(d)*24/Number(o):d,className:["lucide",`lucide-${Bp(i)}`,h].join(" "),...g},[...r.map(([x,N])=>k.createElement(x,N)),...Array.isArray(p)?p:[p]]));return a.displayName=`${i}`,a};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tt=Z("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hr=Z("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zp=Z("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ee=Z("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wp=Z("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nr=Z("Bomb",[["circle",{cx:"11",cy:"13",r:"9",key:"hd149"}],["path",{d:"M14.35 4.65 16.3 2.7a2.41 2.41 0 0 1 3.4 0l1.6 1.6a2.4 2.4 0 0 1 0 3.4l-1.95 1.95",key:"jp4j1b"}],["path",{d:"m22 2-1.5 1.5",key:"ay92ug"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Om=Z("Briefcase",[["rect",{width:"20",height:"14",x:"2",y:"7",rx:"2",ry:"2",key:"eto64e"}],["path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"zwj3tp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sc=Z("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ge=Z("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gt=Z("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const et=Z("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hp=Z("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vp=Z("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rm=Z("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ro=Z("ClipboardCheck",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Me=Z("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qp=Z("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ct=Z("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ct=Z("Drill",[["path",{d:"M14 9c0 .6-.4 1-1 1H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9c.6 0 1 .4 1 1Z",key:"b6nnkj"}],["path",{d:"M18 6h4",key:"66u95g"}],["path",{d:"M14 4h3a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1h-3",key:"105ega"}],["path",{d:"m5 10-2 8",key:"xt2lic"}],["path",{d:"M12 10v3c0 .6-.4 1-1 1H8",key:"mwpjnk"}],["path",{d:"m7 18 2-8",key:"1bzku2"}],["path",{d:"M5 22c-1.7 0-3-1.3-3-3 0-.6.4-1 1-1h7c.6 0 1 .4 1 1v2c0 .6-.4 1-1 1Z",key:"117add"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ot=Z("Factory",[["path",{d:"M2 20a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V8l-7 5V8l-7 5V4a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z",key:"159hny"}],["path",{d:"M17 18h1",key:"uldtlt"}],["path",{d:"M12 18h1",key:"s9uhes"}],["path",{d:"M7 18h1",key:"1neino"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gp=Z("FileCheck",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rt=Z("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kp=Z("Film",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M7 3v18",key:"bbkbws"}],["path",{d:"M3 7.5h4",key:"zfgn84"}],["path",{d:"M3 12h18",key:"1i2n21"}],["path",{d:"M3 16.5h4",key:"1230mu"}],["path",{d:"M17 3v18",key:"in4fa5"}],["path",{d:"M17 7.5h4",key:"myr1c1"}],["path",{d:"M17 16.5h4",key:"go4c1d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const It=Z("Fuel",[["line",{x1:"3",x2:"15",y1:"22",y2:"22",key:"xegly4"}],["line",{x1:"4",x2:"14",y1:"9",y2:"9",key:"xcnuvu"}],["path",{d:"M14 22V4a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v18",key:"16j0yd"}],["path",{d:"M14 13h2a2 2 0 0 1 2 2v2a2 2 0 0 0 2 2h0a2 2 0 0 0 2-2V9.83a2 2 0 0 0-.59-1.42L18 5",key:"8ur5zv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vo=Z("HardHat",[["path",{d:"M2 18a1 1 0 0 0 1 1h18a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1H3a1 1 0 0 0-1 1v2z",key:"1dej2m"}],["path",{d:"M10 10V5a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v5",key:"1p9q5i"}],["path",{d:"M4 15v-3a6 6 0 0 1 6-6h0",key:"1uc279"}],["path",{d:"M14 6h0a6 6 0 0 1 6 6v3",key:"1j9mnm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yp=Z("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jp=Z("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xp=Z("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zp=Z("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eg=Z("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tg=Z("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sg=Z("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qo=Z("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jt=Z("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rg=Z("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zn=Z("Navigation",[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ae=Z("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ng=Z("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pl=Z("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ar=Z("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lm=Z("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Im=Z("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Am=Z("Ruler",[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kt=Z("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jl=Z("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ag=Z("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vr=Z("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const At=Z("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lg=Z("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mm=Z("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gl=Z("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Go=Z("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ve=Z("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dt=Z("Truck",[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xh=Z("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ig=Z("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hn=Z("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ft=Z("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vl=Z("Video",[["path",{d:"m22 8-6 4 6 4V8Z",key:"50v9me"}],["rect",{width:"14",height:"12",x:"2",y:"6",rx:"2",ry:"2",key:"1rqjg6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gr=Z("Wallet",[["path",{d:"M21 12V7H5a2 2 0 0 1 0-4h14v4",key:"195gfw"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h16v-5",key:"195n9w"}],["path",{d:"M18 12a2 2 0 0 0 0 4h4v-4Z",key:"vllfpd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rs=Z("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wl=Z("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qt=Z("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]);function og(){const[i,r]=k.useState(""),[a,l]=k.useState(""),[o,d]=k.useState(""),[u,h]=k.useState(!1),{signIn:p}=Ne(),g=async v=>{v.preventDefault(),d(""),h(!0);try{const{error:x}=await p(i,a);x&&d(x.message||"Failed to sign in")}catch{d("An unexpected error occurred")}finally{h(!1)}};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 flex items-center justify-center p-4",children:e.jsx("div",{className:"w-full max-w-md",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-slate-900 rounded-xl mb-4",children:e.jsx(tg,{className:"w-8 h-8 text-white"})}),e.jsx("h1",{className:"text-3xl font-bold text-slate-900",children:"Quarry ERP"}),e.jsx("p",{className:"text-slate-600 mt-2",children:"Sign in to your account"})]}),e.jsxs("form",{onSubmit:g,className:"space-y-6",children:[o&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-sm",children:o}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-slate-700 mb-2",children:"Email Address"}),e.jsx("input",{id:"email",type:"email",value:i,onChange:v=>r(v.target.value),required:!0,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent transition-all",placeholder:"you@example.com"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-slate-700 mb-2",children:"Password"}),e.jsx("input",{id:"password",type:"password",value:a,onChange:v=>l(v.target.value),required:!0,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent transition-all",placeholder:"Enter your password"})]}),e.jsx("button",{type:"submit",disabled:u,className:"w-full bg-slate-900 text-white py-3 px-4 rounded-lg font-medium hover:bg-slate-800 focus:outline-none focus:ring-2 focus:ring-slate-900 focus:ring-offset-2 transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:u?"Signing in...":"Sign In"})]}),e.jsx("div",{className:"mt-6 text-center text-sm text-slate-600",children:e.jsx("p",{children:"Demo accounts available for testing"})})]})})})}function cg({children:i}){const{user:r,signOut:a}=Ne(),[l,o]=k.useState(!1),[d,u]=k.useState([]),p=(r?.role==="director"?[{name:"Dashboard",icon:Jp,href:"#dashboard",roles:["director"]},{name:"Operations",icon:ot,roles:["director"],children:[{name:"Drilling",icon:Ct,href:"#drilling",roles:["director"]},{name:"Blasting",icon:ot,href:"#blasting",roles:["director"]},{name:"Breaking/Loading",icon:Ro,href:"#loading",roles:["director"]},{name:"Transport",icon:dt,href:"#transport",roles:["director"]},{name:"JCB Operations",icon:dt,href:"#jcb-operations",roles:["director"]}]},{name:"Workforce",icon:ft,roles:["director"],children:[{name:"Attendance",icon:Me,href:"#attendance",roles:["director"]},{name:"Photos/Videos",icon:Gt,href:"#media",roles:["director"]}]},{name:"Resources",icon:Ae,roles:["director"],children:[{name:"Inventory",icon:Ae,href:"#inventory",roles:["director"]},{name:"Fuel",icon:It,href:"#fuel",roles:["director"]},{name:"Safety",icon:Vr,href:"#safety",roles:["director"]}]},{name:"Crusher Production",icon:ot,href:"#crusher-production",roles:["director","crusher_manager","manager"]},{name:"EB Reports",icon:Qt,href:"#eb-reports",roles:["director","crusher_manager","manager"]},{name:"Sales & Customers",icon:At,roles:["director"],children:[{name:"Sales",icon:At,href:"#sales",roles:["director"]},{name:"Customers",icon:ft,href:"#customers",roles:["director"]}]},{name:"Permits",icon:rt,roles:["director"],children:[{name:"New Permit",icon:rt,href:"#new-permit",roles:["director"]}]},{name:"Accounts",icon:Gr,href:"#accounts",roles:["director"]},{name:"Dispatch List",icon:Zp,href:"#dispatch-payment",roles:["director"]},{name:"Stock Management",icon:Ae,href:"#stock-management",roles:["director"]},{name:"User Management",icon:ft,href:"#user-management",roles:["director"]},{name:"Reports",icon:Ee,href:"#reports",roles:["director"]}]:[{name:"Dashboard",icon:Ee,href:"#dashboard",roles:["contractor","crusher_manager","manager","sales"]},{name:"Drilling",icon:Ct,href:"#drilling",roles:["contractor","manager"]},{name:"Blasting",icon:ot,href:"#blasting",roles:["contractor","manager"]},{name:"Breaking/Loading",icon:Ro,href:"#loading",roles:["contractor","manager"]},{name:"Transport",icon:dt,href:"#transport",roles:["contractor","manager"]},{name:"Attendance",icon:Me,href:"#attendance",roles:["contractor","manager"]},{name:"Photos/Videos",icon:Gt,href:"#media",roles:["contractor","manager"]},{name:"Inventory",icon:Ae,href:"#inventory",roles:["contractor","manager"]},{name:"Fuel",icon:It,href:"#fuel",roles:["contractor","manager"]},{name:"Safety",icon:Vr,href:"#safety",roles:["contractor","manager"]},{name:"Crusher Production",icon:ot,href:"#crusher-production",roles:["crusher_manager","manager"]},{name:"EB Reports",icon:Qt,href:"#eb-reports",roles:["crusher_manager","manager"]},{name:"Sales",icon:At,href:"#sales",roles:["sales","manager"]},{name:"Customers",icon:ft,href:"#customers",roles:["sales","manager"]},{name:"Approvals",icon:Ro,href:"#approvals",roles:["manager"]},{name:"Reports",icon:Ee,href:"#reports",roles:["manager"]}]).filter(N=>r?.role&&N.roles.includes(r.role)),g=N=>{console.log("Toggling menu:",N),u(y=>{const b=y.includes(N)?y.filter(j=>j!==N):[...y,N];return console.log("New menu state:",b),b})},v=(N,y)=>{N.preventDefault(),console.log("Navigation clicked:",y),y&&(window.location.hash=y,o(!1))},x=(N,y=0)=>{const b=N.children&&N.children.length>0,j=d.includes(N.name);return b?e.jsxs("div",{children:[e.jsxs("button",{onClick:()=>g(N.name),className:`w-full flex items-center justify-between gap-3 px-4 py-3 text-slate-300 hover:bg-slate-800 hover:text-white rounded-lg transition-colors ${y>0?"pl-8":""}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(N.icon,{className:"w-5 h-5"}),e.jsx("span",{children:N.name})]}),j?e.jsx(Hp,{className:"w-4 h-4"}):e.jsx(Vp,{className:"w-4 h-4"})]}),j&&e.jsx("div",{className:"mt-1 space-y-1",children:N.children?.map(_=>x(_,y+1))})]},N.name):e.jsxs("a",{href:N.href,onClick:_=>{console.log("Link clicked:",N.href),v(_,N.href)},className:`flex items-center gap-3 px-4 py-3 text-slate-300 hover:bg-slate-800 hover:text-white rounded-lg transition-colors ${y>0?"pl-12":""}`,children:[e.jsx(N.icon,{className:"w-5 h-5"}),e.jsx("span",{children:N.name})]},N.name)};return e.jsxs("div",{className:"min-h-screen bg-slate-50",children:[e.jsx("div",{className:`fixed inset-0 bg-slate-900/50 z-40 lg:hidden ${l?"block":"hidden"}`,onClick:()=>o(!1)}),e.jsxs("aside",{className:`fixed inset-y-0 left-0 z-50 w-64 bg-slate-900 transform transition-transform duration-300 ease-in-out lg:translate-x-0 ${l?"translate-x-0":"-translate-x-full"}`,children:[e.jsxs("div",{className:"flex items-center justify-between h-16 px-6 border-b border-slate-800",children:[e.jsx("h1",{className:"text-xl font-bold text-white",children:"Quarry ERP"}),e.jsx("button",{onClick:()=>o(!1),className:"lg:hidden text-white",children:e.jsx(wl,{className:"w-6 h-6"})})]}),e.jsx("nav",{className:"p-4 space-y-1 pb-24 overflow-y-auto h-[calc(100vh-4rem)]",children:p.map(N=>x(N))})]}),e.jsxs("div",{className:"lg:pl-64",children:[e.jsx("header",{className:"sticky top-0 z-30 bg-white border-b border-slate-200",children:e.jsxs("div",{className:"flex items-center justify-between h-16 px-4 lg:px-8",children:[e.jsx("button",{onClick:()=>o(!0),className:"lg:hidden p-2 text-slate-600 hover:text-slate-900",children:e.jsx(rg,{className:"w-6 h-6"})}),e.jsx("div",{className:"flex-1"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("button",{className:"relative p-2 text-slate-600 hover:text-slate-900",children:[e.jsx(Wp,{className:"w-6 h-6"}),e.jsx("span",{className:"absolute top-1 right-1 w-2 h-2 bg-red-500 rounded-full"})]}),e.jsx("button",{className:"p-2 text-slate-600 hover:text-slate-900",children:e.jsx(ag,{className:"w-6 h-6"})}),e.jsx("div",{className:"h-8 w-px bg-slate-200"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-slate-700 flex items-center justify-center text-white font-semibold",children:r?.full_name?.charAt(0).toUpperCase()}),e.jsxs("div",{className:"hidden md:block",children:[e.jsx("p",{className:"text-sm font-medium text-slate-900",children:r?.full_name}),e.jsx("p",{className:"text-xs text-slate-600 capitalize",children:r?.role?.replace("_"," ")})]})]}),e.jsxs("button",{onClick:a,className:"flex items-center gap-2 px-4 py-2 text-slate-700 hover:bg-slate-100 rounded-lg transition-colors",children:[e.jsx(sg,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden md:inline",children:"Sign Out"})]})]})]})}),e.jsx("main",{className:"p-4 lg:p-8",children:i})]})]})}function Fm(){const{user:i}=Ne(),[r,a]=k.useState({totalDrillingRecords:0,totalBlastingRecords:0,totalProductionRecords:0,totalSalesOrders:0,totalRevenue:0,pendingApprovals:0,activeUsers:0,todayAttendance:0,totalEBReports:0,totalUnitsConsumed:0,totalEBCost:0}),[l,o]=k.useState(!0),[d,u]=k.useState([]),[h,p]=k.useState("pending");k.useEffect(()=>{g(),v()},[]),k.useEffect(()=>{v()},[h]);const g=async()=>{try{const j=new Date().toISOString().split("T")[0],[_,T,I,C,D,R,F,H]=await Promise.all([z.from("drilling_records").select("id",{count:"exact",head:!0}),z.from("blasting_records").select("id",{count:"exact",head:!0}),z.from("production_records").select("id",{count:"exact",head:!0}),z.from("sales_orders").select("total_amount"),z.from("approval_workflows").select("id",{count:"exact",head:!0}).eq("status","pending"),z.from("users").select("id",{count:"exact",head:!0}).eq("is_active",!0),z.from("attendance").select("id",{count:"exact",head:!0}).eq("date",j),z.from("eb_reports").select("units_consumed, total_cost")]),ae=C.data?.reduce((ce,be)=>ce+Number(be.total_amount||0),0)||0,_e=H.data?.length||0,He=H.data?.reduce((ce,be)=>ce+(Number(be.units_consumed)||0),0)||0,U=H.data?.reduce((ce,be)=>ce+(Number(be.total_cost)||0),0)||0;a({totalDrillingRecords:_.count||0,totalBlastingRecords:T.count||0,totalProductionRecords:I.count||0,totalSalesOrders:C.data?.length||0,totalRevenue:ae,pendingApprovals:D.count||0,activeUsers:R.count||0,todayAttendance:F.count||0,totalEBReports:_e,totalUnitsConsumed:He,totalEBCost:U})}catch(j){console.error("Error loading dashboard data:",j)}finally{o(!1)}},v=async()=>{try{let j=z.from("approval_workflows").select("*, users!approval_workflows_submitted_by_fkey(full_name)").order("submitted_at",{ascending:!1});h!=="all"&&(j=j.eq("status",h));const{data:_,error:T}=await j;if(T)throw T;u(_||[])}catch(j){console.error("Error loading approvals:",j)}},x=async(j,_)=>{try{const{error:T}=await z.from("approval_workflows").update({status:_,approver_id:i?.id,reviewed_at:new Date().toISOString()}).eq("id",j);if(T)throw T;await v(),await g(),alert(`Request ${_} successfully!`)}catch(T){alert("Error updating approval: "+T.message)}},N=j=>({pending:"bg-yellow-100 text-yellow-700",approved:"bg-green-100 text-green-700",rejected:"bg-red-100 text-red-700"})[j]||"bg-slate-100 text-slate-700",y=j=>({drilling:"Drilling Record",blasting:"Blasting Record",loading:"Loading Record",production:"Production Record",quotation:"Quotation",order:"Sales Order"})[j]||j,b=[{name:"Total Revenue",value:`${r.totalRevenue.toLocaleString("en-IN")}`,icon:ct,color:"bg-green-500",trend:"+12.5%",href:"#sales"},{name:"Drilling Records",value:r.totalDrillingRecords,icon:Ct,color:"bg-blue-500",trend:"+8.2%",href:"#drilling"},{name:"Production Records",value:r.totalProductionRecords,icon:ot,color:"bg-orange-500",trend:"+5.7%",href:"#production"},{name:"Sales Orders",value:r.totalSalesOrders,icon:At,color:"bg-slate-900",trend:"+15.3%",href:"#sales"},{name:"Pending Approvals",value:r.pendingApprovals,icon:Tt,color:"bg-yellow-500",trend:"",href:"#approvals"},{name:"Active Users",value:r.activeUsers,icon:ft,color:"bg-cyan-500",trend:"",href:"#user-management"},{name:"Today Attendance",value:r.todayAttendance,icon:et,color:"bg-green-500",trend:"",href:"#attendance"},{name:"Blasting Records",value:r.totalBlastingRecords,icon:ot,color:"bg-red-500",trend:"+3.1%",href:"#blasting"},{name:"EB Reports",value:r.totalEBReports,icon:ve,color:"bg-yellow-500",trend:"",href:"#eb-reports"},{name:"EB Units Consumed",value:r.totalUnitsConsumed.toFixed(2),icon:Qt,color:"bg-purple-500",trend:"",href:"#eb-reports"},{name:"Total EB Cost",value:`${r.totalEBCost.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})}`,icon:ct,color:"bg-green-500",trend:"",href:"#eb-reports"}];return l?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-slate-600",children:"Loading dashboard..."})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Director Dashboard"}),e.jsx("p",{className:"text-slate-600 mt-1",children:"Overview of all operations and key metrics"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:b.map(j=>e.jsx("a",{href:j.href,className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6 hover:shadow-md hover:border-slate-300 transition-all cursor-pointer",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-slate-600",children:j.name}),e.jsx("p",{className:"text-2xl font-bold text-slate-900 mt-2",children:j.value}),j.trend&&e.jsxs("div",{className:"flex items-center gap-1 mt-2",children:[e.jsx(ve,{className:"w-4 h-4 text-green-500"}),e.jsx("span",{className:"text-sm text-green-500 font-medium",children:j.trend})]})]}),e.jsx("div",{className:`${j.color} w-12 h-12 rounded-lg flex items-center justify-center`,children:e.jsx(j.icon,{className:"w-6 h-6 text-white"})})]})},j.name))}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-4",children:"Recent Activities"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-3 pb-4 border-b border-slate-100",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-blue-100 flex items-center justify-center flex-shrink-0",children:e.jsx(Ct,{className:"w-4 h-4 text-blue-600"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-slate-900",children:"New drilling record submitted"}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"2 hours ago"})]})]}),e.jsxs("div",{className:"flex items-start gap-3 pb-4 border-b border-slate-100",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-green-100 flex items-center justify-center flex-shrink-0",children:e.jsx(At,{className:"w-4 h-4 text-green-600"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-slate-900",children:"New sales order created"}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"4 hours ago"})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-orange-100 flex items-center justify-center flex-shrink-0",children:e.jsx(ot,{className:"w-4 h-4 text-orange-600"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-slate-900",children:"Production report approved"}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"5 hours ago"})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-4",children:"Quick Actions"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("a",{href:"#approvals",className:"p-4 border-2 border-slate-200 rounded-lg hover:border-slate-900 hover:bg-slate-50 transition-all",children:[e.jsx(Tt,{className:"w-6 h-6 text-slate-900 mb-2"}),e.jsx("p",{className:"text-sm font-medium text-slate-900",children:"Review Approvals"})]}),e.jsxs("a",{href:"#reports",className:"p-4 border-2 border-slate-200 rounded-lg hover:border-slate-900 hover:bg-slate-50 transition-all",children:[e.jsx(ft,{className:"w-6 h-6 text-slate-900 mb-2"}),e.jsx("p",{className:"text-sm font-medium text-slate-900",children:"View Reports"})]}),e.jsxs("a",{href:"#sales",className:"p-4 border-2 border-slate-200 rounded-lg hover:border-slate-900 hover:bg-slate-50 transition-all",children:[e.jsx(At,{className:"w-6 h-6 text-slate-900 mb-2"}),e.jsx("p",{className:"text-sm font-medium text-slate-900",children:"Sales Overview"})]}),e.jsxs("a",{href:"#production",className:"p-4 border-2 border-slate-200 rounded-lg hover:border-slate-900 hover:bg-slate-50 transition-all",children:[e.jsx(ot,{className:"w-6 h-6 text-slate-900 mb-2"}),e.jsx("p",{className:"text-sm font-medium text-slate-900",children:"Production Stats"})]})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Approvals"}),e.jsx("p",{className:"text-slate-600 mt-1",children:"Review and approve pending requests"})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200",children:[e.jsx("div",{className:"border-b border-slate-200 p-4",children:e.jsx("div",{className:"flex gap-2",children:["all","pending","approved","rejected"].map(j=>e.jsx("button",{onClick:()=>p(j),className:`px-4 py-2 rounded-lg font-medium capitalize transition-colors ${h===j?"bg-slate-900 text-white":"bg-slate-100 text-slate-700 hover:bg-slate-200"}`,children:j},j))})}),e.jsx("div",{className:"p-6",children:d.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(rt,{className:"w-12 h-12 text-slate-400 mx-auto mb-3"}),e.jsx("p",{className:"text-slate-600",children:"No approval requests found"})]}):e.jsx("div",{className:"space-y-4",children:d.map(j=>e.jsx("div",{className:"border border-slate-200 rounded-lg p-4 hover:border-slate-300 transition-colors",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h4",{className:"font-semibold text-slate-900",children:y(j.record_type)}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${N(j.status)}`,children:j.status})]}),e.jsxs("p",{className:"text-sm text-slate-600",children:["Submitted by ",j.users?.full_name," on"," ",new Date(j.submitted_at).toLocaleDateString()]})]}),j.status==="pending"&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>x(j.id,"approved"),className:"p-2 text-green-600 hover:bg-green-50 rounded-lg transition-colors",title:"Approve",children:e.jsx(et,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>x(j.id,"rejected"),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Reject",children:e.jsx(rs,{className:"w-5 h-5"})})]})]})},j.id))})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-gradient-to-br from-yellow-500 to-orange-500 rounded-xl p-6 text-white",children:[e.jsx(Me,{className:"w-10 h-10 mb-3 opacity-80"}),e.jsx("p",{className:"text-2xl font-bold",children:d.filter(j=>j.status==="pending").length}),e.jsx("p",{className:"text-yellow-100 mt-1",children:"Pending Approvals"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-green-500 to-emerald-500 rounded-xl p-6 text-white",children:[e.jsx(et,{className:"w-10 h-10 mb-3 opacity-80"}),e.jsx("p",{className:"text-2xl font-bold",children:d.filter(j=>j.status==="approved").length}),e.jsx("p",{className:"text-green-100 mt-1",children:"Approved Today"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-red-500 to-pink-500 rounded-xl p-6 text-white",children:[e.jsx(rs,{className:"w-10 h-10 mb-3 opacity-80"}),e.jsx("p",{className:"text-2xl font-bold",children:d.filter(j=>j.status==="rejected").length}),e.jsx("p",{className:"text-red-100 mt-1",children:"Rejected Today"})]})]})]})]})}function dg(){const{user:i}=Ne(),[r,a]=k.useState({todayRecords:0,weekRecords:0,pendingApprovals:0,approvedRecords:0}),[l,o]=k.useState(!0);k.useEffect(()=>{d()},[i]);const d=async()=>{if(i)try{const p=new Date().toISOString().split("T")[0],g=new Date;g.setDate(g.getDate()-7);const v=g.toISOString().split("T")[0],[x,N,y]=await Promise.all([z.from("drilling_records").select("date, status",{count:"exact"}).eq("contractor_id",i.id),z.from("blasting_records").select("date, status",{count:"exact"}).eq("contractor_id",i.id),z.from("loading_records").select("date, status",{count:"exact"}).eq("contractor_id",i.id)]),b=[...x.data||[],...N.data||[],...y.data||[]],j=b.filter(C=>C.date===p).length,_=b.filter(C=>C.date>=v).length,T=b.filter(C=>C.status==="pending").length,I=b.filter(C=>C.status==="approved").length;a({todayRecords:j,weekRecords:_,pendingApprovals:T,approvedRecords:I})}catch(p){console.error("Error loading stats:",p)}finally{o(!1)}},u=[{title:"Today's Records",value:r.todayRecords,icon:ge,color:"bg-blue-500",textColor:"text-blue-600"},{title:"This Week",value:r.weekRecords,icon:ve,color:"bg-green-500",textColor:"text-green-600"},{title:"Pending Approval",value:r.pendingApprovals,icon:Me,color:"bg-amber-500",textColor:"text-amber-600"},{title:"Approved",value:r.approvedRecords,icon:et,color:"bg-emerald-500",textColor:"text-emerald-600"}],h=[{title:"Drilling",description:"Record drilling operations",icon:Ct,color:"bg-blue-600 hover:bg-blue-700",link:"#drilling"},{title:"Blasting",description:"Record blasting activities",icon:nr,color:"bg-orange-600 hover:bg-orange-700",link:"#blasting"},{title:"Breaking/Loading",description:"Track breaking and loading",icon:dt,color:"bg-green-600 hover:bg-green-700",link:"#loading"}];return l?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-slate-600",children:"Loading dashboard..."})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gradient-to-r from-slate-900 to-slate-800 rounded-xl p-6 text-white",children:[e.jsxs("h1",{className:"text-3xl font-bold mb-2",children:["Welcome back, ",i?.full_name,"!"]}),e.jsx("p",{className:"text-slate-300",children:"Quarry Contractor Dashboard"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:u.map((p,g)=>{const v=p.icon;return e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-slate-600 mb-1",children:p.title}),e.jsx("p",{className:"text-3xl font-bold text-slate-900",children:p.value})]}),e.jsx("div",{className:`${p.color} w-12 h-12 rounded-lg flex items-center justify-center`,children:e.jsx(v,{className:"w-6 h-6 text-white"})})]})},g)})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-slate-900 mb-4",children:"Quick Actions"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:h.map((p,g)=>{const v=p.icon;return e.jsxs("a",{href:p.link,className:`${p.color} rounded-xl p-6 text-white transition-all hover:scale-105 hover:shadow-lg`,children:[e.jsx(v,{className:"w-10 h-10 mb-4"}),e.jsx("h3",{className:"text-xl font-bold mb-2",children:p.title}),e.jsx("p",{className:"text-white/90",children:p.description})]},g)})})]}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-6",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx(Tt,{className:"w-6 h-6 text-blue-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-blue-900 mb-2",children:"Important Reminders"}),e.jsxs("ul",{className:"space-y-1 text-sm text-blue-800",children:[e.jsx("li",{children:" Submit daily records before end of shift"}),e.jsx("li",{children:" Ensure all equipment numbers are recorded accurately"}),e.jsx("li",{children:" Report any safety concerns immediately to your manager"}),e.jsx("li",{children:" Check pending approvals regularly"})]})]})]})})]})}function ug(i){if(typeof document>"u")return;let r=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css",r.firstChild?r.insertBefore(a,r.firstChild):r.appendChild(a),a.styleSheet?a.styleSheet.cssText=i:a.appendChild(document.createTextNode(i))}ug(`:root{--toastify-color-light: #fff;--toastify-color-dark: #121212;--toastify-color-info: #3498db;--toastify-color-success: #07bc0c;--toastify-color-warning: #f1c40f;--toastify-color-error: hsl(6, 78%, 57%);--toastify-color-transparent: rgba(255, 255, 255, .7);--toastify-icon-color-info: var(--toastify-color-info);--toastify-icon-color-success: var(--toastify-color-success);--toastify-icon-color-warning: var(--toastify-color-warning);--toastify-icon-color-error: var(--toastify-color-error);--toastify-container-width: fit-content;--toastify-toast-width: 320px;--toastify-toast-offset: 16px;--toastify-toast-top: max(var(--toastify-toast-offset), env(safe-area-inset-top));--toastify-toast-right: max(var(--toastify-toast-offset), env(safe-area-inset-right));--toastify-toast-left: max(var(--toastify-toast-offset), env(safe-area-inset-left));--toastify-toast-bottom: max(var(--toastify-toast-offset), env(safe-area-inset-bottom));--toastify-toast-background: #fff;--toastify-toast-padding: 14px;--toastify-toast-min-height: 64px;--toastify-toast-max-height: 800px;--toastify-toast-bd-radius: 6px;--toastify-toast-shadow: 0px 4px 12px rgba(0, 0, 0, .1);--toastify-font-family: sans-serif;--toastify-z-index: 9999;--toastify-text-color-light: #757575;--toastify-text-color-dark: #fff;--toastify-text-color-info: #fff;--toastify-text-color-success: #fff;--toastify-text-color-warning: #fff;--toastify-text-color-error: #fff;--toastify-spinner-color: #616161;--toastify-spinner-color-empty-area: #e0e0e0;--toastify-color-progress-light: linear-gradient(to right, #4cd964, #5ac8fa, #007aff, #34aadc, #5856d6, #ff2d55);--toastify-color-progress-dark: #bb86fc;--toastify-color-progress-info: var(--toastify-color-info);--toastify-color-progress-success: var(--toastify-color-success);--toastify-color-progress-warning: var(--toastify-color-warning);--toastify-color-progress-error: var(--toastify-color-error);--toastify-color-progress-bgo: .2}.Toastify__toast-container{z-index:var(--toastify-z-index);-webkit-transform:translate3d(0,0,var(--toastify-z-index));position:fixed;width:var(--toastify-container-width);box-sizing:border-box;color:#fff;display:flex;flex-direction:column}.Toastify__toast-container--top-left{top:var(--toastify-toast-top);left:var(--toastify-toast-left)}.Toastify__toast-container--top-center{top:var(--toastify-toast-top);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--top-right{top:var(--toastify-toast-top);right:var(--toastify-toast-right);align-items:end}.Toastify__toast-container--bottom-left{bottom:var(--toastify-toast-bottom);left:var(--toastify-toast-left)}.Toastify__toast-container--bottom-center{bottom:var(--toastify-toast-bottom);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--bottom-right{bottom:var(--toastify-toast-bottom);right:var(--toastify-toast-right);align-items:end}.Toastify__toast{--y: 0;position:relative;touch-action:none;width:var(--toastify-toast-width);min-height:var(--toastify-toast-min-height);box-sizing:border-box;margin-bottom:1rem;padding:var(--toastify-toast-padding);border-radius:var(--toastify-toast-bd-radius);box-shadow:var(--toastify-toast-shadow);max-height:var(--toastify-toast-max-height);font-family:var(--toastify-font-family);z-index:0;display:flex;flex:1 auto;align-items:center;word-break:break-word}@media only screen and (max-width: 480px){.Toastify__toast-container{width:100vw;left:env(safe-area-inset-left);margin:0}.Toastify__toast-container--top-left,.Toastify__toast-container--top-center,.Toastify__toast-container--top-right{top:env(safe-area-inset-top);transform:translate(0)}.Toastify__toast-container--bottom-left,.Toastify__toast-container--bottom-center,.Toastify__toast-container--bottom-right{bottom:env(safe-area-inset-bottom);transform:translate(0)}.Toastify__toast-container--rtl{right:env(safe-area-inset-right);left:initial}.Toastify__toast{--toastify-toast-width: 100%;margin-bottom:0;border-radius:0}}.Toastify__toast-container[data-stacked=true]{width:var(--toastify-toast-width)}.Toastify__toast--stacked{position:absolute;width:100%;transform:translate3d(0,var(--y),0) scale(var(--s));transition:transform .3s}.Toastify__toast--stacked[data-collapsed] .Toastify__toast-body,.Toastify__toast--stacked[data-collapsed] .Toastify__close-button{transition:opacity .1s}.Toastify__toast--stacked[data-collapsed=false]{overflow:visible}.Toastify__toast--stacked[data-collapsed=true]:not(:last-child)>*{opacity:0}.Toastify__toast--stacked:after{content:"";position:absolute;left:0;right:0;height:calc(var(--g) * 1px);bottom:100%}.Toastify__toast--stacked[data-pos=top]{top:0}.Toastify__toast--stacked[data-pos=bot]{bottom:0}.Toastify__toast--stacked[data-pos=bot].Toastify__toast--stacked:before{transform-origin:top}.Toastify__toast--stacked[data-pos=top].Toastify__toast--stacked:before{transform-origin:bottom}.Toastify__toast--stacked:before{content:"";position:absolute;left:0;right:0;bottom:0;height:100%;transform:scaleY(3);z-index:-1}.Toastify__toast--rtl{direction:rtl}.Toastify__toast--close-on-click{cursor:pointer}.Toastify__toast-icon{margin-inline-end:10px;width:22px;flex-shrink:0;display:flex}.Toastify--animate{animation-fill-mode:both;animation-duration:.5s}.Toastify--animate-icon{animation-fill-mode:both;animation-duration:.3s}.Toastify__toast-theme--dark{background:var(--toastify-color-dark);color:var(--toastify-text-color-dark)}.Toastify__toast-theme--light,.Toastify__toast-theme--colored.Toastify__toast--default{background:var(--toastify-color-light);color:var(--toastify-text-color-light)}.Toastify__toast-theme--colored.Toastify__toast--info{color:var(--toastify-text-color-info);background:var(--toastify-color-info)}.Toastify__toast-theme--colored.Toastify__toast--success{color:var(--toastify-text-color-success);background:var(--toastify-color-success)}.Toastify__toast-theme--colored.Toastify__toast--warning{color:var(--toastify-text-color-warning);background:var(--toastify-color-warning)}.Toastify__toast-theme--colored.Toastify__toast--error{color:var(--toastify-text-color-error);background:var(--toastify-color-error)}.Toastify__progress-bar-theme--light{background:var(--toastify-color-progress-light)}.Toastify__progress-bar-theme--dark{background:var(--toastify-color-progress-dark)}.Toastify__progress-bar--info{background:var(--toastify-color-progress-info)}.Toastify__progress-bar--success{background:var(--toastify-color-progress-success)}.Toastify__progress-bar--warning{background:var(--toastify-color-progress-warning)}.Toastify__progress-bar--error{background:var(--toastify-color-progress-error)}.Toastify__progress-bar-theme--colored.Toastify__progress-bar--info,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--success,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--warning,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--error{background:var(--toastify-color-transparent)}.Toastify__close-button{color:#fff;position:absolute;top:6px;right:6px;background:transparent;outline:none;border:none;padding:0;cursor:pointer;opacity:.7;transition:.3s ease;z-index:1}.Toastify__toast--rtl .Toastify__close-button{left:6px;right:unset}.Toastify__close-button--light{color:#000;opacity:.3}.Toastify__close-button>svg{fill:currentColor;height:16px;width:14px}.Toastify__close-button:hover,.Toastify__close-button:focus{opacity:1}@keyframes Toastify__trackProgress{0%{transform:scaleX(1)}to{transform:scaleX(0)}}.Toastify__progress-bar{position:absolute;bottom:0;left:0;width:100%;height:100%;z-index:1;opacity:.7;transform-origin:left}.Toastify__progress-bar--animated{animation:Toastify__trackProgress linear 1 forwards}.Toastify__progress-bar--controlled{transition:transform .2s}.Toastify__progress-bar--rtl{right:0;left:initial;transform-origin:right;border-bottom-left-radius:initial}.Toastify__progress-bar--wrp{position:absolute;overflow:hidden;bottom:0;left:0;width:100%;height:5px;border-bottom-left-radius:var(--toastify-toast-bd-radius);border-bottom-right-radius:var(--toastify-toast-bd-radius)}.Toastify__progress-bar--wrp[data-hidden=true]{opacity:0}.Toastify__progress-bar--bg{opacity:var(--toastify-color-progress-bgo);width:100%;height:100%}.Toastify__spinner{width:20px;height:20px;box-sizing:border-box;border:2px solid;border-radius:100%;border-color:var(--toastify-spinner-color-empty-area);border-right-color:var(--toastify-spinner-color);animation:Toastify__spin .65s linear infinite}@keyframes Toastify__bounceInRight{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(3000px,0,0)}60%{opacity:1;transform:translate3d(-25px,0,0)}75%{transform:translate3d(10px,0,0)}90%{transform:translate3d(-5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutRight{20%{opacity:1;transform:translate3d(-20px,var(--y),0)}to{opacity:0;transform:translate3d(2000px,var(--y),0)}}@keyframes Toastify__bounceInLeft{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(-3000px,0,0)}60%{opacity:1;transform:translate3d(25px,0,0)}75%{transform:translate3d(-10px,0,0)}90%{transform:translate3d(5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutLeft{20%{opacity:1;transform:translate3d(20px,var(--y),0)}to{opacity:0;transform:translate3d(-2000px,var(--y),0)}}@keyframes Toastify__bounceInUp{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,3000px,0)}60%{opacity:1;transform:translate3d(0,-20px,0)}75%{transform:translate3d(0,10px,0)}90%{transform:translate3d(0,-5px,0)}to{transform:translateZ(0)}}@keyframes Toastify__bounceOutUp{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,-2000px,0)}}@keyframes Toastify__bounceInDown{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,-3000px,0)}60%{opacity:1;transform:translate3d(0,25px,0)}75%{transform:translate3d(0,-10px,0)}90%{transform:translate3d(0,5px,0)}to{transform:none}}@keyframes Toastify__bounceOutDown{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,2000px,0)}}.Toastify__bounce-enter--top-left,.Toastify__bounce-enter--bottom-left{animation-name:Toastify__bounceInLeft}.Toastify__bounce-enter--top-right,.Toastify__bounce-enter--bottom-right{animation-name:Toastify__bounceInRight}.Toastify__bounce-enter--top-center{animation-name:Toastify__bounceInDown}.Toastify__bounce-enter--bottom-center{animation-name:Toastify__bounceInUp}.Toastify__bounce-exit--top-left,.Toastify__bounce-exit--bottom-left{animation-name:Toastify__bounceOutLeft}.Toastify__bounce-exit--top-right,.Toastify__bounce-exit--bottom-right{animation-name:Toastify__bounceOutRight}.Toastify__bounce-exit--top-center{animation-name:Toastify__bounceOutUp}.Toastify__bounce-exit--bottom-center{animation-name:Toastify__bounceOutDown}@keyframes Toastify__zoomIn{0%{opacity:0;transform:scale3d(.3,.3,.3)}50%{opacity:1}}@keyframes Toastify__zoomOut{0%{opacity:1}50%{opacity:0;transform:translate3d(0,var(--y),0) scale3d(.3,.3,.3)}to{opacity:0}}.Toastify__zoom-enter{animation-name:Toastify__zoomIn}.Toastify__zoom-exit{animation-name:Toastify__zoomOut}@keyframes Toastify__flipIn{0%{transform:perspective(400px) rotateX(90deg);animation-timing-function:ease-in;opacity:0}40%{transform:perspective(400px) rotateX(-20deg);animation-timing-function:ease-in}60%{transform:perspective(400px) rotateX(10deg);opacity:1}80%{transform:perspective(400px) rotateX(-5deg)}to{transform:perspective(400px)}}@keyframes Toastify__flipOut{0%{transform:translate3d(0,var(--y),0) perspective(400px)}30%{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(-20deg);opacity:1}to{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(90deg);opacity:0}}.Toastify__flip-enter{animation-name:Toastify__flipIn}.Toastify__flip-exit{animation-name:Toastify__flipOut}@keyframes Toastify__slideInRight{0%{transform:translate3d(110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInLeft{0%{transform:translate3d(-110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInUp{0%{transform:translate3d(0,110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInDown{0%{transform:translate3d(0,-110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideOutRight{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(110%,var(--y),0)}}@keyframes Toastify__slideOutLeft{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(-110%,var(--y),0)}}@keyframes Toastify__slideOutDown{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,500px,0)}}@keyframes Toastify__slideOutUp{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,-500px,0)}}.Toastify__slide-enter--top-left,.Toastify__slide-enter--bottom-left{animation-name:Toastify__slideInLeft}.Toastify__slide-enter--top-right,.Toastify__slide-enter--bottom-right{animation-name:Toastify__slideInRight}.Toastify__slide-enter--top-center{animation-name:Toastify__slideInDown}.Toastify__slide-enter--bottom-center{animation-name:Toastify__slideInUp}.Toastify__slide-exit--top-left,.Toastify__slide-exit--bottom-left{animation-name:Toastify__slideOutLeft;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-right,.Toastify__slide-exit--bottom-right{animation-name:Toastify__slideOutRight;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-center{animation-name:Toastify__slideOutUp;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--bottom-center{animation-name:Toastify__slideOutDown;animation-timing-function:ease-in;animation-duration:.3s}@keyframes Toastify__spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}
`);var rc=i=>typeof i=="number"&&!isNaN(i),Vn=i=>typeof i=="string",ph=i=>typeof i=="function",mg=i=>Vn(i)||rc(i),hg=i=>k.isValidElement(i)||Vn(i)||ph(i)||rc(i),fg=1,gh=()=>`${fg++}`,ss=new Map,Ko=[],$m=new Set,vh=()=>ss.size>0,xg=(i,{containerId:r})=>{var a;return(a=ss.get(r||1))==null?void 0:a.toasts.get(i)};function pg(i,r){var a;if(r)return!!((a=ss.get(r))!=null&&a.isToastActive(i));let l=!1;return ss.forEach(o=>{o.isToastActive(i)&&(l=!0)}),l}function gg(i){if(!vh()){Ko=Ko.filter(r=>i!=null&&r.options.toastId!==i);return}if(i==null||mg(i))ss.forEach(r=>{r.removeToast(i)});else if(i&&("containerId"in i||"id"in i)){let r=ss.get(i.containerId);r?r.removeToast(i.id):ss.forEach(a=>{a.removeToast(i.id)})}}var vg=(i={})=>{ss.forEach(r=>{r.props.limit&&(!i.containerId||r.id===i.containerId)&&r.clearQueue()})};function bg(i,r){hg(i)&&(vh()||Ko.push({content:i,options:r}),ss.forEach(a=>{a.buildToast(i,r)}))}function bh(i,r){ss.forEach(a=>{(r==null||!(r!=null&&r.containerId)||r?.containerId===a.id)&&a.toggle(i,r?.id)})}function yg(i){return $m.add(i),()=>{$m.delete(i)}}function jg(i){return i&&(Vn(i.toastId)||rc(i.toastId))?i.toastId:gh()}function Yn(i,r){return bg(i,r),r.toastId}function Nl(i,r){return{...r,type:r&&r.type||i,toastId:jg(r)}}function _l(i){return(r,a)=>Yn(r,Nl(i,a))}function Te(i,r){return Yn(i,Nl("default",r))}Te.loading=(i,r)=>Yn(i,Nl("default",{isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1,...r}));function wg(i,{pending:r,error:a,success:l},o){let d;r&&(d=Vn(r)?Te.loading(r,o):Te.loading(r.render,{...o,...r}));let u={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null},h=(g,v,x)=>{if(v==null){Te.dismiss(d);return}let N={type:g,...u,...o,data:x},y=Vn(v)?{render:v}:v;return d?Te.update(d,{...N,...y}):Te(y.render,{...N,...y}),x},p=ph(i)?i():i;return p.then(g=>h("success",l,g)).catch(g=>h("error",a,g)),p}Te.promise=wg;Te.success=_l("success");Te.info=_l("info");Te.error=_l("error");Te.warning=_l("warning");Te.warn=Te.warning;Te.dark=(i,r)=>Yn(i,Nl("default",{theme:"dark",...r}));function Ng(i){gg(i)}Te.dismiss=Ng;Te.clearWaitingQueue=vg;Te.isActive=pg;Te.update=(i,r={})=>{let a=xg(i,r);if(a){let{props:l,content:o}=a,d={delay:100,...l,...r,toastId:r.toastId||i,updateId:gh()};d.toastId!==i&&(d.staleId=i);let u=d.render||o;delete d.render,Yn(u,d)}};Te.done=i=>{Te.update(i,{progress:1})};Te.onChange=yg;Te.play=i=>bh(!0,i);Te.pause=i=>bh(!1,i);function _g({onSuccess:i}){const{user:r}=Ne(),[a,l]=k.useState(!1),[o,d]=k.useState(null),[u,h]=k.useState({date:new Date().toISOString().split("T")[0],location:"",material_type:"",equipment_used:"",diesel_consumed:"",notes:""}),[p,g]=k.useState(!1),[v,x]=k.useState({rod10:0,rod9:0,rod8:0,rod7:0,rod6:0,rod5:0,rod4:0,rod3:0,rod2:0,rod1:0,rod10_set2:0,rod9_set2:0,rod8_set2:0,rod7_set2:0,rod6_set2:0,rod5_set2:0,rod4_set2:0,rod3_set2:0,rod2_set2:0,rod1_set2:0}),N=()=>{const T=[];return u.location||T.push("Location is required"),u.equipment_used||T.push("Equipment used is required"),T.length>0?(d(T.join(", ")),!1):(d(null),!0)},y=async T=>{if(T.preventDefault(),!r){d("User not authenticated");return}if(N()){l(!0),d(null);try{console.log("Current user ID:",r.id);const I={contractor_id:r.id,date:u.date,location:u.location,material_type:u.material_type||null,equipment_used:u.equipment_used,diesel_consumed:parseFloat(u.diesel_consumed)||0,notes:u.notes||null,status:"pending",rod_measurements:v,created_at:new Date().toISOString()};console.log("Submitting drilling data:",I),console.log("Checking access to drilling_records table...");const{error:C}=await z.from("drilling_records").select("*").limit(1);if(C)throw console.error("Error accessing drilling_records table:",C),new Error(`Database error: ${C.message}`);console.log("Table access successful, proceeding with insert...");const{data:D,error:R}=await z.from("drilling_records").insert([I]).select();if(console.log("Insert response:",{data:D,error:R}),R)throw console.error("Detailed error:",{message:R.message,code:R.code,details:R.details,hint:R.hint}),R;h({date:new Date().toISOString().split("T")[0],location:"",material_type:"",equipment_used:"",diesel_consumed:"",notes:""}),x({rod10:0,rod9:0,rod8:0,rod7:0,rod6:0,rod5:0,rod4:0,rod3:0,rod2:0,rod1:0,rod10_set2:0,rod9_set2:0,rod8_set2:0,rod7_set2:0,rod6_set2:0,rod5_set2:0,rod4_set2:0,rod3_set2:0,rod2_set2:0,rod1_set2:0}),i&&i()}catch(I){console.error("Error in handleSubmit:",I);let C="An unknown error occurred";I instanceof Error?(console.error("Error details:",{name:I.name,message:I.message,stack:I.stack}),C=I.message):typeof I=="string"?C=I:I&&typeof I=="object"&&(C=JSON.stringify(I)),d(`Failed to save drilling record: ${C}`),Te.error(`Failed to save: ${C}`)}finally{l(!1)}}},b=()=>Object.values(v).reduce((T,I)=>T+I,0),j=()=>{const T=()=>Object.values(v).reduce((I,C)=>I+C,0);return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-xl p-6 w-96 max-h-[90vh] overflow-y-auto",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-4",children:"Rod Measurements"}),[10,9,8,7,6,5,4,3,2,1].map(I=>e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:["Rod ",I," (feet)"]}),e.jsx("input",{type:"number",value:v[`rod${I}`],onChange:C=>x({...v,[`rod${I}`]:parseFloat(C.target.value)||0}),min:"0",step:"0.1",className:"w-full px-4 py-2 border border-slate-300 rounded-lg"})]},I)),e.jsx("div",{className:"mt-4 pt-4 border-t border-slate-200",children:e.jsxs("div",{className:"font-semibold text-slate-900",children:["Total: ",T()," feet"]})}),e.jsx("div",{className:"mt-6 flex justify-end gap-3",children:e.jsx("button",{type:"button",onClick:()=>g(!1),className:"px-4 py-2 text-slate-700 bg-slate-100 rounded-lg hover:bg-slate-200",children:"Close"})})]})})},_=()=>v.rod10_set2*10+v.rod9_set2*9+v.rod8_set2*8+v.rod7_set2*7+v.rod6_set2*6+v.rod5_set2*5+v.rod4_set2*4+v.rod3_set2*3+v.rod2_set2*2+v.rod1_set2*1;return e.jsxs("form",{onSubmit:y,className:"space-y-6",children:[o&&e.jsx("div",{className:"bg-red-50 border-l-4 border-red-500 p-4 mb-4",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(Tt,{className:"h-5 w-5 text-red-500","aria-hidden":"true"})}),e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:"text-sm text-red-700",children:o})})]})}),e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-blue-100 flex items-center justify-center",children:e.jsx(Ct,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"New Drilling Record"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Record daily drilling operations"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Date"}),e.jsx("input",{type:"date",value:u.date,onChange:T=>h({...u,date:T.target.value}),required:!0,className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Location"}),e.jsxs("select",{value:u.location,onChange:T=>h({...u,location:T.target.value}),required:!0,className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Select location"}),e.jsx("option",{value:"Site 1",children:"Site 1"}),e.jsx("option",{value:"Storage Bay",children:"Storage Bay"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Material Type"}),e.jsxs("select",{value:u.material_type,onChange:T=>h({...u,material_type:T.target.value}),required:!0,className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Select material type"}),e.jsx("option",{value:"Good Boulders",children:"Good Boulders"}),e.jsx("option",{value:"Weathered Rocks",children:"Weathered Rocks"}),e.jsx("option",{value:"Soil",children:"Soil"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Equipment Used"}),e.jsxs("select",{value:u.equipment_used,onChange:T=>h({...u,equipment_used:T.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Select equipment"}),e.jsx("option",{value:"Tractor",children:"Tractor"}),e.jsx("option",{value:"Bore",children:"Bore"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Diesel Consumed (L)"}),e.jsx("input",{type:"number",step:"0.01",value:u.diesel_consumed,onChange:T=>h({...u,diesel_consumed:T.target.value}),min:"0",className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"0.00"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Notes"}),e.jsx("textarea",{value:u.notes,onChange:T=>h({...u,notes:T.target.value}),rows:3,className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Additional notes..."})]})]}),e.jsxs("div",{className:"mt-8 border-t border-slate-200 pt-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-4",children:"Rod Measurements (10 to 1 size)"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"border border-slate-200 rounded-lg p-4",children:[e.jsx("h4",{className:"text-lg font-semibold text-blue-600 mb-4",children:"Set 1"}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:[10,9,8,7,6,5,4,3,2,1].map(T=>e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs font-medium text-slate-700 mb-1",children:[T,"ft holes (qty)"]}),e.jsx("input",{type:"number",value:v[`rod${T}`]===0?"":v[`rod${T}`],onChange:I=>x({...v,[`rod${T}`]:parseFloat(I.target.value)||0}),min:"0",step:"1",className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-sm",placeholder:"0"})]},`set1-${T}`))}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-slate-200 space-y-1",children:[e.jsxs("div",{className:"font-semibold text-slate-900",children:["Total Holes: ",b()," holes"]}),e.jsxs("div",{className:"font-semibold text-blue-600",children:["Total Feet: ",b()," ft"]})]})]}),e.jsxs("div",{className:"border border-slate-200 rounded-lg p-4",children:[e.jsx("h4",{className:"text-lg font-semibold text-emerald-600 mb-4",children:"Set 2"}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:[10,9,8,7,6,5,4,3,2,1].map(T=>e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs font-medium text-slate-700 mb-1",children:[T,"ft holes (qty)"]}),e.jsx("input",{type:"number",value:v[`rod${T}_set2`]===0?"":v[`rod${T}_set2`],onChange:I=>x({...v,[`rod${T}_set2`]:parseFloat(I.target.value)||0}),min:"0",step:"1",className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-emerald-500 text-sm",placeholder:"0"})]},`set2-${T}`))}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-slate-200 space-y-1",children:[e.jsxs("div",{className:"font-semibold text-slate-900",children:["Total Holes: ",b()," holes"]}),e.jsxs("div",{className:"font-semibold text-emerald-600",children:["Total Feet: ",_()," ft"]})]})]})]}),e.jsx("div",{className:"mt-4 p-4 bg-slate-50 rounded-lg",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-slate-600",children:"Combined Total Holes"}),e.jsxs("div",{className:"text-xl font-bold text-slate-900",children:[b()+b()," holes"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-slate-600",children:"Combined Total Feet"}),e.jsxs("div",{className:"text-xl font-bold text-slate-900",children:[(b()+_()).toFixed(1)," ft"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-slate-600",children:"Approx Production (tons)"}),e.jsxs("div",{className:"text-xl font-bold text-emerald-600",children:[((b()+_())*.8).toFixed(2)," tons"]})]})]})})]}),e.jsx("div",{className:"mt-6 flex justify-end",children:e.jsxs("button",{type:"submit",disabled:a,className:"flex items-center gap-2 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors disabled:opacity-50",children:[e.jsx(Kt,{className:"w-4 h-4"}),a?"Saving...":"Save Record"]})}),p&&e.jsx(j,{})]})}function kg(){const{user:i}=Ne(),[r,a]=k.useState([]),[l,o]=k.useState({totalHoles:0,totalDepth:0,totalDiesel:0,averageDepthPerHole:0}),[d,u]=k.useState(!0),[h,p]=k.useState(null);k.useEffect(()=>{g()},[i]);const g=async()=>{if(i){u(!0);try{const{data:x,error:N}=await z.from("drilling_records").select("*").eq("contractor_id",i.id).order("date",{ascending:!1});if(N)throw N;a(x||[]);const y=x?.reduce((T,I)=>T+I.holes_drilled,0)||0,b=x?.reduce((T,I)=>T+I.total_depth,0)||0,j=x?.reduce((T,I)=>T+I.diesel_consumed,0)||0,_=y>0?b/y:0;o({totalHoles:y,totalDepth:b,totalDiesel:j,averageDepthPerHole:_})}catch(x){console.error("Error loading records:",x)}finally{u(!1)}}},v=x=>{switch(x){case"approved":return e.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 rounded-full text-xs font-semibold bg-green-100 text-green-700",children:[e.jsx(et,{className:"w-3 h-3"}),"Approved"]});case"rejected":return e.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 rounded-full text-xs font-semibold bg-red-100 text-red-700",children:[e.jsx(rs,{className:"w-3 h-3"}),"Rejected"]});default:return e.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 rounded-full text-xs font-semibold bg-amber-100 text-amber-700",children:[e.jsx(Me,{className:"w-3 h-3"}),"Pending"]})}};return d?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-slate-600",children:"Loading drilling details..."})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-blue-100 flex items-center justify-center",children:e.jsx(Rm,{className:"w-5 h-5 text-blue-600"})}),e.jsx(ve,{className:"w-4 h-4 text-slate-400"})]}),e.jsx("p",{className:"text-2xl font-bold text-slate-900",children:l.totalHoles}),e.jsx("p",{className:"text-sm text-slate-600",children:"Total Holes Drilled"})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-emerald-100 flex items-center justify-center",children:e.jsx(Am,{className:"w-5 h-5 text-emerald-600"})}),e.jsx(Ee,{className:"w-4 h-4 text-slate-400"})]}),e.jsxs("p",{className:"text-2xl font-bold text-slate-900",children:[l.totalDepth.toFixed(1),"m"]}),e.jsx("p",{className:"text-sm text-slate-600",children:"Total Depth"})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-orange-100 flex items-center justify-center",children:e.jsx(It,{className:"w-5 h-5 text-orange-600"})}),e.jsx(ve,{className:"w-4 h-4 text-slate-400"})]}),e.jsxs("p",{className:"text-2xl font-bold text-slate-900",children:[l.totalDiesel.toFixed(1),"L"]}),e.jsx("p",{className:"text-sm text-slate-600",children:"Diesel Consumed"})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-violet-100 flex items-center justify-center",children:e.jsx(Ct,{className:"w-5 h-5 text-violet-600"})}),e.jsx(Ee,{className:"w-4 h-4 text-slate-400"})]}),e.jsxs("p",{className:"text-2xl font-bold text-slate-900",children:[l.averageDepthPerHole.toFixed(1),"m"]}),e.jsx("p",{className:"text-sm text-slate-600",children:"Avg Depth/Hole"})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-slate-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"Drilling Records"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Click on a record to view details"})]}),r.length===0?e.jsx("div",{className:"p-8 text-center text-slate-600",children:"No drilling records found. Create your first record to get started."}):e.jsx("div",{className:"divide-y divide-slate-200",children:r.map(x=>e.jsxs("div",{onClick:()=>p(h?.id===x.id?null:x),className:"p-6 hover:bg-slate-50 cursor-pointer transition-colors",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-lg bg-blue-100 flex items-center justify-center flex-shrink-0",children:e.jsx(Ct,{className:"w-6 h-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-slate-900",children:new Date(x.date).toLocaleDateString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric"})}),e.jsxs("div",{className:"flex items-center gap-1 text-sm text-slate-600 mt-0.5",children:[e.jsx(jt,{className:"w-4 h-4"}),x.location]})]})]}),v(x.status)]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-3",children:[e.jsxs("div",{className:"bg-slate-50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(Rm,{className:"w-4 h-4 text-blue-600"}),e.jsx("span",{className:"text-xs font-medium text-slate-600",children:"Holes"})]}),e.jsx("p",{className:"text-lg font-bold text-slate-900",children:x.holes_drilled})]}),e.jsxs("div",{className:"bg-slate-50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(Am,{className:"w-4 h-4 text-emerald-600"}),e.jsx("span",{className:"text-xs font-medium text-slate-600",children:"Depth"})]}),e.jsxs("p",{className:"text-lg font-bold text-slate-900",children:[x.total_depth,"m"]})]}),e.jsxs("div",{className:"bg-slate-50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(It,{className:"w-4 h-4 text-orange-600"}),e.jsx("span",{className:"text-xs font-medium text-slate-600",children:"Diesel"})]}),e.jsxs("p",{className:"text-lg font-bold text-slate-900",children:[x.diesel_consumed,"L"]})]}),e.jsxs("div",{className:"bg-slate-50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(Ct,{className:"w-4 h-4 text-violet-600"}),e.jsx("span",{className:"text-xs font-medium text-slate-600",children:"Avg/Hole"})]}),e.jsxs("p",{className:"text-lg font-bold text-slate-900",children:[(x.total_depth/x.holes_drilled).toFixed(1),"m"]})]})]}),h?.id===x.id&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-slate-200 space-y-3",children:[x.equipment_used&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(Ct,{className:"w-4 h-4 text-slate-600"}),e.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Equipment Used"})]}),e.jsx("p",{className:"text-sm text-slate-600 ml-6",children:x.equipment_used})]}),x.notes&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(rt,{className:"w-4 h-4 text-slate-600"}),e.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Notes"})]}),e.jsx("p",{className:"text-sm text-slate-600 ml-6",children:x.notes})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(ge,{className:"w-4 h-4 text-slate-600"}),e.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Submitted"})]}),e.jsx("p",{className:"text-sm text-slate-600 ml-6",children:new Date(x.created_at).toLocaleString()})]})]})]},x.id))})]})]})}function Sg({onSuccess:i}){const{user:r}=Ne(),[a,l]=k.useState(!1),[o,d]=k.useState({date:new Date().toISOString().split("T")[0],ed_nos:"",edet_nos:"",nonel_3m_nos:"",nonel_4m_nos:"",pg_nos:"",pg_unit:"boxes",material_type:"",notes:""}),u=async h=>{if(h.preventDefault(),!!r){l(!0);try{const{error:p}=await z.from("blasting_records").insert([{contractor_id:r.id,date:o.date,ed_nos:parseFloat(o.ed_nos)||0,edet_nos:parseFloat(o.edet_nos)||0,nonel_3m_nos:parseFloat(o.nonel_3m_nos)||0,nonel_4m_nos:parseFloat(o.nonel_4m_nos)||0,pg_nos:parseFloat(o.pg_nos)||0,pg_unit:o.pg_unit,material_type:o.material_type,notes:o.notes,status:"pending"}]);if(p)throw p;d({date:new Date().toISOString().split("T")[0],ed_nos:"",edet_nos:"",nonel_3m_nos:"",nonel_4m_nos:"",pg_nos:"",pg_unit:"boxes",material_type:"",notes:""}),alert("Blasting record submitted successfully!"),i&&i()}catch(p){alert("Error submitting blasting record: "+p.message)}finally{l(!1)}}};return e.jsxs("form",{onSubmit:u,className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-orange-100 flex items-center justify-center",children:e.jsx(nr,{className:"w-5 h-5 text-orange-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"New Blasting Record"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Record blasting operations"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Date"}),e.jsx("input",{type:"date",value:o.date,onChange:h=>d({...o,date:h.target.value}),required:!0,className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Material Type"}),e.jsxs("select",{value:o.material_type,onChange:h=>d({...o,material_type:h.target.value}),required:!0,className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Select material type"}),e.jsx("option",{value:"Good Boulders",children:"Good Boulders"}),e.jsx("option",{value:"Weathered Rocks",children:"Weathered Rocks"}),e.jsx("option",{value:"Soil",children:"Soil"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"ED in nos"}),e.jsx("input",{type:"number",step:"0.01",value:o.ed_nos,onChange:h=>d({...o,ed_nos:h.target.value}),required:!0,min:"0",className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent",placeholder:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"EDET in nos"}),e.jsx("input",{type:"number",step:"0.01",value:o.edet_nos,onChange:h=>d({...o,edet_nos:h.target.value}),required:!0,min:"0",className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent",placeholder:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"NONEL 3m in nos"}),e.jsx("input",{type:"number",step:"0.01",value:o.nonel_3m_nos,onChange:h=>d({...o,nonel_3m_nos:h.target.value}),required:!0,min:"0",className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent",placeholder:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"NONEL 4m in nos"}),e.jsx("input",{type:"number",step:"0.01",value:o.nonel_4m_nos,onChange:h=>d({...o,nonel_4m_nos:h.target.value}),required:!0,min:"0",className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent",placeholder:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"PG Quantity"}),e.jsx("input",{type:"number",step:"0.01",value:o.pg_nos,onChange:h=>d({...o,pg_nos:h.target.value}),required:!0,min:"0",className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent",placeholder:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"PG Unit"}),e.jsxs("select",{value:o.pg_unit,onChange:h=>d({...o,pg_unit:h.target.value}),required:!0,className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent",children:[e.jsx("option",{value:"boxes",children:"Boxes"}),e.jsx("option",{value:"nos",children:"In Nos"})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Notes"}),e.jsx("textarea",{value:o.notes,onChange:h=>d({...o,notes:h.target.value}),rows:3,className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent",placeholder:"Safety protocols followed, weather conditions, etc..."})]})]}),e.jsx("div",{className:"mt-6 flex justify-end",children:e.jsxs("button",{type:"submit",disabled:a,className:"flex items-center gap-2 px-6 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 focus:outline-none focus:ring-2 focus:ring-orange-500 focus:ring-offset-2 transition-colors disabled:opacity-50",children:[e.jsx(Kt,{className:"w-4 h-4"}),a?"Saving...":"Save Record"]})})]})}function Cg(){const{user:i}=Ne(),[r,a]=k.useState([]),[l,o]=k.useState({totalED:0,totalEDET:0,totalNONEL3m:0,totalNONEL4m:0,totalPG:0,remainingBalance:0}),[d,u]=k.useState(!0),[h,p]=k.useState(null);k.useEffect(()=>{g()},[i]);const g=async()=>{if(i){u(!0);try{const{data:x,error:N}=await z.from("blasting_records").select("*").eq("contractor_id",i.id).order("date",{ascending:!1});if(N)throw N;a(x||[]);const y=x?.reduce((C,D)=>C+D.ed_nos,0)||0,b=x?.reduce((C,D)=>C+D.edet_nos,0)||0,j=x?.reduce((C,D)=>C+(D.nonel_3m_nos||0),0)||0,_=x?.reduce((C,D)=>C+(D.nonel_4m_nos||0),0)||0,T=x?.reduce((C,D)=>C+D.pg_nos,0)||0;o({totalED:y,totalEDET:b,totalNONEL3m:j,totalNONEL4m:_,totalPG:T,remainingBalance:0})}catch(x){console.error("Error loading records:",x)}finally{u(!1)}}},v=x=>{switch(x){case"approved":return e.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 rounded-full text-xs font-semibold bg-green-100 text-green-700",children:[e.jsx(et,{className:"w-3 h-3"}),"Approved"]});case"rejected":return e.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 rounded-full text-xs font-semibold bg-red-100 text-red-700",children:[e.jsx(rs,{className:"w-3 h-3"}),"Rejected"]});default:return e.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 rounded-full text-xs font-semibold bg-amber-100 text-amber-700",children:[e.jsx(Me,{className:"w-3 h-3"}),"Pending"]})}};return d?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-slate-600",children:"Loading blasting details..."})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-6 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-orange-100 flex items-center justify-center",children:e.jsx(Qt,{className:"w-5 h-5 text-orange-600"})}),e.jsx(ve,{className:"w-4 h-4 text-slate-400"})]}),e.jsx("p",{className:"text-2xl font-bold text-slate-900",children:l.totalED.toFixed(1)}),e.jsx("p",{className:"text-sm text-slate-600",children:"Total ED"})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-red-100 flex items-center justify-center",children:e.jsx(Mm,{className:"w-5 h-5 text-red-600"})}),e.jsx(Ee,{className:"w-4 h-4 text-slate-400"})]}),e.jsx("p",{className:"text-2xl font-bold text-slate-900",children:l.totalEDET.toFixed(1)}),e.jsx("p",{className:"text-sm text-slate-600",children:"Total EDET"})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-amber-100 flex items-center justify-center",children:e.jsx(Qt,{className:"w-5 h-5 text-amber-600"})}),e.jsx(Ee,{className:"w-4 h-4 text-slate-400"})]}),e.jsx("p",{className:"text-2xl font-bold text-slate-900",children:l.totalPG.toFixed(1)}),e.jsx("p",{className:"text-sm text-slate-600",children:"Total PG"})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-purple-100 flex items-center justify-center",children:e.jsx(nr,{className:"w-5 h-5 text-purple-600"})}),e.jsx(ve,{className:"w-4 h-4 text-slate-400"})]}),e.jsx("p",{className:"text-2xl font-bold text-slate-900",children:l.totalNONEL3m.toFixed(1)}),e.jsx("p",{className:"text-sm text-slate-600",children:"NONEL 3m"})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-indigo-100 flex items-center justify-center",children:e.jsx(nr,{className:"w-5 h-5 text-indigo-600"})}),e.jsx(ve,{className:"w-4 h-4 text-slate-400"})]}),e.jsx("p",{className:"text-2xl font-bold text-slate-900",children:l.totalNONEL4m.toFixed(1)}),e.jsx("p",{className:"text-sm text-slate-600",children:"NONEL 4m"})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-green-100 flex items-center justify-center",children:e.jsx(ve,{className:"w-5 h-5 text-green-600"})}),e.jsx(Ee,{className:"w-4 h-4 text-slate-400"})]}),e.jsx("p",{className:"text-2xl font-bold text-slate-900",children:l.remainingBalance.toFixed(2)}),e.jsx("p",{className:"text-sm text-slate-600",children:"Remaining Balance"})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-slate-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"Blasting Records"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Click on a record to view details"})]}),r.length===0?e.jsx("div",{className:"p-8 text-center text-slate-600",children:"No blasting records found. Create your first record to get started."}):e.jsx("div",{className:"divide-y divide-slate-200",children:r.map(x=>e.jsxs("div",{onClick:()=>p(h?.id===x.id?null:x),className:"p-6 hover:bg-slate-50 cursor-pointer transition-colors",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-lg bg-orange-100 flex items-center justify-center flex-shrink-0",children:e.jsx(nr,{className:"w-6 h-6 text-orange-600"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-slate-900",children:new Date(x.date).toLocaleDateString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric"})}),e.jsxs("div",{className:"flex items-center gap-1 text-sm text-slate-600 mt-0.5",children:[e.jsx(jt,{className:"w-4 h-4"}),x.location]}),x.material_type&&e.jsx("div",{className:"mt-1",children:e.jsx("span",{className:"inline-block px-2 py-0.5 text-xs font-semibold rounded bg-slate-100 text-slate-700",children:x.material_type})})]})]}),v(x.status)]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4 mb-3",children:[e.jsxs("div",{className:"bg-slate-50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(Qt,{className:"w-4 h-4 text-orange-600"}),e.jsx("span",{className:"text-xs font-medium text-slate-600",children:"ED"})]}),e.jsx("p",{className:"text-lg font-bold text-slate-900",children:x.ed_nos})]}),e.jsxs("div",{className:"bg-slate-50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(Mm,{className:"w-4 h-4 text-red-600"}),e.jsx("span",{className:"text-xs font-medium text-slate-600",children:"EDET"})]}),e.jsx("p",{className:"text-lg font-bold text-slate-900",children:x.edet_nos})]}),e.jsxs("div",{className:"bg-slate-50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(nr,{className:"w-4 h-4 text-purple-600"}),e.jsx("span",{className:"text-xs font-medium text-slate-600",children:"NONEL 3m"})]}),e.jsx("p",{className:"text-lg font-bold text-slate-900",children:x.nonel_3m_nos||0})]}),e.jsxs("div",{className:"bg-slate-50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(nr,{className:"w-4 h-4 text-indigo-600"}),e.jsx("span",{className:"text-xs font-medium text-slate-600",children:"NONEL 4m"})]}),e.jsx("p",{className:"text-lg font-bold text-slate-900",children:x.nonel_4m_nos||0})]}),e.jsxs("div",{className:"bg-slate-50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(Qt,{className:"w-4 h-4 text-amber-600"}),e.jsxs("span",{className:"text-xs font-medium text-slate-600",children:["PG (",x.pg_unit||"boxes",")"]})]}),e.jsx("p",{className:"text-lg font-bold text-slate-900",children:x.pg_nos})]})]}),h?.id===x.id&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-slate-200 space-y-3",children:[x.notes&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(rt,{className:"w-4 h-4 text-slate-600"}),e.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Notes"})]}),e.jsx("p",{className:"text-sm text-slate-600 ml-6",children:x.notes})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(ge,{className:"w-4 h-4 text-slate-600"}),e.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Submitted"})]}),e.jsx("p",{className:"text-sm text-slate-600 ml-6",children:new Date(x.created_at).toLocaleString()})]})]})]},x.id))})]})]})}const Tg=["KVSS Good Boulders","KVSS Weather Rocks","KVSS Soil","SBBM Slurry Work","SBBM Stockyard Good Boulders","Others"],Eg=["EX140","120"],Pg=["Breaker","Bucket"];function Dg({onSuccess:i}){const{user:r}=Ne(),[a,l]=k.useState(!1),[o,d]=k.useState({date:new Date().toISOString().split("T")[0],material_type:"",vehicle_used:"",vehicle_owner_name:"",destination:"",breaker_bucket:"",starting_hours:"",ending_hours:"",notes:""}),u=async h=>{if(h.preventDefault(),!!r){l(!0);try{const{error:p}=await z.from("loading_records").insert([{contractor_id:r.id,date:o.date,material_type:o.material_type,vehicle_used:o.vehicle_used,vehicle_owner_name:o.vehicle_owner_name,destination:o.destination,breaker_bucket:o.breaker_bucket,starting_hours:parseFloat(o.starting_hours)||0,ending_hours:parseFloat(o.ending_hours)||0,status:"pending"}]);if(p)throw p;d({date:new Date().toISOString().split("T")[0],material_type:"",vehicle_used:"",vehicle_owner_name:"",destination:"",breaker_bucket:"",starting_hours:"",ending_hours:"",notes:""}),alert("Breaking/Loading record submitted successfully!"),i&&i()}catch(p){alert("Error submitting loading record: "+p.message)}finally{l(!1)}}};return e.jsxs("form",{onSubmit:u,className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-green-100 flex items-center justify-center",children:e.jsx(dt,{className:"w-5 h-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"New Breaking/Loading Record"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Track material breaking and loading operations"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Date"}),e.jsx("input",{type:"date",value:o.date,onChange:h=>d({...o,date:h.target.value}),required:!0,className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Material Type"}),e.jsxs("select",{value:o.material_type,onChange:h=>d({...o,material_type:h.target.value}),required:!0,className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Select material"}),Tg.map(h=>e.jsx("option",{value:h,children:h},h))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Vehicle Used"}),e.jsxs("select",{value:o.vehicle_used,onChange:h=>d({...o,vehicle_used:h.target.value}),required:!0,className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Select vehicle"}),Eg.map(h=>e.jsx("option",{value:h,children:h},h))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Vehicle Owner Name"}),e.jsx("input",{type:"text",value:o.vehicle_owner_name,onChange:h=>d({...o,vehicle_owner_name:h.target.value}),required:!0,className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"Enter vehicle owner name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Destination"}),e.jsx("input",{type:"text",value:o.destination,onChange:h=>d({...o,destination:h.target.value}),required:!0,className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"Enter destination location"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Breaker/Bucket"}),e.jsxs("select",{value:o.breaker_bucket,onChange:h=>d({...o,breaker_bucket:h.target.value}),required:!0,className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Select option"}),Pg.map(h=>e.jsx("option",{value:h,children:h},h))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Starting Hours"}),e.jsx("input",{type:"number",step:"0.1",value:o.starting_hours,onChange:h=>d({...o,starting_hours:h.target.value}),required:!0,min:"0",className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"Enter hours"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Ending Hours"}),e.jsx("input",{type:"number",step:"0.1",value:o.ending_hours,onChange:h=>d({...o,ending_hours:h.target.value}),required:!0,min:"0",className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"Enter hours"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Notes"}),e.jsx("textarea",{value:o.notes,onChange:h=>d({...o,notes:h.target.value}),rows:3,className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"Loading conditions, special instructions, etc..."})]})]}),e.jsx("div",{className:"mt-6 flex justify-end",children:e.jsxs("button",{type:"submit",disabled:a,className:"flex items-center gap-2 px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transition-colors disabled:opacity-50",children:[e.jsx(Kt,{className:"w-4 h-4"}),a?"Saving...":"Save Record"]})})]})}function Og(){const{user:i}=Ne(),[r,a]=k.useState([]),[l,o]=k.useState({totalHoursWork:0,uniqueOwners:0,uniqueVehicleTypes:0}),[d,u]=k.useState(!0),[h,p]=k.useState(null);k.useEffect(()=>{g()},[i]);const g=async()=>{if(i){u(!0);try{const{data:x,error:N}=await z.from("loading_records").select("*").eq("contractor_id",i.id).order("date",{ascending:!1});if(N)throw N;a(x||[]);const y=x?.reduce((_,T)=>{const I=(T.ending_hours||0)-(T.starting_hours||0);return _+(I>0?I:0)},0)||0,b=new Set(x?.map(_=>_.vehicle_owner_name).filter(Boolean)).size,j=new Set(x?.map(_=>_.vehicle_used).filter(Boolean)).size;o({totalHoursWork:y,uniqueOwners:b,uniqueVehicleTypes:j})}catch(x){console.error("Error loading records:",x)}finally{u(!1)}}},v=x=>{switch(x){case"approved":return e.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 rounded-full text-xs font-semibold bg-green-100 text-green-700",children:[e.jsx(et,{className:"w-3 h-3"}),"Approved"]});case"rejected":return e.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 rounded-full text-xs font-semibold bg-red-100 text-red-700",children:[e.jsx(rs,{className:"w-3 h-3"}),"Rejected"]});default:return e.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 rounded-full text-xs font-semibold bg-amber-100 text-amber-700",children:[e.jsx(Me,{className:"w-3 h-3"}),"Pending"]})}};return d?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-slate-600",children:"Loading breaking/loading details..."})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-blue-100 flex items-center justify-center",children:e.jsx(Me,{className:"w-5 h-5 text-blue-600"})}),e.jsx(Ee,{className:"w-4 h-4 text-slate-400"})]}),e.jsxs("p",{className:"text-2xl font-bold text-slate-900",children:[l.totalHoursWork.toFixed(1)," hrs"]}),e.jsx("p",{className:"text-sm text-slate-600",children:"Total Hours Work"})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-amber-100 flex items-center justify-center",children:e.jsx(Ae,{className:"w-5 h-5 text-amber-600"})}),e.jsx(ve,{className:"w-4 h-4 text-slate-400"})]}),e.jsx("p",{className:"text-2xl font-bold text-slate-900",children:l.uniqueVehicleTypes}),e.jsx("p",{className:"text-sm text-slate-600",children:"Vehicle Types Used"})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-violet-100 flex items-center justify-center",children:e.jsx(Yp,{className:"w-5 h-5 text-violet-600"})}),e.jsx(Ee,{className:"w-4 h-4 text-slate-400"})]}),e.jsx("p",{className:"text-2xl font-bold text-slate-900",children:l.uniqueOwners}),e.jsx("p",{className:"text-sm text-slate-600",children:"Unique Vehicle Owners"})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-slate-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"Breaking/Loading Records"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Click on a record to view details"})]}),r.length===0?e.jsx("div",{className:"p-8 text-center text-slate-600",children:"No breaking/loading records found. Create your first record to get started."}):e.jsx("div",{className:"divide-y divide-slate-200",children:r.map(x=>e.jsxs("div",{onClick:()=>p(h?.id===x.id?null:x),className:"p-6 hover:bg-slate-50 cursor-pointer transition-colors",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-lg bg-green-100 flex items-center justify-center flex-shrink-0",children:e.jsx(dt,{className:"w-6 h-6 text-green-600"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-slate-900",children:new Date(x.date).toLocaleDateString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric"})}),e.jsxs("div",{className:"flex items-center gap-1 text-sm text-slate-600 mt-0.5",children:[e.jsx(Ae,{className:"w-4 h-4"}),x.material_type]})]})]}),v(x.status)]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4 mb-3",children:[e.jsxs("div",{className:"bg-slate-50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(Ae,{className:"w-4 h-4 text-green-600"}),e.jsx("span",{className:"text-xs font-medium text-slate-600",children:"Vehicle Used"})]}),e.jsx("p",{className:"text-lg font-bold text-slate-900",children:x.vehicle_used||"N/A"})]}),e.jsxs("div",{className:"bg-slate-50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(dt,{className:"w-4 h-4 text-blue-600"}),e.jsx("span",{className:"text-xs font-medium text-slate-600",children:"Owner"})]}),e.jsx("p",{className:"text-lg font-bold text-slate-900",children:x.vehicle_owner_name||"N/A"})]}),e.jsxs("div",{className:"bg-slate-50 rounded-lg p-3 md:col-span-1 col-span-2",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(zn,{className:"w-4 h-4 text-violet-600"}),e.jsx("span",{className:"text-xs font-medium text-slate-600",children:"Destination"})]}),e.jsx("p",{className:"text-lg font-bold text-slate-900 truncate",children:x.destination})]})]}),h?.id===x.id&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-slate-200 space-y-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(zn,{className:"w-4 h-4 text-slate-600"}),e.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Full Destination"})]}),e.jsx("p",{className:"text-sm text-slate-600 ml-6",children:x.destination})]}),x.breaker_bucket&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(Ae,{className:"w-4 h-4 text-slate-600"}),e.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Breaker/Bucket"})]}),e.jsx("p",{className:"text-sm text-slate-600 ml-6",children:x.breaker_bucket})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(Me,{className:"w-4 h-4 text-slate-600"}),e.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Starting Hours"})]}),e.jsxs("p",{className:"text-sm text-slate-600 ml-6",children:[x.starting_hours||0," hrs"]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(Me,{className:"w-4 h-4 text-slate-600"}),e.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Ending Hours"})]}),e.jsxs("p",{className:"text-sm text-slate-600 ml-6",children:[x.ending_hours||0," hrs"]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(ge,{className:"w-4 h-4 text-slate-600"}),e.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Submitted"})]}),e.jsx("p",{className:"text-sm text-slate-600 ml-6",children:new Date(x.created_at).toLocaleString()})]})]})]},x.id))})]})]})}const Rg=["Truck","Tractor"],Lg=["Good Boulders","Weather Rocks","Soil","Aggregate's Rehandling"],yh=["Quarry","Stockyard","Crusher"],Ig=i=>{if(!i)return yh;switch(i){case"Quarry":return["Stockyard","Crusher"];case"Stockyard":return["Crusher"];case"Crusher":return[];default:return[]}};function Ag({onSuccess:i}){const{user:r}=Ne(),[a,l]=k.useState(!1),[o,d]=k.useState({date:new Date().toISOString().split("T")[0],vehicle_type:"",from_location:"",to_location:"",distance_km:"",fuel_consumed:"",material_transported:"",quantity:"",notes:""}),u=g=>{d(g==="Aggregate's Rehandling"?v=>({...v,material_transported:g,from_location:"Crusher",to_location:"Crusher"}):v=>({...v,material_transported:g,from_location:v.from_location==="Crusher"?"":v.from_location,to_location:v.to_location==="Crusher"?"":v.to_location}))},h=g=>{o.material_transported!=="Aggregate's Rehandling"&&d({...o,from_location:g,to_location:""})},p=async g=>{if(g.preventDefault(),!!r){l(!0);try{const{error:v}=await z.from("transport_records").insert([{contractor_id:r.id,date:o.date,vehicle_type:o.vehicle_type,from_location:o.from_location,to_location:o.to_location,distance_km:parseFloat(o.distance_km)||0,fuel_consumed:parseFloat(o.fuel_consumed)||0,material_transported:o.material_transported,quantity:parseFloat(o.quantity)||0,notes:o.notes,status:"pending"}]);if(v)throw v;d({date:new Date().toISOString().split("T")[0],vehicle_type:"",from_location:"",to_location:"",distance_km:"",fuel_consumed:"",material_transported:"",quantity:"",notes:""}),alert("Transport record submitted successfully!"),i&&i()}catch(v){alert("Error submitting transport record: "+v.message)}finally{l(!1)}}};return e.jsxs("form",{onSubmit:p,className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-purple-100 flex items-center justify-center",children:e.jsx(dt,{className:"w-5 h-5 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"New Transport Record"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Track vehicle and material transport"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Date"}),e.jsx("input",{type:"date",value:o.date,onChange:g=>d({...o,date:g.target.value}),required:!0,className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Vehicle Type"}),e.jsxs("select",{value:o.vehicle_type,onChange:g=>d({...o,vehicle_type:g.target.value}),required:!0,className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Select vehicle type"}),Rg.map(g=>e.jsx("option",{value:g,children:g},g))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Material Transported *"}),e.jsxs("select",{value:o.material_transported,onChange:g=>u(g.target.value),required:!0,className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Select material type"}),Lg.map(g=>e.jsx("option",{value:g,children:g},g))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"From Location *"}),e.jsxs("select",{value:o.from_location,onChange:g=>h(g.target.value),required:!0,disabled:o.material_transported==="Aggregate's Rehandling",className:`w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent ${o.material_transported==="Aggregate's Rehandling"?"bg-gray-100":""}`,children:[e.jsx("option",{value:"",children:"Select source location"}),yh.map(g=>e.jsx("option",{value:g,children:g},`from-${g}`))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"To Location *"}),e.jsxs("select",{value:o.to_location,onChange:g=>d({...o,to_location:g.target.value}),required:!0,disabled:!o.from_location||o.material_transported==="Aggregate's Rehandling",className:`w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent ${!o.from_location||o.material_transported==="Aggregate's Rehandling"?"opacity-50 cursor-not-allowed":""}`,children:[e.jsx("option",{value:"",children:o.material_transported==="Aggregate's Rehandling"?"Crusher to Crusher (auto-set)":o.from_location?"Select destination":"Select source location first"}),Ig(o.from_location).map(g=>e.jsx("option",{value:g,children:g},`to-${g}`))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Distance (km)"}),e.jsx("input",{type:"number",step:"0.1",value:o.distance_km,onChange:g=>d({...o,distance_km:g.target.value}),min:"0",className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"0.0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Fuel Consumed (liters)"}),e.jsx("input",{type:"number",step:"0.1",value:o.fuel_consumed,onChange:g=>d({...o,fuel_consumed:g.target.value}),min:"0",className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"0.0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Quantity (tons)"}),e.jsx("input",{type:"number",step:"0.01",value:o.quantity,onChange:g=>d({...o,quantity:g.target.value}),min:"0",className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"0.00"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Notes"}),e.jsx("textarea",{value:o.notes,onChange:g=>d({...o,notes:g.target.value}),rows:3,className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"Trip details, route conditions, etc..."})]})]}),e.jsx("div",{className:"mt-6 flex justify-end",children:e.jsxs("button",{type:"submit",disabled:a,className:"flex items-center gap-2 px-6 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2 transition-colors disabled:opacity-50",children:[e.jsx(Kt,{className:"w-4 h-4"}),a?"Saving...":"Save Record"]})})]})}function Mg(){const{user:i}=Ne(),[r,a]=k.useState([]),[l,o]=k.useState({totalDistance:0,totalFuel:0,totalQuantity:0,totalTrips:0}),[d,u]=k.useState(!0),[h,p]=k.useState(null);k.useEffect(()=>{g()},[i]);const g=async()=>{if(i){u(!0);try{const{data:x,error:N}=await z.from("transport_records").select("*").eq("contractor_id",i.id).order("date",{ascending:!1});if(N)throw N;a(x||[]);const y=x?.reduce((T,I)=>T+I.distance_km,0)||0,b=x?.reduce((T,I)=>T+I.fuel_consumed,0)||0,j=x?.reduce((T,I)=>T+I.quantity,0)||0,_=x?.length||0;o({totalDistance:y,totalFuel:b,totalQuantity:j,totalTrips:_})}catch(x){console.error("Error loading records:",x)}finally{u(!1)}}},v=x=>{switch(x){case"approved":return e.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 rounded-full text-xs font-semibold bg-green-100 text-green-700",children:[e.jsx(et,{className:"w-3 h-3"}),"Approved"]});case"rejected":return e.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 rounded-full text-xs font-semibold bg-red-100 text-red-700",children:[e.jsx(rs,{className:"w-3 h-3"}),"Rejected"]});default:return e.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 rounded-full text-xs font-semibold bg-amber-100 text-amber-700",children:[e.jsx(Me,{className:"w-3 h-3"}),"Pending"]})}};return d?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-slate-600",children:"Loading transport details..."})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-purple-100 flex items-center justify-center",children:e.jsx(zn,{className:"w-5 h-5 text-purple-600"})}),e.jsx(ve,{className:"w-4 h-4 text-slate-400"})]}),e.jsxs("p",{className:"text-2xl font-bold text-slate-900",children:[l.totalDistance.toFixed(1)," km"]}),e.jsx("p",{className:"text-sm text-slate-600",children:"Total Distance"})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-red-100 flex items-center justify-center",children:e.jsx(It,{className:"w-5 h-5 text-red-600"})}),e.jsx(Ee,{className:"w-4 h-4 text-slate-400"})]}),e.jsxs("p",{className:"text-2xl font-bold text-slate-900",children:[l.totalFuel.toFixed(1)," L"]}),e.jsx("p",{className:"text-sm text-slate-600",children:"Total Fuel"})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-blue-100 flex items-center justify-center",children:e.jsx(Ae,{className:"w-5 h-5 text-blue-600"})}),e.jsx(ve,{className:"w-4 h-4 text-slate-400"})]}),e.jsxs("p",{className:"text-2xl font-bold text-slate-900",children:[l.totalQuantity.toFixed(1)," tons"]}),e.jsx("p",{className:"text-sm text-slate-600",children:"Material Transported"})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-green-100 flex items-center justify-center",children:e.jsx(dt,{className:"w-5 h-5 text-green-600"})}),e.jsx(Ee,{className:"w-4 h-4 text-slate-400"})]}),e.jsx("p",{className:"text-2xl font-bold text-slate-900",children:l.totalTrips}),e.jsx("p",{className:"text-sm text-slate-600",children:"Total Trips"})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-slate-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"Transport Records"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Click on a record to view details"})]}),r.length===0?e.jsx("div",{className:"p-8 text-center text-slate-600",children:"No transport records found. Create your first record to get started."}):e.jsx("div",{className:"divide-y divide-slate-200",children:r.map(x=>e.jsxs("div",{onClick:()=>p(h?.id===x.id?null:x),className:"p-6 hover:bg-slate-50 cursor-pointer transition-colors",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-lg bg-purple-100 flex items-center justify-center flex-shrink-0",children:e.jsx(dt,{className:"w-6 h-6 text-purple-600"})}),e.jsxs("div",{children:[e.jsxs("h4",{className:"font-semibold text-slate-900",children:[x.vehicle_number," - ",x.vehicle_type]}),e.jsxs("div",{className:"flex items-center gap-1 text-sm text-slate-600 mt-0.5",children:[e.jsx(ge,{className:"w-4 h-4"}),new Date(x.date).toLocaleDateString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric"})]})]})]}),v(x.status)]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-slate-50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(jt,{className:"w-4 h-4 text-slate-600"}),e.jsx("span",{className:"text-xs font-medium text-slate-600",children:"From"})]}),e.jsx("p",{className:"text-sm font-bold text-slate-900 truncate",children:x.from_location})]}),e.jsxs("div",{className:"bg-slate-50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(zn,{className:"w-4 h-4 text-slate-600"}),e.jsx("span",{className:"text-xs font-medium text-slate-600",children:"To"})]}),e.jsx("p",{className:"text-sm font-bold text-slate-900 truncate",children:x.to_location})]}),e.jsxs("div",{className:"bg-slate-50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(zn,{className:"w-4 h-4 text-purple-600"}),e.jsx("span",{className:"text-xs font-medium text-slate-600",children:"Distance"})]}),e.jsxs("p",{className:"text-sm font-bold text-slate-900",children:[x.distance_km," km"]})]}),e.jsxs("div",{className:"bg-slate-50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(It,{className:"w-4 h-4 text-red-600"}),e.jsx("span",{className:"text-xs font-medium text-slate-600",children:"Fuel"})]}),e.jsxs("p",{className:"text-sm font-bold text-slate-900",children:[x.fuel_consumed," L"]})]})]}),h?.id===x.id&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-slate-200 space-y-3",children:[x.material_transported&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(Ae,{className:"w-4 h-4 text-slate-600"}),e.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Material"})]}),e.jsxs("p",{className:"text-sm text-slate-600 ml-6",children:[x.material_transported," - ",x.quantity," tons"]})]}),x.notes&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(ge,{className:"w-4 h-4 text-slate-600"}),e.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Notes"})]}),e.jsx("p",{className:"text-sm text-slate-600 ml-6",children:x.notes})]})]})]},x.id))})]})]})}const Fg=["Drilling","Blasting","Breaking/Loading","Transport","Maintenance","Site Preparation","Other"],$g=["Quarry","Crusher","Production"];function qg({onSuccess:i}){const{user:r}=Ne(),[a,l]=k.useState(!1),[o,d]=k.useState([]),[u,h]=k.useState([]),[p,g]=k.useState(!1),[v,x]=k.useState(""),[N,y]=k.useState(""),[b,j]=k.useState({date:new Date().toISOString().split("T")[0],check_in:new Date().toTimeString().slice(0,5),check_out:"",location:"",work_type:"",notes:""});k.useEffect(()=>{_()},[]);const _=async()=>{try{const{data:D,error:R}=await z.from("workers").select("*").eq("is_active",!0).order("name",{ascending:!0});if(R)throw R;d(D||[])}catch(D){console.error("Error loading workers:",D)}},T=k.useCallback(async()=>{if(v.trim())try{const{data:D,error:R}=await z.from("workers").insert([{name:v.trim(),employee_id:N.trim()||null,is_active:!0}]).select().single();if(R)throw R;d([...o,D]),h([...u,D.id]),x(""),y(""),g(!1),alert("Worker added successfully!")}catch(D){alert("Error adding worker: "+D.message)}},[v,N,o,u]),I=k.useCallback(D=>{u.includes(D)?h(u.filter(R=>R!==D)):h([...u,D])},[u]),C=async D=>{if(D.preventDefault(),!!r){if(b.check_out){const R=new Date(`${b.date}T${b.check_in}`);if(new Date(`${b.date}T${b.check_out}`)<=R){alert("Check-out time must be after check-in time");return}}if(u.length===0){alert("Please select at least one worker");return}l(!0);try{const R=new Date(`${b.date}T${b.check_in}:00`).toISOString(),F=b.check_out?new Date(`${b.date}T${b.check_out}:00`).toISOString():null,ae=o.filter(He=>u.includes(He.id)).map(He=>He.name),{error:_e}=await z.from("attendance_records").insert([{user_id:r.id,date:b.date,check_in:R,check_out:F,location:b.location,work_type:b.work_type,notes:b.notes,status:"present",worker_ids:u,number_of_workers:u.length,worker_names:ae}]);if(_e)throw _e;j({date:new Date().toISOString().split("T")[0],check_in:new Date().toTimeString().slice(0,5),check_out:"",location:"",work_type:"",notes:""}),h([]),alert("Attendance record submitted successfully!"),i&&i()}catch(R){alert("Error submitting attendance record: "+R.message)}finally{l(!1)}}};return e.jsxs("form",{onSubmit:C,className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-blue-100 flex items-center justify-center",children:e.jsx(Me,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"New Attendance Record"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Record daily attendance and work hours"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Date"}),e.jsx("input",{type:"date",value:b.date,onChange:D=>j({...b,date:D.target.value}),required:!0,className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Location *"}),e.jsxs("select",{value:b.location,onChange:D=>j({...b,location:D.target.value}),required:!0,className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Select location"}),$g.map(D=>e.jsx("option",{value:D,children:D},D))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Check In Time"}),e.jsx("input",{type:"time",value:b.check_in,onChange:D=>j({...b,check_in:D.target.value}),required:!0,className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Check Out Time"}),e.jsx("input",{type:"time",value:b.check_out,onChange:D=>j({...b,check_out:D.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Work Type"}),e.jsxs("select",{value:b.work_type,onChange:D=>j({...b,work_type:D.target.value}),required:!0,className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Select work type"}),Fg.map(D=>e.jsx("option",{value:D,children:D},D))]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700",children:["Workers (",u.length," selected)"]}),e.jsxs("button",{type:"button",onClick:()=>g(!p),className:"flex items-center gap-1 text-sm text-blue-600 hover:text-blue-700 font-medium",children:[e.jsx(ar,{className:"w-4 h-4"}),"Add New Worker"]})]}),p&&e.jsxs("div",{className:"mb-4 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-700 mb-1",children:"Worker Name *"}),e.jsx("input",{type:"text",value:v,onChange:D=>x(D.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter worker name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-700 mb-1",children:"Employee ID (optional)"}),e.jsx("input",{type:"text",value:N,onChange:D=>y(D.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g., EMP-001"})]})]}),e.jsxs("div",{className:"flex gap-2 mt-3",children:[e.jsxs("button",{type:"button",onClick:T,disabled:!v.trim(),className:"flex items-center gap-1 px-4 py-2 bg-blue-600 text-white rounded-lg text-sm font-medium hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(ar,{className:"w-4 h-4"}),"Add Worker"]}),e.jsx("button",{type:"button",onClick:()=>{g(!1),x(""),y("")},className:"px-4 py-2 bg-slate-200 text-slate-700 rounded-lg text-sm font-medium hover:bg-slate-300",children:"Cancel"})]})]}),e.jsx("div",{className:"border border-slate-300 rounded-lg p-4 max-h-64 overflow-y-auto",children:o.length===0?e.jsx("p",{className:"text-sm text-slate-600 text-center py-4",children:"No workers found. Add your first worker above."}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-2",children:o.map(D=>e.jsxs("label",{className:`flex items-center gap-2 p-3 rounded-lg border-2 cursor-pointer transition-colors ${u.includes(D.id)?"border-blue-500 bg-blue-50":"border-slate-200 hover:border-slate-300"}`,children:[e.jsx("input",{type:"checkbox",checked:u.includes(D.id),onChange:()=>I(D.id),className:"w-4 h-4 text-blue-600 rounded focus:ring-2 focus:ring-blue-500"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-slate-900 truncate",children:D.name}),D.employee_id&&e.jsx("p",{className:"text-xs text-slate-600 truncate",children:D.employee_id})]})]},D.id))})})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Notes"}),e.jsx("textarea",{value:b.notes,onChange:D=>j({...b,notes:D.target.value}),rows:3,className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Work activities, overtime, special tasks..."})]})]}),e.jsx("div",{className:"mt-6 flex justify-end",children:e.jsxs("button",{type:"submit",disabled:a||u.length===0,className:"flex items-center gap-2 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(Kt,{className:"w-4 h-4"}),a?"Saving...":"Save Record"]})})]})}function Ug(){const{user:i}=Ne(),[r,a]=k.useState([]),[l,o]=k.useState({totalDays:0,totalHours:0,averageHours:0,thisMonth:0,totalWorkers:0,averageWorkersPerDay:0}),[d,u]=k.useState(!0),[h,p]=k.useState(null);k.useEffect(()=>{g()},[i]);const g=async()=>{if(i){u(!0);try{const{data:x,error:N}=await z.from("attendance_records").select("*").eq("user_id",i.id).order("date",{ascending:!1});if(N)throw N;a(x||[]);let y=0;const b=new Date().getMonth();let j=0,_=0;x?.forEach(R=>{if(R.check_in&&R.check_out){const H=new Date(R.check_in),_e=(new Date(R.check_out).getTime()-H.getTime())/(1e3*60*60);y+=_e}new Date(R.date).getMonth()===b&&j++,R.number_of_workers&&(_+=R.number_of_workers)});const T=x?.length||0,I=T>0?y/T:0,C=T>0?_/T:0,D=new Set;x?.forEach(R=>{R.worker_ids&&Array.isArray(R.worker_ids)&&R.worker_ids.forEach(F=>D.add(F))}),o({totalDays:T,totalHours:y,averageHours:I,thisMonth:j,totalWorkers:D.size,averageWorkersPerDay:C})}catch(x){console.error("Error loading records:",x)}finally{u(!1)}}},v=(x,N)=>{if(!N)return"In Progress";const y=new Date(x);return`${((new Date(N).getTime()-y.getTime())/(1e3*60*60)).toFixed(1)} hrs`};return d?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-slate-600",children:"Loading attendance details..."})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-blue-100 flex items-center justify-center",children:e.jsx(ge,{className:"w-5 h-5 text-blue-600"})}),e.jsx(ve,{className:"w-4 h-4 text-slate-400"})]}),e.jsx("p",{className:"text-2xl font-bold text-slate-900",children:l.totalDays}),e.jsx("p",{className:"text-sm text-slate-600",children:"Total Days"})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-green-100 flex items-center justify-center",children:e.jsx(Me,{className:"w-5 h-5 text-green-600"})}),e.jsx(Ee,{className:"w-4 h-4 text-slate-400"})]}),e.jsx("p",{className:"text-2xl font-bold text-slate-900",children:l.totalHours.toFixed(1)}),e.jsx("p",{className:"text-sm text-slate-600",children:"Total Hours"})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-amber-100 flex items-center justify-center",children:e.jsx(Ee,{className:"w-5 h-5 text-amber-600"})}),e.jsx(ve,{className:"w-4 h-4 text-slate-400"})]}),e.jsx("p",{className:"text-2xl font-bold text-slate-900",children:l.averageHours.toFixed(1)}),e.jsx("p",{className:"text-sm text-slate-600",children:"Avg Hours/Day"})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-purple-100 flex items-center justify-center",children:e.jsx(ge,{className:"w-5 h-5 text-purple-600"})}),e.jsx(Ee,{className:"w-4 h-4 text-slate-400"})]}),e.jsx("p",{className:"text-2xl font-bold text-slate-900",children:l.thisMonth}),e.jsx("p",{className:"text-sm text-slate-600",children:"This Month"})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-cyan-100 flex items-center justify-center",children:e.jsx(ft,{className:"w-5 h-5 text-cyan-600"})}),e.jsx(ve,{className:"w-4 h-4 text-slate-400"})]}),e.jsx("p",{className:"text-2xl font-bold text-slate-900",children:l.totalWorkers}),e.jsx("p",{className:"text-sm text-slate-600",children:"Total Workers"})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-pink-100 flex items-center justify-center",children:e.jsx(ft,{className:"w-5 h-5 text-pink-600"})}),e.jsx(Ee,{className:"w-4 h-4 text-slate-400"})]}),e.jsx("p",{className:"text-2xl font-bold text-slate-900",children:l.averageWorkersPerDay.toFixed(1)}),e.jsx("p",{className:"text-sm text-slate-600",children:"Avg Workers/Day"})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-slate-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"Attendance Records"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Click on a record to view details"})]}),r.length===0?e.jsx("div",{className:"p-8 text-center text-slate-600",children:"No attendance records found. Create your first record to get started."}):e.jsx("div",{className:"divide-y divide-slate-200",children:r.map(x=>e.jsxs("div",{onClick:()=>p(h?.id===x.id?null:x),className:"p-6 hover:bg-slate-50 cursor-pointer transition-colors",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-lg bg-blue-100 flex items-center justify-center flex-shrink-0",children:e.jsx(Me,{className:"w-6 h-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-slate-900",children:new Date(x.date).toLocaleDateString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric"})}),e.jsxs("div",{className:"flex items-center gap-1 text-sm text-slate-600 mt-0.5",children:[e.jsx(jt,{className:"w-4 h-4"}),x.location]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 rounded-full text-xs font-semibold bg-cyan-100 text-cyan-700",children:[e.jsx(ft,{className:"w-3 h-3"}),x.number_of_workers||0," Workers"]}),e.jsx("span",{className:"inline-flex items-center gap-1 px-3 py-1 rounded-full text-xs font-semibold bg-green-100 text-green-700",children:x.status})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-slate-50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(Me,{className:"w-4 h-4 text-green-600"}),e.jsx("span",{className:"text-xs font-medium text-slate-600",children:"Check In"})]}),e.jsx("p",{className:"text-sm font-bold text-slate-900",children:new Date(x.check_in).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})})]}),e.jsxs("div",{className:"bg-slate-50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(Me,{className:"w-4 h-4 text-red-600"}),e.jsx("span",{className:"text-xs font-medium text-slate-600",children:"Check Out"})]}),e.jsx("p",{className:"text-sm font-bold text-slate-900",children:x.check_out?new Date(x.check_out).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}):"-"})]}),e.jsxs("div",{className:"bg-slate-50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(Om,{className:"w-4 h-4 text-blue-600"}),e.jsx("span",{className:"text-xs font-medium text-slate-600",children:"Hours"})]}),e.jsx("p",{className:"text-sm font-bold text-slate-900",children:v(x.check_in,x.check_out)})]})]}),h?.id===x.id&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-slate-200 space-y-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(Om,{className:"w-4 h-4 text-slate-600"}),e.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Work Type"})]}),e.jsx("p",{className:"text-sm text-slate-600 ml-6",children:x.work_type})]}),x.worker_names&&x.worker_names.length>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(ft,{className:"w-4 h-4 text-slate-600"}),e.jsxs("span",{className:"text-sm font-medium text-slate-700",children:["Workers (",x.worker_names.length,")"]})]}),e.jsx("div",{className:"ml-6 flex flex-wrap gap-2",children:x.worker_names.map((N,y)=>e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-md text-xs font-medium bg-blue-50 text-blue-700 border border-blue-200",children:N},y))})]}),x.notes&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(ge,{className:"w-4 h-4 text-slate-600"}),e.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Notes"})]}),e.jsx("p",{className:"text-sm text-slate-600 ml-6",children:x.notes})]})]})]},x.id))})]})]})}const Bg=[{value:"drilling",label:"Drilling"},{value:"blasting",label:"Blasting"},{value:"loading",label:"Breaking/Loading"},{value:"transport",label:"Transport"},{value:"general",label:"General"}],zg=[{value:"photo",label:"Photo",icon:Gt},{value:"video",label:"Video",icon:vl}];function Wg({onSuccess:i}){const{user:r}=Ne(),[a,l]=k.useState(!1),[o,d]=k.useState(!1),[u,h]=k.useState(null),[p,g]=k.useState(""),[v,x]=k.useState({record_type:"",media_type:"photo",title:"",description:"",location:"",date_taken:new Date().toISOString().split("T")[0]}),N=_=>{const T=_.target.files?.[0];if(!T)return;const I=50*1024*1024;if(T.size>I){alert("File size must be less than 50MB");return}const C=["image/jpeg","image/png","image/gif","image/webp"],D=["video/mp4","video/quicktime","video/x-msvideo"];if(v.media_type==="photo"&&!C.includes(T.type)){alert("Please select a valid image file (JPEG, PNG, GIF, WebP)");return}if(v.media_type==="video"&&!D.includes(T.type)){alert("Please select a valid video file (MP4, MOV, AVI)");return}if(h(T),T.type.startsWith("image/")){const R=new FileReader;R.onloadend=()=>{g(R.result)},R.readAsDataURL(T)}else g("")},y=()=>{h(null),g("")},b=async _=>{if(!r)throw new Error("User not authenticated");const T=_.name.split(".").pop(),I=`${r.id}/${Date.now()}.${T}`,{error:C}=await z.storage.from("media").upload(I,_,{cacheControl:"3600",upsert:!1});if(C)throw C;const{data:D}=z.storage.from("media").getPublicUrl(I);return D.publicUrl},j=async _=>{if(_.preventDefault(),!!r){if(!u){alert("Please select a file to upload");return}l(!0),d(!0);try{const T=await b(u),I=new Date(v.date_taken).toISOString(),{error:C}=await z.from("media_records").insert([{user_id:r.id,record_type:v.record_type,media_type:v.media_type,media_url:T,title:v.title,description:v.description,location:v.location,date_taken:I}]);if(C)throw C;x({record_type:"",media_type:"photo",title:"",description:"",location:"",date_taken:new Date().toISOString().split("T")[0]}),h(null),g(""),alert("Media uploaded successfully!"),i&&i()}catch(T){alert("Error uploading media: "+T.message)}finally{l(!1),d(!1)}}};return e.jsxs("form",{onSubmit:j,className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-pink-100 flex items-center justify-center",children:e.jsx(Gt,{className:"w-5 h-5 text-pink-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"Upload Photo/Video"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Upload and document site media from your device"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Media Type"}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:zg.map(_=>{const T=_.icon;return e.jsxs("button",{type:"button",onClick:()=>{x({...v,media_type:_.value}),y()},className:`flex items-center justify-center gap-2 px-4 py-3 rounded-lg border-2 transition-colors ${v.media_type===_.value?"border-pink-500 bg-pink-50 text-pink-700":"border-slate-300 hover:border-slate-400"}`,children:[e.jsx(T,{className:"w-5 h-5"}),_.label]},_.value)})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Category"}),e.jsxs("select",{value:v.record_type,onChange:_=>x({...v,record_type:_.target.value}),required:!0,className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Select category"}),Bg.map(_=>e.jsx("option",{value:_.value,children:_.label},_.value))]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:["Upload ",v.media_type==="photo"?"Photo":"Video"]}),u?e.jsxs("div",{className:"relative border-2 border-pink-500 rounded-lg p-4",children:[p&&v.media_type==="photo"&&e.jsx("img",{src:p,alt:"Preview",className:"w-full h-48 object-cover rounded-lg mb-3"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[v.media_type==="photo"?e.jsx(Gt,{className:"w-5 h-5 text-pink-600"}):e.jsx(vl,{className:"w-5 h-5 text-pink-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-slate-900",children:u.name}),e.jsxs("p",{className:"text-xs text-slate-500",children:[(u.size/(1024*1024)).toFixed(2)," MB"]})]})]}),e.jsx("button",{type:"button",onClick:y,className:"p-2 hover:bg-slate-100 rounded-lg transition-colors",children:e.jsx(wl,{className:"w-5 h-5 text-slate-600"})})]})]}):e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"file",accept:v.media_type==="photo"?"image/*":"video/*",onChange:N,className:"hidden",id:"file-upload"}),e.jsxs("label",{htmlFor:"file-upload",className:"flex flex-col items-center justify-center w-full h-40 border-2 border-dashed border-slate-300 rounded-lg cursor-pointer hover:border-pink-500 hover:bg-pink-50 transition-colors",children:[e.jsx(xh,{className:"w-10 h-10 text-slate-400 mb-2"}),e.jsxs("span",{className:"text-sm font-medium text-slate-700",children:["Click to upload ",v.media_type==="photo"?"photo":"video"]}),e.jsxs("span",{className:"text-xs text-slate-500 mt-1",children:[v.media_type==="photo"?"JPEG, PNG, GIF, WebP":"MP4, MOV, AVI"," (Max 50MB)"]})]})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Title"}),e.jsx("input",{type:"text",value:v.title,onChange:_=>x({...v,title:_.target.value}),required:!0,className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent",placeholder:"Brief title for this media"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Location"}),e.jsx("input",{type:"text",value:v.location,onChange:_=>x({...v,location:_.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent",placeholder:"Where was this taken?"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Date Taken"}),e.jsx("input",{type:"date",value:v.date_taken,onChange:_=>x({...v,date_taken:_.target.value}),required:!0,className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Description"}),e.jsx("textarea",{value:v.description,onChange:_=>x({...v,description:_.target.value}),rows:3,className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent",placeholder:"Describe what this photo/video shows..."})]})]}),e.jsx("div",{className:"mt-6 flex justify-end",children:e.jsx("button",{type:"submit",disabled:a||!u,className:"flex items-center gap-2 px-6 py-2 bg-pink-600 text-white rounded-lg hover:bg-pink-700 focus:outline-none focus:ring-2 focus:ring-pink-500 focus:ring-offset-2 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:o?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Uploading..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Kt,{className:"w-4 h-4"}),"Upload Media"]})})})]})}function Hg(){const{user:i}=Ne(),[r,a]=k.useState([]),[l,o]=k.useState({totalPhotos:0,totalVideos:0,totalMedia:0,thisMonth:0}),[d,u]=k.useState(!0),[h,p]=k.useState(null),[g,v]=k.useState("all");k.useEffect(()=>{x()},[i]);const x=async()=>{if(i){u(!0);try{const{data:b,error:j}=await z.from("media_records").select("*").eq("user_id",i.id).order("date_taken",{ascending:!1});if(j)throw j;a(b||[]);const _=b?.filter(F=>F.media_type==="photo").length||0,T=b?.filter(F=>F.media_type==="video").length||0,I=b?.length||0,C=new Date().getMonth(),D=new Date().getFullYear(),R=b?.filter(F=>{const H=new Date(F.date_taken);return H.getMonth()===C&&H.getFullYear()===D}).length||0;o({totalPhotos:_,totalVideos:T,totalMedia:I,thisMonth:R})}catch(b){console.error("Error loading records:",b)}finally{u(!1)}}},N=r.filter(b=>g==="all"?!0:b.media_type===g),y=b=>{const j={drilling:"bg-blue-100 text-blue-700",blasting:"bg-orange-100 text-orange-700",loading:"bg-green-100 text-green-700",transport:"bg-purple-100 text-purple-700",general:"bg-slate-100 text-slate-700"};return e.jsx("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded text-xs font-semibold ${j[b]||j.general}`,children:b.charAt(0).toUpperCase()+b.slice(1)})};return d?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-slate-600",children:"Loading media..."})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-pink-100 flex items-center justify-center",children:e.jsx(Xp,{className:"w-5 h-5 text-pink-600"})}),e.jsx(ve,{className:"w-4 h-4 text-slate-400"})]}),e.jsx("p",{className:"text-2xl font-bold text-slate-900",children:l.totalPhotos}),e.jsx("p",{className:"text-sm text-slate-600",children:"Total Photos"})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-purple-100 flex items-center justify-center",children:e.jsx(Kp,{className:"w-5 h-5 text-purple-600"})}),e.jsx(Ee,{className:"w-4 h-4 text-slate-400"})]}),e.jsx("p",{className:"text-2xl font-bold text-slate-900",children:l.totalVideos}),e.jsx("p",{className:"text-sm text-slate-600",children:"Total Videos"})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-blue-100 flex items-center justify-center",children:e.jsx(Gt,{className:"w-5 h-5 text-blue-600"})}),e.jsx(ve,{className:"w-4 h-4 text-slate-400"})]}),e.jsx("p",{className:"text-2xl font-bold text-slate-900",children:l.totalMedia}),e.jsx("p",{className:"text-sm text-slate-600",children:"Total Media"})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-green-100 flex items-center justify-center",children:e.jsx(ge,{className:"w-5 h-5 text-green-600"})}),e.jsx(Ee,{className:"w-4 h-4 text-slate-400"})]}),e.jsx("p",{className:"text-2xl font-bold text-slate-900",children:l.thisMonth}),e.jsx("p",{className:"text-sm text-slate-600",children:"This Month"})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200",children:[e.jsx("div",{className:"px-6 py-4 border-b border-slate-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"Photos & Videos"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Click on an item to view details"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>v("all"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${g==="all"?"bg-pink-600 text-white":"bg-slate-100 text-slate-700 hover:bg-slate-200"}`,children:"All"}),e.jsx("button",{onClick:()=>v("photo"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${g==="photo"?"bg-pink-600 text-white":"bg-slate-100 text-slate-700 hover:bg-slate-200"}`,children:"Photos"}),e.jsx("button",{onClick:()=>v("video"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${g==="video"?"bg-pink-600 text-white":"bg-slate-100 text-slate-700 hover:bg-slate-200"}`,children:"Videos"})]})]})}),N.length===0?e.jsx("div",{className:"p-8 text-center text-slate-600",children:"No media records found. Upload your first photo or video to get started."}):e.jsx("div",{className:"divide-y divide-slate-200",children:N.map(b=>e.jsxs("div",{onClick:()=>p(h?.id===b.id?null:b),className:"p-6 hover:bg-slate-50 cursor-pointer transition-colors",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-12 h-12 rounded-lg ${b.media_type==="photo"?"bg-pink-100":"bg-purple-100"} flex items-center justify-center flex-shrink-0`,children:b.media_type==="photo"?e.jsx(Gt,{className:"w-6 h-6 text-pink-600"}):e.jsx(vl,{className:"w-6 h-6 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-slate-900",children:b.title}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-600 mt-0.5",children:[e.jsx(ge,{className:"w-4 h-4"}),new Date(b.date_taken).toLocaleDateString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric"})]})]})]}),y(b.record_type)]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-slate-600",children:[b.location&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(jt,{className:"w-4 h-4"}),b.location]}),e.jsxs("div",{className:"flex items-center gap-1",children:[b.media_type==="photo"?e.jsx(Gt,{className:"w-4 h-4"}):e.jsx(vl,{className:"w-4 h-4"}),b.media_type]})]}),h?.id===b.id&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-slate-200 space-y-3",children:[b.description&&e.jsx("div",{children:e.jsx("p",{className:"text-sm text-slate-600 mb-3",children:b.description})}),b.media_type==="photo"?e.jsx("div",{className:"rounded-lg overflow-hidden border border-slate-200",children:e.jsx("img",{src:b.media_url,alt:b.title,className:"w-full h-auto object-contain max-h-96",onError:j=>{const _=j.target;_.style.display="none";const T=_.parentElement;T&&(T.innerHTML=`
                                <div class="p-4 text-center text-slate-600">
                                  <p class="text-sm">Image failed to load</p>
                                  <a href="${b.media_url}" target="_blank" rel="noopener noreferrer" class="text-sm text-blue-600 hover:text-blue-700 mt-2 inline-block">
                                    Try opening in new tab 
                                  </a>
                                </div>
                              `)}})}):e.jsx("div",{className:"rounded-lg overflow-hidden border border-slate-200",children:e.jsx("video",{src:b.media_url,controls:!0,className:"w-full h-auto max-h-96",onError:j=>{const _=j.target;_.style.display="none";const T=_.parentElement;T&&(T.innerHTML=`
                                <div class="p-4 text-center text-slate-600">
                                  <p class="text-sm">Video failed to load</p>
                                  <a href="${b.media_url}" target="_blank" rel="noopener noreferrer" class="text-sm text-blue-600 hover:text-blue-700 mt-2 inline-block">
                                    Try opening in new tab 
                                  </a>
                                </div>
                              `)},children:"Your browser does not support the video tag."})}),e.jsx("div",{className:"bg-slate-100 rounded-lg p-3",children:e.jsx("a",{href:b.media_url,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:text-blue-700 break-all",children:"Open in new tab "})})]})]},b.id))})]})]})}const qm=()=>`INV-${Math.floor(1e3+Math.random()*9e3)}`,Vg=["Equipment","Tools","Spare Parts","Explosives","Safety Gear","Consumables","Other"],Qg=["pieces","kg","liters","meters","boxes","sets","units"],Gg=["Main Store","Tool Room","Equipment Shed","Yard Storage","Office Supply Closet","Workshop","Field Storage","Security Cabin","Other"],Kg=["In Stock","Assigned","In Maintenance","Disposed","Lost/Stolen"],Yg=["Not Assigned","Site Supervisor","Foreman","Operator","Technician","Safety Officer","Office Staff"];function Jg({onSuccess:i}){const{user:r}=Ne(),[a,l]=k.useState(!1),o={item_name:"",item_code:qm(),category:"",quantity:"",unit:"",status:"In Stock",assigned_to:"Not Assigned",assigned_date:"",expected_return_date:"",storage_location:"Main Store",minimum_quantity:"",location:"Main Store",given_to:"",supplier:"",last_restock_date:"",notes:""},[d,u]=k.useState(o),h=async p=>{if(p.preventDefault(),!!r){l(!0);try{const{error:g}=await z.from("inventory_items").insert([{item_name:d.item_name,item_code:d.item_code,category:d.category,quantity:parseFloat(d.quantity)||0,unit:d.unit,minimum_quantity:parseFloat(d.minimum_quantity)||0,location:d.location,supplier:d.supplier,given_to:d.given_to||null,last_restock_date:d.last_restock_date||null,notes:d.notes}]);if(g)throw g;(()=>{u({...o,item_code:qm()})})(),alert("Inventory item added successfully!"),i&&i()}catch(g){alert("Error adding inventory item: "+g.message)}finally{l(!1)}}};return e.jsxs("form",{onSubmit:h,className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-cyan-100 flex items-center justify-center",children:e.jsx(Ae,{className:"w-5 h-5 text-cyan-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"Add Inventory Item"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Add new item to inventory"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Item Name *"}),e.jsx("input",{type:"text",value:d.item_name,onChange:p=>u({...d,item_name:p.target.value}),required:!0,className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent",placeholder:"e.g., Drill Bits"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Item Code"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:d.item_code,readOnly:!0,className:"w-full px-4 py-2 border border-slate-300 rounded-lg bg-slate-50 cursor-not-allowed","aria-label":"Auto-generated item code"}),e.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none text-slate-500 text-sm",children:"Auto-generated"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Category"}),e.jsxs("select",{value:d.category,onChange:p=>u({...d,category:p.target.value}),required:!0,className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Select category"}),Vg.map(p=>e.jsx("option",{value:p,children:p},p))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Unit"}),e.jsxs("select",{value:d.unit,onChange:p=>u({...d,unit:p.target.value}),required:!0,className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Select unit"}),Qg.map(p=>e.jsx("option",{value:p,children:p},p))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Quantity"}),e.jsx("input",{type:"number",step:"0.01",value:d.quantity,onChange:p=>u({...d,quantity:p.target.value}),required:!0,min:"0",className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent",placeholder:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Minimum Quantity (Alert Level)"}),e.jsx("input",{type:"number",step:"0.01",value:d.minimum_quantity,onChange:p=>u({...d,minimum_quantity:p.target.value}),min:"0",className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent",placeholder:"0"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Storage Area *"}),e.jsx("select",{value:d.storage_location,onChange:p=>u({...d,storage_location:p.target.value}),required:!0,className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent",children:Gg.map(p=>e.jsx("option",{value:p,children:p},p))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Item Status *"}),e.jsx("select",{value:d.status,onChange:p=>u({...d,status:p.target.value}),required:!0,className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent",children:Kg.map(p=>e.jsx("option",{value:p,children:p},p))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Assigned To"}),e.jsx("select",{value:d.assigned_to,onChange:p=>u({...d,assigned_to:p.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent",children:Yg.map(p=>e.jsx("option",{value:p,children:p},p))})]}),d.assigned_to!=="Not Assigned"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Assignment Date"}),e.jsx("input",{type:"date",value:d.assigned_date,onChange:p=>u({...d,assigned_date:p.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent"})]}),d.assigned_to!=="Not Assigned"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Expected Return Date"}),e.jsx("input",{type:"date",value:d.expected_return_date,onChange:p=>u({...d,expected_return_date:p.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Given To"}),e.jsx("input",{type:"text",value:d.given_to,onChange:p=>u({...d,given_to:p.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent",placeholder:"Enter recipient's name or leave blank"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Supplier"}),e.jsx("input",{type:"text",value:d.supplier,onChange:p=>u({...d,supplier:p.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent",placeholder:"Supplier name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Last Restock Date"}),e.jsx("input",{type:"date",value:d.last_restock_date,onChange:p=>u({...d,last_restock_date:p.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Notes"}),e.jsx("textarea",{value:d.notes,onChange:p=>u({...d,notes:p.target.value}),rows:3,className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent",placeholder:"Additional details about this item..."})]})]}),e.jsx("div",{className:"mt-6 flex justify-end",children:e.jsxs("button",{type:"submit",disabled:a,className:"flex items-center gap-2 px-6 py-2 bg-cyan-600 text-white rounded-lg hover:bg-cyan-700 focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:ring-offset-2 transition-colors disabled:opacity-50",children:[e.jsx(Kt,{className:"w-4 h-4"}),a?"Saving...":"Add Item"]})})]})}function Xg(){const[i,r]=k.useState([]),[a,l]=k.useState({totalItems:0,lowStockItems:0,totalCategories:0,totalValue:0}),[o,d]=k.useState(!0),[u,h]=k.useState(null),[p,g]=k.useState("all");k.useEffect(()=>{v()},[]);const v=async()=>{d(!0);try{const{data:y,error:b}=await z.from("inventory_items").select("*").order("item_name",{ascending:!0});if(b)throw b;r(y||[]);const j=y?.filter(T=>T.quantity<=T.minimum_quantity).length||0,_=new Set(y?.map(T=>T.category));l({totalItems:y?.length||0,lowStockItems:j,totalCategories:_.size,totalValue:0})}catch(y){console.error("Error loading inventory:",y)}finally{d(!1)}},x=i.filter(y=>p==="all"?!0:p==="low-stock"?y.quantity<=y.minimum_quantity:y.category===p),N=Array.from(new Set(i.map(y=>y.category)));return o?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-slate-600",children:"Loading inventory..."})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-cyan-100 flex items-center justify-center",children:e.jsx(Ae,{className:"w-5 h-5 text-cyan-600"})}),e.jsx(ve,{className:"w-4 h-4 text-slate-400"})]}),e.jsx("p",{className:"text-2xl font-bold text-slate-900",children:a.totalItems}),e.jsx("p",{className:"text-sm text-slate-600",children:"Total Items"})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-red-100 flex items-center justify-center",children:e.jsx(Hr,{className:"w-5 h-5 text-red-600"})}),e.jsx(Ee,{className:"w-4 h-4 text-slate-400"})]}),e.jsx("p",{className:"text-2xl font-bold text-slate-900",children:a.lowStockItems}),e.jsx("p",{className:"text-sm text-slate-600",children:"Low Stock Items"})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-blue-100 flex items-center justify-center",children:e.jsx(Ee,{className:"w-5 h-5 text-blue-600"})}),e.jsx(ve,{className:"w-4 h-4 text-slate-400"})]}),e.jsx("p",{className:"text-2xl font-bold text-slate-900",children:a.totalCategories}),e.jsx("p",{className:"text-sm text-slate-600",children:"Categories"})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-green-100 flex items-center justify-center",children:e.jsx(Ae,{className:"w-5 h-5 text-green-600"})}),e.jsx(Ee,{className:"w-4 h-4 text-slate-400"})]}),e.jsx("p",{className:"text-2xl font-bold text-slate-900",children:i.filter(y=>y.quantity>y.minimum_quantity).length}),e.jsx("p",{className:"text-sm text-slate-600",children:"In Stock"})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200",children:[e.jsx("div",{className:"px-6 py-4 border-b border-slate-200",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"Inventory Items"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Click on an item to view details"})]}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsx("button",{onClick:()=>g("all"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${p==="all"?"bg-cyan-600 text-white":"bg-slate-100 text-slate-700 hover:bg-slate-200"}`,children:"All"}),e.jsx("button",{onClick:()=>g("low-stock"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${p==="low-stock"?"bg-cyan-600 text-white":"bg-slate-100 text-slate-700 hover:bg-slate-200"}`,children:"Low Stock"}),N.map(y=>e.jsx("button",{onClick:()=>g(y),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${p===y?"bg-cyan-600 text-white":"bg-slate-100 text-slate-700 hover:bg-slate-200"}`,children:y},y))]})]})}),x.length===0?e.jsx("div",{className:"p-8 text-center text-slate-600",children:"No inventory items found. Add your first item to get started."}):e.jsx("div",{className:"divide-y divide-slate-200",children:x.map(y=>{const b=y.quantity<=y.minimum_quantity;return e.jsxs("div",{onClick:()=>h(u?.id===y.id?null:y),className:"p-6 hover:bg-slate-50 cursor-pointer transition-colors",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-12 h-12 rounded-lg ${b?"bg-red-100":"bg-cyan-100"} flex items-center justify-center flex-shrink-0`,children:e.jsx(Ae,{className:`w-6 h-6 ${b?"text-red-600":"text-cyan-600"}`})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-slate-900",children:y.item_name}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-600 mt-0.5",children:[e.jsx("span",{className:"font-mono",children:y.item_code}),e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-semibold bg-slate-100 text-slate-700",children:y.category})]})]})]}),b&&e.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 rounded-full text-xs font-semibold bg-red-100 text-red-700",children:[e.jsx(Hr,{className:"w-3 h-3"}),"Low Stock"]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-slate-50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(Ae,{className:"w-4 h-4 text-slate-600"}),e.jsx("span",{className:"text-xs font-medium text-slate-600",children:"Quantity"})]}),e.jsxs("p",{className:"text-sm font-bold text-slate-900",children:[y.quantity," ",y.unit]})]}),e.jsxs("div",{className:"bg-slate-50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(Hr,{className:"w-4 h-4 text-slate-600"}),e.jsx("span",{className:"text-xs font-medium text-slate-600",children:"Min Level"})]}),e.jsxs("p",{className:"text-sm font-bold text-slate-900",children:[y.minimum_quantity," ",y.unit]})]}),y.location&&e.jsxs("div",{className:"bg-slate-50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(jt,{className:"w-4 h-4 text-slate-600"}),e.jsx("span",{className:"text-xs font-medium text-slate-600",children:"Location"})]}),e.jsx("p",{className:"text-sm font-bold text-slate-900 truncate",children:y.location})]}),y.supplier&&e.jsxs("div",{className:"bg-slate-50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(sc,{className:"w-4 h-4 text-slate-600"}),e.jsx("span",{className:"text-xs font-medium text-slate-600",children:"Supplier"})]}),e.jsx("p",{className:"text-sm font-bold text-slate-900 truncate",children:y.supplier})]})]}),u?.id===y.id&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-slate-200 space-y-3",children:[y.last_restock_date&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Last Restock: "}),e.jsx("span",{className:"text-sm text-slate-600",children:new Date(y.last_restock_date).toLocaleDateString()})]}),y.notes&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Notes: "}),e.jsx("p",{className:"text-sm text-slate-600 mt-1",children:y.notes})]})]})]},y.id)})})]})]})}const Zg=["Truck","Loader","Excavator","Dumper","Drill Rig","Crusher","Generator","Other"],ev=["Diesel","Petrol"];function tv({onSuccess:i}){const{user:r}=Ne(),[a,l]=k.useState(!1),o=()=>{const g="FUEL",v=Math.floor(1e3+Math.random()*9e3);return`${g}-${new Date().getFullYear()}-${v}`},[d,u]=k.useState({date:new Date().toISOString().split("T")[0],vehicle_number:o(),vehicle_type:"",fuel_type:"",quantity_liters:"",cost_per_liter:"",odometer_reading:"",supplier:"",receipt_number:"",notes:""}),h=(parseFloat(d.quantity_liters)||0)*(parseFloat(d.cost_per_liter)||0),p=async g=>{if(g.preventDefault(),!!r){l(!0);try{const{error:v}=await z.from("fuel_records").insert([{user_id:r.id,date:d.date,vehicle_number:d.vehicle_number,vehicle_type:d.vehicle_type,fuel_type:d.fuel_type,quantity_liters:parseFloat(d.quantity_liters)||0,cost_per_liter:parseFloat(d.cost_per_liter)||0,total_cost:h,odometer_reading:d.odometer_reading?parseFloat(d.odometer_reading):null,supplier:d.supplier,receipt_number:d.receipt_number,notes:d.notes,status:"pending"}]);if(v)throw v;u({date:new Date().toISOString().split("T")[0],vehicle_number:o(),vehicle_type:"",fuel_type:"",quantity_liters:"",cost_per_liter:"",odometer_reading:"",supplier:"",receipt_number:"",notes:""}),alert("Fuel record submitted successfully!"),i&&i()}catch(v){alert("Error submitting fuel record: "+v.message)}finally{l(!1)}}};return e.jsxs("form",{onSubmit:p,className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-amber-100 flex items-center justify-center",children:e.jsx(It,{className:"w-5 h-5 text-amber-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"New Fuel Record"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Track fuel consumption and costs"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Date"}),e.jsx("input",{type:"date",value:d.date,onChange:g=>u({...d,date:g.target.value}),required:!0,className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Record Number"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:d.vehicle_number,readOnly:!0,required:!0,className:"w-full px-4 py-2 border border-slate-300 rounded-lg bg-slate-50 cursor-not-allowed","aria-label":"Auto-generated record number"}),e.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none text-slate-500 text-sm",children:"Auto-generated"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Vehicle Type"}),e.jsxs("select",{value:d.vehicle_type,onChange:g=>u({...d,vehicle_type:g.target.value}),required:!0,className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Select vehicle type"}),Zg.map(g=>e.jsx("option",{value:g,children:g},g))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Fuel Type"}),e.jsxs("select",{value:d.fuel_type,onChange:g=>u({...d,fuel_type:g.target.value}),required:!0,className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Select fuel type"}),ev.map(g=>e.jsx("option",{value:g,children:g},g))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Quantity (liters)"}),e.jsx("input",{type:"number",step:"0.01",value:d.quantity_liters,onChange:g=>u({...d,quantity_liters:g.target.value}),required:!0,min:"0",className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-transparent",placeholder:"0.00"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Cost per Liter"}),e.jsx("input",{type:"number",step:"0.01",value:d.cost_per_liter,onChange:g=>u({...d,cost_per_liter:g.target.value}),required:!0,min:"0",className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-transparent",placeholder:"0.00"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Total Cost"}),e.jsx("input",{type:"text",value:h.toFixed(2),readOnly:!0,className:"w-full px-4 py-2 border border-slate-300 rounded-lg bg-slate-50 text-slate-700 font-semibold"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Odometer Reading (optional)"}),e.jsx("input",{type:"number",step:"0.1",value:d.odometer_reading,onChange:g=>u({...d,odometer_reading:g.target.value}),min:"0",className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-transparent",placeholder:"0.0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Supplier"}),e.jsx("input",{type:"text",value:d.supplier,onChange:g=>u({...d,supplier:g.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-transparent",placeholder:"Fuel supplier name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Receipt Number"}),e.jsx("input",{type:"text",value:d.receipt_number,onChange:g=>u({...d,receipt_number:g.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-transparent",placeholder:"Receipt #"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Notes"}),e.jsx("textarea",{value:d.notes,onChange:g=>u({...d,notes:g.target.value}),rows:3,className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-transparent",placeholder:"Additional details..."})]})]}),e.jsx("div",{className:"mt-6 flex justify-end",children:e.jsxs("button",{type:"submit",disabled:a,className:"flex items-center gap-2 px-6 py-2 bg-amber-600 text-white rounded-lg hover:bg-amber-700 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:ring-offset-2 transition-colors disabled:opacity-50",children:[e.jsx(Kt,{className:"w-4 h-4"}),a?"Saving...":"Save Record"]})})]})}function sv(){const{user:i}=Ne(),[r,a]=k.useState([]),[l,o]=k.useState({totalLiters:0,totalCost:0,averageCostPerLiter:0,totalRecords:0}),[d,u]=k.useState(!0),[h,p]=k.useState(null);k.useEffect(()=>{g()},[i]);const g=async()=>{if(i){u(!0);try{const{data:x,error:N}=await z.from("fuel_records").select("*").eq("user_id",i.id).order("date",{ascending:!1});if(N)throw N;a(x||[]);const y=x?.reduce((_,T)=>_+T.quantity_liters,0)||0,b=x?.reduce((_,T)=>_+T.total_cost,0)||0,j=y>0?b/y:0;o({totalLiters:y,totalCost:b,averageCostPerLiter:j,totalRecords:x?.length||0})}catch(x){console.error("Error loading fuel records:",x)}finally{u(!1)}}},v=x=>{switch(x){case"approved":return e.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 rounded-full text-xs font-semibold bg-green-100 text-green-700",children:[e.jsx(et,{className:"w-3 h-3"}),"Approved"]});case"rejected":return e.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 rounded-full text-xs font-semibold bg-red-100 text-red-700",children:[e.jsx(rs,{className:"w-3 h-3"}),"Rejected"]});default:return e.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 rounded-full text-xs font-semibold bg-amber-100 text-amber-700",children:[e.jsx(Me,{className:"w-3 h-3"}),"Pending"]})}};return d?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-slate-600",children:"Loading fuel records..."})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-amber-100 flex items-center justify-center",children:e.jsx(It,{className:"w-5 h-5 text-amber-600"})}),e.jsx(ve,{className:"w-4 h-4 text-slate-400"})]}),e.jsxs("p",{className:"text-2xl font-bold text-slate-900",children:[l.totalLiters.toFixed(1)," L"]}),e.jsx("p",{className:"text-sm text-slate-600",children:"Total Fuel"})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-green-100 flex items-center justify-center",children:e.jsx(ct,{className:"w-5 h-5 text-green-600"})}),e.jsx(Ee,{className:"w-4 h-4 text-slate-400"})]}),e.jsxs("p",{className:"text-2xl font-bold text-slate-900",children:["",l.totalCost.toFixed(2)]}),e.jsx("p",{className:"text-sm text-slate-600",children:"Total Cost"})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-blue-100 flex items-center justify-center",children:e.jsx(Ee,{className:"w-5 h-5 text-blue-600"})}),e.jsx(ve,{className:"w-4 h-4 text-slate-400"})]}),e.jsxs("p",{className:"text-2xl font-bold text-slate-900",children:["",l.averageCostPerLiter.toFixed(2)]}),e.jsx("p",{className:"text-sm text-slate-600",children:"Avg Cost/Liter"})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-purple-100 flex items-center justify-center",children:e.jsx(ge,{className:"w-5 h-5 text-purple-600"})}),e.jsx(Ee,{className:"w-4 h-4 text-slate-400"})]}),e.jsx("p",{className:"text-2xl font-bold text-slate-900",children:l.totalRecords}),e.jsx("p",{className:"text-sm text-slate-600",children:"Total Records"})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-slate-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"Fuel Records"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Click on a record to view details"})]}),r.length===0?e.jsx("div",{className:"p-8 text-center text-slate-600",children:"No fuel records found. Create your first record to get started."}):e.jsx("div",{className:"divide-y divide-slate-200",children:r.map(x=>e.jsxs("div",{onClick:()=>p(h?.id===x.id?null:x),className:"p-6 hover:bg-slate-50 cursor-pointer transition-colors",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-lg bg-amber-100 flex items-center justify-center flex-shrink-0",children:e.jsx(It,{className:"w-6 h-6 text-amber-600"})}),e.jsxs("div",{children:[e.jsxs("h4",{className:"font-semibold text-slate-900",children:[x.vehicle_number," - ",x.vehicle_type]}),e.jsxs("div",{className:"flex items-center gap-1 text-sm text-slate-600 mt-0.5",children:[e.jsx(ge,{className:"w-4 h-4"}),new Date(x.date).toLocaleDateString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric"})]})]})]}),v(x.status)]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-slate-50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(It,{className:"w-4 h-4 text-amber-600"}),e.jsx("span",{className:"text-xs font-medium text-slate-600",children:"Fuel Type"})]}),e.jsx("p",{className:"text-sm font-bold text-slate-900",children:x.fuel_type})]}),e.jsxs("div",{className:"bg-slate-50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(It,{className:"w-4 h-4 text-blue-600"}),e.jsx("span",{className:"text-xs font-medium text-slate-600",children:"Quantity"})]}),e.jsxs("p",{className:"text-sm font-bold text-slate-900",children:[x.quantity_liters," L"]})]}),e.jsxs("div",{className:"bg-slate-50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(ct,{className:"w-4 h-4 text-green-600"}),e.jsx("span",{className:"text-xs font-medium text-slate-600",children:"Cost/L"})]}),e.jsxs("p",{className:"text-sm font-bold text-slate-900",children:["",x.cost_per_liter]})]}),e.jsxs("div",{className:"bg-slate-50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(ct,{className:"w-4 h-4 text-green-600"}),e.jsx("span",{className:"text-xs font-medium text-slate-600",children:"Total"})]}),e.jsxs("p",{className:"text-sm font-bold text-slate-900",children:["",x.total_cost.toFixed(2)]})]})]}),h?.id===x.id&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-slate-200 space-y-3",children:[x.odometer_reading&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Odometer: "}),e.jsxs("span",{className:"text-sm text-slate-600",children:[x.odometer_reading," km"]})]}),x.supplier&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Supplier: "}),e.jsx("span",{className:"text-sm text-slate-600",children:x.supplier})]}),x.receipt_number&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Receipt #: "}),e.jsx("span",{className:"text-sm text-slate-600",children:x.receipt_number})]}),x.notes&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Notes: "}),e.jsx("p",{className:"text-sm text-slate-600 mt-1",children:x.notes})]})]})]},x.id))})]})]})}const rv=["Near Miss","Minor Injury","Major Injury","Equipment Damage","Environmental","Fire","Chemical Spill","Other"],nv=["Low","Medium","High","Critical"];function av({onSuccess:i}){const{user:r}=Ne(),[a,l]=k.useState(!1),[o,d]=k.useState(!1),[u,h]=k.useState(0),[p,g]=k.useState([]),v=k.useRef(null),x=async _=>{try{if(!_.target.files||_.target.files.length===0)return;const T=Array.from(_.target.files),I=[];for(const C of T){d(!0),h(0);const D=C.name.split(".").pop(),F=`safety-incidents/${`${Math.random()}.${D}`}`,{error:H}=await z.storage.from("safety-images").upload(F,C,{cacheControl:"3600",upsert:!1});if(H)throw H;const{data:{publicUrl:ae}}=z.storage.from("safety-images").getPublicUrl(F);I.push({url:ae,name:C.name})}g(C=>[...C,...I]),d(!1)}catch(T){console.error("Error uploading image:",T),alert("Error uploading image. Please try again."),d(!1)}},N=_=>{g(T=>T.filter((I,C)=>C!==_))},[y,b]=k.useState({date:new Date().toISOString().split("T")[0],time:new Date().toTimeString().slice(0,5),location:"",incident_type:"",severity:"",description:"",people_involved:"",witnesses:"",immediate_action:"",corrective_action:""}),j=async _=>{if(_.preventDefault(),!!r){l(!0);try{const{error:T}=await z.from("safety_incidents").insert([{reported_by:r.id,date:y.date,time:y.time,location:y.location,incident_type:y.incident_type,severity:y.severity,description:y.description,people_involved:y.people_involved,witnesses:y.witnesses,immediate_action:y.immediate_action,corrective_action:y.corrective_action,status:"reported",image_urls:p.map(I=>I.url)}]);if(T)throw T;b({date:new Date().toISOString().split("T")[0],time:new Date().toTimeString().slice(0,5),location:"",incident_type:"",severity:"",description:"",people_involved:"",witnesses:"",immediate_action:"",corrective_action:""}),g([]),h(0),v.current&&(v.current.value=""),alert("Safety incident reported successfully!"),i&&i()}catch(T){alert("Error reporting incident: "+T.message)}finally{l(!1)}}};return e.jsxs("form",{onSubmit:j,className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-red-100 flex items-center justify-center",children:e.jsx(Vr,{className:"w-5 h-5 text-red-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"Report Safety Incident"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Document incidents and near misses"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Date"}),e.jsx("input",{type:"date",value:y.date,onChange:_=>b({...y,date:_.target.value}),required:!0,className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Time"}),e.jsx("input",{type:"time",value:y.time,onChange:_=>b({...y,time:_.target.value}),required:!0,className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Location"}),e.jsx("input",{type:"text",value:y.location,onChange:_=>b({...y,location:_.target.value}),required:!0,className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent",placeholder:"Where did this occur?"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Incident Type"}),e.jsxs("select",{value:y.incident_type,onChange:_=>b({...y,incident_type:_.target.value}),required:!0,className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Select incident type"}),rv.map(_=>e.jsx("option",{value:_,children:_},_))]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Severity Level"}),e.jsx("div",{className:"grid grid-cols-4 gap-3",children:nv.map(_=>e.jsx("button",{type:"button",onClick:()=>b({...y,severity:_}),className:`px-4 py-3 rounded-lg border-2 font-medium transition-colors ${y.severity===_?_==="Critical"?"border-red-600 bg-red-50 text-red-700":_==="High"?"border-orange-600 bg-orange-50 text-orange-700":_==="Medium"?"border-amber-600 bg-amber-50 text-amber-700":"border-green-600 bg-green-50 text-green-700":"border-slate-300 hover:border-slate-400"}`,children:_},_))})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Description"}),e.jsx("textarea",{value:y.description,onChange:_=>b({...y,description:_.target.value}),required:!0,rows:4,className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent",placeholder:"Describe what happened in detail..."})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Incident Photos (Optional)"}),e.jsx("div",{className:"mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-slate-300 border-dashed rounded-lg",children:e.jsxs("div",{className:"space-y-1 text-center",children:[e.jsxs("div",{className:"flex text-sm text-slate-600 justify-center",children:[e.jsxs("label",{className:"relative cursor-pointer bg-white rounded-md font-medium text-red-600 hover:text-red-500 focus-within:outline-none",children:[e.jsx("span",{children:"Upload photos"}),e.jsx("input",{ref:v,id:"file-upload",name:"file-upload",type:"file",className:"sr-only",multiple:!0,accept:"image/*",onChange:x,disabled:o})]}),e.jsx("p",{className:"pl-1",children:"or drag and drop"})]}),e.jsx("p",{className:"text-xs text-slate-500",children:"PNG, JPG, GIF up to 5MB"}),o&&e.jsx("div",{className:"w-full bg-slate-200 rounded-full h-2.5 mt-2",children:e.jsx("div",{className:"bg-red-600 h-2.5 rounded-full",style:{width:`${u}%`}})})]})}),p.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsxs("h4",{className:"text-sm font-medium text-slate-700 mb-2",children:["Attached Photos (",p.length,")"]}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4",children:p.map((_,T)=>e.jsxs("div",{className:"relative group",children:[e.jsxs("div",{className:"aspect-w-1 aspect-h-1 w-full overflow-hidden rounded-lg bg-slate-100",children:[e.jsx("img",{src:_.url,alt:_.name,className:"h-full w-full object-cover object-center"}),e.jsx("button",{type:"button",onClick:()=>N(T),className:"absolute top-1 right-1 bg-red-500 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity",title:"Remove image",children:e.jsx(wl,{className:"w-3 h-3"})})]}),e.jsx("p",{className:"mt-1 text-xs text-slate-500 truncate",children:_.name.length>20?`${_.name.substring(0,17)}...`:_.name})]},T))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"People Involved"}),e.jsx("input",{type:"text",value:y.people_involved,onChange:_=>b({...y,people_involved:_.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent",placeholder:"Names of people involved"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Witnesses"}),e.jsx("input",{type:"text",value:y.witnesses,onChange:_=>b({...y,witnesses:_.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent",placeholder:"Names of witnesses"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Immediate Action Taken"}),e.jsx("textarea",{value:y.immediate_action,onChange:_=>b({...y,immediate_action:_.target.value}),rows:3,className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent",placeholder:"What actions were taken immediately after the incident?"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Recommended Corrective Action"}),e.jsx("textarea",{value:y.corrective_action,onChange:_=>b({...y,corrective_action:_.target.value}),rows:3,className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent",placeholder:"What should be done to prevent this from happening again?"})]})]}),e.jsx("div",{className:"mt-6 flex justify-end",children:e.jsxs("button",{type:"submit",disabled:a,className:"flex items-center gap-2 px-6 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 transition-colors disabled:opacity-50",children:[e.jsx(Kt,{className:"w-4 h-4"}),a?"Reporting...":"Report Incident"]})})]})}function lv(){const{user:i}=Ne(),[r,a]=k.useState([]),[l,o]=k.useState({totalIncidents:0,criticalIncidents:0,resolvedIncidents:0,thisMonth:0}),[d,u]=k.useState(!0),[h,p]=k.useState(null),[g,v]=k.useState("all");k.useEffect(()=>{x()},[i]);const x=async()=>{if(i){u(!0);try{const{data:j,error:_}=await z.from("safety_incidents").select("*").eq("reported_by",i.id).order("date",{ascending:!1});if(_)throw _;a(j||[]);const T=j?.filter(F=>F.severity==="Critical").length||0,I=j?.filter(F=>F.status==="resolved"||F.status==="closed").length||0,C=new Date().getMonth(),D=new Date().getFullYear(),R=j?.filter(F=>{const H=new Date(F.date);return H.getMonth()===C&&H.getFullYear()===D}).length||0;o({totalIncidents:j?.length||0,criticalIncidents:T,resolvedIncidents:I,thisMonth:R})}catch(j){console.error("Error loading incidents:",j)}finally{u(!1)}}},N=r.filter(j=>g==="all"?!0:g==="critical"?j.severity==="Critical":g==="open"?j.status==="reported"||j.status==="investigating":j.status===g||j.severity===g),y=j=>{const _={Critical:"bg-red-100 text-red-700",High:"bg-orange-100 text-orange-700",Medium:"bg-amber-100 text-amber-700",Low:"bg-green-100 text-green-700"};return e.jsxs("span",{className:`inline-flex items-center gap-1 px-3 py-1 rounded-full text-xs font-semibold ${_[j]}`,children:[e.jsx(Hr,{className:"w-3 h-3"}),j]})},b=j=>{const _={reported:"bg-blue-100 text-blue-700",investigating:"bg-amber-100 text-amber-700",resolved:"bg-green-100 text-green-700",closed:"bg-slate-100 text-slate-700"};return e.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded text-xs font-semibold ${_[j]||_.reported}`,children:j.charAt(0).toUpperCase()+j.slice(1)})};return d?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-slate-600",children:"Loading safety incidents..."})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-red-100 flex items-center justify-center",children:e.jsx(Vr,{className:"w-5 h-5 text-red-600"})}),e.jsx(ve,{className:"w-4 h-4 text-slate-400"})]}),e.jsx("p",{className:"text-2xl font-bold text-slate-900",children:l.totalIncidents}),e.jsx("p",{className:"text-sm text-slate-600",children:"Total Incidents"})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-orange-100 flex items-center justify-center",children:e.jsx(Hr,{className:"w-5 h-5 text-orange-600"})}),e.jsx(Ee,{className:"w-4 h-4 text-slate-400"})]}),e.jsx("p",{className:"text-2xl font-bold text-slate-900",children:l.criticalIncidents}),e.jsx("p",{className:"text-sm text-slate-600",children:"Critical Incidents"})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-green-100 flex items-center justify-center",children:e.jsx(Vr,{className:"w-5 h-5 text-green-600"})}),e.jsx(ve,{className:"w-4 h-4 text-slate-400"})]}),e.jsx("p",{className:"text-2xl font-bold text-slate-900",children:l.resolvedIncidents}),e.jsx("p",{className:"text-sm text-slate-600",children:"Resolved"})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-blue-100 flex items-center justify-center",children:e.jsx(ge,{className:"w-5 h-5 text-blue-600"})}),e.jsx(Ee,{className:"w-4 h-4 text-slate-400"})]}),e.jsx("p",{className:"text-2xl font-bold text-slate-900",children:l.thisMonth}),e.jsx("p",{className:"text-sm text-slate-600",children:"This Month"})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200",children:[e.jsx("div",{className:"px-6 py-4 border-b border-slate-200",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"Safety Incidents"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Click on an incident to view details"})]}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsx("button",{onClick:()=>v("all"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${g==="all"?"bg-red-600 text-white":"bg-slate-100 text-slate-700 hover:bg-slate-200"}`,children:"All"}),e.jsx("button",{onClick:()=>v("critical"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${g==="critical"?"bg-red-600 text-white":"bg-slate-100 text-slate-700 hover:bg-slate-200"}`,children:"Critical"}),e.jsx("button",{onClick:()=>v("open"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${g==="open"?"bg-red-600 text-white":"bg-slate-100 text-slate-700 hover:bg-slate-200"}`,children:"Open"})]})]})}),N.length===0?e.jsx("div",{className:"p-8 text-center text-slate-600",children:"No safety incidents found. This is great news!"}):e.jsx("div",{className:"divide-y divide-slate-200",children:N.map(j=>e.jsxs("div",{onClick:()=>p(h?.id===j.id?null:j),className:"p-6 hover:bg-slate-50 cursor-pointer transition-colors",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-lg bg-red-100 flex items-center justify-center flex-shrink-0",children:e.jsx(Vr,{className:"w-6 h-6 text-red-600"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-slate-900",children:j.incident_type}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-600 mt-0.5",children:[e.jsx(ge,{className:"w-4 h-4"}),new Date(j.date).toLocaleDateString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric"}),e.jsx(Me,{className:"w-4 h-4 ml-2"}),j.time]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[y(j.severity),b(j.status)]})]}),e.jsxs("div",{className:"bg-slate-50 rounded-lg p-3 mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(jt,{className:"w-4 h-4 text-slate-600"}),e.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Location"})]}),e.jsx("p",{className:"text-sm text-slate-900",children:j.location})]}),e.jsx("p",{className:"text-sm text-slate-600 line-clamp-2",children:j.description}),h?.id===j.id&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-slate-200 space-y-4",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-semibold text-slate-900 mb-2",children:"Full Description"}),e.jsx("p",{className:"text-sm text-slate-600",children:j.description})]}),j.people_involved&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(ft,{className:"w-4 h-4 text-slate-600"}),e.jsx("span",{className:"text-sm font-medium text-slate-700",children:"People Involved"})]}),e.jsx("p",{className:"text-sm text-slate-600",children:j.people_involved})]}),j.witnesses&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(ft,{className:"w-4 h-4 text-slate-600"}),e.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Witnesses"})]}),e.jsx("p",{className:"text-sm text-slate-600",children:j.witnesses})]}),j.immediate_action&&e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-semibold text-slate-900 mb-1",children:"Immediate Action"}),e.jsx("p",{className:"text-sm text-slate-600",children:j.immediate_action})]}),j.corrective_action&&e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-semibold text-slate-900 mb-1",children:"Corrective Action"}),e.jsx("p",{className:"text-sm text-slate-600",children:j.corrective_action})]}),j.investigation_notes&&e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-semibold text-slate-900 mb-1",children:"Investigation Notes"}),e.jsx("p",{className:"text-sm text-slate-600",children:j.investigation_notes})]})]})]},j.id))})]})]})}function iv(){const{user:i}=Ne(),[r,a]=k.useState("attendance"),[l,o]=k.useState(!1),[d,u]=k.useState(null),h=async()=>{if(i){o(!0);try{const g=new Date,v=g.toISOString().split("T")[0],{error:x}=await z.from("attendance").insert([{user_id:i.id,date:v,check_in:g.toISOString(),location:"Quarry Site"}]);if(x)throw x;u(g),alert("Checked in successfully!")}catch(g){alert("Error checking in: "+g.message)}finally{o(!1)}}},p=async()=>{if(i){o(!0);try{const g=new Date,v=g.toISOString().split("T")[0],{error:x}=await z.from("attendance").update({check_out:g.toISOString()}).eq("user_id",i.id).eq("date",v);if(x)throw x;alert("Checked out successfully!"),u(null)}catch(g){alert("Error checking out: "+g.message)}finally{o(!1)}}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 rounded-xl p-6 text-white",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Mobile Operations"}),e.jsx("p",{className:"text-blue-100 mt-1",children:"Field operations management"})]}),e.jsx(Me,{className:"w-12 h-12 opacity-80"})]}),e.jsxs("div",{className:"bg-white/10 backdrop-blur-sm rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(jt,{className:"w-5 h-5"}),e.jsx("span",{className:"font-medium",children:"Quarry Site"})]}),e.jsx("div",{className:"text-sm",children:new Date().toLocaleDateString()})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("button",{onClick:h,disabled:l||d!==null,className:"bg-white text-blue-600 px-6 py-3 rounded-lg font-semibold hover:bg-blue-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(et,{className:"w-5 h-5 mx-auto mb-1"}),"Check In"]}),e.jsxs("button",{onClick:p,disabled:l||d===null,className:"bg-white/20 text-white px-6 py-3 rounded-lg font-semibold hover:bg-white/30 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(Me,{className:"w-5 h-5 mx-auto mb-1"}),"Check Out"]})]}),d&&e.jsxs("div",{className:"mt-4 text-center text-sm",children:["Checked in at ",d.toLocaleTimeString()]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200",children:[e.jsx("div",{className:"border-b border-slate-200",children:e.jsx("div",{className:"flex overflow-x-auto",children:["attendance","drilling","blasting","loading"].map(g=>e.jsx("button",{onClick:()=>a(g),className:`px-6 py-3 font-medium capitalize whitespace-nowrap ${r===g?"text-blue-600 border-b-2 border-blue-600":"text-slate-600 hover:text-slate-900"}`,children:g==="loading"?"breaking/loading":g},g))})}),e.jsxs("div",{className:"p-6",children:[r==="attendance"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-semibold text-slate-900",children:"Attendance History"}),e.jsx("p",{className:"text-slate-600",children:"View your attendance records and work hours"}),e.jsx("div",{className:"bg-slate-50 rounded-lg p-4 text-center text-slate-600",children:"Attendance records will appear here"})]}),r==="drilling"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-semibold text-slate-900",children:"Quick Drilling Entry"}),e.jsx("p",{className:"text-slate-600 text-sm",children:"Record drilling activities on the go"}),e.jsxs("button",{className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg font-medium hover:bg-blue-700 transition-colors",children:[e.jsx(Gt,{className:"w-5 h-5 mx-auto mb-1"}),"Add Drilling Record"]})]}),r==="blasting"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-semibold text-slate-900",children:"Quick Blasting Entry"}),e.jsx("p",{className:"text-slate-600 text-sm",children:"Record blasting operations instantly"}),e.jsxs("button",{className:"w-full bg-orange-600 text-white py-3 px-4 rounded-lg font-medium hover:bg-orange-700 transition-colors",children:[e.jsx(Gt,{className:"w-5 h-5 mx-auto mb-1"}),"Add Blasting Record"]})]}),r==="loading"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-semibold text-slate-900",children:"Quick Breaking/Loading Entry"}),e.jsx("p",{className:"text-slate-600 text-sm",children:"Track breaking and loading operations in real-time"}),e.jsxs("button",{className:"w-full bg-green-600 text-white py-3 px-4 rounded-lg font-medium hover:bg-green-700 transition-colors",children:[e.jsx(Gt,{className:"w-5 h-5 mx-auto mb-1"}),"Add Breaking/Loading Record"]})]})]})]})]})}function ov({onSuccess:i,onCancel:r}){const[a,l]=k.useState(!1),[o,d]=k.useState(!0),[u,h]=k.useState({invoice_number:"",customer_name:"",invoice_date:new Date().toISOString().split("T")[0],due_date:"",tax_rate:"5",amount_paid:"0",payment_mode:"",payment_date:"",empty_weight:"",gross_weight:"",net_weight:"",notes:"",terms_conditions:`Payment due within 30 days.
Late payments may incur additional charges.`}),[p,g]=k.useState([{material:"",quantity:0,rate:0,amount:0}]),v=()=>{g([...p,{material:"",quantity:0,rate:0,amount:0}])},x=C=>{p.length>1&&g(p.filter((D,R)=>R!==C))},N=(C,D,R)=>{const F=[...p];F[C]={...F[C],[D]:R},(D==="quantity"||D==="rate")&&(F[C].amount=F[C].quantity*F[C].rate),g(F)},y=()=>{const C=p.reduce((H,ae)=>H+ae.amount,0),D=parseFloat(u.tax_rate)||0,R=C/(1+D/100),F=C-R;return{subtotal:R,taxAmount:F,total:C}},{subtotal:b,taxAmount:j,total:_}=y();k.useEffect(()=>{T()},[]),k.useEffect(()=>{if(u.net_weight){const C=parseFloat(u.net_weight);if(!isNaN(C)&&p.length>0){const D=[...p];D[0]={...D[0],quantity:C},g(D)}}},[u.net_weight]);const T=async()=>{try{const C=new Date().getFullYear(),{data:D,error:R}=await z.from("invoices").select("invoice_number").like("invoice_number",`INV-${C}-%`).order("created_at",{ascending:!1}).limit(1);if(R)throw R;let F=1;if(D&&D.length>0){const ae=D[0].invoice_number;F=parseInt(ae.split("-")[2])+1}const H=`INV-${C}-${String(F).padStart(3,"0")}`;h(ae=>({...ae,invoice_number:H}))}catch(C){console.error("Error generating invoice number:",C)}finally{d(!1)}},I=async C=>{C.preventDefault(),l(!0);try{const D=parseFloat(u.amount_paid)||0,R=_-D;let F="unpaid";R<=0?F="paid":D>0&&(F="partial");const H=[];D>0&&H.push({amount:D,payment_mode:u.payment_mode,payment_date:u.payment_date,notes:"Initial payment on invoice creation",recorded_at:new Date().toISOString()});const{error:ae}=await z.from("invoices").insert([{invoice_number:u.invoice_number,customer_name:u.customer_name,invoice_date:u.invoice_date,due_date:u.due_date,items:JSON.stringify(p),subtotal:b,tax_rate:parseFloat(u.tax_rate),tax_amount:j,total_amount:_,status:F,amount_paid:D,payment_mode:u.payment_mode||null,payment_date:u.payment_date||null,payment_history:H.length>0?JSON.stringify(H):null,notes:u.notes||null,terms_conditions:u.terms_conditions||null}]);if(ae)throw ae;alert("Invoice created successfully!"),i()}catch(D){alert(D.message)}finally{l(!1)}};return e.jsxs("form",{onSubmit:I,className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between pb-4 border-b border-slate-200",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(rt,{className:"w-5 h-5 text-blue-600"})}),e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"Create New Invoice"})]}),e.jsx("button",{type:"button",onClick:r,className:"text-slate-600 hover:text-slate-900",children:"Cancel"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Invoice Number *"}),e.jsx("input",{type:"text",required:!0,value:u.invoice_number,onChange:C=>h({...u,invoice_number:C.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-slate-50",placeholder:"Auto-generated",readOnly:o}),o&&e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Generating invoice number..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Customer Name *"}),e.jsx("input",{type:"text",required:!0,value:u.customer_name,onChange:C=>h({...u,customer_name:C.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Customer name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Invoice Date *"}),e.jsx("input",{type:"date",required:!0,value:u.invoice_date,onChange:C=>h({...u,invoice_date:C.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Due Date (Optional)"}),e.jsx("input",{type:"date",value:u.due_date,onChange:C=>h({...u,due_date:C.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),e.jsxs("div",{className:"border-t border-slate-200 pt-6",children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-700 mb-4",children:"Weight Information (Optional)"}),e.jsx("div",{className:"bg-white p-4 rounded-lg border border-slate-200",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Empty Weight (Tons)"}),e.jsx("input",{type:"number",step:"0.001",min:"0",value:u.empty_weight,onChange:C=>h({...u,empty_weight:C.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"0.000",title:"Enter weight in tons"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Gross Weight (Tons)"}),e.jsx("input",{type:"number",step:"0.001",min:"0",value:u.gross_weight,onChange:C=>h({...u,gross_weight:C.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"0.000",title:"Enter weight in tons"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Net Weight (Tons)"}),e.jsx("input",{type:"number",step:"0.001",min:"0",value:u.empty_weight&&u.gross_weight?(parseFloat(u.gross_weight)-parseFloat(u.empty_weight)).toFixed(3):u.net_weight,onChange:C=>h({...u,net_weight:C.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-slate-50",placeholder:"0.000",title:"Enter weight in tons",readOnly:!!(u.empty_weight&&u.gross_weight)})]})]})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-700",children:"Invoice Items"}),e.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["Rate is GST inclusive (includes ",u.tax_rate,"% GST)"]})]}),e.jsxs("button",{type:"button",onClick:v,className:"flex items-center gap-2 px-3 py-1 text-sm bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[e.jsx(ar,{className:"w-4 h-4"}),"Add Item"]})]}),e.jsxs("div",{className:"grid grid-cols-12 gap-3 px-3 mb-2",children:[e.jsx("div",{className:"col-span-5 text-xs font-medium text-slate-600",children:"Material/Description"}),e.jsx("div",{className:"col-span-2 text-xs font-medium text-slate-600",children:"Quantity"}),e.jsx("div",{className:"col-span-2 text-xs font-medium text-slate-600",children:"Rate (Inc. GST)"}),e.jsx("div",{className:"col-span-2 text-xs font-medium text-slate-600",children:"Amount"}),e.jsx("div",{className:"col-span-1"})]}),e.jsx("div",{className:"space-y-3",children:p.map((C,D)=>e.jsxs("div",{className:"grid grid-cols-12 gap-3 p-3 bg-slate-50 rounded-lg",children:[e.jsx("div",{className:"col-span-5",children:e.jsx("input",{type:"text",required:!0,value:C.material,onChange:R=>N(D,"material",R.target.value),className:"w-full px-3 py-2 text-sm border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Material/Description"})}),e.jsx("div",{className:"col-span-2",children:e.jsx("input",{type:"number",step:"0.01",required:!0,value:C.quantity||"",onChange:R=>N(D,"quantity",parseFloat(R.target.value)||0),className:"w-full px-3 py-2 text-sm border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Qty"})}),e.jsx("div",{className:"col-span-2",children:e.jsx("input",{type:"number",step:"0.01",required:!0,value:C.rate||"",onChange:R=>N(D,"rate",parseFloat(R.target.value)||0),className:"w-full px-3 py-2 text-sm border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Rate"})}),e.jsx("div",{className:"col-span-2",children:e.jsx("input",{type:"text",readOnly:!0,value:C.amount.toFixed(2),className:"w-full px-3 py-2 text-sm border border-slate-300 rounded-lg bg-slate-100",placeholder:"Amount"})}),e.jsx("div",{className:"col-span-1 flex items-center justify-center",children:e.jsx("button",{type:"button",onClick:()=>x(D),disabled:p.length===1,className:"p-2 text-red-600 hover:bg-red-50 rounded-lg disabled:opacity-30 disabled:cursor-not-allowed",children:e.jsx(gl,{className:"w-4 h-4"})})})]},D))})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Tax Rate (%)"}),e.jsx("input",{type:"number",step:"0.01",value:u.tax_rate,onChange:C=>h({...u,tax_rate:C.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{className:"bg-slate-50 rounded-lg p-4 space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-slate-600",children:"Base Amount:"}),e.jsxs("span",{className:"font-semibold text-slate-900",children:["",b.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsxs("span",{className:"text-slate-600",children:["GST (",u.tax_rate,"%):"]}),e.jsxs("span",{className:"font-semibold text-slate-900",children:["",j.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between text-base pt-2 border-t border-slate-300",children:[e.jsx("span",{className:"font-semibold text-slate-900",children:"Total (Inc. GST):"}),e.jsxs("span",{className:"font-bold text-blue-600 text-lg",children:["",_.toFixed(2)]})]})]})]}),e.jsxs("div",{className:"border-t border-slate-200 pt-6",children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-700 mb-4",children:"Payment Information (Optional)"}),e.jsx("div",{className:"bg-white p-4 rounded-lg border border-slate-200",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Amount Received"}),e.jsx("input",{type:"number",step:"0.01",min:"0",value:u.amount_paid,onChange:C=>h({...u,amount_paid:C.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"0.00"}),parseFloat(u.amount_paid)>0&&e.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["Balance: ",(_-parseFloat(u.amount_paid)).toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Payment Mode"}),e.jsxs("select",{value:u.payment_mode,onChange:C=>h({...u,payment_mode:C.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:!u.amount_paid||parseFloat(u.amount_paid)===0,children:[e.jsx("option",{value:"",children:"Select mode"}),e.jsx("option",{value:"cash",children:"Cash"}),e.jsx("option",{value:"bank_transfer",children:"Bank Transfer"}),e.jsx("option",{value:"cheque",children:"Cheque"}),e.jsx("option",{value:"upi",children:"UPI"}),e.jsx("option",{value:"card",children:"Card"}),e.jsx("option",{value:"other",children:"Other"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Payment Date"}),e.jsx("input",{type:"date",value:u.payment_date,onChange:C=>h({...u,payment_date:C.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:!u.amount_paid||parseFloat(u.amount_paid)===0})]})]})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Notes"}),e.jsx("textarea",{value:u.notes,onChange:C=>h({...u,notes:C.target.value}),rows:2,className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Additional notes for this invoice..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Terms & Conditions"}),e.jsx("textarea",{value:u.terms_conditions,onChange:C=>h({...u,terms_conditions:C.target.value}),rows:3,className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Terms and conditions..."})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-slate-200",children:[e.jsx("button",{type:"button",onClick:r,className:"px-6 py-2 border border-slate-300 text-slate-700 rounded-lg hover:bg-slate-50 transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:a,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-slate-400 transition-colors",children:a?"Creating...":"Create Invoice"})]})]})}function cv(i,r=!0){const a=typeof i.items=="string"?JSON.parse(i.items):i.items,l=window.open("","_blank","width=300,height=600");if(!l){alert("Please allow pop-ups to print invoice");return}const o=i.total_amount-i.amount_paid,d=(u,h,p=32)=>{const g=p-u.length-h.length;return u+" ".repeat(Math.max(1,g))+h};l.document.write(`
    <!DOCTYPE html>
    <html>
      <head>
        <title>Invoice ${i.invoice_number}</title>
        <meta charset="UTF-8">
        <style>
          @page {
            size: 80mm auto;
            margin: 0;
          }
          
          * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
          }
          
          body {
            width: 80mm;
            font-family: 'Courier New', monospace;
            font-size: 10pt;
            line-height: 1.4;
            padding: 5mm;
            background: white;
          }
          
          .center {
            text-align: center;
          }
          
          .bold {
            font-weight: bold;
          }
          
          .header {
            text-align: center;
            margin-bottom: 10px;
          }
          
          .company-name {
            font-size: 16pt;
            font-weight: bold;
            margin-bottom: 2px;
          }
          
          .invoice-title {
            font-size: 12pt;
            margin-bottom: 5px;
          }
          
          .separator {
            margin: 8px 0;
            border: none;
            border-top: 2px solid #000;
          }
          
          .dotted-line {
            margin: 5px 0;
            border: none;
            border-top: 1px dashed #666;
          }
          
          .section {
            margin: 8px 0;
          }
          
          .line {
            display: flex;
            justify-content: space-between;
            margin: 2px 0;
          }
          
          .item-row {
            margin: 3px 0;
          }
          
          .total-section {
            margin-top: 8px;
            border-top: 2px solid #000;
            padding-top: 5px;
          }
          
          .grand-total {
            font-size: 12pt;
            font-weight: bold;
            margin: 5px 0;
          }
          
          .status-badge {
            display: inline-block;
            padding: 2px 8px;
            margin: 5px 0;
            border: 1px solid #000;
            font-weight: bold;
          }
          
          .notes {
            margin-top: 10px;
            font-size: 9pt;
            padding: 5px;
            border: 1px solid #666;
          }
          
          .terms {
            margin-top: 8px;
            font-size: 8pt;
            text-align: center;
          }
          
          .footer {
            margin-top: 15px;
            text-align: center;
            font-size: 9pt;
          }
          
          pre {
            font-family: 'Courier New', monospace;
            font-size: 10pt;
            white-space: pre;
            margin: 0;
          }
          
          @media print {
            body {
              width: 80mm;
              padding: 2mm;
            }
          }
        </style>
      </head>
      <body>
        <div class="header">
          ${r?'<div class="company-name">SRI BABA BLUE MATELS PVT LTD</div>':""}
          <div class="invoice-title">BILL</div>
        </div>
        
        <hr class="separator">
        
        <div class="section">
          <pre>Bill#: ${i.invoice_number}</pre>
          <pre>Date    : ${new Date(i.invoice_date).toLocaleDateString("en-GB")}</pre>
          <pre>Due Date: ${new Date(i.due_date).toLocaleDateString("en-GB")}</pre>
        </div>
        
        <hr class="dotted-line">
        
        <div class="section">
          <div class="bold">BILL TO:</div>
          <pre>${i.customer_name}</pre>
        </div>
        
        <hr class="separator">
        
        <div class="section">
          <pre class="bold">${d("Item","Amount",32)}</pre>
          <pre class="bold">${d("Qty x Rate","",32)}</pre>
          <hr class="dotted-line">
          ${a.map(u=>`
          <div class="item-row">
            <pre>${u.material}</pre>
            <pre>${u.amount.toFixed(2)}</pre>
          </div>
          <pre>${u.quantity} x ${u.rate.toFixed(2)}</pre>
          `).join("")}
        </div>
        
        <hr class="dotted-line">
        
        <div class="total-section">
          <div class="line">
            <span>Total Amount:</span>
            <span class="bold">${i.total_amount.toFixed(2)}</span>
          </div>
          ${i.amount_paid>0?`
          <hr class="dotted-line">
          <div class="line">
            <span>Paid:</span>
            <span>${i.amount_paid.toFixed(2)}</span>
          </div>
          <div class="line">
            <span>Balance:</span>
            <span class="bold">${o.toFixed(2)}</span>
          </div>
          `:""}
        </div>
        
        <div class="center">
          <span class="status-badge">${i.status.toUpperCase()}</span>
        </div>
        
        ${i.notes?`
        <div class="notes">
          <div class="bold">Notes:</div>
          <pre style="white-space: pre-wrap; font-size: 9pt;">${i.notes}</pre>
        </div>
        `:""}
        
        ${i.terms_conditions?`
        <div class="terms">
          <hr class="dotted-line">
          <div class="bold">Terms & Conditions</div>
          <pre style="white-space: pre-wrap; font-size: 8pt;">${i.terms_conditions}</pre>
        </div>
        `:""}
        
        <div class="footer">
          <hr class="dotted-line">
          <div>Thank you for your business!</div>
          <div style="margin-top: 3px; font-size: 8pt;">Printed: ${new Date().toLocaleString("en-GB")}</div>
        </div>
      </body>
    </html>
  `),l.document.close(),setTimeout(()=>{l.print()},250)}function dv(i,r=!0){const a=typeof i.items=="string"?JSON.parse(i.items):i.items,l=window.open("","_blank","width=220,height=600");if(!l){alert("Please allow pop-ups to print invoice");return}const o=i.total_amount-i.amount_paid,d=(u,h,p=24)=>{const g=p-u.length-h.length;return u+" ".repeat(Math.max(1,g))+h};l.document.write(`
    <!DOCTYPE html>
    <html>
      <head>
        <title>Invoice ${i.invoice_number}</title>
        <meta charset="UTF-8">
        <style>
          @page {
            size: 58mm auto;
            margin: 0;
          }
          
          * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
          }
          
          body {
            width: 58mm;
            font-family: 'Courier New', monospace;
            font-size: 9pt;
            line-height: 1.3;
            padding: 3mm;
            background: white;
          }
          
          .center { text-align: center; }
          .bold { font-weight: bold; }
          
          .company-name {
            font-size: 14pt;
            font-weight: bold;
            text-align: center;
            margin-bottom: 2px;
          }
          
          .separator {
            margin: 5px 0;
            border: none;
            border-top: 1px solid #000;
          }
          
          .section { margin: 5px 0; }
          
          pre {
            font-family: 'Courier New', monospace;
            font-size: 9pt;
            white-space: pre;
            margin: 1px 0;
          }
          
          .grand-total {
            font-size: 11pt;
            font-weight: bold;
          }
          
          @media print {
            body {
              width: 58mm;
              padding: 2mm;
            }
          }
        </style>
      </head>
      <body>
        ${r?'<div class="company-name">SRI BABA BLUE MATELS PVT LTD</div>':""}
        <div class="center bold">BILL</div>
        <hr class="separator">
        
        <div class="section">
          <pre>INV: ${i.invoice_number}</pre>
          <pre>Date: ${new Date(i.invoice_date).toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"2-digit"})}</pre>
          <pre>Customer:</pre>
          <pre>${i.customer_name.substring(0,22)}</pre>
        </div>
        
        <hr class="separator">
        
        <div class="section">
          ${a.map(u=>`
          <pre>${u.material.substring(0,24)}</pre>
          <pre>${d(`${u.quantity}x${u.rate}`,`${u.amount.toFixed(2)}`,24)}</pre>
          `).join("")}
        </div>
        
        <hr class="separator">
        
        <div class="section">
          <pre class="bold grand-total">${d("TOTAL:",`${i.total_amount.toFixed(2)}`,24)}</pre>
          ${i.amount_paid>0?`
          <pre>${d("Paid:",`${i.amount_paid.toFixed(2)}`,24)}</pre>
          <pre class="bold">${d("Balance:",`${o.toFixed(2)}`,24)}</pre>
          `:""}
        </div>
        
        <div class="center bold">[${i.status.toUpperCase()}]</div>
        
        <div class="center" style="margin-top: 10px; font-size: 8pt;">
          <pre>Thank You!</pre>
        </div>
      </body>
    </html>
  `),l.document.close(),setTimeout(()=>{l.print()},250)}function uv(){const[i,r]=k.useState([]),[a,l]=k.useState(!0),[o,d]=k.useState(null),[u,h]=k.useState("all"),[p,g]=k.useState(""),[v,x]=k.useState(!1),[N,y]=k.useState(null),[b,j]=k.useState(!0),[_,T]=k.useState({amount:"",payment_mode:"cash",payment_date:new Date().toISOString().split("T")[0],notes:""});k.useEffect(()=>{I()},[]),k.useEffect(()=>{const U=ce=>{N&&(ce.target.closest(".print-menu-container")||y(null))};return document.addEventListener("mousedown",U),()=>document.removeEventListener("mousedown",U)},[N]);const I=async()=>{try{const{data:U,error:ce}=await z.from("invoices").select("*").order("invoice_date",{ascending:!1});if(ce)throw ce;r(U||[])}catch(U){console.error("Error fetching invoices:",U)}finally{l(!1)}},C=U=>{switch(U){case"paid":return"bg-green-100 text-green-800";case"partial":return"bg-amber-100 text-amber-800";case"unpaid":return"bg-red-100 text-red-800";default:return"bg-slate-100 text-slate-800"}},D=U=>{switch(U){case"paid":return e.jsx(et,{className:"w-4 h-4 text-green-600"});case"partial":return e.jsx(Tt,{className:"w-4 h-4 text-amber-600"});case"unpaid":return e.jsx(Tt,{className:"w-4 h-4 text-red-600"});default:return null}},R=i.filter(U=>u==="all"?!0:U.status===u).filter(U=>p?U.invoice_number.toLowerCase().includes(p.toLowerCase())||U.customer_name.toLowerCase().includes(p.toLowerCase()):!0),H=(()=>{const U=i.length,ce=i.reduce((G,V)=>G+V.total_amount,0),be=i.reduce((G,V)=>G+V.amount_paid,0),Oe=ce-be,Re=i.filter(G=>G.status==="paid").length,qe=i.filter(G=>G.status==="unpaid").length;return{totalInvoices:U,totalAmount:ce,totalPaid:be,totalPending:Oe,paidCount:Re,unpaidCount:qe}})(),ae=U=>{d(U);const ce=U.total_amount-U.amount_paid;T({amount:ce.toFixed(2),payment_mode:"cash",payment_date:new Date().toISOString().split("T")[0],notes:""}),x(!0)},_e=async()=>{if(o)try{const U=parseFloat(_.amount),ce=o.amount_paid+U,be=o.total_amount-ce;let Oe="unpaid";be<=0?Oe="paid":ce>0&&(Oe="partial");const Re=o.payment_history?JSON.parse(o.payment_history):[];Re.push({amount:U,payment_mode:_.payment_mode,payment_date:_.payment_date,notes:_.notes,recorded_at:new Date().toISOString()});const{error:qe}=await z.from("invoices").update({amount_paid:ce,status:Oe,payment_mode:_.payment_mode,payment_date:_.payment_date,payment_history:JSON.stringify(Re)}).eq("id",o.id);if(qe)throw qe;alert("Payment recorded successfully!"),x(!1),d(null),I()}catch(U){alert("Error recording payment: "+U.message)}},He=(U,ce=!0)=>{const be=JSON.parse(U.items),Oe=window.open("","_blank");Oe&&(Oe.document.write(`
      <html>
        <head>
          <title>Invoice ${U.invoice_number}</title>
          <style>
            body { font-family: Arial, sans-serif; padding: 40px; }
            .header { text-align: center; margin-bottom: 30px; }
            .company-name { font-size: 24px; font-weight: bold; }
            .invoice-info { margin-bottom: 30px; }
            .customer-info { margin-bottom: 30px; }
            table { width: 100%; border-collapse: collapse; margin: 20px 0; }
            th, td { padding: 10px; text-align: left; border-bottom: 1px solid #ddd; }
            th { background-color: #f5f5f5; font-weight: bold; }
            .totals { text-align: right; margin-top: 20px; }
            .totals table { width: 300px; margin-left: auto; }
            .total-row { font-weight: bold; font-size: 16px; }
            .notes { margin-top: 30px; padding: 15px; background-color: #f9f9f9; }
            .terms { margin-top: 20px; font-size: 12px; color: #666; }
          </style>
        </head>
        <body>
          <div class="header">
            ${ce?'<div class="company-name">SRI BABA BLUE MATELS PVT LTD</div>':""}
            <div>Invoice</div>
          </div>

          <div class="invoice-info">
            <table style="width: 100%; border: none;">
              <tr>
                <td style="border: none;"><strong>Invoice Number:</strong> ${U.invoice_number}</td>
                <td style="border: none; text-align: right;"><strong>Date:</strong> ${new Date(U.invoice_date).toLocaleDateString()}</td>
              </tr>
              <tr>
                <td style="border: none;"><strong>Customer:</strong> ${U.customer_name}</td>
                <td style="border: none; text-align: right;"><strong>Due Date:</strong> ${new Date(U.due_date).toLocaleDateString()}</td>
              </tr>
            </table>
          </div>

          <table>
            <thead>
              <tr>
                <th>Material/Description</th>
                <th style="text-align: right;">Quantity</th>
                <th style="text-align: right;">Rate</th>
                <th style="text-align: right;">Amount</th>
              </tr>
            </thead>
            <tbody>
              ${be.map(Re=>`
                <tr>
                  <td>${Re.material}</td>
                  <td style="text-align: right;">${Re.quantity}</td>
                  <td style="text-align: right;">${Re.rate.toFixed(2)}</td>
                  <td style="text-align: right;">${Re.amount.toFixed(2)}</td>
                </tr>
              `).join("")}
            </tbody>
          </table>

          <div class="totals">
            <table>
              <tr>
                <td>Subtotal:</td>
                <td style="text-align: right;">${U.subtotal.toFixed(2)}</td>
              </tr>
              <tr>
                <td>Tax (${U.tax_rate}%):</td>
                <td style="text-align: right;">${U.tax_amount.toFixed(2)}</td>
              </tr>
              <tr class="total-row">
                <td>Total:</td>
                <td style="text-align: right;">${U.total_amount.toFixed(2)}</td>
              </tr>
              ${U.amount_paid>0?`
              <tr>
                <td>Paid:</td>
                <td style="text-align: right; color: green;">${U.amount_paid.toFixed(2)}</td>
              </tr>
              <tr class="total-row">
                <td>Balance Due:</td>
                <td style="text-align: right; color: red;">${(U.total_amount-U.amount_paid).toFixed(2)}</td>
              </tr>
              `:""}
            </table>
          </div>

          ${U.notes?`
          <div class="notes">
            <strong>Notes:</strong><br/>
            ${U.notes}
          </div>
          `:""}

          ${U.terms_conditions?`
          <div class="terms">
            <strong>Terms & Conditions:</strong><br/>
            ${U.terms_conditions.replace(/\n/g,"<br/>")}
          </div>
          `:""}
        </body>
      </html>
    `),Oe.document.close(),Oe.print())};return a?e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-8 text-center",children:e.jsx("p",{className:"text-slate-600",children:"Loading invoices..."})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx("div",{className:"bg-blue-50 rounded-lg p-4 border border-blue-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(rt,{className:"w-8 h-8 text-blue-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-blue-600 font-medium",children:"Total Invoices"}),e.jsx("p",{className:"text-2xl font-bold text-blue-900",children:H.totalInvoices})]})]})}),e.jsx("div",{className:"bg-green-50 rounded-lg p-4 border border-green-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ct,{className:"w-8 h-8 text-green-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-green-600 font-medium",children:"Total Amount"}),e.jsxs("p",{className:"text-2xl font-bold text-green-900",children:["",H.totalAmount.toFixed(0)]})]})]})}),e.jsx("div",{className:"bg-emerald-50 rounded-lg p-4 border border-emerald-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(et,{className:"w-8 h-8 text-emerald-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-emerald-600 font-medium",children:"Paid"}),e.jsxs("p",{className:"text-2xl font-bold text-emerald-900",children:["",H.totalPaid.toFixed(0)]})]})]})}),e.jsx("div",{className:"bg-red-50 rounded-lg p-4 border border-red-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Tt,{className:"w-8 h-8 text-red-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-red-600 font-medium",children:"Pending"}),e.jsxs("p",{className:"text-2xl font-bold text-red-900",children:["",H.totalPending.toFixed(0)]})]})]})})]}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-4",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsx("input",{type:"text",placeholder:"Search by invoice number or customer...",value:p,onChange:U=>g(U.target.value),className:"flex-1 px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),e.jsxs("select",{value:u,onChange:U=>h(U.target.value),className:"px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"unpaid",children:"Unpaid"}),e.jsx("option",{value:"partial",children:"Partially Paid"}),e.jsx("option",{value:"paid",children:"Paid"})]})]})}),R.length===0?e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-8 text-center",children:[e.jsx(rt,{className:"w-12 h-12 text-slate-400 mx-auto mb-3"}),e.jsx("p",{className:"text-slate-600",children:"No invoices found"})]}):e.jsx("div",{className:"space-y-4",children:R.map(U=>e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(rt,{className:"w-6 h-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:U.invoice_number}),e.jsxs("span",{className:`flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium ${C(U.status)}`,children:[D(U.status),U.status.toUpperCase()]})]}),e.jsx("p",{className:"text-sm text-slate-600",children:U.customer_name})]})]}),e.jsxs("div",{className:"flex gap-2",children:[U.status!=="paid"&&e.jsxs("button",{onClick:()=>ae(U),className:"flex items-center gap-2 px-3 py-2 text-white bg-green-600 rounded-lg hover:bg-green-700",children:[e.jsx(Qp,{className:"w-4 h-4"}),"Record Payment"]}),e.jsxs("div",{className:"relative print-menu-container",children:[e.jsxs("button",{onClick:()=>y(N===U.id?null:U.id),className:"flex items-center gap-2 px-3 py-2 text-slate-700 border border-slate-300 rounded-lg hover:bg-slate-50",children:[e.jsx(Lm,{className:"w-4 h-4"}),"Print"]}),N===U.id&&e.jsxs("div",{className:"absolute right-0 mt-2 w-64 bg-white rounded-lg shadow-lg border border-slate-200 z-10",children:[e.jsx("div",{className:"px-4 py-3 border-b border-slate-200",children:e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:b,onChange:ce=>j(ce.target.checked),className:"w-4 h-4 text-blue-600 rounded focus:ring-2 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Show Company Name"})]})}),e.jsxs("div",{className:"py-1",children:[e.jsxs("button",{onClick:()=>{He(U,b),y(null)},className:"w-full flex items-center gap-3 px-4 py-2 text-left text-slate-700 hover:bg-slate-50",children:[e.jsx(Lm,{className:"w-4 h-4"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"Standard Print"}),e.jsx("div",{className:"text-xs text-slate-500",children:"A4 Size"})]})]}),e.jsxs("button",{onClick:()=>{cv(U,b),y(null)},className:"w-full flex items-center gap-3 px-4 py-2 text-left text-slate-700 hover:bg-slate-50",children:[e.jsx(Im,{className:"w-4 h-4"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"Thermal 80mm"}),e.jsx("div",{className:"text-xs text-slate-500",children:"Standard thermal"})]})]}),e.jsxs("button",{onClick:()=>{dv(U,b),y(null)},className:"w-full flex items-center gap-3 px-4 py-2 text-left text-slate-700 hover:bg-slate-50",children:[e.jsx(Im,{className:"w-4 h-4"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"Thermal 58mm"}),e.jsx("div",{className:"text-xs text-slate-500",children:"Compact thermal"})]})]})]})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 mb-1",children:"Invoice Date"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ge,{className:"w-4 h-4 text-slate-400"}),e.jsx("p",{className:"text-sm font-medium text-slate-900",children:new Date(U.invoice_date).toLocaleDateString()})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 mb-1",children:"Due Date"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ge,{className:"w-4 h-4 text-slate-400"}),e.jsx("p",{className:"text-sm font-medium text-slate-900",children:new Date(U.due_date).toLocaleDateString()})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 mb-1",children:"Total Amount"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ct,{className:"w-4 h-4 text-slate-400"}),e.jsxs("p",{className:"text-sm font-bold text-slate-900",children:["",U.total_amount.toFixed(2)]})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 mb-1",children:"Balance Due"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ct,{className:"w-4 h-4 text-slate-400"}),e.jsxs("p",{className:"text-sm font-bold text-red-600",children:["",(U.total_amount-U.amount_paid).toFixed(2)]})]})]})]}),U.amount_paid>0&&e.jsx("div",{className:"pt-4 border-t border-slate-200 mb-4",children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 mb-1",children:"Amount Paid"}),e.jsxs("p",{className:"text-sm font-bold text-green-600",children:["",U.amount_paid.toFixed(2)]})]}),U.payment_mode&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 mb-1",children:"Payment Mode"}),e.jsx("p",{className:"text-sm font-medium text-slate-900 capitalize",children:U.payment_mode})]}),U.payment_date&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 mb-1",children:"Payment Date"}),e.jsx("p",{className:"text-sm font-medium text-slate-900",children:new Date(U.payment_date).toLocaleDateString()})]})]})}),U.notes&&e.jsxs("div",{className:"pt-4 border-t border-slate-200",children:[e.jsx("p",{className:"text-xs text-slate-500 mb-1",children:"Notes"}),e.jsx("p",{className:"text-sm text-slate-700",children:U.notes})]})]},U.id))}),v&&o&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"Record Payment"}),e.jsx("button",{onClick:()=>x(!1),className:"text-slate-400 hover:text-slate-600",children:e.jsx(wl,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsxs("div",{className:"bg-slate-50 rounded-lg p-4",children:[e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsx("span",{className:"text-sm text-slate-600",children:"Invoice Number:"}),e.jsx("span",{className:"text-sm font-semibold text-slate-900",children:o.invoice_number})]}),e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsx("span",{className:"text-sm text-slate-600",children:"Customer:"}),e.jsx("span",{className:"text-sm font-semibold text-slate-900",children:o.customer_name})]}),e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsx("span",{className:"text-sm text-slate-600",children:"Total Amount:"}),e.jsxs("span",{className:"text-sm font-semibold text-slate-900",children:["",o.total_amount.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsx("span",{className:"text-sm text-slate-600",children:"Already Paid:"}),e.jsxs("span",{className:"text-sm font-semibold text-green-600",children:["",o.amount_paid.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between pt-2 border-t border-slate-300",children:[e.jsx("span",{className:"text-sm font-semibold text-slate-600",children:"Balance Due:"}),e.jsxs("span",{className:"text-base font-bold text-red-600",children:["",(o.total_amount-o.amount_paid).toFixed(2)]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Payment Amount *"}),e.jsx("input",{type:"number",step:"0.01",required:!0,value:_.amount,onChange:U=>T({..._,amount:U.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"0.00"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Payment Mode *"}),e.jsxs("select",{required:!0,value:_.payment_mode,onChange:U=>T({..._,payment_mode:U.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[e.jsx("option",{value:"cash",children:"Cash"}),e.jsx("option",{value:"bank_transfer",children:"Bank Transfer"}),e.jsx("option",{value:"cheque",children:"Cheque"}),e.jsx("option",{value:"upi",children:"UPI"}),e.jsx("option",{value:"card",children:"Card"}),e.jsx("option",{value:"other",children:"Other"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Payment Date *"}),e.jsx("input",{type:"date",required:!0,value:_.payment_date,onChange:U=>T({..._,payment_date:U.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Notes"}),e.jsx("textarea",{value:_.notes,onChange:U=>T({..._,notes:U.target.value}),rows:2,className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"Payment reference or notes..."})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>x(!1),className:"flex-1 px-4 py-2 border border-slate-300 text-slate-700 rounded-lg hover:bg-slate-50",children:"Cancel"}),e.jsx("button",{onClick:_e,className:"flex-1 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:"Record Payment"})]})]})})]})}function mv(){Ne();const[i,r]=k.useState("invoices"),[a,l]=k.useState([]),[o,d]=k.useState(!0),[u,h]=k.useState(!1);k.useEffect(()=>{i==="customers"&&p()},[i]);const p=async()=>{d(!0);try{const{data:g,error:v}=await z.from("customers").select("*").order("created_at",{ascending:!1});if(v)throw v;l(g||[])}catch(g){console.error("Error loading customers:",g)}finally{d(!1)}};return u?e.jsx("div",{className:"space-y-6",children:e.jsx(ov,{onSuccess:()=>{h(!1),window.location.reload()},onCancel:()=>h(!1)})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Sales Management"}),e.jsx("p",{className:"text-slate-600 mt-1",children:"Manage invoices and customers"})]}),e.jsxs("button",{onClick:()=>h(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(ar,{className:"w-5 h-5"}),"New Invoice"]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200",children:[e.jsx("div",{className:"border-b border-slate-200",children:e.jsxs("div",{className:"flex",children:[e.jsx("button",{onClick:()=>r("invoices"),className:`px-6 py-3 font-medium ${i==="invoices"?"text-blue-600 border-b-2 border-blue-600":"text-slate-600 hover:text-slate-900"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(rt,{className:"w-4 h-4"}),"Invoices"]})}),e.jsx("button",{onClick:()=>r("customers"),className:`px-6 py-3 font-medium ${i==="customers"?"text-blue-600 border-b-2 border-blue-600":"text-slate-600 hover:text-slate-900"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ft,{className:"w-4 h-4"}),"Customers"]})})]})}),e.jsxs("div",{className:"p-6",children:[i==="invoices"&&e.jsx(uv,{}),i==="customers"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(jl,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-slate-400"}),e.jsx("input",{type:"text",placeholder:"Search customers...",className:"w-full pl-10 pr-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-600 focus:border-transparent"})]}),e.jsx("button",{onClick:()=>window.location.hash="customer-form",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",title:"Add New Customer",children:e.jsx(ar,{className:"w-5 h-5"})})]}),o?e.jsx("div",{className:"text-center py-8 text-slate-600",children:"Loading customers..."}):a.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(ft,{className:"w-12 h-12 text-slate-400 mx-auto mb-3"}),e.jsx("p",{className:"text-slate-600",children:"No customers found"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:a.map(g=>e.jsxs("div",{className:"border border-slate-200 rounded-lg p-4 hover:border-slate-300 transition-colors",children:[e.jsx("h4",{className:"font-semibold text-slate-900",children:g.name}),g.company&&e.jsx("p",{className:"text-sm text-slate-600 mt-1",children:g.company}),e.jsxs("div",{className:"mt-2 space-y-1",children:[g.email&&e.jsx("p",{className:"text-xs text-slate-500",children:g.email}),g.phone&&e.jsx("p",{className:"text-xs text-slate-500",children:g.phone})]})]},g.id))})]})]})]})]})}function hv(){const{user:i}=Ne(),[r,a]=k.useState([]),[l,o]=k.useState(!0),[d,u]=k.useState("pending");k.useEffect(()=>{h()},[d]);const h=async()=>{o(!0);try{let x=z.from("approval_workflows").select("*, users!approval_workflows_submitted_by_fkey(full_name)").order("submitted_at",{ascending:!1});d!=="all"&&(x=x.eq("status",d));const{data:N,error:y}=await x;if(y)throw y;a(N||[])}catch(x){console.error("Error loading approvals:",x)}finally{o(!1)}},p=async(x,N)=>{try{const{error:y}=await z.from("approval_workflows").update({status:N,approver_id:i?.id,reviewed_at:new Date().toISOString()}).eq("id",x);if(y)throw y;await h(),alert(`Request ${N} successfully!`)}catch(y){alert("Error updating approval: "+y.message)}},g=x=>({pending:"bg-yellow-100 text-yellow-700",approved:"bg-green-100 text-green-700",rejected:"bg-red-100 text-red-700"})[x]||"bg-slate-100 text-slate-700",v=x=>({drilling:"Drilling Record",blasting:"Blasting Record",loading:"Loading Record",production:"Production Record",quotation:"Quotation",order:"Sales Order"})[x]||x;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Approvals"}),e.jsx("p",{className:"text-slate-600 mt-1",children:"Review and approve pending requests"})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200",children:[e.jsx("div",{className:"border-b border-slate-200 p-4",children:e.jsx("div",{className:"flex gap-2",children:["all","pending","approved","rejected"].map(x=>e.jsx("button",{onClick:()=>u(x),className:`px-4 py-2 rounded-lg font-medium capitalize transition-colors ${d===x?"bg-slate-900 text-white":"bg-slate-100 text-slate-700 hover:bg-slate-200"}`,children:x},x))})}),e.jsx("div",{className:"p-6",children:l?e.jsx("div",{className:"text-center py-8 text-slate-600",children:"Loading approvals..."}):r.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(rt,{className:"w-12 h-12 text-slate-400 mx-auto mb-3"}),e.jsx("p",{className:"text-slate-600",children:"No approval requests found"})]}):e.jsx("div",{className:"space-y-4",children:r.map(x=>e.jsx("div",{className:"border border-slate-200 rounded-lg p-4 hover:border-slate-300 transition-colors",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h4",{className:"font-semibold text-slate-900",children:v(x.record_type)}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${g(x.status)}`,children:x.status})]}),e.jsxs("p",{className:"text-sm text-slate-600",children:["Submitted by ",x.users?.full_name," on"," ",new Date(x.submitted_at).toLocaleDateString()]})]}),x.status==="pending"&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>p(x.id,"approved"),className:"p-2 text-green-600 hover:bg-green-50 rounded-lg transition-colors",title:"Approve",children:e.jsx(et,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>p(x.id,"rejected"),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Reject",children:e.jsx(rs,{className:"w-5 h-5"})})]})]})},x.id))})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-gradient-to-br from-yellow-500 to-orange-500 rounded-xl p-6 text-white",children:[e.jsx(Me,{className:"w-10 h-10 mb-3 opacity-80"}),e.jsx("p",{className:"text-2xl font-bold",children:r.filter(x=>x.status==="pending").length}),e.jsx("p",{className:"text-yellow-100 mt-1",children:"Pending Approvals"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-green-500 to-emerald-500 rounded-xl p-6 text-white",children:[e.jsx(et,{className:"w-10 h-10 mb-3 opacity-80"}),e.jsx("p",{className:"text-2xl font-bold",children:r.filter(x=>x.status==="approved").length}),e.jsx("p",{className:"text-green-100 mt-1",children:"Approved Today"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-red-500 to-pink-500 rounded-xl p-6 text-white",children:[e.jsx(rs,{className:"w-10 h-10 mb-3 opacity-80"}),e.jsx("p",{className:"text-2xl font-bold",children:r.filter(x=>x.status==="rejected").length}),e.jsx("p",{className:"text-red-100 mt-1",children:"Rejected Today"})]})]})]})}function fv({onSuccess:i}){const[r,a]=k.useState(!1),[l,o]=k.useState(!1),[d,u]=k.useState(0),h=k.useRef(null),p=[{value:"sri_baba_blue_metals",label:"Sri Baba Blue Metals"},{value:"kvss",label:"KVSS"}],[g,v]=k.useState({company_name:"",permit_type:"",approval_date:"",expiry_date:"",status:"active",description:"",document_url:"",quantity_in_mt:""}),x=async y=>{try{const b=y.target.files?.[0];if(!b)return;if(b.type!=="application/pdf"){alert("Please upload a PDF file");return}o(!0),u(0),u(100);const j=b.name.split(".").pop(),T=`${`${Math.random().toString(36).substring(2)}.${j}`}`,I=z.storage.from("permit-documents").upload(T,b,{cacheControl:"3600",upsert:!1}),C=setInterval(()=>{u(F=>Math.min(F+10,90))},300),{error:D}=await I;if(clearInterval(C),D)throw D;const{data:{publicUrl:R}}=z.storage.from("permit-documents").getPublicUrl(T);v(F=>({...F,document_url:R}))}catch(b){alert(`Error uploading file: ${b.message}`)}finally{o(!1)}},N=async y=>{if(y.preventDefault(),!g.document_url){alert("Please upload a PDF document");return}a(!0);try{const{data:{user:b}}=await z.auth.getUser();if(!b){alert("You must be logged in");return}const{error:j}=await z.from("permits").insert([{...g,created_by:b.id}]);if(j)throw j;alert("Permit created successfully!"),v({company_name:"",permit_type:"",approval_date:"",expiry_date:"",status:"active",description:"",document_url:"",quantity_in_mt:""}),i()}catch(b){alert(b.message)}finally{a(!1)}};return e.jsxs("form",{onSubmit:N,className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-3 pb-4 border-b border-slate-200",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(rt,{className:"w-5 h-5 text-blue-600"})}),e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"New Permit Application"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Company Name *"}),e.jsxs("select",{required:!0,value:g.company_name,onChange:y=>v({...g,company_name:y.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Select Company"}),p.map(y=>e.jsx("option",{value:y.value,children:y.label},y.value))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Permit Type *"}),e.jsxs("select",{required:!0,value:g.permit_type,onChange:y=>v({...g,permit_type:y.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Select Type"}),e.jsx("option",{value:"quarry",children:"Quarry Permit"}),e.jsx("option",{value:"crusher",children:"Crusher Permit"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Quantity (MT) *"}),e.jsx("input",{type:"number",step:"0.01",min:"0",required:!0,value:g.quantity_in_mt,onChange:y=>v({...g,quantity_in_mt:y.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter quantity in metric tons"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Approval Date *"}),e.jsx("input",{type:"date",required:!0,value:g.approval_date,onChange:y=>v({...g,approval_date:y.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Expiry Date *"}),e.jsx("input",{type:"date",required:!0,value:g.expiry_date,onChange:y=>v({...g,expiry_date:y.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Status"}),e.jsxs("select",{value:g.status,onChange:y=>v({...g,status:y.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"expired",children:"Expired"}),e.jsx("option",{value:"pending_renewal",children:"Pending Renewal"})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:["Upload Document (PDF only) ",g.document_url&&e.jsx("span",{className:"text-green-600 ml-1",children:""})]}),e.jsx("div",{className:"mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-slate-300 border-dashed rounded-lg",children:e.jsxs("div",{className:"space-y-1 text-center",children:[g.document_url?e.jsxs("div",{className:"flex flex-col items-center text-green-600",children:[e.jsx(Gp,{className:"mx-auto h-12 w-12"}),e.jsx("p",{className:"mt-2 text-sm",children:"Document uploaded successfully"}),e.jsx("button",{type:"button",onClick:()=>h.current?.click(),className:"mt-2 text-sm text-blue-600 hover:text-blue-500",children:"Change file"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex justify-center",children:e.jsx(xh,{className:"mx-auto h-12 w-12 text-slate-400"})}),e.jsxs("div",{className:"flex text-sm text-slate-600",children:[e.jsxs("label",{htmlFor:"file-upload",className:"relative cursor-pointer bg-white rounded-md font-medium text-blue-600 hover:text-blue-500 focus-within:outline-none",children:[e.jsx("span",{children:"Upload a file"}),e.jsx("input",{id:"file-upload",name:"file-upload",type:"file",className:"sr-only",accept:".pdf,application/pdf",onChange:x,ref:h,disabled:l})]}),e.jsx("p",{className:"pl-1",children:"or drag and drop"})]}),e.jsx("p",{className:"text-xs text-slate-500",children:"PDF up to 10MB"})]}),l&&e.jsx("div",{className:"w-full bg-slate-200 rounded-full h-2.5 mt-2",children:e.jsx("div",{className:"bg-blue-600 h-2.5 rounded-full",style:{width:`${d}%`}})})]})}),g.document_url&&e.jsx("div",{className:"mt-2 text-sm text-slate-600",children:e.jsx("a",{href:g.document_url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:"View uploaded document"})})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Description"}),e.jsx("textarea",{value:g.description,onChange:y=>v({...g,description:y.target.value}),rows:3,className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Additional details about the permit..."})]})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t border-slate-200",children:e.jsx("button",{type:"submit",disabled:r,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-slate-400 transition-colors",children:r?"Creating...":"Create Permit"})})]})}function xv(){const[i,r]=k.useState([]),[a,l]=k.useState(!0);k.useEffect(()=>{o()},[]);const o=async()=>{try{const{data:p,error:g}=await z.from("permits").select("*").order("created_at",{ascending:!1});if(g)throw g;r(p||[])}catch(p){console.error("Error fetching permits:",p)}finally{l(!1)}},d=p=>{switch(p){case"active":return e.jsx(et,{className:"w-5 h-5 text-green-600"});case"expired":return e.jsx(Tt,{className:"w-5 h-5 text-red-600"});case"pending_renewal":return e.jsx(Me,{className:"w-5 h-5 text-amber-600"});default:return e.jsx(rt,{className:"w-5 h-5 text-slate-600"})}},u=p=>{switch(p){case"active":return"bg-green-100 text-green-800";case"expired":return"bg-red-100 text-red-800";case"pending_renewal":return"bg-amber-100 text-amber-800";default:return"bg-slate-100 text-slate-800"}},h=p=>p.split("_").map(g=>g.charAt(0).toUpperCase()+g.slice(1)).join(" ");return a?e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-8 text-center",children:e.jsx("p",{className:"text-slate-600",children:"Loading permits..."})}):i.length===0?e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-8 text-center",children:[e.jsx(rt,{className:"w-12 h-12 text-slate-400 mx-auto mb-3"}),e.jsx("p",{className:"text-slate-600",children:"No permits found"})]}):e.jsx("div",{className:"space-y-4",children:i.map(p=>e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(rt,{className:"w-6 h-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:p.permit_number}),e.jsx("p",{className:"text-sm text-slate-600",children:h(p.permit_type)})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[d(p.status),e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${u(p.status)}`,children:p.status.replace("_"," ").toUpperCase()})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 mb-1",children:"Issuing Authority"}),e.jsx("p",{className:"text-sm font-medium text-slate-900",children:p.issuing_authority})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 mb-1",children:"Approval Date"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ge,{className:"w-4 h-4 text-slate-400"}),e.jsx("p",{className:"text-sm font-medium text-slate-900",children:new Date(p.approval_date).toLocaleDateString()})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 mb-1",children:"Expiry Date"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ge,{className:"w-4 h-4 text-slate-400"}),e.jsx("p",{className:"text-sm font-medium text-slate-900",children:new Date(p.expiry_date).toLocaleDateString()})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 mb-1",children:"Days Until Expiry"}),e.jsxs("p",{className:"text-sm font-medium text-slate-900",children:[Math.ceil((new Date(p.expiry_date).getTime()-new Date().getTime())/(1e3*60*60*24))," days"]})]})]}),p.description&&e.jsxs("div",{className:"mb-4",children:[e.jsx("p",{className:"text-xs text-slate-500 mb-1",children:"Description"}),e.jsx("p",{className:"text-sm text-slate-700",children:p.description})]}),p.document_url&&e.jsx("div",{className:"pt-4 border-t border-slate-200",children:e.jsx("a",{href:p.document_url,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:text-blue-700 font-medium",children:"View Document "})})]},p.id))})}function pv({onSuccess:i}){const[r,a]=k.useState(!1),[l,o]=k.useState({transaction_type:"invoice",invoice_number:"",customer_name:"",amount:"",amount_given:"",reason:"",transaction_date:new Date().toISOString().split("T")[0],payment_method:"",status:"pending",notes:""}),d=async h=>{h.preventDefault(),a(!0);try{const{data:{user:p}}=await z.auth.getUser();if(!p){alert("You must be logged in");return}const{error:g}=await z.from("accounts").insert([{transaction_type:l.transaction_type,invoice_number:l.invoice_number||null,customer_name:l.customer_name,amount:parseFloat(l.amount),amount_given:l.amount_given?parseFloat(l.amount_given):0,reason:l.reason,transaction_date:l.transaction_date,payment_method:l.payment_method||null,status:l.status,notes:l.notes||null,created_by:p.id}]);if(g)throw g;alert("Account record created successfully!"),o({transaction_type:"invoice",invoice_number:"",customer_name:"",amount:"",amount_given:"",reason:"",transaction_date:new Date().toISOString().split("T")[0],payment_method:"",status:"pending",notes:""}),i()}catch(p){alert(p.message)}finally{a(!1)}},u=()=>{const h=parseFloat(l.amount)||0,p=parseFloat(l.amount_given)||0;return h-p};return e.jsxs("form",{onSubmit:d,className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-3 pb-4 border-b border-slate-200",children:[e.jsx("div",{className:"w-10 h-10 bg-emerald-100 rounded-lg flex items-center justify-center",children:e.jsx(Gr,{className:"w-5 h-5 text-emerald-600"})}),e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"New Account Entry"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Transaction Type *"}),e.jsxs("select",{required:!0,value:l.transaction_type,onChange:h=>o({...l,transaction_type:h.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent",children:[e.jsx("option",{value:"invoice",children:"Invoice"}),e.jsx("option",{value:"payment",children:"Payment"}),e.jsx("option",{value:"expense",children:"Expense"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Invoice Number"}),e.jsx("input",{type:"text",value:l.invoice_number,onChange:h=>o({...l,invoice_number:h.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"INV-2024-001"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Customer/Recipient Name *"}),e.jsx("input",{type:"text",required:!0,value:l.customer_name,onChange:h=>o({...l,customer_name:h.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"Enter name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Transaction Date *"}),e.jsx("input",{type:"date",required:!0,value:l.transaction_date,onChange:h=>o({...l,transaction_date:h.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Total Amount *"}),e.jsxs("div",{className:"relative",children:[e.jsx(ct,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400"}),e.jsx("input",{type:"number",step:"0.01",required:!0,value:l.amount,onChange:h=>o({...l,amount:h.target.value}),className:"w-full pl-10 pr-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"0.00"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Amount Given/Paid"}),e.jsxs("div",{className:"relative",children:[e.jsx(ct,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400"}),e.jsx("input",{type:"number",step:"0.01",value:l.amount_given,onChange:h=>o({...l,amount_given:h.target.value}),className:"w-full pl-10 pr-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"0.00"})]})]}),(l.amount||l.amount_given)&&e.jsx("div",{className:"md:col-span-2",children:e.jsx("div",{className:"p-4 bg-slate-50 rounded-lg border border-slate-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Outstanding Balance:"}),e.jsxs("span",{className:`text-lg font-bold ${u()>0?"text-red-600":"text-green-600"}`,children:["",u().toFixed(2)]})]})})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Payment Method"}),e.jsxs("select",{value:l.payment_method,onChange:h=>o({...l,payment_method:h.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Select Method"}),e.jsx("option",{value:"cash",children:"Cash"}),e.jsx("option",{value:"bank_transfer",children:"Bank Transfer"}),e.jsx("option",{value:"cheque",children:"Cheque"}),e.jsx("option",{value:"credit_card",children:"Credit Card"}),e.jsx("option",{value:"online",children:"Online Payment"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Status *"}),e.jsxs("select",{required:!0,value:l.status,onChange:h=>o({...l,status:h.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent",children:[e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"partial",children:"Partial Payment"}),e.jsx("option",{value:"paid",children:"Fully Paid"}),e.jsx("option",{value:"overdue",children:"Overdue"})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Reason/Purpose *"}),e.jsx("input",{type:"text",required:!0,value:l.reason,onChange:h=>o({...l,reason:h.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"e.g., Material supply, Equipment rental, Services rendered"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Additional Notes"}),e.jsx("textarea",{value:l.notes,onChange:h=>o({...l,notes:h.target.value}),rows:3,className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"Additional details or remarks..."})]})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t border-slate-200",children:e.jsx("button",{type:"submit",disabled:r,className:"px-6 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 disabled:bg-slate-400 transition-colors",children:r?"Saving...":"Save Entry"})})]})}function gv(){const[i,r]=k.useState([]),[a,l]=k.useState(!0),[o,d]=k.useState("all"),[u,h]=k.useState("");k.useEffect(()=>{p()},[]);const p=async()=>{try{const{data:b,error:j}=await z.from("accounts").select("*").order("transaction_date",{ascending:!1});if(j)throw j;r(b||[])}catch(b){console.error("Error fetching accounts:",b)}finally{l(!1)}},g=b=>{switch(b){case"paid":return"bg-green-100 text-green-800";case"partial":return"bg-amber-100 text-amber-800";case"pending":return"bg-blue-100 text-blue-800";case"overdue":return"bg-red-100 text-red-800";default:return"bg-slate-100 text-slate-800"}},v=b=>{switch(b){case"invoice":return e.jsx(rt,{className:"w-5 h-5 text-blue-600"});case"payment":return e.jsx(ve,{className:"w-5 h-5 text-green-600"});case"expense":return e.jsx(Go,{className:"w-5 h-5 text-red-600"});default:return e.jsx(Gr,{className:"w-5 h-5 text-slate-600"})}},x=i.filter(b=>o==="all"?!0:b.status===o).filter(b=>u?b.customer_name.toLowerCase().includes(u.toLowerCase())||b.invoice_number?.toLowerCase().includes(u.toLowerCase())||b.reason.toLowerCase().includes(u.toLowerCase()):!0),y=(()=>{const b=x.reduce((T,I)=>T+I.amount,0),j=x.reduce((T,I)=>T+I.amount_given,0),_=x.reduce((T,I)=>T+I.balance,0);return{totalAmount:b,totalPaid:j,totalBalance:_}})();return a?e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-8 text-center",children:e.jsx("p",{className:"text-slate-600",children:"Loading accounts..."})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx("div",{className:"bg-blue-50 rounded-xl p-4 border border-blue-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(ct,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-blue-600 font-medium",children:"Total Amount"}),e.jsxs("p",{className:"text-xl font-bold text-blue-900",children:["",y.totalAmount.toFixed(2)]})]})]})}),e.jsx("div",{className:"bg-green-50 rounded-xl p-4 border border-green-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx(ve,{className:"w-5 h-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-green-600 font-medium",children:"Total Paid"}),e.jsxs("p",{className:"text-xl font-bold text-green-900",children:["",y.totalPaid.toFixed(2)]})]})]})}),e.jsx("div",{className:"bg-red-50 rounded-xl p-4 border border-red-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-red-100 rounded-lg flex items-center justify-center",children:e.jsx(Go,{className:"w-5 h-5 text-red-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-red-600 font-medium",children:"Outstanding"}),e.jsxs("p",{className:"text-xl font-bold text-red-900",children:["",y.totalBalance.toFixed(2)]})]})]})})]}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-4",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsx("input",{type:"text",placeholder:"Search by customer, invoice, or reason...",value:u,onChange:b=>h(b.target.value),className:"flex-1 px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent"}),e.jsxs("select",{value:o,onChange:b=>d(b.target.value),className:"px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"partial",children:"Partial"}),e.jsx("option",{value:"paid",children:"Paid"}),e.jsx("option",{value:"overdue",children:"Overdue"})]})]})}),x.length===0?e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-8 text-center",children:[e.jsx(Gr,{className:"w-12 h-12 text-slate-400 mx-auto mb-3"}),e.jsx("p",{className:"text-slate-600",children:"No accounts found"})]}):e.jsx("div",{className:"space-y-4",children:x.map(b=>e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-slate-50 rounded-lg flex items-center justify-center border border-slate-200",children:v(b.transaction_type)}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:b.customer_name}),b.invoice_number&&e.jsxs("span",{className:"text-sm text-slate-500",children:["(",b.invoice_number,")"]})]}),e.jsx("p",{className:"text-sm text-slate-600 capitalize",children:b.transaction_type})]})]}),e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${g(b.status)}`,children:b.status.toUpperCase()})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("p",{className:"text-sm text-slate-600 mb-1",children:"Reason:"}),e.jsx("p",{className:"text-base font-medium text-slate-900",children:b.reason})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 mb-1",children:"Total Amount"}),e.jsxs("p",{className:"text-base font-semibold text-slate-900",children:["",b.amount.toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 mb-1",children:"Amount Paid"}),e.jsxs("p",{className:"text-base font-semibold text-green-600",children:["",b.amount_given.toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 mb-1",children:"Balance"}),e.jsxs("p",{className:`text-base font-semibold ${b.balance>0?"text-red-600":"text-green-600"}`,children:["",b.balance.toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 mb-1",children:"Date"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ge,{className:"w-4 h-4 text-slate-400"}),e.jsx("p",{className:"text-sm font-medium text-slate-900",children:new Date(b.transaction_date).toLocaleDateString()})]})]})]}),b.payment_method&&e.jsxs("div",{className:"mb-4",children:[e.jsx("p",{className:"text-xs text-slate-500 mb-1",children:"Payment Method"}),e.jsx("p",{className:"text-sm font-medium text-slate-900 capitalize",children:b.payment_method.replace("_"," ")})]}),b.notes&&e.jsxs("div",{className:"pt-4 border-t border-slate-200",children:[e.jsx("p",{className:"text-xs text-slate-500 mb-1",children:"Notes"}),e.jsx("p",{className:"text-sm text-slate-700",children:b.notes})]})]},b.id))})]})}function vv({onSuccess:i}){const[r,a]=k.useState(!1),[l,o]=k.useState({dispatch_number:"",material_type:"",quantity_dispatched:"",quantity_received:"",unit:"tons",transportation_mode:"",vehicle_number:"",driver_name:"",driver_contact:"",destination:"",customer_name:"",dispatch_date:new Date().toISOString().split("T")[0],expected_delivery_date:"",delivery_status:"dispatched",notes:""}),d=async h=>{h.preventDefault(),a(!0);try{const{data:{user:p}}=await z.auth.getUser();if(!p){alert("You must be logged in");return}const{error:g}=await z.from("dispatch_list").insert([{dispatch_number:l.dispatch_number,material_type:l.material_type,quantity_dispatched:parseFloat(l.quantity_dispatched),quantity_received:l.quantity_received?parseFloat(l.quantity_received):0,unit:l.unit,transportation_mode:l.transportation_mode,vehicle_number:l.vehicle_number||null,driver_name:l.driver_name||null,driver_contact:l.driver_contact||null,destination:l.destination,customer_name:l.customer_name,dispatch_date:l.dispatch_date,expected_delivery_date:l.expected_delivery_date||null,delivery_status:l.delivery_status,notes:l.notes||null,created_by:p.id}]);if(g)throw g;alert("Dispatch record created successfully!"),o({dispatch_number:"",material_type:"",quantity_dispatched:"",quantity_received:"",unit:"tons",transportation_mode:"",vehicle_number:"",driver_name:"",driver_contact:"",destination:"",customer_name:"",dispatch_date:new Date().toISOString().split("T")[0],expected_delivery_date:"",delivery_status:"dispatched",notes:""}),i()}catch(p){alert(p.message)}finally{a(!1)}},u=()=>{const h=parseFloat(l.quantity_dispatched)||0,p=parseFloat(l.quantity_received)||0;return h-p};return e.jsxs("form",{onSubmit:d,className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-3 pb-4 border-b border-slate-200",children:[e.jsx("div",{className:"w-10 h-10 bg-orange-100 rounded-lg flex items-center justify-center",children:e.jsx(dt,{className:"w-5 h-5 text-orange-600"})}),e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"New Dispatch Entry"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Dispatch Number *"}),e.jsx("input",{type:"text",required:!0,value:l.dispatch_number,onChange:h=>o({...l,dispatch_number:h.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent",placeholder:"e.g., DSP-2024-001"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Customer Name *"}),e.jsx("input",{type:"text",required:!0,value:l.customer_name,onChange:h=>o({...l,customer_name:h.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent",placeholder:"Enter customer name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Material Type *"}),e.jsxs("select",{required:!0,value:l.material_type,onChange:h=>o({...l,material_type:h.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Select Material"}),e.jsx("option",{value:"aggregate",children:"Aggregate"}),e.jsx("option",{value:"crushed_stone",children:"Crushed Stone"}),e.jsx("option",{value:"sand",children:"Sand"}),e.jsx("option",{value:"gravel",children:"Gravel"}),e.jsx("option",{value:"boulders",children:"Boulders"}),e.jsx("option",{value:"limestone",children:"Limestone"}),e.jsx("option",{value:"granite",children:"Granite"}),e.jsx("option",{value:"other",children:"Other"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Destination *"}),e.jsx("input",{type:"text",required:!0,value:l.destination,onChange:h=>o({...l,destination:h.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent",placeholder:"Enter destination address"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Quantity Dispatched *"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"number",step:"0.01",required:!0,value:l.quantity_dispatched,onChange:h=>o({...l,quantity_dispatched:h.target.value}),className:"flex-1 px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent",placeholder:"0.00"}),e.jsxs("select",{value:l.unit,onChange:h=>o({...l,unit:h.target.value}),className:"w-32 px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent",children:[e.jsx("option",{value:"tons",children:"Tons"}),e.jsx("option",{value:"cubic_meters",children:"Cubic M"}),e.jsx("option",{value:"loads",children:"Loads"}),e.jsx("option",{value:"kg",children:"Kg"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Quantity Received"}),e.jsx("input",{type:"number",step:"0.01",value:l.quantity_received,onChange:h=>o({...l,quantity_received:h.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent",placeholder:"0.00"})]}),(l.quantity_dispatched||l.quantity_received)&&e.jsx("div",{className:"md:col-span-2",children:e.jsx("div",{className:"p-4 bg-slate-50 rounded-lg border border-slate-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ae,{className:"w-5 h-5 text-slate-600"}),e.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Balance Material:"})]}),e.jsxs("span",{className:`text-lg font-bold ${u()>0?"text-orange-600":"text-green-600"}`,children:[u().toFixed(2)," ",l.unit]})]})})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Transportation Mode *"}),e.jsxs("select",{required:!0,value:l.transportation_mode,onChange:h=>o({...l,transportation_mode:h.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Select Mode"}),e.jsx("option",{value:"truck",children:"Truck"}),e.jsx("option",{value:"dumper",children:"Dumper"}),e.jsx("option",{value:"trailer",children:"Trailer"}),e.jsx("option",{value:"rail",children:"Rail"}),e.jsx("option",{value:"conveyor",children:"Conveyor Belt"}),e.jsx("option",{value:"other",children:"Other"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Vehicle Number"}),e.jsx("input",{type:"text",value:l.vehicle_number,onChange:h=>o({...l,vehicle_number:h.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent",placeholder:"e.g., ABC-1234"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Driver Name"}),e.jsx("input",{type:"text",value:l.driver_name,onChange:h=>o({...l,driver_name:h.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent",placeholder:"Enter driver name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Driver Contact"}),e.jsx("input",{type:"tel",value:l.driver_contact,onChange:h=>o({...l,driver_contact:h.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent",placeholder:"Phone number"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Dispatch Date *"}),e.jsx("input",{type:"date",required:!0,value:l.dispatch_date,onChange:h=>o({...l,dispatch_date:h.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Expected Delivery Date"}),e.jsx("input",{type:"date",value:l.expected_delivery_date,onChange:h=>o({...l,expected_delivery_date:h.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Delivery Status *"}),e.jsxs("select",{required:!0,value:l.delivery_status,onChange:h=>o({...l,delivery_status:h.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent",children:[e.jsx("option",{value:"dispatched",children:"Dispatched"}),e.jsx("option",{value:"in_transit",children:"In Transit"}),e.jsx("option",{value:"delivered",children:"Delivered"}),e.jsx("option",{value:"cancelled",children:"Cancelled"})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Additional Notes"}),e.jsx("textarea",{value:l.notes,onChange:h=>o({...l,notes:h.target.value}),rows:3,className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent",placeholder:"Any additional information about this dispatch..."})]})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t border-slate-200",children:e.jsx("button",{type:"submit",disabled:r,className:"px-6 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 disabled:bg-slate-400 transition-colors",children:r?"Creating...":"Create Dispatch"})})]})}function bv(){const[i,r]=k.useState([]),[a,l]=k.useState(!0),[o,d]=k.useState("all"),[u,h]=k.useState("");k.useEffect(()=>{p()},[]);const p=async()=>{try{const{data:j,error:_}=await z.from("dispatch_list").select("*").order("dispatch_date",{ascending:!1});if(_)throw _;r(j||[])}catch(j){console.error("Error fetching dispatches:",j)}finally{l(!1)}},g=j=>{switch(j){case"delivered":return"bg-green-100 text-green-800";case"in_transit":return"bg-blue-100 text-blue-800";case"dispatched":return"bg-amber-100 text-amber-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-slate-100 text-slate-800"}},v=j=>j.split("_").map(_=>_.charAt(0).toUpperCase()+_.slice(1)).join(" "),x=j=>j.split("_").map(_=>_.charAt(0).toUpperCase()+_.slice(1)).join(" "),N=i.filter(j=>o==="all"?!0:j.delivery_status===o).filter(j=>u?j.customer_name.toLowerCase().includes(u.toLowerCase())||j.dispatch_number.toLowerCase().includes(u.toLowerCase())||j.material_type.toLowerCase().includes(u.toLowerCase())||j.destination.toLowerCase().includes(u.toLowerCase()):!0),b=(()=>{const j=N.reduce((I,C)=>I+C.quantity_dispatched,0),_=N.reduce((I,C)=>I+C.quantity_received,0),T=N.reduce((I,C)=>I+C.balance_quantity,0);return{totalDispatched:j,totalReceived:_,totalBalance:T}})();return a?e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-8 text-center",children:e.jsx("p",{className:"text-slate-600",children:"Loading dispatch records..."})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx("div",{className:"bg-orange-50 rounded-xl p-4 border border-orange-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-orange-100 rounded-lg flex items-center justify-center",children:e.jsx(dt,{className:"w-5 h-5 text-orange-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-orange-600 font-medium",children:"Total Dispatched"}),e.jsx("p",{className:"text-xl font-bold text-orange-900",children:b.totalDispatched.toFixed(2)})]})]})}),e.jsx("div",{className:"bg-green-50 rounded-xl p-4 border border-green-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx(Ae,{className:"w-5 h-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-green-600 font-medium",children:"Total Received"}),e.jsx("p",{className:"text-xl font-bold text-green-900",children:b.totalReceived.toFixed(2)})]})]})}),e.jsx("div",{className:"bg-blue-50 rounded-xl p-4 border border-blue-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(Tt,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-blue-600 font-medium",children:"Balance Material"}),e.jsx("p",{className:"text-xl font-bold text-blue-900",children:b.totalBalance.toFixed(2)})]})]})})]}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-4",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsx("input",{type:"text",placeholder:"Search by customer, dispatch #, material, or destination...",value:u,onChange:j=>h(j.target.value),className:"flex-1 px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"}),e.jsxs("select",{value:o,onChange:j=>d(j.target.value),className:"px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"dispatched",children:"Dispatched"}),e.jsx("option",{value:"in_transit",children:"In Transit"}),e.jsx("option",{value:"delivered",children:"Delivered"}),e.jsx("option",{value:"cancelled",children:"Cancelled"})]})]})}),N.length===0?e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-8 text-center",children:[e.jsx(dt,{className:"w-12 h-12 text-slate-400 mx-auto mb-3"}),e.jsx("p",{className:"text-slate-600",children:"No dispatch records found"})]}):e.jsx("div",{className:"space-y-4",children:N.map(j=>e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6 hover:shadow-md transition-shadow",children:[e.jsx("div",{className:"flex items-start justify-between mb-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-orange-100 rounded-lg flex items-center justify-center",children:e.jsx(dt,{className:"w-6 h-6 text-orange-600"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:j.dispatch_number}),e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${g(j.delivery_status)}`,children:j.delivery_status.replace("_"," ").toUpperCase()})]}),e.jsx("p",{className:"text-sm text-slate-600",children:v(j.material_type)})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-4 p-4 bg-slate-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 mb-1",children:"Quantity Dispatched"}),e.jsxs("p",{className:"text-base font-semibold text-orange-900",children:[j.quantity_dispatched.toFixed(2)," ",j.unit]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 mb-1",children:"Quantity Received"}),e.jsxs("p",{className:"text-base font-semibold text-green-900",children:[j.quantity_received.toFixed(2)," ",j.unit]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 mb-1",children:"Balance Material"}),e.jsxs("p",{className:`text-base font-semibold ${j.balance_quantity>0?"text-red-600":"text-green-600"}`,children:[j.balance_quantity.toFixed(2)," ",j.unit]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 mb-1",children:"Transportation"}),e.jsx("p",{className:"text-base font-semibold text-slate-900",children:x(j.transportation_mode)})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 mb-2",children:"Customer"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Hn,{className:"w-4 h-4 text-slate-400"}),e.jsx("p",{className:"text-sm font-medium text-slate-900",children:j.customer_name})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 mb-2",children:"Destination"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(jt,{className:"w-4 h-4 text-slate-400"}),e.jsx("p",{className:"text-sm font-medium text-slate-900",children:j.destination})]})]}),j.vehicle_number&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 mb-2",children:"Vehicle Number"}),e.jsx("p",{className:"text-sm font-medium text-slate-900",children:j.vehicle_number})]}),j.driver_name&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 mb-2",children:"Driver"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Hn,{className:"w-4 h-4 text-slate-400"}),e.jsx("p",{className:"text-sm font-medium text-slate-900",children:j.driver_name}),j.driver_contact&&e.jsxs(e.Fragment,{children:[e.jsx(pl,{className:"w-4 h-4 text-slate-400 ml-2"}),e.jsx("p",{className:"text-sm text-slate-600",children:j.driver_contact})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 mb-1",children:"Dispatch Date"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ge,{className:"w-4 h-4 text-slate-400"}),e.jsx("p",{className:"text-sm font-medium text-slate-900",children:new Date(j.dispatch_date).toLocaleDateString()})]})]}),j.expected_delivery_date&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 mb-1",children:"Expected Delivery"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ge,{className:"w-4 h-4 text-slate-400"}),e.jsx("p",{className:"text-sm font-medium text-slate-900",children:new Date(j.expected_delivery_date).toLocaleDateString()})]})]})]}),j.notes&&e.jsxs("div",{className:"pt-4 border-t border-slate-200",children:[e.jsx("p",{className:"text-xs text-slate-500 mb-1",children:"Notes"}),e.jsx("p",{className:"text-sm text-slate-700",children:j.notes})]})]},j.id))})]})}function yv({onSuccess:i}){const[r,a]=k.useState(!1),[l,o]=k.useState({material_type:"",quantity:"",unit:"tons",stock_date:new Date().toISOString().split("T")[0],location:"",quality_grade:"",notes:""}),d=async u=>{u.preventDefault(),a(!0);try{const{data:{user:h}}=await z.auth.getUser();if(!h){alert("You must be logged in");return}const{error:p}=await z.from("production_stock").insert([{material_type:l.material_type,quantity:parseFloat(l.quantity),unit:l.unit,stock_date:l.stock_date,location:l.location||null,quality_grade:l.quality_grade||null,notes:l.notes||null,created_by:h.id}]);if(p)throw p;alert("Production stock added successfully!"),o({material_type:"",quantity:"",unit:"tons",stock_date:new Date().toISOString().split("T")[0],location:"",quality_grade:"",notes:""}),i()}catch(h){alert(h.message)}finally{a(!1)}};return e.jsxs("form",{onSubmit:d,className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-3 pb-4 border-b border-slate-200",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(Ae,{className:"w-5 h-5 text-blue-600"})}),e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"Add Production Stock"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Material Type *"}),e.jsxs("select",{required:!0,value:l.material_type,onChange:u=>o({...l,material_type:u.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Select Material"}),e.jsx("option",{value:"aggregate",children:"Aggregate"}),e.jsx("option",{value:"crushed_stone",children:"Crushed Stone"}),e.jsx("option",{value:"sand",children:"Sand"}),e.jsx("option",{value:"gravel",children:"Gravel"}),e.jsx("option",{value:"boulders",children:"Boulders"}),e.jsx("option",{value:"limestone",children:"Limestone"}),e.jsx("option",{value:"granite",children:"Granite"}),e.jsx("option",{value:"20mm",children:"20mm"}),e.jsx("option",{value:"40mm",children:"40mm"}),e.jsx("option",{value:"dust",children:"Dust"}),e.jsx("option",{value:"other",children:"Other"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Quantity *"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"number",step:"0.01",required:!0,value:l.quantity,onChange:u=>o({...l,quantity:u.target.value}),className:"flex-1 px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"0.00"}),e.jsxs("select",{value:l.unit,onChange:u=>o({...l,unit:u.target.value}),className:"w-32 px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"tons",children:"Tons"}),e.jsx("option",{value:"cubic_meters",children:"Cubic M"}),e.jsx("option",{value:"loads",children:"Loads"}),e.jsx("option",{value:"kg",children:"Kg"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Stock Date *"}),e.jsx("input",{type:"date",required:!0,value:l.stock_date,onChange:u=>o({...l,stock_date:u.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Storage Location"}),e.jsx("input",{type:"text",value:l.location,onChange:u=>o({...l,location:u.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g., Yard A, Section 2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Quality Grade"}),e.jsxs("select",{value:l.quality_grade,onChange:u=>o({...l,quality_grade:u.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Select Grade"}),e.jsx("option",{value:"premium",children:"Premium"}),e.jsx("option",{value:"standard",children:"Standard"}),e.jsx("option",{value:"economy",children:"Economy"}),e.jsx("option",{value:"grade_a",children:"Grade A"}),e.jsx("option",{value:"grade_b",children:"Grade B"}),e.jsx("option",{value:"grade_c",children:"Grade C"})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Additional Notes"}),e.jsx("textarea",{value:l.notes,onChange:u=>o({...l,notes:u.target.value}),rows:3,className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Any additional information about this stock..."})]})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t border-slate-200",children:e.jsx("button",{type:"submit",disabled:r,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-slate-400 transition-colors",children:r?"Adding...":"Add Stock"})})]})}function jv(){const[i,r]=k.useState([]),[a,l]=k.useState(!0),[o,d]=k.useState("all"),[u,h]=k.useState("");k.useEffect(()=>{p()},[]);const p=async()=>{try{const{data:j,error:_}=await z.from("production_stock").select("*").order("stock_date",{ascending:!1});if(_)throw _;r(j||[])}catch(j){console.error("Error fetching production stock:",j)}finally{l(!1)}},g=j=>j.split("_").map(_=>_.charAt(0).toUpperCase()+_.slice(1)).join(" "),v=j=>j?j.split("_").map(_=>_.charAt(0).toUpperCase()+_.slice(1)).join(" "):"N/A",x=i.filter(j=>o==="all"?!0:j.material_type===o).filter(j=>u?j.material_type.toLowerCase().includes(u.toLowerCase())||j.location?.toLowerCase().includes(u.toLowerCase())||j.quality_grade?.toLowerCase().includes(u.toLowerCase()):!0),y=(()=>{const j={};return x.forEach(_=>{j[_.material_type]||(j[_.material_type]=0),j[_.material_type]+=_.quantity}),j})(),b=Array.from(new Set(i.map(j=>j.material_type)));return a?e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-8 text-center",children:e.jsx("p",{className:"text-slate-600",children:"Loading production stock..."})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx("div",{className:"bg-blue-50 rounded-xl p-4 border border-blue-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(Ae,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-blue-600 font-medium",children:"Total Stock Items"}),e.jsx("p",{className:"text-xl font-bold text-blue-900",children:x.length})]})]})}),e.jsx("div",{className:"bg-green-50 rounded-xl p-4 border border-green-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx(Ae,{className:"w-5 h-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-green-600 font-medium",children:"Material Types"}),e.jsx("p",{className:"text-xl font-bold text-green-900",children:b.length})]})]})}),e.jsx("div",{className:"bg-purple-50 rounded-xl p-4 border border-purple-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center",children:e.jsx(Ae,{className:"w-5 h-5 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-purple-600 font-medium",children:"Total Quantity"}),e.jsx("p",{className:"text-xl font-bold text-purple-900",children:x.reduce((j,_)=>j+_.quantity,0).toFixed(2)})]})]})})]}),Object.keys(y).length>0&&e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-700 mb-4",children:"Stock Summary by Material"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:Object.entries(y).map(([j,_])=>e.jsxs("div",{className:"p-3 bg-slate-50 rounded-lg border border-slate-200",children:[e.jsx("p",{className:"text-xs text-slate-600 mb-1",children:g(j)}),e.jsx("p",{className:"text-lg font-bold text-slate-900",children:_.toFixed(2)})]},j))})]}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-4",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsx("input",{type:"text",placeholder:"Search by material, location, or grade...",value:u,onChange:j=>h(j.target.value),className:"flex-1 px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),e.jsxs("select",{value:o,onChange:j=>d(j.target.value),className:"px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"All Materials"}),b.map(j=>e.jsx("option",{value:j,children:g(j)},j))]})]})}),x.length===0?e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-8 text-center",children:[e.jsx(Ae,{className:"w-12 h-12 text-slate-400 mx-auto mb-3"}),e.jsx("p",{className:"text-slate-600",children:"No production stock found"})]}):e.jsx("div",{className:"space-y-4",children:x.map(j=>e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(Ae,{className:"w-6 h-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:g(j.material_type)}),e.jsxs("p",{className:"text-sm text-slate-600",children:[j.quantity.toFixed(2)," ",j.unit]})]})]}),j.quality_grade&&e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1 bg-green-100 rounded-full",children:[e.jsx(zp,{className:"w-4 h-4 text-green-600"}),e.jsx("span",{className:"text-xs font-medium text-green-800",children:v(j.quality_grade)})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 mb-1",children:"Stock Date"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ge,{className:"w-4 h-4 text-slate-400"}),e.jsx("p",{className:"text-sm font-medium text-slate-900",children:new Date(j.stock_date).toLocaleDateString()})]})]}),j.location&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 mb-1",children:"Location"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(jt,{className:"w-4 h-4 text-slate-400"}),e.jsx("p",{className:"text-sm font-medium text-slate-900",children:j.location})]})]})]}),j.notes&&e.jsxs("div",{className:"pt-4 border-t border-slate-200",children:[e.jsx("p",{className:"text-xs text-slate-500 mb-1",children:"Notes"}),e.jsx("p",{className:"text-sm text-slate-700",children:j.notes})]})]},j.id))})]})}function wv({onSuccess:i}){const[r,a]=k.useState(!1),[l,o]=k.useState({request_number:"",material_name:"",quantity:"",unit:"units",purpose:"",priority:"medium",required_by:"",estimated_cost:"",supplier_suggestion:"",notes:""}),d=async u=>{u.preventDefault(),a(!0);try{const{data:{user:h}}=await z.auth.getUser();if(!h){alert("You must be logged in");return}const{error:p}=await z.from("purchase_requests").insert([{request_number:l.request_number,material_name:l.material_name,quantity:parseFloat(l.quantity),unit:l.unit,purpose:l.purpose,priority:l.priority,required_by:l.required_by||null,estimated_cost:l.estimated_cost?parseFloat(l.estimated_cost):null,supplier_suggestion:l.supplier_suggestion||null,status:"pending",notes:l.notes||null,created_by:h.id}]);if(p)throw p;alert("Purchase request submitted successfully!"),o({request_number:"",material_name:"",quantity:"",unit:"units",purpose:"",priority:"medium",required_by:"",estimated_cost:"",supplier_suggestion:"",notes:""}),i()}catch(h){alert(h.message)}finally{a(!1)}};return e.jsxs("form",{onSubmit:d,className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-3 pb-4 border-b border-slate-200",children:[e.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx(At,{className:"w-5 h-5 text-green-600"})}),e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"New Purchase Request"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Request Number *"}),e.jsx("input",{type:"text",required:!0,value:l.request_number,onChange:u=>o({...l,request_number:u.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"e.g., PR-2024-001"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Priority *"}),e.jsxs("select",{required:!0,value:l.priority,onChange:u=>o({...l,priority:u.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[e.jsx("option",{value:"low",children:"Low"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"urgent",children:"Urgent"})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Material Name *"}),e.jsx("input",{type:"text",required:!0,value:l.material_name,onChange:u=>o({...l,material_name:u.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"e.g., Drill Bits, Explosives, Spare Parts, etc."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Quantity *"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"number",step:"0.01",required:!0,value:l.quantity,onChange:u=>o({...l,quantity:u.target.value}),className:"flex-1 px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"0.00"}),e.jsxs("select",{value:l.unit,onChange:u=>o({...l,unit:u.target.value}),className:"w-32 px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[e.jsx("option",{value:"units",children:"Units"}),e.jsx("option",{value:"pieces",children:"Pieces"}),e.jsx("option",{value:"boxes",children:"Boxes"}),e.jsx("option",{value:"kg",children:"Kg"}),e.jsx("option",{value:"liters",children:"Liters"}),e.jsx("option",{value:"tons",children:"Tons"}),e.jsx("option",{value:"meters",children:"Meters"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Estimated Cost"}),e.jsx("input",{type:"number",step:"0.01",value:l.estimated_cost,onChange:u=>o({...l,estimated_cost:u.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"0.00"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Required By"}),e.jsx("input",{type:"date",value:l.required_by,onChange:u=>o({...l,required_by:u.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Suggested Supplier"}),e.jsx("input",{type:"text",value:l.supplier_suggestion,onChange:u=>o({...l,supplier_suggestion:u.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"Supplier name or company"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Purpose/Reason *"}),e.jsx("input",{type:"text",required:!0,value:l.purpose,onChange:u=>o({...l,purpose:u.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"Explain why this material is needed..."})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Additional Notes"}),e.jsx("textarea",{value:l.notes,onChange:u=>o({...l,notes:u.target.value}),rows:3,className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"Any additional details or specifications..."})]})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t border-slate-200",children:e.jsx("button",{type:"submit",disabled:r,className:"px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:bg-slate-400 transition-colors",children:r?"Submitting...":"Submit Request"})})]})}function Nv(){const[i,r]=k.useState([]),[a,l]=k.useState(!0),[o,d]=k.useState("all"),[u,h]=k.useState("");k.useEffect(()=>{p()},[]);const p=async()=>{try{const{data:b,error:j}=await z.from("purchase_requests").select("*").order("created_at",{ascending:!1});if(j)throw j;r(b||[])}catch(b){console.error("Error fetching purchase requests:",b)}finally{l(!1)}},g=b=>{switch(b){case"approved":return"bg-green-100 text-green-800";case"ordered":return"bg-blue-100 text-blue-800";case"received":return"bg-emerald-100 text-emerald-800";case"rejected":return"bg-red-100 text-red-800";case"pending":return"bg-amber-100 text-amber-800";default:return"bg-slate-100 text-slate-800"}},v=b=>{switch(b){case"urgent":return"bg-red-100 text-red-800";case"high":return"bg-orange-100 text-orange-800";case"medium":return"bg-yellow-100 text-yellow-800";case"low":return"bg-blue-100 text-blue-800";default:return"bg-slate-100 text-slate-800"}},x=i.filter(b=>o==="all"?!0:b.status===o).filter(b=>u?b.material_name.toLowerCase().includes(u.toLowerCase())||b.request_number.toLowerCase().includes(u.toLowerCase())||b.purpose.toLowerCase().includes(u.toLowerCase()):!0),y=(()=>{const b=i.filter(T=>T.status==="pending").length,j=i.filter(T=>T.status==="approved").length,_=i.filter(T=>T.estimated_cost&&T.status!=="rejected").reduce((T,I)=>T+I.estimated_cost,0);return{pending:b,approved:j,totalCost:_}})();return a?e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-8 text-center",children:e.jsx("p",{className:"text-slate-600",children:"Loading purchase requests..."})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx("div",{className:"bg-amber-50 rounded-xl p-4 border border-amber-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-amber-100 rounded-lg flex items-center justify-center",children:e.jsx(Tt,{className:"w-5 h-5 text-amber-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-amber-600 font-medium",children:"Pending Requests"}),e.jsx("p",{className:"text-xl font-bold text-amber-900",children:y.pending})]})]})}),e.jsx("div",{className:"bg-green-50 rounded-xl p-4 border border-green-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx(et,{className:"w-5 h-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-green-600 font-medium",children:"Approved Requests"}),e.jsx("p",{className:"text-xl font-bold text-green-900",children:y.approved})]})]})}),e.jsx("div",{className:"bg-blue-50 rounded-xl p-4 border border-blue-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(ct,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-blue-600 font-medium",children:"Estimated Total Cost"}),e.jsxs("p",{className:"text-xl font-bold text-blue-900",children:["",y.totalCost.toFixed(2)]})]})]})})]}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-4",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsx("input",{type:"text",placeholder:"Search by material, request #, or purpose...",value:u,onChange:b=>h(b.target.value),className:"flex-1 px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"}),e.jsxs("select",{value:o,onChange:b=>d(b.target.value),className:"px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"approved",children:"Approved"}),e.jsx("option",{value:"ordered",children:"Ordered"}),e.jsx("option",{value:"received",children:"Received"}),e.jsx("option",{value:"rejected",children:"Rejected"})]})]})}),x.length===0?e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-8 text-center",children:[e.jsx(At,{className:"w-12 h-12 text-slate-400 mx-auto mb-3"}),e.jsx("p",{className:"text-slate-600",children:"No purchase requests found"})]}):e.jsx("div",{className:"space-y-4",children:x.map(b=>e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx(At,{className:"w-6 h-6 text-green-600"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:b.request_number}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${v(b.priority)}`,children:b.priority.toUpperCase()})]}),e.jsx("p",{className:"text-base font-medium text-slate-700",children:b.material_name})]})]}),e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${g(b.status)}`,children:b.status.toUpperCase()})]}),e.jsxs("div",{className:"mb-4 p-3 bg-slate-50 rounded-lg",children:[e.jsx("p",{className:"text-xs text-slate-500 mb-1",children:"Purpose:"}),e.jsx("p",{className:"text-sm font-medium text-slate-900",children:b.purpose})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 mb-1",children:"Quantity"}),e.jsxs("p",{className:"text-base font-semibold text-slate-900",children:[b.quantity.toFixed(2)," ",b.unit]})]}),b.estimated_cost&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 mb-1",children:"Estimated Cost"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ct,{className:"w-4 h-4 text-slate-400"}),e.jsx("p",{className:"text-base font-semibold text-slate-900",children:b.estimated_cost.toFixed(2)})]})]}),b.required_by&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 mb-1",children:"Required By"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ge,{className:"w-4 h-4 text-slate-400"}),e.jsx("p",{className:"text-sm font-medium text-slate-900",children:new Date(b.required_by).toLocaleDateString()})]})]}),b.supplier_suggestion&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 mb-1",children:"Suggested Supplier"}),e.jsx("p",{className:"text-sm font-medium text-slate-900",children:b.supplier_suggestion})]})]}),b.notes&&e.jsxs("div",{className:"pt-4 border-t border-slate-200 mb-4",children:[e.jsx("p",{className:"text-xs text-slate-500 mb-1",children:"Notes"}),e.jsx("p",{className:"text-sm text-slate-700",children:b.notes})]}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-slate-200",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-500",children:[e.jsx(ge,{className:"w-4 h-4"}),e.jsxs("span",{children:["Created: ",new Date(b.created_at).toLocaleDateString()]})]}),b.approval_date&&e.jsxs("div",{className:"flex items-center gap-2 text-xs text-green-600",children:[e.jsx(et,{className:"w-4 h-4"}),e.jsxs("span",{children:["Approved: ",new Date(b.approval_date).toLocaleDateString()]})]})]})]},b.id))})]})}function Um(){const[i,r]=k.useState([]),[a,l]=k.useState(!0),[o,d]=k.useState(""),[u,h]=k.useState("");k.useEffect(()=>{p()},[o,u]);const p=async()=>{try{let y=z.from("production_stock").select("*").order("stock_date",{ascending:!1});o&&(y=y.gte("stock_date",o)),u&&(y=y.lte("stock_date",u));const{data:b,error:j}=await y;if(j)throw j;r(b||[])}catch(y){console.error("Error fetching production data:",y)}finally{l(!1)}},g=()=>{const y={};let b=0;return i.forEach(j=>{y[j.material_type]||(y[j.material_type]=0),y[j.material_type]+=j.quantity,b+=j.quantity}),{materialSummary:y,totalQuantity:b}},v=y=>y.split("_").map(b=>b.charAt(0).toUpperCase()+b.slice(1)).join(" "),{materialSummary:x,totalQuantity:N}=g();return a?e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-8 text-center",children:e.jsx("p",{className:"text-slate-600",children:"Loading production report..."})}):e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(ot,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"Crusher Production Report"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Material production summary by crusher manager"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Start Date"}),e.jsx("input",{type:"date",value:o,onChange:y=>d(y.target.value),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"End Date"}),e.jsx("input",{type:"date",value:u,onChange:y=>h(y.target.value),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsx("div",{className:"bg-blue-50 rounded-lg p-4 border border-blue-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ae,{className:"w-8 h-8 text-blue-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-blue-600 font-medium",children:"Total Production"}),e.jsx("p",{className:"text-2xl font-bold text-blue-900",children:N.toFixed(2)}),e.jsx("p",{className:"text-xs text-blue-600",children:"Tons"})]})]})}),e.jsx("div",{className:"bg-green-50 rounded-lg p-4 border border-green-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ve,{className:"w-8 h-8 text-green-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-green-600 font-medium",children:"Material Types"}),e.jsx("p",{className:"text-2xl font-bold text-green-900",children:Object.keys(x).length}),e.jsx("p",{className:"text-xs text-green-600",children:"Different Materials"})]})]})}),e.jsx("div",{className:"bg-purple-50 rounded-lg p-4 border border-purple-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ge,{className:"w-8 h-8 text-purple-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-purple-600 font-medium",children:"Records"}),e.jsx("p",{className:"text-2xl font-bold text-purple-900",children:i.length}),e.jsx("p",{className:"text-xs text-purple-600",children:"Production Entries"})]})]})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-700 mb-4",children:"Production by Material Type"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:Object.entries(x).map(([y,b])=>e.jsxs("div",{className:"bg-slate-50 rounded-lg p-4 border border-slate-200",children:[e.jsx("p",{className:"text-sm font-medium text-slate-700 mb-1",children:v(y)}),e.jsx("p",{className:"text-2xl font-bold text-slate-900",children:b.toFixed(2)}),e.jsx("p",{className:"text-xs text-slate-600",children:"Tons"}),e.jsx("div",{className:"mt-2 w-full bg-slate-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${b/N*100}%`}})}),e.jsxs("p",{className:"text-xs text-slate-600 mt-1",children:[(b/N*100).toFixed(1),"% of total"]})]},y))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-700 mb-4",children:"Detailed Production Records"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-slate-50 border-b border-slate-200",children:[e.jsx("th",{className:"text-left text-xs font-semibold text-slate-600 px-4 py-3",children:"Date"}),e.jsx("th",{className:"text-left text-xs font-semibold text-slate-600 px-4 py-3",children:"Material"}),e.jsx("th",{className:"text-right text-xs font-semibold text-slate-600 px-4 py-3",children:"Quantity"}),e.jsx("th",{className:"text-left text-xs font-semibold text-slate-600 px-4 py-3",children:"Location"}),e.jsx("th",{className:"text-left text-xs font-semibold text-slate-600 px-4 py-3",children:"Grade"})]})}),e.jsx("tbody",{children:i.map(y=>e.jsxs("tr",{className:"border-b border-slate-100 hover:bg-slate-50",children:[e.jsx("td",{className:"px-4 py-3 text-sm text-slate-900",children:new Date(y.stock_date).toLocaleDateString()}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-900",children:v(y.material_type)}),e.jsxs("td",{className:"px-4 py-3 text-sm text-slate-900 text-right font-medium",children:[y.quantity.toFixed(2)," ",y.unit]}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-600",children:y.location||"-"}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-600",children:y.quality_grade?v(y.quality_grade):"-"})]},y.id))})]})})]})]})})}function _v(){const[i,r]=k.useState([]),[a,l]=k.useState([]),[o,d]=k.useState([]),[u,h]=k.useState([]),[p,g]=k.useState(!0),[v,x]=k.useState(""),[N,y]=k.useState("");k.useEffect(()=>{b()},[v,N]);const b=async()=>{try{const T=[];let I=z.from("drilling").select("*").order("date",{ascending:!1});v&&(I=I.gte("date",v)),N&&(I=I.lte("date",N)),T.push(I);let C=z.from("blasting").select("*").order("date",{ascending:!1});v&&(C=C.gte("date",v)),N&&(C=C.lte("date",N)),T.push(C);let D=z.from("loading").select("*").order("date",{ascending:!1});v&&(D=D.gte("date",v)),N&&(D=D.lte("date",N)),T.push(D);let R=z.from("transport").select("*").order("date",{ascending:!1});v&&(R=R.gte("date",v)),N&&(R=R.lte("date",N)),T.push(R);const[F,H,ae,_e]=await Promise.all(T);if(F.error)throw F.error;if(H.error)throw H.error;if(ae.error)throw ae.error;if(_e.error)throw _e.error;r(F.data||[]),l(H.data||[]),d(ae.data||[]),h(_e.data||[])}catch(T){console.error("Error fetching quarry data:",T)}finally{g(!1)}},_=(()=>{const T=i.reduce((F,H)=>F+(H.holes_drilled||0),0),I=i.reduce((F,H)=>F+(H.depth||0)*(H.holes_drilled||0),0),C=a.reduce((F,H)=>F+(H.quantity||0),0),D=o.reduce((F,H)=>F+(H.quantity||0),0),R=u.reduce((F,H)=>F+(H.quantity||0),0);return{totalHolesDrilled:T,totalDepthDrilled:I,totalBlasted:C,totalLoaded:D,totalTransported:R}})();return p?e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-8 text-center",children:e.jsx("p",{className:"text-slate-600",children:"Loading quarry production report..."})}):e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-10 h-10 bg-orange-100 rounded-lg flex items-center justify-center",children:e.jsx(Ct,{className:"w-5 h-5 text-orange-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"Quarry Production Report"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Operations summary by contractor"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Start Date"}),e.jsx("input",{type:"date",value:v,onChange:T=>x(T.target.value),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"End Date"}),e.jsx("input",{type:"date",value:N,onChange:T=>y(T.target.value),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[e.jsx("div",{className:"bg-blue-50 rounded-lg p-4 border border-blue-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ct,{className:"w-8 h-8 text-blue-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-blue-600 font-medium",children:"Drilling"}),e.jsx("p",{className:"text-2xl font-bold text-blue-900",children:_.totalHolesDrilled}),e.jsxs("p",{className:"text-xs text-blue-600",children:["Holes (",_.totalDepthDrilled.toFixed(1),"m)"]})]})]})}),e.jsx("div",{className:"bg-orange-50 rounded-lg p-4 border border-orange-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ot,{className:"w-8 h-8 text-orange-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-orange-600 font-medium",children:"Blasting"}),e.jsx("p",{className:"text-2xl font-bold text-orange-900",children:_.totalBlasted.toFixed(2)}),e.jsx("p",{className:"text-xs text-orange-600",children:"Cubic Meters"})]})]})}),e.jsx("div",{className:"bg-green-50 rounded-lg p-4 border border-green-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ve,{className:"w-8 h-8 text-green-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-green-600 font-medium",children:"Loading"}),e.jsx("p",{className:"text-2xl font-bold text-green-900",children:_.totalLoaded.toFixed(2)}),e.jsx("p",{className:"text-xs text-green-600",children:"Tons"})]})]})}),e.jsx("div",{className:"bg-purple-50 rounded-lg p-4 border border-purple-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(dt,{className:"w-8 h-8 text-purple-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-purple-600 font-medium",children:"Transport"}),e.jsx("p",{className:"text-2xl font-bold text-purple-900",children:_.totalTransported.toFixed(2)}),e.jsx("p",{className:"text-xs text-purple-600",children:"Tons"})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-700 mb-4",children:"Drilling Summary"}),e.jsx("div",{className:"bg-slate-50 rounded-lg p-4 border border-slate-200",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-slate-600",children:"Total Records:"}),e.jsx("span",{className:"text-sm font-semibold text-slate-900",children:i.length})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-slate-600",children:"Total Holes:"}),e.jsx("span",{className:"text-sm font-semibold text-slate-900",children:_.totalHolesDrilled})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-slate-600",children:"Total Depth:"}),e.jsxs("span",{className:"text-sm font-semibold text-slate-900",children:[_.totalDepthDrilled.toFixed(2),"m"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-slate-600",children:"Avg per Record:"}),e.jsxs("span",{className:"text-sm font-semibold text-slate-900",children:[i.length>0?(_.totalHolesDrilled/i.length).toFixed(1):0," holes"]})]})]})})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-700 mb-4",children:"Blasting Summary"}),e.jsx("div",{className:"bg-slate-50 rounded-lg p-4 border border-slate-200",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-slate-600",children:"Total Records:"}),e.jsx("span",{className:"text-sm font-semibold text-slate-900",children:a.length})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-slate-600",children:"Total Blasted:"}),e.jsxs("span",{className:"text-sm font-semibold text-slate-900",children:[_.totalBlasted.toFixed(2)," m"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-slate-600",children:"Avg per Blast:"}),e.jsxs("span",{className:"text-sm font-semibold text-slate-900",children:[a.length>0?(_.totalBlasted/a.length).toFixed(2):0," m"]})]})]})})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-700 mb-4",children:"Loading Summary"}),e.jsx("div",{className:"bg-slate-50 rounded-lg p-4 border border-slate-200",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-slate-600",children:"Total Records:"}),e.jsx("span",{className:"text-sm font-semibold text-slate-900",children:o.length})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-slate-600",children:"Total Loaded:"}),e.jsxs("span",{className:"text-sm font-semibold text-slate-900",children:[_.totalLoaded.toFixed(2)," tons"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-slate-600",children:"Avg per Record:"}),e.jsxs("span",{className:"text-sm font-semibold text-slate-900",children:[o.length>0?(_.totalLoaded/o.length).toFixed(2):0," tons"]})]})]})})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-700 mb-4",children:"Transport Summary"}),e.jsx("div",{className:"bg-slate-50 rounded-lg p-4 border border-slate-200",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-slate-600",children:"Total Records:"}),e.jsx("span",{className:"text-sm font-semibold text-slate-900",children:u.length})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-slate-600",children:"Total Transported:"}),e.jsxs("span",{className:"text-sm font-semibold text-slate-900",children:[_.totalTransported.toFixed(2)," tons"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-slate-600",children:"Avg per Trip:"}),e.jsxs("span",{className:"text-sm font-semibold text-slate-900",children:[u.length>0?(_.totalTransported/u.length).toFixed(2):0," tons"]})]})]})})]})]})]})})}function kv(){const[i,r]=k.useState([]),[a,l]=k.useState(!0),[o,d]=k.useState(""),[u,h]=k.useState("");k.useEffect(()=>{p()},[o,u]);const p=async()=>{try{let N=z.from("dispatch_list").select("*").order("dispatch_date",{ascending:!1});o&&(N=N.gte("dispatch_date",o)),u&&(N=N.lte("dispatch_date",u));const{data:y,error:b}=await N;if(b)throw b;r(y||[])}catch(N){console.error("Error fetching sales data:",N)}finally{l(!1)}},g=()=>{const N={},y={};let b=0,j=0,_=0;i.forEach(C=>{N[C.material_type]||(N[C.material_type]=0),N[C.material_type]+=C.quantity_dispatched,y[C.customer_name]||(y[C.customer_name]=0),y[C.customer_name]+=C.quantity_dispatched,b+=C.quantity_dispatched,C.delivery_status==="delivered"?j+=C.quantity_dispatched:_+=C.quantity_dispatched});const T=Object.entries(y).sort((C,D)=>D[1]-C[1]).slice(0,5),I=Object.entries(N).sort((C,D)=>D[1]-C[1]).slice(0,5);return{materialSales:N,customerSales:y,totalDispatched:b,totalDelivered:j,totalPending:_,topCustomers:T,topMaterials:I,uniqueCustomers:Object.keys(y).length}},v=N=>N.split("_").map(y=>y.charAt(0).toUpperCase()+y.slice(1)).join(" "),x=g();return a?e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-8 text-center",children:e.jsx("p",{className:"text-slate-600",children:"Loading sales report..."})}):e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx(At,{className:"w-5 h-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"Sales Report"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Material dispatch and customer sales summary"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Start Date"}),e.jsx("input",{type:"date",value:o,onChange:N=>d(N.target.value),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"End Date"}),e.jsx("input",{type:"date",value:u,onChange:N=>h(N.target.value),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[e.jsx("div",{className:"bg-green-50 rounded-lg p-4 border border-green-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ve,{className:"w-8 h-8 text-green-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-green-600 font-medium",children:"Total Dispatched"}),e.jsx("p",{className:"text-2xl font-bold text-green-900",children:x.totalDispatched.toFixed(2)}),e.jsx("p",{className:"text-xs text-green-600",children:"Tons"})]})]})}),e.jsx("div",{className:"bg-blue-50 rounded-lg p-4 border border-blue-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(At,{className:"w-8 h-8 text-blue-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-blue-600 font-medium",children:"Delivered"}),e.jsx("p",{className:"text-2xl font-bold text-blue-900",children:x.totalDelivered.toFixed(2)}),e.jsx("p",{className:"text-xs text-blue-600",children:"Tons"})]})]})}),e.jsx("div",{className:"bg-amber-50 rounded-lg p-4 border border-amber-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ct,{className:"w-8 h-8 text-amber-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-amber-600 font-medium",children:"In Transit"}),e.jsx("p",{className:"text-2xl font-bold text-amber-900",children:x.totalPending.toFixed(2)}),e.jsx("p",{className:"text-xs text-amber-600",children:"Tons"})]})]})}),e.jsx("div",{className:"bg-purple-50 rounded-lg p-4 border border-purple-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ft,{className:"w-8 h-8 text-purple-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-purple-600 font-medium",children:"Customers"}),e.jsx("p",{className:"text-2xl font-bold text-purple-900",children:x.uniqueCustomers}),e.jsx("p",{className:"text-xs text-purple-600",children:"Total"})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-700 mb-4",children:"Top 5 Customers by Volume"}),e.jsx("div",{className:"space-y-3",children:x.topCustomers.map(([N,y],b)=>e.jsxs("div",{className:"bg-slate-50 rounded-lg p-4 border border-slate-200",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-6 h-6 bg-green-100 text-green-800 rounded-full flex items-center justify-center text-xs font-bold",children:b+1}),e.jsx("span",{className:"text-sm font-medium text-slate-900",children:N})]}),e.jsxs("span",{className:"text-sm font-bold text-slate-900",children:[y.toFixed(2)," tons"]})]}),e.jsx("div",{className:"w-full bg-slate-200 rounded-full h-2",children:e.jsx("div",{className:"bg-green-600 h-2 rounded-full",style:{width:`${y/x.totalDispatched*100}%`}})}),e.jsxs("p",{className:"text-xs text-slate-600 mt-1",children:[(y/x.totalDispatched*100).toFixed(1),"% of total sales"]})]},N))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-700 mb-4",children:"Top 5 Materials by Volume"}),e.jsx("div",{className:"space-y-3",children:x.topMaterials.map(([N,y],b)=>e.jsxs("div",{className:"bg-slate-50 rounded-lg p-4 border border-slate-200",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-6 h-6 bg-blue-100 text-blue-800 rounded-full flex items-center justify-center text-xs font-bold",children:b+1}),e.jsx("span",{className:"text-sm font-medium text-slate-900",children:v(N)})]}),e.jsxs("span",{className:"text-sm font-bold text-slate-900",children:[y.toFixed(2)," tons"]})]}),e.jsx("div",{className:"w-full bg-slate-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${y/x.totalDispatched*100}%`}})}),e.jsxs("p",{className:"text-xs text-slate-600 mt-1",children:[(y/x.totalDispatched*100).toFixed(1),"% of total volume"]})]},N))})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-700 mb-4",children:"Delivery Performance"}),e.jsx("div",{className:"bg-slate-50 rounded-lg p-4 border border-slate-200",children:e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-xs text-slate-600 mb-1",children:"Delivery Rate"}),e.jsxs("p",{className:"text-2xl font-bold text-green-600",children:[x.totalDispatched>0?(x.totalDelivered/x.totalDispatched*100).toFixed(1):0,"%"]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-xs text-slate-600 mb-1",children:"Total Orders"}),e.jsx("p",{className:"text-2xl font-bold text-slate-900",children:i.length})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-xs text-slate-600 mb-1",children:"Avg Order Size"}),e.jsxs("p",{className:"text-2xl font-bold text-slate-900",children:[i.length>0?(x.totalDispatched/i.length).toFixed(2):0," tons"]})]})]})})]})]})})}function Sv(){const[i,r]=k.useState([]),[a,l]=k.useState(!0),[o,d]=k.useState(""),[u,h]=k.useState("");k.useEffect(()=>{p()},[o,u]);const p=async()=>{try{let N=z.from("accounts").select("*").order("transaction_date",{ascending:!1});o&&(N=N.gte("transaction_date",o)),u&&(N=N.lte("transaction_date",u));const{data:y,error:b}=await N;if(b)throw b;r(y||[])}catch(N){console.error("Error fetching accounting data:",N)}finally{l(!1)}},g=()=>{let N=0,y=0;const b={},j={};i.forEach(I=>{I.transaction_type==="income"?N+=I.amount:y+=I.amount,b[I.category]||(b[I.category]=0),b[I.category]+=I.amount,j[I.payment_method]||(j[I.payment_method]=0),j[I.payment_method]+=I.amount});const _=N-y,T=Object.entries(b).sort((I,C)=>C[1]-I[1]).slice(0,5);return{totalIncome:N,totalExpense:y,netBalance:_,categoryBreakdown:b,paymentMethodBreakdown:j,topExpenses:T}},v=N=>N.split("_").map(y=>y.charAt(0).toUpperCase()+y.slice(1)).join(" "),x=g();return a?e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-8 text-center",children:e.jsx("p",{className:"text-slate-600",children:"Loading accounting report..."})}):e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-10 h-10 bg-emerald-100 rounded-lg flex items-center justify-center",children:e.jsx(Gr,{className:"w-5 h-5 text-emerald-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"Accounting Report"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Financial transactions and balance summary"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Start Date"}),e.jsx("input",{type:"date",value:o,onChange:N=>d(N.target.value),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"End Date"}),e.jsx("input",{type:"date",value:u,onChange:N=>h(N.target.value),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsx("div",{className:"bg-green-50 rounded-lg p-4 border border-green-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ve,{className:"w-8 h-8 text-green-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-green-600 font-medium",children:"Total Income"}),e.jsxs("p",{className:"text-2xl font-bold text-green-900",children:["",x.totalIncome.toFixed(2)]}),e.jsxs("p",{className:"text-xs text-green-600",children:[i.filter(N=>N.transaction_type==="income").length," transactions"]})]})]})}),e.jsx("div",{className:"bg-red-50 rounded-lg p-4 border border-red-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Go,{className:"w-8 h-8 text-red-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-red-600 font-medium",children:"Total Expenses"}),e.jsxs("p",{className:"text-2xl font-bold text-red-900",children:["",x.totalExpense.toFixed(2)]}),e.jsxs("p",{className:"text-xs text-red-600",children:[i.filter(N=>N.transaction_type==="expense").length," transactions"]})]})]})}),e.jsx("div",{className:`rounded-lg p-4 border ${x.netBalance>=0?"bg-emerald-50 border-emerald-200":"bg-amber-50 border-amber-200"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ct,{className:`w-8 h-8 ${x.netBalance>=0?"text-emerald-600":"text-amber-600"}`}),e.jsxs("div",{children:[e.jsx("p",{className:`text-xs font-medium ${x.netBalance>=0?"text-emerald-600":"text-amber-600"}`,children:"Net Balance"}),e.jsxs("p",{className:`text-2xl font-bold ${x.netBalance>=0?"text-emerald-900":"text-amber-900"}`,children:["",Math.abs(x.netBalance).toFixed(2)]}),e.jsx("p",{className:`text-xs ${x.netBalance>=0?"text-emerald-600":"text-amber-600"}`,children:x.netBalance>=0?"Profit":"Loss"})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-700 mb-4",children:"Top 5 Expense Categories"}),e.jsx("div",{className:"space-y-3",children:x.topExpenses.map(([N,y],b)=>e.jsxs("div",{className:"bg-slate-50 rounded-lg p-4 border border-slate-200",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-6 h-6 bg-red-100 text-red-800 rounded-full flex items-center justify-center text-xs font-bold",children:b+1}),e.jsx("span",{className:"text-sm font-medium text-slate-900",children:v(N)})]}),e.jsxs("span",{className:"text-sm font-bold text-slate-900",children:["",y.toFixed(2)]})]}),e.jsx("div",{className:"w-full bg-slate-200 rounded-full h-2",children:e.jsx("div",{className:"bg-red-600 h-2 rounded-full",style:{width:`${y/x.totalExpense*100}%`}})}),e.jsxs("p",{className:"text-xs text-slate-600 mt-1",children:[(y/x.totalExpense*100).toFixed(1),"% of total expenses"]})]},N))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-700 mb-4",children:"Payment Methods"}),e.jsx("div",{className:"space-y-3",children:Object.entries(x.paymentMethodBreakdown).sort((N,y)=>y[1]-N[1]).map(([N,y])=>e.jsxs("div",{className:"bg-slate-50 rounded-lg p-4 border border-slate-200",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-slate-900",children:v(N)}),e.jsxs("span",{className:"text-sm font-bold text-slate-900",children:["",y.toFixed(2)]})]}),e.jsx("div",{className:"w-full bg-slate-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${y/(x.totalIncome+x.totalExpense)*100}%`}})})]},N))})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-700 mb-4",children:"Financial Overview"}),e.jsx("div",{className:"bg-slate-50 rounded-lg p-4 border border-slate-200",children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-xs text-slate-600 mb-1",children:"Total Transactions"}),e.jsx("p",{className:"text-2xl font-bold text-slate-900",children:i.length})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-xs text-slate-600 mb-1",children:"Avg Income"}),e.jsxs("p",{className:"text-2xl font-bold text-green-600",children:["",i.filter(N=>N.transaction_type==="income").length>0?(x.totalIncome/i.filter(N=>N.transaction_type==="income").length).toFixed(2):"0.00"]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-xs text-slate-600 mb-1",children:"Avg Expense"}),e.jsxs("p",{className:"text-2xl font-bold text-red-600",children:["",i.filter(N=>N.transaction_type==="expense").length>0?(x.totalExpense/i.filter(N=>N.transaction_type==="expense").length).toFixed(2):"0.00"]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-xs text-slate-600 mb-1",children:"Categories"}),e.jsx("p",{className:"text-2xl font-bold text-slate-900",children:Object.keys(x.categoryBreakdown).length})]})]})})]})]})})}function Cv(){const[i,r]=k.useState("production"),a=[{id:"production",name:"Production Report",description:"Crusher production summary",icon:ot,color:"blue"},{id:"quarry",name:"Quarry Production",description:"Contractor operations summary",icon:Ct,color:"orange"},{id:"sales",name:"Sales Report",description:"Material dispatch and customer sales",icon:At,color:"green"},{id:"accounting",name:"Accounting Report",description:"Financial transactions and balance",icon:Gr,color:"emerald"}],l=(d,u)=>({blue:{bg:u?"bg-blue-50":"bg-white",border:u?"border-blue-500":"border-slate-200",iconBg:"bg-blue-100",iconText:"text-blue-600",text:u?"text-blue-900":"text-slate-700"},orange:{bg:u?"bg-orange-50":"bg-white",border:u?"border-orange-500":"border-slate-200",iconBg:"bg-orange-100",iconText:"text-orange-600",text:u?"text-orange-900":"text-slate-700"},green:{bg:u?"bg-green-50":"bg-white",border:u?"border-green-500":"border-slate-200",iconBg:"bg-green-100",iconText:"text-green-600",text:u?"text-green-900":"text-slate-700"},emerald:{bg:u?"bg-emerald-50":"bg-white",border:u?"border-emerald-500":"border-slate-200",iconBg:"bg-emerald-100",iconText:"text-emerald-600",text:u?"text-emerald-900":"text-slate-700"}})[d],o=()=>{switch(i){case"production":return e.jsx(Um,{});case"quarry":return e.jsx(_v,{});case"sales":return e.jsx(kv,{});case"accounting":return e.jsx(Sv,{});default:return e.jsx(Um,{})}};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:a.map(d=>{const u=i===d.id,h=l(d.color,u),p=d.icon;return e.jsxs("button",{onClick:()=>r(d.id),className:`${h.bg} rounded-xl p-4 border-2 ${h.border} hover:shadow-md transition-all text-left`,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:`w-10 h-10 ${h.iconBg} rounded-lg flex items-center justify-center`,children:e.jsx(p,{className:`w-5 h-5 ${h.iconText}`})}),e.jsx("h3",{className:`text-base font-semibold ${h.text}`,children:d.name})]}),e.jsx("p",{className:"text-xs text-slate-600",children:d.description})]},d.id)})}),e.jsx("div",{children:o()})]})}function Tv(){const[i,r]=k.useState([]),[a,l]=k.useState(!0),[o,d]=k.useState(!1),[u,h]=k.useState(null),[p,g]=k.useState(""),[v,x]=k.useState({email:"",password:"",full_name:"",role:"contractor",phone:""});k.useEffect(()=>{N()},[]);const N=async()=>{try{const{data:R,error:F}=await z.from("users").select("id, email, full_name, role, phone, is_active, created_at").order("created_at",{ascending:!1});if(F)throw F;r(R||[])}catch(R){console.error("Error loading users:",R)}finally{l(!1)}},y=async R=>{R.preventDefault();try{const{data:{session:F}}=await z.auth.getSession();if(!F)throw new Error("No active session");const ae=await fetch("https://exuiwldxpsezihvcoety.supabase.co/functions/v1/manage-user",{method:"POST",headers:{Authorization:`Bearer ${F.access_token}`,"Content-Type":"application/json"},body:JSON.stringify({email:v.email,password:v.password,full_name:v.full_name,role:v.role,phone:v.phone})}),_e=await ae.json();if(!ae.ok)throw new Error(_e.error||"Failed to create user");alert("User created successfully!"),d(!1),x({email:"",password:"",full_name:"",role:"contractor",phone:""}),N()}catch(F){console.error("Error creating user:",F),alert(F.message||"Failed to create user")}},b=async R=>{if(R.preventDefault(),!!u)try{const{error:F}=await z.from("users").update({full_name:v.full_name,role:v.role,phone:v.phone}).eq("id",u.id);if(F)throw F;alert("User updated successfully!"),h(null),x({email:"",password:"",full_name:"",role:"contractor",phone:""}),N()}catch(F){console.error("Error updating user:",F),alert(F.message||"Failed to update user")}},j=async(R,F)=>{try{const{error:H}=await z.from("users").update({is_active:!F}).eq("id",R);if(H)throw H;N()}catch(H){console.error("Error toggling user status:",H),alert(H.message||"Failed to update user status")}},_=async(R,F)=>{if(confirm(`Are you sure you want to delete user ${F}? This action cannot be undone.`))try{const{error:H}=await z.from("users").delete().eq("id",R);if(H)throw H;alert("User deleted successfully!"),N()}catch(H){console.error("Error deleting user:",H),alert(H.message||"Failed to delete user")}},T=R=>{h(R),x({email:R.email,password:"",full_name:R.full_name,role:R.role,phone:R.phone||""}),d(!0)},I=()=>{d(!1),h(null),x({email:"",password:"",full_name:"",role:"contractor",phone:""})},C=async()=>{if(confirm("This will remove any auth users that don't have corresponding user records. Continue?"))try{const{data:{session:R}}=await z.auth.getSession();if(!R)throw new Error("No active session");const H=await fetch("https://exuiwldxpsezihvcoety.supabase.co/functions/v1/cleanup-orphaned-users",{method:"POST",headers:{Authorization:`Bearer ${R.access_token}`,"Content-Type":"application/json"}}),ae=await H.json();if(!H.ok)throw new Error(ae.error||"Failed to cleanup users");alert(`Cleanup complete! Removed ${ae.orphaned_count} orphaned auth user(s).`),N()}catch(R){console.error("Error cleaning up users:",R),alert(R.message||"Failed to cleanup users")}},D=i.filter(R=>R.full_name.toLowerCase().includes(p.toLowerCase())||R.email.toLowerCase().includes(p.toLowerCase())||R.role.toLowerCase().includes(p.toLowerCase()));return a?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-slate-600",children:"Loading users..."})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"User Management"}),e.jsx("p",{className:"text-slate-600 mt-1",children:"Add, edit, and manage system users"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:C,className:"flex items-center gap-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:[e.jsx(gl,{className:"w-5 h-5"}),"Cleanup Orphaned Users"]}),e.jsxs("button",{onClick:()=>d(!o),className:"flex items-center gap-2 px-4 py-2 bg-slate-900 text-white rounded-lg hover:bg-slate-800 transition-colors",children:[e.jsx(ig,{className:"w-5 h-5"}),"Add New User"]})]})]}),o&&e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-4",children:u?"Edit User":"Add New User"}),e.jsxs("form",{onSubmit:u?b:y,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Email *"}),e.jsx("input",{type:"email",required:!0,disabled:!!u,value:v.email,onChange:R=>x({...v,email:R.target.value}),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent disabled:bg-slate-100"})]}),!u&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Password *"}),e.jsx("input",{type:"password",required:!0,value:v.password,onChange:R=>x({...v,password:R.target.value}),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Full Name *"}),e.jsx("input",{type:"text",required:!0,value:v.full_name,onChange:R=>x({...v,full_name:R.target.value}),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Role *"}),e.jsxs("select",{required:!0,value:v.role,onChange:R=>x({...v,role:R.target.value}),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent",children:[e.jsx("option",{value:"contractor",children:"Contractor"}),e.jsx("option",{value:"crusher_manager",children:"Crusher Manager"}),e.jsx("option",{value:"manager",children:"Manager"}),e.jsx("option",{value:"sales",children:"Sales"}),e.jsx("option",{value:"director",children:"Director"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Phone"}),e.jsx("input",{type:"tel",value:v.phone,onChange:R=>x({...v,phone:R.target.value}),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent"})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"submit",className:"px-4 py-2 bg-slate-900 text-white rounded-lg hover:bg-slate-800 transition-colors",children:u?"Update User":"Create User"}),e.jsx("button",{type:"button",onClick:I,className:"px-4 py-2 border border-slate-300 text-slate-700 rounded-lg hover:bg-slate-50 transition-colors",children:"Cancel"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200",children:[e.jsx("div",{className:"p-4 border-b border-slate-200",children:e.jsxs("div",{className:"relative",children:[e.jsx(jl,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-slate-400"}),e.jsx("input",{type:"text",placeholder:"Search users by name, email, or role...",value:p,onChange:R=>g(R.target.value),className:"w-full pl-10 pr-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent"})]})}),e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-slate-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"User"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Role"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Phone"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Created At"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-slate-200",children:D.map(R=>e.jsxs("tr",{className:"hover:bg-slate-50",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-slate-900",children:R.full_name}),e.jsx("div",{className:"text-sm text-slate-500",children:R.email})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-slate-100 text-slate-800 capitalize",children:R.role.replace("_"," ")})}),e.jsx("td",{className:"px-6 py-4 text-sm text-slate-500",children:R.phone||"-"}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("button",{onClick:()=>j(R.id,R.is_active),className:"flex items-center gap-1",children:R.is_active?e.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[e.jsx(et,{className:"w-3 h-3"}),"Active"]}):e.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",children:[e.jsx(rs,{className:"w-3 h-3"}),"Inactive"]})})}),e.jsx("td",{className:"px-6 py-4 text-sm text-slate-500",children:new Date(R.created_at).toLocaleDateString()}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>T(R),className:"p-2 text-slate-600 hover:text-slate-900 hover:bg-slate-100 rounded-lg transition-colors",title:"Edit user",children:e.jsx(ng,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>_(R.id,R.email),className:"p-2 text-red-600 hover:text-red-900 hover:bg-red-50 rounded-lg transition-colors",title:"Delete user",children:e.jsx(gl,{className:"w-4 h-4"})})]})})]},R.id))})]}),D.length===0&&e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-slate-500",children:"No users found"})})]})]}),e.jsx("div",{className:"bg-slate-50 rounded-lg p-4 border border-slate-200",children:e.jsxs("p",{className:"text-sm text-slate-600",children:[e.jsx("strong",{children:"Total Users:"})," ",i.length," |",e.jsx("strong",{className:"ml-3",children:"Active:"})," ",i.filter(R=>R.is_active).length," |",e.jsx("strong",{className:"ml-3",children:"Inactive:"})," ",i.filter(R=>!R.is_active).length]})})]})}function Ev({onSuccess:i}){const[r,a]=k.useState(!1),[l,o]=k.useState([]),[d,u]=k.useState(!0);k.useEffect(()=>{(async()=>{try{const{data:b,error:j}=await z.from("transport_records").select("material_transported, quantity, date").not("material_transported","is",null).not("quantity","is",null).gt("quantity",0).order("date",{ascending:!1}).limit(100);if(j)throw j;if(!b||b.length===0){o([{label:"Quarry",value:"quarry"},{label:"Stockyard",value:"stockyard"}]),u(!1);return}const _=b.find(C=>C.material_transported&&(C.quantity||0)>0),T=new Map;b.forEach(C=>{if(C.material_transported){const D=T.get(C.material_transported)||{quantity:0,latestDate:"1970-01-01"};T.set(C.material_transported,{quantity:D.quantity+(C.quantity||0),latestDate:C.date>D.latestDate?C.date:D.latestDate})}});const I=Array.from(T.entries()).sort((C,D)=>{const R=new Date(D[1].latestDate).getTime()-new Date(C[1].latestDate).getTime();return R!==0?R:D[1].quantity-C[1].quantity}).map(([C,D])=>({label:`${C} (${D.quantity.toFixed(1)} tons)`,value:C}));o(I),_&&p(C=>({...C,material_source:_.material_transported||"quarry"}))}catch(b){console.error("Error fetching material sources:",b),o([{label:"Quarry",value:"quarry"},{label:"Stockyard",value:"stockyard"}])}finally{u(!1)}})()},[]);const[h,p]=k.useState({date:new Date().toISOString().split("T")[0],shift:"morning",crusher_type:"jaw",machine_working_hours:"8.0",machine_downtime:"0.0",maintenance_hours:"0.0",material_source:"quarry",status:"operational",maintenance_notes:"",notes:""}),g=()=>{const y=parseFloat(h.machine_working_hours)||0,b=parseFloat(h.machine_downtime)||0,j=parseFloat(h.maintenance_hours)||0,_=y+b+j,T=_>0?y/_*100:0;return{totalHours:_,efficiency:T}},{totalHours:v,efficiency:x}=g(),N=async y=>{y.preventDefault(),a(!0);try{const{data:{user:b}}=await z.auth.getUser();if(!b){alert("You must be logged in");return}const{error:j}=await z.from("production_records").insert([{date:h.date,shift:h.shift,crusher_type:h.crusher_type,machine_working_hours:parseFloat(h.machine_working_hours),machine_downtime:parseFloat(h.machine_downtime),maintenance_hours:parseFloat(h.maintenance_hours),material_source:h.material_source,status:h.status,maintenance_notes:h.maintenance_notes,notes:h.notes}]);if(j)throw j;alert("Crusher production record added successfully!"),p({date:new Date().toISOString().split("T")[0],shift:"morning",crusher_type:"jaw",machine_working_hours:"8.0",machine_downtime:"0.0",maintenance_hours:"0.0",material_source:"quarry",status:"operational",maintenance_notes:"",notes:""}),i()}catch(b){alert(b.message)}finally{a(!1)}};return e.jsxs("form",{onSubmit:N,className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-3 pb-4 border-b border-slate-200",children:[e.jsx("div",{className:"w-10 h-10 bg-orange-100 rounded-lg flex items-center justify-center",children:e.jsx(ot,{className:"w-5 h-5 text-orange-600"})}),e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"Record Crusher Production"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Date *"}),e.jsxs("div",{className:"relative",children:[e.jsx(ge,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400"}),e.jsx("input",{type:"date",required:!0,value:h.date,onChange:y=>p({...h,date:y.target.value}),className:"w-full pl-10 pr-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Shift *"}),e.jsxs("select",{required:!0,value:h.shift,onChange:y=>p({...h,shift:y.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent",children:[e.jsx("option",{value:"morning",children:"Morning Shift"}),e.jsx("option",{value:"night",children:"Night Shift"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Crusher Type *"}),e.jsxs("select",{required:!0,value:h.crusher_type,onChange:y=>p({...h,crusher_type:y.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent",children:[e.jsx("option",{value:"jaw",children:"Jaw Crusher"}),e.jsx("option",{value:"vsi",children:"VSI"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:["Material Source *",d&&e.jsxs("span",{className:"ml-2 inline-flex items-center text-xs text-slate-500",children:[e.jsx(eg,{className:"w-3 h-3 mr-1 animate-spin"}),"Loading latest materials..."]}),!d&&l.length>0&&e.jsx("span",{className:"ml-2 text-xs text-green-600",children:" Auto-selected latest material"})]}),e.jsxs("select",{required:!0,value:h.material_source,onChange:y=>p({...h,material_source:y.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent",disabled:d,children:[l.map(y=>e.jsx("option",{value:y.value,children:y.label},y.value)),l.length===0&&!d&&e.jsxs(e.Fragment,{children:[e.jsx("option",{value:"quarry",children:"Quarry (No transport data)"}),e.jsx("option",{value:"stockyard",children:"Stockyard (No transport data)"})]})]}),!d&&l.length>0&&e.jsx("p",{className:"mt-1 text-xs text-slate-500",children:"Showing materials from latest transport operations with quantities"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Machine Working Hours *"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"number",step:"0.1",min:"0",max:"24",required:!0,value:h.machine_working_hours,onChange:y=>p({...h,machine_working_hours:y.target.value}),className:"w-full pl-4 pr-10 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"}),e.jsx("span",{className:"absolute right-3 top-2 text-slate-500",children:"hrs"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Machine Downtime"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"number",step:"0.1",min:"0",max:"24",value:h.machine_downtime,onChange:y=>p({...h,machine_downtime:y.target.value}),className:"w-full pl-4 pr-10 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"}),e.jsx("span",{className:"absolute right-3 top-2 text-slate-500",children:"hrs"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Maintenance Hours"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"number",step:"0.1",min:"0",max:"24",value:h.maintenance_hours,onChange:y=>p({...h,maintenance_hours:y.target.value}),className:"w-full pl-4 pr-10 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"}),e.jsx("span",{className:"absolute right-3 top-2 text-slate-500",children:"hrs"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 p-3 bg-slate-50 rounded-lg",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-slate-500",children:"Total Shift Hours"}),e.jsxs("p",{className:"text-lg font-semibold",children:[v.toFixed(1)," hrs"]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-slate-500",children:"Machine Efficiency"}),e.jsxs("p",{className:"text-lg font-semibold",children:[x.toFixed(1),"%"]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-slate-500",children:"Uptime"}),e.jsxs("p",{className:"text-lg font-semibold",children:[v>0?(parseFloat(h.machine_working_hours)/v*100).toFixed(1):"0.0","%"]})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Status *"}),e.jsxs("select",{required:!0,value:h.status,onChange:y=>p({...h,status:y.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent",children:[e.jsx("option",{value:"completed",children:"Completed"}),e.jsx("option",{value:"in_progress",children:"In Progress"}),e.jsx("option",{value:"maintenance",children:"Maintenance"}),e.jsx("option",{value:"breakdown",children:"Breakdown"})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Maintenance Notes"}),e.jsx("textarea",{value:h.maintenance_notes,onChange:y=>p({...h,maintenance_notes:y.target.value}),rows:2,className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent",placeholder:"Any maintenance activities performed..."})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Additional Notes"}),e.jsx("textarea",{value:h.notes,onChange:y=>p({...h,notes:y.target.value}),rows:2,className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent",placeholder:"General observations or remarks..."})]})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t border-slate-200",children:e.jsx("button",{type:"submit",disabled:r,className:"px-6 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 disabled:bg-slate-400 transition-colors",children:r?"Saving...":"Save Production Record"})})]})}function Pv(){const[i,r]=k.useState([]),[a,l]=k.useState(!0),[o,d]=k.useState(null);k.useEffect(()=>{u()},[]);const u=async()=>{try{const{data:v,error:x}=await z.from("production_records").select("*").order("date",{ascending:!1});if(x)throw x;r(v||[])}catch(v){console.error("Error fetching production records:",v)}finally{l(!1)}},h=v=>{switch(v){case"completed":return"bg-green-100 text-green-800";case"in_progress":return"bg-blue-100 text-blue-800";case"maintenance":return"bg-amber-100 text-amber-800";case"breakdown":return"bg-red-100 text-red-800";default:return"bg-slate-100 text-slate-800"}},g=(()=>{const v=i.reduce((b,j)=>b+j.material_input,0),x=i.reduce((b,j)=>b+(j.total_output||0),0),N=i.reduce((b,j)=>b+j.working_hours,0),y=v>0?x/v*100:0;return{totalInput:v,totalOutput:x,totalHours:N,avgEfficiency:y}})();return a?e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-8 text-center",children:e.jsx("p",{className:"text-slate-600",children:"Loading production records..."})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx("div",{className:"bg-orange-50 rounded-lg p-4 border border-orange-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ot,{className:"w-8 h-8 text-orange-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-orange-600 font-medium",children:"Total Input"}),e.jsxs("p",{className:"text-xl font-bold text-orange-900",children:[g.totalInput.toFixed(2)," T"]})]})]})}),e.jsx("div",{className:"bg-green-50 rounded-lg p-4 border border-green-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ve,{className:"w-8 h-8 text-green-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-green-600 font-medium",children:"Total Output"}),e.jsxs("p",{className:"text-xl font-bold text-green-900",children:[g.totalOutput.toFixed(2)," T"]})]})]})}),e.jsx("div",{className:"bg-blue-50 rounded-lg p-4 border border-blue-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Me,{className:"w-8 h-8 text-blue-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-blue-600 font-medium",children:"Working Hours"}),e.jsxs("p",{className:"text-xl font-bold text-blue-900",children:[g.totalHours.toFixed(1)," hrs"]})]})]})}),e.jsx("div",{className:"bg-purple-50 rounded-lg p-4 border border-purple-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Tt,{className:"w-8 h-8 text-purple-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-purple-600 font-medium",children:"Efficiency"}),e.jsxs("p",{className:"text-xl font-bold text-purple-900",children:[g.avgEfficiency.toFixed(1),"%"]})]})]})})]}),i.length===0?e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-8 text-center",children:[e.jsx(ot,{className:"w-12 h-12 text-slate-400 mx-auto mb-3"}),e.jsx("p",{className:"text-slate-600",children:"No production records found"})]}):e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200",children:[e.jsx("div",{className:"px-6 py-4 border-b border-slate-200",children:e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"Production Records"})}),e.jsx("div",{className:"divide-y divide-slate-200",children:i.map(v=>e.jsxs("div",{onClick:()=>d(o?.id===v.id?null:v),className:"p-6 hover:bg-slate-50 cursor-pointer transition-colors",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-lg bg-orange-100 flex items-center justify-center flex-shrink-0",children:e.jsx(ot,{className:"w-6 h-6 text-orange-600"})}),e.jsxs("div",{children:[e.jsxs("h4",{className:"font-semibold text-slate-900",children:["Production - ",new Date(v.date).toLocaleDateString()]}),e.jsxs("div",{className:"flex items-center gap-1 text-sm text-slate-600 mt-0.5",children:[e.jsx(ge,{className:"w-4 h-4"}),new Date(v.date).toLocaleDateString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric"})]})]})]}),e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${h(v.status)}`,children:v.status.toUpperCase().replace("_"," ")})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-slate-50 rounded-lg p-3",children:[e.jsx("p",{className:"text-xs font-medium text-slate-600 mb-1",children:"Input"}),e.jsxs("p",{className:"text-sm font-bold text-slate-900",children:[v.material_input," T"]})]}),e.jsxs("div",{className:"bg-slate-50 rounded-lg p-3",children:[e.jsx("p",{className:"text-xs font-medium text-slate-600 mb-1",children:"Output 20mm"}),e.jsxs("p",{className:"text-sm font-bold text-slate-900",children:[v.output_20mm||0," T"]})]}),e.jsxs("div",{className:"bg-slate-50 rounded-lg p-3",children:[e.jsx("p",{className:"text-xs font-medium text-slate-600 mb-1",children:"Output 40mm"}),e.jsxs("p",{className:"text-sm font-bold text-slate-900",children:[v.output_40mm||0," T"]})]}),e.jsxs("div",{className:"bg-slate-50 rounded-lg p-3",children:[e.jsx("p",{className:"text-xs font-medium text-slate-600 mb-1",children:"Output Dust"}),e.jsxs("p",{className:"text-sm font-bold text-slate-900",children:[v.output_dust||0," T"]})]})]}),o?.id===v.id&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-slate-200 space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Total Output: "}),e.jsxs("span",{className:"text-sm text-slate-900 font-bold",children:[v.total_output||0," T"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Working Hours: "}),e.jsxs("span",{className:"text-sm text-slate-900",children:[v.working_hours," hrs"]})]}),v.downtime_hours>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Downtime: "}),e.jsxs("span",{className:"text-sm text-red-600",children:[v.downtime_hours," hrs"]})]})]}),v.maintenance_notes&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Maintenance: "}),e.jsx("p",{className:"text-sm text-slate-600 mt-1",children:v.maintenance_notes})]}),v.notes&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Notes: "}),e.jsx("p",{className:"text-sm text-slate-600 mt-1",children:v.notes})]})]})]},v.id))})]})]})}function Dv({onSuccess:i}){const[r,a]=k.useState(!1),[l,o]=k.useState({report_date:new Date().toISOString().split("T")[0],starting_reading:{kw:"",kva:"",kvah:"",kwh:"",pf_c:"",pf:""},ending_reading:{kw:"",kva:"",kvah:"",kwh:"",pf_c:"",pf:""},notes:""});k.useEffect(()=>{(async()=>{try{const{data:N,error:y}=await z.from("eb_reports").select("ending_reading").order("report_date",{ascending:!1}).limit(1);if(y)throw y;N&&N.length>0&&N[0].ending_reading&&o(b=>({...b,starting_reading:N[0].ending_reading,ending_reading:N[0].ending_reading}))}catch(N){console.error("Error fetching latest EB report:",N)}})()},[]);const d=async(x,N,y={})=>{const{data:{user:b}}=await z.auth.getUser();b&&await z.from("notifications").insert([{user_id:b.id,type:"pf_warning",title:x,message:N,metadata:{...y,report_date:l.report_date}}])},u=async()=>{const x=parseFloat(l.starting_reading.pf)||0,N=parseFloat(l.ending_reading.pf)||0;x>.95&&await d("High Power Factor Warning",`Starting PF (${x}) exceeds 0.95`,{pf_value:x,reading_type:"starting"}),N>.95&&await d("High Power Factor Warning",`Ending PF (${N}) exceeds 0.95`,{pf_value:N,reading_type:"ending"})},h=async x=>{x.preventDefault(),a(!0);try{await u();const{data:{user:N}}=await z.auth.getUser();if(!N){alert("You must be logged in");return}const{error:y}=await z.from("eb_reports").insert([{user_id:N.id,report_date:l.report_date,starting_reading:l.starting_reading,ending_reading:l.ending_reading,notes:l.notes||null}]);if(y)throw y;alert("EB report submitted successfully!"),o({report_date:new Date().toISOString().split("T")[0],starting_reading:{kw:"",kva:"",kvah:"",kwh:"",pf_c:"",pf:""},ending_reading:{kw:"",kva:"",kvah:"",kwh:"",pf_c:"",pf:""},notes:""}),i()}catch(N){alert(N.message)}finally{a(!1)}},p=()=>{const x=parseFloat(l.starting_reading.kwh)||0,N=parseFloat(l.ending_reading.kwh)||0;return Math.max(0,N-x)},g=()=>0,v=(x,N,y)=>{o(b=>x==="starting"?{...b,starting_reading:{...b.starting_reading,[N]:y},ending_reading:{...b.ending_reading,[N]:y}}:{...b,ending_reading:{...b.ending_reading,[N]:y}})};return e.jsxs("form",{onSubmit:h,className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-3 pb-4 border-b border-slate-200",children:[e.jsx("div",{className:"w-10 h-10 bg-yellow-100 rounded-lg flex items-center justify-center",children:e.jsx(Qt,{className:"w-5 h-5 text-yellow-600"})}),e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"Daily EB Report"})]}),parseFloat(l.starting_reading.pf)>.95||parseFloat(l.ending_reading.pf)>.95&&e.jsx("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 p-4 mb-6",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(Hr,{className:"h-5 w-5 text-yellow-400","aria-hidden":"true"})}),e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:"text-sm text-yellow-700",children:"Warning: Power Factor (PF) exceeds 0.95. A notification has been sent to the director."})})]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"max-w-xs",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Report Date *"}),e.jsxs("div",{className:"relative",children:[e.jsx(ge,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400"}),e.jsx("input",{type:"date",required:!0,value:l.report_date,onChange:x=>o({...l,report_date:x.target.value}),className:"w-full pl-10 pr-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-transparent"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-slate-50 p-4 rounded-lg border border-slate-200",children:[e.jsx("h4",{className:"text-sm font-medium text-slate-700 mb-4",children:"Starting Reading"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-600 mb-1",children:"KW"}),e.jsx("input",{type:"number",step:"0.01",value:l.starting_reading.kw,onChange:x=>v("starting","kw",x.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-yellow-500 focus:border-transparent",placeholder:"0.00"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-600 mb-1",children:"KVA"}),e.jsx("input",{type:"number",step:"0.01",value:l.starting_reading.kva,onChange:x=>v("starting","kva",x.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-yellow-500 focus:border-transparent",placeholder:"0.00"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-600 mb-1",children:"KVAH"}),e.jsx("input",{type:"number",step:"0.01",value:l.starting_reading.kvah,onChange:x=>v("starting","kvah",x.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-yellow-500 focus:border-transparent",placeholder:"0.00"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-600 mb-1",children:"KWH"}),e.jsx("input",{type:"number",step:"0.01",required:!0,value:l.starting_reading.kwh,onChange:x=>v("starting","kwh",x.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-yellow-500 focus:border-transparent",placeholder:"0.00"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-600 mb-1",children:"PF C"}),e.jsx("input",{type:"number",step:"0.01",value:l.starting_reading.pf_c,onChange:x=>v("starting","pf_c",x.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-yellow-500 focus:border-transparent",placeholder:"0.00"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-600 mb-1",children:"PF"}),e.jsx("input",{type:"number",step:"0.01",value:l.starting_reading.pf,onChange:x=>v("starting","pf",x.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-yellow-500 focus:border-transparent",placeholder:"0.00"})]})]})]}),e.jsxs("div",{className:"bg-slate-50 p-4 rounded-lg border border-slate-200",children:[e.jsx("h4",{className:"text-sm font-medium text-slate-700 mb-4",children:"Ending Reading"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-600 mb-1",children:"KW"}),e.jsx("input",{type:"number",step:"0.01",value:l.ending_reading.kw,onChange:x=>v("ending","kw",x.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-yellow-500 focus:border-transparent",placeholder:"0.00"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-600 mb-1",children:"KVA"}),e.jsx("input",{type:"number",step:"0.01",value:l.ending_reading.kva,onChange:x=>v("ending","kva",x.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-yellow-500 focus:border-transparent",placeholder:"0.00"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-600 mb-1",children:"KVAH"}),e.jsx("input",{type:"number",step:"0.01",value:l.ending_reading.kvah,onChange:x=>v("ending","kvah",x.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-yellow-500 focus:border-transparent",placeholder:"0.00"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-600 mb-1",children:"KWH *"}),e.jsx("input",{type:"number",step:"0.01",required:!0,value:l.ending_reading.kwh,onChange:x=>v("ending","kwh",x.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-yellow-500 focus:border-transparent",placeholder:"0.00"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-600 mb-1",children:"PF C"}),e.jsx("input",{type:"number",step:"0.01",value:l.ending_reading.pf_c,onChange:x=>v("ending","pf_c",x.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-yellow-500 focus:border-transparent",placeholder:"0.00"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-600 mb-1",children:"PF"}),e.jsx("input",{type:"number",step:"0.01",value:l.ending_reading.pf,onChange:x=>v("ending","pf",x.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-yellow-500 focus:border-transparent",placeholder:"0.00"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"p-4 bg-slate-50 rounded-lg border border-slate-200",children:[e.jsx("div",{className:"text-sm font-medium text-slate-600 mb-1",children:"Units Consumed"}),e.jsx("input",{type:"text",value:`${p().toFixed(2)} kWh`,readOnly:!0,className:"w-full px-4 py-2 border border-slate-300 rounded-lg bg-white text-slate-700 font-semibold mt-2"})]}),e.jsxs("div",{className:"p-4 bg-slate-50 rounded-lg border border-slate-200",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-600 mb-1",children:"Total Cost"}),e.jsx("input",{type:"text",value:""+g().toFixed(2),readOnly:!0,className:"w-full px-4 py-2 border border-slate-300 rounded-lg bg-white text-green-700 font-semibold mt-2"})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Additional Notes"}),e.jsx("textarea",{value:l.notes,onChange:x=>o({...l,notes:x.target.value}),rows:2,className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-transparent",placeholder:"Any other observations or remarks..."})]})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t border-slate-200",children:e.jsx("button",{type:"submit",disabled:r,className:"px-6 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700 disabled:bg-slate-400 transition-colors",children:r?"Submitting...":"Submit EB Report"})})]})}function Ov(){const[i,r]=k.useState([]),[a,l]=k.useState(!0),[o,d]=k.useState(null);k.useEffect(()=>{u()},[]);const u=async()=>{try{const{data:v,error:x}=await z.from("eb_reports").select("*").order("report_date",{ascending:!1});if(x)throw x;r(v||[])}catch(v){console.error("Error fetching EB reports:",v)}finally{l(!1)}},h=v=>{switch(v){case"operational":return"bg-green-100 text-green-800";case"partial":return"bg-blue-100 text-blue-800";case"maintenance":return"bg-amber-100 text-amber-800";case"breakdown":return"bg-red-100 text-red-800";default:return"bg-slate-100 text-slate-800"}},g=(()=>{const v=i.reduce((y,b)=>y+b.units_consumed,0),x=i.reduce((y,b)=>y+b.total_cost,0),N=v>0?x/v:0;return{totalUnits:v,totalCost:x,avgCostPerUnit:N,reportCount:i.length}})();return a?e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-8 text-center",children:e.jsx("p",{className:"text-slate-600",children:"Loading EB reports..."})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx("div",{className:"bg-yellow-50 rounded-lg p-4 border border-yellow-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Qt,{className:"w-8 h-8 text-yellow-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-yellow-600 font-medium",children:"Total Units"}),e.jsx("p",{className:"text-xl font-bold text-yellow-900",children:g.totalUnits.toFixed(2)})]})]})}),e.jsx("div",{className:"bg-green-50 rounded-lg p-4 border border-green-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ct,{className:"w-8 h-8 text-green-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-green-600 font-medium",children:"Total Cost"}),e.jsxs("p",{className:"text-xl font-bold text-green-900",children:["",g.totalCost.toFixed(2)]})]})]})}),e.jsx("div",{className:"bg-blue-50 rounded-lg p-4 border border-blue-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ve,{className:"w-8 h-8 text-blue-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-blue-600 font-medium",children:"Avg Cost/Unit"}),e.jsxs("p",{className:"text-xl font-bold text-blue-900",children:["",g.avgCostPerUnit.toFixed(2)]})]})]})}),e.jsx("div",{className:"bg-purple-50 rounded-lg p-4 border border-purple-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ge,{className:"w-8 h-8 text-purple-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-purple-600 font-medium",children:"Reports"}),e.jsx("p",{className:"text-xl font-bold text-purple-900",children:g.reportCount})]})]})})]}),i.length===0?e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-8 text-center",children:[e.jsx(Qt,{className:"w-12 h-12 text-slate-400 mx-auto mb-3"}),e.jsx("p",{className:"text-slate-600",children:"No EB reports found"})]}):e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200",children:[e.jsx("div",{className:"px-6 py-4 border-b border-slate-200",children:e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"EB Reports"})}),e.jsx("div",{className:"divide-y divide-slate-200",children:i.map(v=>e.jsxs("div",{onClick:()=>d(o?.id===v.id?null:v),className:"p-6 hover:bg-slate-50 cursor-pointer transition-colors",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-lg bg-yellow-100 flex items-center justify-center flex-shrink-0",children:e.jsx(Qt,{className:"w-6 h-6 text-yellow-600"})}),e.jsxs("div",{children:[e.jsxs("h4",{className:"font-semibold text-slate-900",children:["EB Report - ",new Date(v.report_date).toLocaleDateString()]}),e.jsxs("div",{className:"flex items-center gap-1 text-sm text-slate-600 mt-0.5",children:[e.jsx(ge,{className:"w-4 h-4"}),new Date(v.report_date).toLocaleDateString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric"})]})]})]}),e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${h(v.equipment_status)}`,children:v.equipment_status.toUpperCase()})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-slate-50 rounded-lg p-3",children:[e.jsx("p",{className:"text-xs font-medium text-slate-600 mb-1",children:"Start Reading"}),e.jsx("p",{className:"text-sm font-bold text-slate-900",children:v.meter_reading_start})]}),e.jsxs("div",{className:"bg-slate-50 rounded-lg p-3",children:[e.jsx("p",{className:"text-xs font-medium text-slate-600 mb-1",children:"End Reading"}),e.jsx("p",{className:"text-sm font-bold text-slate-900",children:v.meter_reading_end})]}),e.jsxs("div",{className:"bg-yellow-50 rounded-lg p-3",children:[e.jsx("p",{className:"text-xs font-medium text-yellow-600 mb-1",children:"Units Consumed"}),e.jsx("p",{className:"text-sm font-bold text-yellow-900",children:v.units_consumed.toFixed(2)})]}),e.jsxs("div",{className:"bg-green-50 rounded-lg p-3",children:[e.jsx("p",{className:"text-xs font-medium text-green-600 mb-1",children:"Total Cost"}),e.jsxs("p",{className:"text-sm font-bold text-green-900",children:["",v.total_cost.toFixed(2)]})]})]}),o?.id===v.id&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-slate-200 space-y-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Cost per Unit: "}),e.jsxs("span",{className:"text-sm text-slate-900",children:["",v.cost_per_unit.toFixed(2)]})]}),v.power_cuts&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Power Cuts: "}),e.jsx("p",{className:"text-sm text-slate-600 mt-1",children:v.power_cuts})]}),v.notes&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Notes: "}),e.jsx("p",{className:"text-sm text-slate-600 mt-1",children:v.notes})]})]})]},v.id))})]})]})}function Rv({onSuccess:i}){const{user:r}=Ne(),[a,l]=k.useState(!1),[o,d]=k.useState(null),[u,h]=k.useState({date:new Date().toISOString().split("T")[0],operator_name:"",vehicle_number:"",start_time:"",end_time:"",total_hours:"",fuel_consumed:"",work_description:"",notes:""}),p=y=>{const{name:b,value:j}=y.target;h(_=>({..._,[b]:j}))},g=y=>{const b=y.match(/^(\d{1,2}):(\d{2})$/);if(b){const _=parseInt(b[1],10),T=parseInt(b[2],10);if(_>=0&&_<24&&T>=0&&T<60)return _+T/60}const j=y.match(/^(\d{1,2}):(\d{2})\s*(AM|PM|am|pm)?$/i);if(j){let _=parseInt(j[1],10);const T=parseInt(j[2],10),I=(j[3]||"").toLowerCase();if(I==="pm"&&_<12&&(_+=12),I==="am"&&_===12&&(_=0),_>=0&&_<24&&T>=0&&T<60)return _+T/60}return null},v=()=>{if(u.start_time&&u.end_time){const y=g(u.start_time),b=g(u.end_time);if(y!==null&&b!==null){let j=b-y;j<0&&(j+=24),h(_=>({..._,total_hours:j.toFixed(2)}))}else h(j=>({...j,total_hours:""}))}},x=()=>{const y=[];return u.operator_name||y.push("Operator name is required"),u.vehicle_number||y.push("Driver name is required"),u.start_time||y.push("Start time is required"),u.end_time||y.push("End time is required"),y.length>0?(d(y.join(", ")),!1):(d(null),!0)},N=async y=>{if(y.preventDefault(),!r){d("User not authenticated");return}if(x()){l(!0),d(null);try{const b={user_id:r?.id,date:u.date,operator_name:u.operator_name,vehicle_number:u.vehicle_number,start_time:u.start_time,end_time:u.end_time,total_hours:parseFloat(u.total_hours)||0,fuel_consumed:parseFloat(u.fuel_consumed)||0,work_description:u.work_description||null,notes:u.notes||null,status:"pending",created_at:new Date().toISOString()},{error:j}=await z.from("jcb_operations").insert([b]);if(j)throw j;h({date:new Date().toISOString().split("T")[0],operator_name:"",vehicle_number:"",start_time:"",end_time:"",total_hours:"",fuel_consumed:"",work_description:"",notes:""}),Te.success("JCB operation recorded successfully!"),i&&i()}catch(b){console.error("Error saving JCB operation:",b),d(b instanceof Error?b.message:"Failed to save JCB operation"),Te.error("Failed to save JCB operation")}finally{l(!1)}}};return e.jsxs("form",{onSubmit:N,className:"space-y-6",children:[o&&e.jsx("div",{className:"bg-red-50 border-l-4 border-red-500 p-4 mb-4",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(Tt,{className:"h-5 w-5 text-red-500","aria-hidden":"true"})}),e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:"text-sm text-red-700",children:o})})]})}),e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-amber-100 flex items-center justify-center",children:e.jsx(Vo,{className:"w-5 h-5 text-amber-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"JCB Operations"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Record JCB operations and maintenance"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Date"}),e.jsx("input",{type:"date",name:"date",value:u.date,onChange:p,required:!0,className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Work Type"}),e.jsxs("select",{name:"operator_name",value:u.operator_name,onChange:p,required:!0,className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Select work type"}),e.jsx("option",{value:"Good borders loading",children:"Good borders loading"}),e.jsx("option",{value:"Material loading",children:"Material loading"}),e.jsx("option",{value:"Bunker works",children:"Bunker works"}),e.jsx("option",{value:"Crusher works",children:"Crusher works"}),e.jsx("option",{value:"Quarry works",children:"Quarry works"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Driver Name"}),e.jsx("input",{type:"text",name:"driver_name",value:u.vehicle_number,onChange:p,required:!0,className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-transparent",placeholder:"Enter driver name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Start Time"}),e.jsx("input",{type:"text",name:"start_time",value:u.start_time,onChange:p,onBlur:v,required:!0,className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-transparent",placeholder:"e.g., 9:00 AM or 14:30"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"End Time"}),e.jsx("input",{type:"text",name:"end_time",value:u.end_time,onChange:p,onBlur:v,required:!0,className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-transparent",placeholder:"e.g., 5:30 PM or 17:30"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Total Hours"}),e.jsx("input",{type:"number",name:"total_hours",value:u.total_hours,readOnly:!0,className:"w-full px-4 py-2 border border-slate-300 bg-slate-50 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Fuel Consumed (Liters)"}),e.jsx("input",{type:"number",name:"fuel_consumed",value:u.fuel_consumed,onChange:p,min:"0",step:"0.1",className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-transparent",placeholder:"0.0"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Work Description"}),e.jsx("input",{type:"text",name:"work_description",value:u.work_description,onChange:p,className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-transparent",placeholder:"E.g., Loading, Leveling, Excavation, etc."})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Notes"}),e.jsx("textarea",{name:"notes",value:u.notes,onChange:p,rows:3,className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-transparent",placeholder:"Any additional notes or observations..."})]})]}),e.jsx("div",{className:"mt-6 flex justify-end",children:e.jsxs("button",{type:"submit",disabled:a,className:"flex items-center gap-2 px-6 py-2 bg-amber-600 text-white rounded-lg hover:bg-amber-700 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:ring-offset-2 transition-colors disabled:opacity-50",children:[e.jsx(Kt,{className:"w-4 h-4"}),a?"Saving...":"Save Record"]})})]})}const jh=6048e5,Lv=864e5,Bm=Symbol.for("constructDateFrom");function fs(i,r){return typeof i=="function"?i(r):i&&typeof i=="object"&&Bm in i?i[Bm](r):i instanceof Date?new i.constructor(r):new Date(r)}function Mt(i,r){return fs(r||i,i)}function wh(i,r,a){const l=Mt(i,a?.in);return isNaN(r)?fs(i,NaN):(r&&l.setDate(l.getDate()+r),l)}let Iv={};function kl(){return Iv}function Qn(i,r){const a=kl(),l=r?.weekStartsOn??r?.locale?.options?.weekStartsOn??a.weekStartsOn??a.locale?.options?.weekStartsOn??0,o=Mt(i,r?.in),d=o.getDay(),u=(d<l?7:0)+d-l;return o.setDate(o.getDate()-u),o.setHours(0,0,0,0),o}function bl(i,r){return Qn(i,{...r,weekStartsOn:1})}function Nh(i,r){const a=Mt(i,r?.in),l=a.getFullYear(),o=fs(a,0);o.setFullYear(l+1,0,4),o.setHours(0,0,0,0);const d=bl(o),u=fs(a,0);u.setFullYear(l,0,4),u.setHours(0,0,0,0);const h=bl(u);return a.getTime()>=d.getTime()?l+1:a.getTime()>=h.getTime()?l:l-1}function zm(i){const r=Mt(i),a=new Date(Date.UTC(r.getFullYear(),r.getMonth(),r.getDate(),r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds()));return a.setUTCFullYear(r.getFullYear()),+i-+a}function Av(i,...r){const a=fs.bind(null,r.find(l=>typeof l=="object"));return r.map(a)}function Wm(i,r){const a=Mt(i,r?.in);return a.setHours(0,0,0,0),a}function Mv(i,r,a){const[l,o]=Av(a?.in,i,r),d=Wm(l),u=Wm(o),h=+d-zm(d),p=+u-zm(u);return Math.round((h-p)/Lv)}function Fv(i,r){const a=Nh(i,r),l=fs(i,0);return l.setFullYear(a,0,4),l.setHours(0,0,0,0),bl(l)}function $v(i){return i instanceof Date||typeof i=="object"&&Object.prototype.toString.call(i)==="[object Date]"}function qv(i){return!(!$v(i)&&typeof i!="number"||isNaN(+Mt(i)))}function Uv(i,r){const a=Mt(i,r?.in);return a.setFullYear(a.getFullYear(),0,1),a.setHours(0,0,0,0),a}const Bv={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},zv=(i,r,a)=>{let l;const o=Bv[i];return typeof o=="string"?l=o:r===1?l=o.one:l=o.other.replace("{{count}}",r.toString()),a?.addSuffix?a.comparison&&a.comparison>0?"in "+l:l+" ago":l};function Lo(i){return(r={})=>{const a=r.width?String(r.width):i.defaultWidth;return i.formats[a]||i.formats[i.defaultWidth]}}const Wv={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},Hv={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},Vv={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},Qv={date:Lo({formats:Wv,defaultWidth:"full"}),time:Lo({formats:Hv,defaultWidth:"full"}),dateTime:Lo({formats:Vv,defaultWidth:"full"})},Gv={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},Kv=(i,r,a,l)=>Gv[i];function Mn(i){return(r,a)=>{const l=a?.context?String(a.context):"standalone";let o;if(l==="formatting"&&i.formattingValues){const u=i.defaultFormattingWidth||i.defaultWidth,h=a?.width?String(a.width):u;o=i.formattingValues[h]||i.formattingValues[u]}else{const u=i.defaultWidth,h=a?.width?String(a.width):i.defaultWidth;o=i.values[h]||i.values[u]}const d=i.argumentCallback?i.argumentCallback(r):r;return o[d]}}const Yv={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},Jv={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},Xv={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},Zv={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},eb={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},tb={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},sb=(i,r)=>{const a=Number(i),l=a%100;if(l>20||l<10)switch(l%10){case 1:return a+"st";case 2:return a+"nd";case 3:return a+"rd"}return a+"th"},rb={ordinalNumber:sb,era:Mn({values:Yv,defaultWidth:"wide"}),quarter:Mn({values:Jv,defaultWidth:"wide",argumentCallback:i=>i-1}),month:Mn({values:Xv,defaultWidth:"wide"}),day:Mn({values:Zv,defaultWidth:"wide"}),dayPeriod:Mn({values:eb,defaultWidth:"wide",formattingValues:tb,defaultFormattingWidth:"wide"})};function Fn(i){return(r,a={})=>{const l=a.width,o=l&&i.matchPatterns[l]||i.matchPatterns[i.defaultMatchWidth],d=r.match(o);if(!d)return null;const u=d[0],h=l&&i.parsePatterns[l]||i.parsePatterns[i.defaultParseWidth],p=Array.isArray(h)?ab(h,x=>x.test(u)):nb(h,x=>x.test(u));let g;g=i.valueCallback?i.valueCallback(p):p,g=a.valueCallback?a.valueCallback(g):g;const v=r.slice(u.length);return{value:g,rest:v}}}function nb(i,r){for(const a in i)if(Object.prototype.hasOwnProperty.call(i,a)&&r(i[a]))return a}function ab(i,r){for(let a=0;a<i.length;a++)if(r(i[a]))return a}function lb(i){return(r,a={})=>{const l=r.match(i.matchPattern);if(!l)return null;const o=l[0],d=r.match(i.parsePattern);if(!d)return null;let u=i.valueCallback?i.valueCallback(d[0]):d[0];u=a.valueCallback?a.valueCallback(u):u;const h=r.slice(o.length);return{value:u,rest:h}}}const ib=/^(\d+)(th|st|nd|rd)?/i,ob=/\d+/i,cb={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},db={any:[/^b/i,/^(a|c)/i]},ub={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},mb={any:[/1/i,/2/i,/3/i,/4/i]},hb={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},fb={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},xb={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},pb={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},gb={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},vb={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},bb={ordinalNumber:lb({matchPattern:ib,parsePattern:ob,valueCallback:i=>parseInt(i,10)}),era:Fn({matchPatterns:cb,defaultMatchWidth:"wide",parsePatterns:db,defaultParseWidth:"any"}),quarter:Fn({matchPatterns:ub,defaultMatchWidth:"wide",parsePatterns:mb,defaultParseWidth:"any",valueCallback:i=>i+1}),month:Fn({matchPatterns:hb,defaultMatchWidth:"wide",parsePatterns:fb,defaultParseWidth:"any"}),day:Fn({matchPatterns:xb,defaultMatchWidth:"wide",parsePatterns:pb,defaultParseWidth:"any"}),dayPeriod:Fn({matchPatterns:gb,defaultMatchWidth:"any",parsePatterns:vb,defaultParseWidth:"any"})},yb={code:"en-US",formatDistance:zv,formatLong:Qv,formatRelative:Kv,localize:rb,match:bb,options:{weekStartsOn:0,firstWeekContainsDate:1}};function jb(i,r){const a=Mt(i,r?.in);return Mv(a,Uv(a))+1}function wb(i,r){const a=Mt(i,r?.in),l=+bl(a)-+Fv(a);return Math.round(l/jh)+1}function _h(i,r){const a=Mt(i,r?.in),l=a.getFullYear(),o=kl(),d=r?.firstWeekContainsDate??r?.locale?.options?.firstWeekContainsDate??o.firstWeekContainsDate??o.locale?.options?.firstWeekContainsDate??1,u=fs(r?.in||i,0);u.setFullYear(l+1,0,d),u.setHours(0,0,0,0);const h=Qn(u,r),p=fs(r?.in||i,0);p.setFullYear(l,0,d),p.setHours(0,0,0,0);const g=Qn(p,r);return+a>=+h?l+1:+a>=+g?l:l-1}function Nb(i,r){const a=kl(),l=r?.firstWeekContainsDate??r?.locale?.options?.firstWeekContainsDate??a.firstWeekContainsDate??a.locale?.options?.firstWeekContainsDate??1,o=_h(i,r),d=fs(r?.in||i,0);return d.setFullYear(o,0,l),d.setHours(0,0,0,0),Qn(d,r)}function _b(i,r){const a=Mt(i,r?.in),l=+Qn(a,r)-+Nb(a,r);return Math.round(l/jh)+1}function we(i,r){const a=i<0?"-":"",l=Math.abs(i).toString().padStart(r,"0");return a+l}const Is={y(i,r){const a=i.getFullYear(),l=a>0?a:1-a;return we(r==="yy"?l%100:l,r.length)},M(i,r){const a=i.getMonth();return r==="M"?String(a+1):we(a+1,2)},d(i,r){return we(i.getDate(),r.length)},a(i,r){const a=i.getHours()/12>=1?"pm":"am";switch(r){case"a":case"aa":return a.toUpperCase();case"aaa":return a;case"aaaaa":return a[0];case"aaaa":default:return a==="am"?"a.m.":"p.m."}},h(i,r){return we(i.getHours()%12||12,r.length)},H(i,r){return we(i.getHours(),r.length)},m(i,r){return we(i.getMinutes(),r.length)},s(i,r){return we(i.getSeconds(),r.length)},S(i,r){const a=r.length,l=i.getMilliseconds(),o=Math.trunc(l*Math.pow(10,a-3));return we(o,r.length)}},Br={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Hm={G:function(i,r,a){const l=i.getFullYear()>0?1:0;switch(r){case"G":case"GG":case"GGG":return a.era(l,{width:"abbreviated"});case"GGGGG":return a.era(l,{width:"narrow"});case"GGGG":default:return a.era(l,{width:"wide"})}},y:function(i,r,a){if(r==="yo"){const l=i.getFullYear(),o=l>0?l:1-l;return a.ordinalNumber(o,{unit:"year"})}return Is.y(i,r)},Y:function(i,r,a,l){const o=_h(i,l),d=o>0?o:1-o;if(r==="YY"){const u=d%100;return we(u,2)}return r==="Yo"?a.ordinalNumber(d,{unit:"year"}):we(d,r.length)},R:function(i,r){const a=Nh(i);return we(a,r.length)},u:function(i,r){const a=i.getFullYear();return we(a,r.length)},Q:function(i,r,a){const l=Math.ceil((i.getMonth()+1)/3);switch(r){case"Q":return String(l);case"QQ":return we(l,2);case"Qo":return a.ordinalNumber(l,{unit:"quarter"});case"QQQ":return a.quarter(l,{width:"abbreviated",context:"formatting"});case"QQQQQ":return a.quarter(l,{width:"narrow",context:"formatting"});case"QQQQ":default:return a.quarter(l,{width:"wide",context:"formatting"})}},q:function(i,r,a){const l=Math.ceil((i.getMonth()+1)/3);switch(r){case"q":return String(l);case"qq":return we(l,2);case"qo":return a.ordinalNumber(l,{unit:"quarter"});case"qqq":return a.quarter(l,{width:"abbreviated",context:"standalone"});case"qqqqq":return a.quarter(l,{width:"narrow",context:"standalone"});case"qqqq":default:return a.quarter(l,{width:"wide",context:"standalone"})}},M:function(i,r,a){const l=i.getMonth();switch(r){case"M":case"MM":return Is.M(i,r);case"Mo":return a.ordinalNumber(l+1,{unit:"month"});case"MMM":return a.month(l,{width:"abbreviated",context:"formatting"});case"MMMMM":return a.month(l,{width:"narrow",context:"formatting"});case"MMMM":default:return a.month(l,{width:"wide",context:"formatting"})}},L:function(i,r,a){const l=i.getMonth();switch(r){case"L":return String(l+1);case"LL":return we(l+1,2);case"Lo":return a.ordinalNumber(l+1,{unit:"month"});case"LLL":return a.month(l,{width:"abbreviated",context:"standalone"});case"LLLLL":return a.month(l,{width:"narrow",context:"standalone"});case"LLLL":default:return a.month(l,{width:"wide",context:"standalone"})}},w:function(i,r,a,l){const o=_b(i,l);return r==="wo"?a.ordinalNumber(o,{unit:"week"}):we(o,r.length)},I:function(i,r,a){const l=wb(i);return r==="Io"?a.ordinalNumber(l,{unit:"week"}):we(l,r.length)},d:function(i,r,a){return r==="do"?a.ordinalNumber(i.getDate(),{unit:"date"}):Is.d(i,r)},D:function(i,r,a){const l=jb(i);return r==="Do"?a.ordinalNumber(l,{unit:"dayOfYear"}):we(l,r.length)},E:function(i,r,a){const l=i.getDay();switch(r){case"E":case"EE":case"EEE":return a.day(l,{width:"abbreviated",context:"formatting"});case"EEEEE":return a.day(l,{width:"narrow",context:"formatting"});case"EEEEEE":return a.day(l,{width:"short",context:"formatting"});case"EEEE":default:return a.day(l,{width:"wide",context:"formatting"})}},e:function(i,r,a,l){const o=i.getDay(),d=(o-l.weekStartsOn+8)%7||7;switch(r){case"e":return String(d);case"ee":return we(d,2);case"eo":return a.ordinalNumber(d,{unit:"day"});case"eee":return a.day(o,{width:"abbreviated",context:"formatting"});case"eeeee":return a.day(o,{width:"narrow",context:"formatting"});case"eeeeee":return a.day(o,{width:"short",context:"formatting"});case"eeee":default:return a.day(o,{width:"wide",context:"formatting"})}},c:function(i,r,a,l){const o=i.getDay(),d=(o-l.weekStartsOn+8)%7||7;switch(r){case"c":return String(d);case"cc":return we(d,r.length);case"co":return a.ordinalNumber(d,{unit:"day"});case"ccc":return a.day(o,{width:"abbreviated",context:"standalone"});case"ccccc":return a.day(o,{width:"narrow",context:"standalone"});case"cccccc":return a.day(o,{width:"short",context:"standalone"});case"cccc":default:return a.day(o,{width:"wide",context:"standalone"})}},i:function(i,r,a){const l=i.getDay(),o=l===0?7:l;switch(r){case"i":return String(o);case"ii":return we(o,r.length);case"io":return a.ordinalNumber(o,{unit:"day"});case"iii":return a.day(l,{width:"abbreviated",context:"formatting"});case"iiiii":return a.day(l,{width:"narrow",context:"formatting"});case"iiiiii":return a.day(l,{width:"short",context:"formatting"});case"iiii":default:return a.day(l,{width:"wide",context:"formatting"})}},a:function(i,r,a){const o=i.getHours()/12>=1?"pm":"am";switch(r){case"a":case"aa":return a.dayPeriod(o,{width:"abbreviated",context:"formatting"});case"aaa":return a.dayPeriod(o,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return a.dayPeriod(o,{width:"narrow",context:"formatting"});case"aaaa":default:return a.dayPeriod(o,{width:"wide",context:"formatting"})}},b:function(i,r,a){const l=i.getHours();let o;switch(l===12?o=Br.noon:l===0?o=Br.midnight:o=l/12>=1?"pm":"am",r){case"b":case"bb":return a.dayPeriod(o,{width:"abbreviated",context:"formatting"});case"bbb":return a.dayPeriod(o,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return a.dayPeriod(o,{width:"narrow",context:"formatting"});case"bbbb":default:return a.dayPeriod(o,{width:"wide",context:"formatting"})}},B:function(i,r,a){const l=i.getHours();let o;switch(l>=17?o=Br.evening:l>=12?o=Br.afternoon:l>=4?o=Br.morning:o=Br.night,r){case"B":case"BB":case"BBB":return a.dayPeriod(o,{width:"abbreviated",context:"formatting"});case"BBBBB":return a.dayPeriod(o,{width:"narrow",context:"formatting"});case"BBBB":default:return a.dayPeriod(o,{width:"wide",context:"formatting"})}},h:function(i,r,a){if(r==="ho"){let l=i.getHours()%12;return l===0&&(l=12),a.ordinalNumber(l,{unit:"hour"})}return Is.h(i,r)},H:function(i,r,a){return r==="Ho"?a.ordinalNumber(i.getHours(),{unit:"hour"}):Is.H(i,r)},K:function(i,r,a){const l=i.getHours()%12;return r==="Ko"?a.ordinalNumber(l,{unit:"hour"}):we(l,r.length)},k:function(i,r,a){let l=i.getHours();return l===0&&(l=24),r==="ko"?a.ordinalNumber(l,{unit:"hour"}):we(l,r.length)},m:function(i,r,a){return r==="mo"?a.ordinalNumber(i.getMinutes(),{unit:"minute"}):Is.m(i,r)},s:function(i,r,a){return r==="so"?a.ordinalNumber(i.getSeconds(),{unit:"second"}):Is.s(i,r)},S:function(i,r){return Is.S(i,r)},X:function(i,r,a){const l=i.getTimezoneOffset();if(l===0)return"Z";switch(r){case"X":return Qm(l);case"XXXX":case"XX":return sr(l);case"XXXXX":case"XXX":default:return sr(l,":")}},x:function(i,r,a){const l=i.getTimezoneOffset();switch(r){case"x":return Qm(l);case"xxxx":case"xx":return sr(l);case"xxxxx":case"xxx":default:return sr(l,":")}},O:function(i,r,a){const l=i.getTimezoneOffset();switch(r){case"O":case"OO":case"OOO":return"GMT"+Vm(l,":");case"OOOO":default:return"GMT"+sr(l,":")}},z:function(i,r,a){const l=i.getTimezoneOffset();switch(r){case"z":case"zz":case"zzz":return"GMT"+Vm(l,":");case"zzzz":default:return"GMT"+sr(l,":")}},t:function(i,r,a){const l=Math.trunc(+i/1e3);return we(l,r.length)},T:function(i,r,a){return we(+i,r.length)}};function Vm(i,r=""){const a=i>0?"-":"+",l=Math.abs(i),o=Math.trunc(l/60),d=l%60;return d===0?a+String(o):a+String(o)+r+we(d,2)}function Qm(i,r){return i%60===0?(i>0?"-":"+")+we(Math.abs(i)/60,2):sr(i,r)}function sr(i,r=""){const a=i>0?"-":"+",l=Math.abs(i),o=we(Math.trunc(l/60),2),d=we(l%60,2);return a+o+r+d}const Gm=(i,r)=>{switch(i){case"P":return r.date({width:"short"});case"PP":return r.date({width:"medium"});case"PPP":return r.date({width:"long"});case"PPPP":default:return r.date({width:"full"})}},kh=(i,r)=>{switch(i){case"p":return r.time({width:"short"});case"pp":return r.time({width:"medium"});case"ppp":return r.time({width:"long"});case"pppp":default:return r.time({width:"full"})}},kb=(i,r)=>{const a=i.match(/(P+)(p+)?/)||[],l=a[1],o=a[2];if(!o)return Gm(i,r);let d;switch(l){case"P":d=r.dateTime({width:"short"});break;case"PP":d=r.dateTime({width:"medium"});break;case"PPP":d=r.dateTime({width:"long"});break;case"PPPP":default:d=r.dateTime({width:"full"});break}return d.replace("{{date}}",Gm(l,r)).replace("{{time}}",kh(o,r))},Sb={p:kh,P:kb},Cb=/^D+$/,Tb=/^Y+$/,Eb=["D","DD","YY","YYYY"];function Pb(i){return Cb.test(i)}function Db(i){return Tb.test(i)}function Ob(i,r,a){const l=Rb(i,r,a);if(console.warn(l),Eb.includes(i))throw new RangeError(l)}function Rb(i,r,a){const l=i[0]==="Y"?"years":"days of the month";return`Use \`${i.toLowerCase()}\` instead of \`${i}\` (in \`${r}\`) for formatting ${l} to the input \`${a}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const Lb=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Ib=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Ab=/^'([^]*?)'?$/,Mb=/''/g,Fb=/[a-zA-Z]/;function Ms(i,r,a){const l=kl(),o=l.locale??yb,d=l.firstWeekContainsDate??l.locale?.options?.firstWeekContainsDate??1,u=l.weekStartsOn??l.locale?.options?.weekStartsOn??0,h=Mt(i,a?.in);if(!qv(h))throw new RangeError("Invalid time value");let p=r.match(Ib).map(v=>{const x=v[0];if(x==="p"||x==="P"){const N=Sb[x];return N(v,o.formatLong)}return v}).join("").match(Lb).map(v=>{if(v==="''")return{isToken:!1,value:"'"};const x=v[0];if(x==="'")return{isToken:!1,value:$b(v)};if(Hm[x])return{isToken:!0,value:v};if(x.match(Fb))throw new RangeError("Format string contains an unescaped latin alphabet character `"+x+"`");return{isToken:!1,value:v}});o.localize.preprocessor&&(p=o.localize.preprocessor(h,p));const g={firstWeekContainsDate:d,weekStartsOn:u,locale:o};return p.map(v=>{if(!v.isToken)return v.value;const x=v.value;(Db(x)||Pb(x))&&Ob(x,r,String(i));const N=Hm[x[0]];return N(h,x,o.localize,g)}).join("")}function $b(i){const r=i.match(Ab);return r?r[1].replace(Mb,"'"):i}function hl(i,r,a){return wh(i,-r,a)}function qb(){const{user:i}=Ne(),[r,a]=k.useState([]),[l,o]=k.useState(!0),[d,u]=k.useState(null),[h,p]=k.useState(""),[g,v]=k.useState("");k.useEffect(()=>{i&&x()},[i]);const x=async()=>{try{o(!0),u(null);let b=z.from("jcb_operations").select("*").order("date",{ascending:!1});i?.role!=="director"&&(b=b.eq("contractor_id",i?.id)),g&&(b=b.eq("date",g)),h&&(b=b.or(`operator_name.ilike.%${h}%,
           vehicle_number.ilike.%${h}%,
           location.ilike.%${h}%,
           work_description.ilike.%${h}%`));const{data:j,error:_}=await b;if(_)throw _;a(j||[])}catch(b){console.error("Error fetching JCB records:",b),u(b instanceof Error?b.message:"Failed to fetch records")}finally{o(!1)}},N=()=>{x()},y=b=>{if(!b)return"";const[j,_]=b.split(":");return`${parseInt(j,10)%12||12}:${_} ${parseInt(j,10)>=12?"PM":"AM"}`};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-amber-100 flex items-center justify-center",children:e.jsx(Vo,{className:"w-5 h-5 text-amber-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-900",children:"JCB Operations"}),e.jsx("p",{className:"text-sm text-slate-500",children:"View and manage JCB operations"})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(jl,{className:"h-4 w-4 text-slate-400"})}),e.jsx("input",{type:"text",placeholder:"Search records...",value:h,onChange:b=>p(b.target.value),className:"pl-10 pr-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-transparent w-full sm:w-64"})]}),e.jsx("input",{type:"date",value:g,onChange:b=>v(b.target.value),className:"px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-transparent"}),e.jsx("button",{onClick:N,className:"px-4 py-2 bg-white border border-slate-300 rounded-lg hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:ring-offset-2 transition-colors",children:"Refresh"})]})]}),d&&e.jsx("div",{className:"bg-red-50 border-l-4 border-red-500 p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(Tt,{className:"h-5 w-5 text-red-500","aria-hidden":"true"})}),e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:"text-sm text-red-700",children:d})})]})}),l?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-amber-600"})}):r.length===0?e.jsxs("div",{className:"text-center py-12 bg-slate-50 rounded-xl",children:[e.jsx(Vo,{className:"mx-auto h-12 w-12 text-slate-400"}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-slate-900",children:"No JCB records found"}),e.jsx("p",{className:"mt-1 text-sm text-slate-500",children:"Get started by creating a new record."})]}):e.jsx("div",{className:"bg-white shadow-sm rounded-xl overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-slate-200",children:[e.jsx("thead",{className:"bg-slate-50",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Date"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Operator"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Vehicle"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Location"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Hours"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Fuel (L)"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Status"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-slate-200",children:r.map(b=>e.jsxs("tr",{className:"hover:bg-slate-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(ge,{className:"h-4 w-4 text-slate-400 mr-2"}),e.jsx("div",{className:"text-sm font-medium text-slate-900",children:Ms(new Date(b.date),"MMM d, yyyy")})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-slate-900",children:b.operator_name})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm font-medium text-slate-900",children:b.vehicle_number})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(jt,{className:"h-4 w-4 text-slate-400 mr-2"}),e.jsx("div",{className:"text-sm text-slate-500",children:b.location})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Me,{className:"h-4 w-4 text-slate-400 mr-2"}),e.jsxs("div",{className:"text-sm text-slate-900",children:[y(b.start_time)," - ",y(b.end_time),e.jsxs("div",{className:"text-xs text-slate-500",children:[b.total_hours.toFixed(1)," hours"]})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(It,{className:"h-4 w-4 text-slate-400 mr-2"}),e.jsxs("div",{className:"text-sm text-slate-900",children:[b.fuel_consumed," L"]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${b.status==="approved"?"bg-green-100 text-green-800":b.status==="rejected"?"bg-red-100 text-red-800":"bg-amber-100 text-amber-800"}`,children:b.status.charAt(0).toUpperCase()+b.status.slice(1)})})]},b.id))})]})})})]})}const Ub=["Retail","Wholesale","Contractor","Government","Reseller","Other"],Bb=["Net 7","Net 15","Net 30","Net 60","Due on Receipt","Custom"];function Sh({onSuccess:i,initialData:r}){const{user:a}=Ne(),[l,o]=k.useState(!1),[d]=k.useState(!!r),[u,h]=k.useState({company_name:r?.company_name||"",contact_person:r?.contact_person||"",email:r?.email||"",phone:r?.phone||"",address:r?.address||"",city:r?.city||"",state:r?.state||"",postal_code:r?.postal_code||"",country:r?.country||"India",tax_id:r?.tax_id||"",customer_type:r?.customer_type||"Retail",payment_terms:r?.payment_terms||"Net 30",credit_limit:r?.credit_limit||"",notes:r?.notes||""}),p=async g=>{if(g.preventDefault(),!!a){o(!0);try{const v={...u,updated_by:a.id,credit_limit:parseFloat(u.credit_limit)||0};if(d&&r?.id){const{error:x}=await z.from("customers").update(v).eq("id",r.id);if(x)throw x;alert("Customer updated successfully!")}else{const{error:x}=await z.from("customers").insert([{...v,created_by:a.id}]);if(x)throw x;alert("Customer added successfully!")}i&&i()}catch(v){alert("Error saving customer: "+v.message)}finally{o(!1)}}};return e.jsxs("form",{onSubmit:p,className:"space-y-6 bg-white p-6 rounded-xl shadow-sm border border-slate-200",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx("div",{className:"col-span-2",children:e.jsx("h3",{className:"text-lg font-medium text-slate-800 mb-4",children:d?"Edit Customer":"Add New Customer"})}),e.jsx("div",{className:"md:col-span-2 border-b border-slate-200 pb-4",children:e.jsxs("h4",{className:"text-md font-medium text-slate-700 flex items-center",children:[e.jsx(sc,{className:"h-5 w-5 mr-2 text-cyan-600"}),"Company Information"]})}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Company Name *"}),e.jsx("input",{type:"text",value:u.company_name,onChange:g=>h({...u,company_name:g.target.value}),required:!0,className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent",placeholder:"Enter company name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Customer Type"}),e.jsx("select",{value:u.customer_type,onChange:g=>h({...u,customer_type:g.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent",children:Ub.map(g=>e.jsx("option",{value:g,children:g},g))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Tax ID / GSTIN"}),e.jsx("input",{type:"text",value:u.tax_id,onChange:g=>h({...u,tax_id:g.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent",placeholder:"Enter tax ID or GSTIN"})]}),e.jsx("div",{className:"md:col-span-2 border-b border-slate-200 pb-4 mt-6",children:e.jsxs("h4",{className:"text-md font-medium text-slate-700 flex items-center",children:[e.jsx(Hn,{className:"h-5 w-5 mr-2 text-cyan-600"}),"Contact Information"]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Contact Person *"}),e.jsx("input",{type:"text",value:u.contact_person,onChange:g=>h({...u,contact_person:g.target.value}),required:!0,className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent",placeholder:"Full name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Email"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(Qo,{className:"h-5 w-5 text-slate-400"})}),e.jsx("input",{type:"email",value:u.email,onChange:g=>h({...u,email:g.target.value}),className:"pl-10 w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent",placeholder:"email@company.com"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Phone *"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(pl,{className:"h-5 w-5 text-slate-400"})}),e.jsx("input",{type:"tel",value:u.phone,onChange:g=>h({...u,phone:g.target.value}),required:!0,className:"pl-10 w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent",placeholder:"+91 98765 43210"})]})]}),e.jsx("div",{className:"md:col-span-2 border-b border-slate-200 pb-4 mt-6",children:e.jsxs("h4",{className:"text-md font-medium text-slate-700 flex items-center",children:[e.jsx(jt,{className:"h-5 w-5 mr-2 text-cyan-600"}),"Address"]})}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Street Address"}),e.jsx("input",{type:"text",value:u.address,onChange:g=>h({...u,address:g.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent",placeholder:"123 Business Street"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"City"}),e.jsx("input",{type:"text",value:u.city,onChange:g=>h({...u,city:g.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent",placeholder:"City"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"State"}),e.jsx("input",{type:"text",value:u.state,onChange:g=>h({...u,state:g.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent",placeholder:"State"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Postal Code"}),e.jsx("input",{type:"text",value:u.postal_code,onChange:g=>h({...u,postal_code:g.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent",placeholder:"Postal code"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Country"}),e.jsx("input",{type:"text",value:u.country,onChange:g=>h({...u,country:g.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent",placeholder:"Country"})]}),e.jsx("div",{className:"md:col-span-2 border-b border-slate-200 pb-4 mt-6",children:e.jsxs("h4",{className:"text-md font-medium text-slate-700 flex items-center",children:[e.jsx(dt,{className:"h-5 w-5 mr-2 text-cyan-600"}),"Payment & Credit"]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Payment Terms"}),e.jsx("select",{value:u.payment_terms,onChange:g=>h({...u,payment_terms:g.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent",children:Bb.map(g=>e.jsx("option",{value:g,children:g},g))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Credit Limit ()"}),e.jsx("input",{type:"number",step:"0.01",min:"0",value:u.credit_limit,onChange:g=>h({...u,credit_limit:g.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent",placeholder:"0.00"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Notes"}),e.jsx("textarea",{rows:3,value:u.notes,onChange:g=>h({...u,notes:g.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent",placeholder:"Any additional notes about this customer..."})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-slate-200",children:[e.jsx("button",{type:"button",onClick:()=>window.history.back(),className:"px-4 py-2 border border-slate-300 rounded-lg text-slate-700 hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-cyan-500",disabled:l,children:"Cancel"}),e.jsx("button",{type:"submit",disabled:l,className:"px-6 py-2 border border-transparent rounded-lg shadow-sm text-white bg-cyan-600 hover:bg-cyan-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-cyan-500 disabled:opacity-50 flex items-center",children:l?"Saving...":e.jsxs(e.Fragment,{children:[e.jsx(Kt,{className:"h-4 w-4 mr-2"}),d?"Update Customer":"Add Customer"]})})]})]})}function Km(){Ne();const[i,r]=k.useState([]),[a,l]=k.useState(!0),[o,d]=k.useState(""),[u,h]=k.useState(!1),[p,g]=k.useState(null),[v,x]=k.useState(null),[N,y]=k.useState([]),[b,j]=k.useState(!1),[_,T]=k.useState(1),[I]=k.useState(10),[C,D]=k.useState(0),R=async()=>{l(!0);try{const{data:G,error:V}=await z.from("customers").select("*").order("company_name",{ascending:!0});if(V)throw V;r(G||[])}catch(G){console.error("Error fetching customers:",G.message)}finally{l(!1)}};k.useEffect(()=>{R()},[]);const F=async G=>{if(window.confirm("Are you sure you want to delete this customer?"))try{const{error:V}=await z.from("customers").delete().eq("id",G);if(V)throw V;R(),alert("Customer deleted successfully")}catch(V){alert("Error deleting customer: "+V.message)}},H=G=>{g(G),h(!0)},ae=async G=>{x(G),j(!0);try{const V=Ms(hl(new Date,10),"yyyy-MM-dd"),{data:se,error:K}=await z.from("invoices").select("*").eq("customer_id",G.id).gte("date",V).order("date",{ascending:!1});if(K)throw K;const O=se?.reduce(($,ie)=>$+(ie.total_amount-(ie.paid_amount||0)),0)||0;y(se||[]),D(O)}catch(V){console.error("Error fetching invoices:",V);const se=[{id:"1",invoice_number:"INV-2023-001",date:Ms(hl(new Date,2),"yyyy-MM-dd"),due_date:Ms(wh(new Date,28),"yyyy-MM-dd"),total_amount:125e3,paid_amount:75e3,status:"pending",items:[{description:"Crushed Stone (20mm)",quantity:50,unit_price:2500,amount:125e3}]},{id:"2",invoice_number:"INV-2023-002",date:Ms(hl(new Date,5),"yyyy-MM-dd"),due_date:Ms(hl(new Date,1),"yyyy-MM-dd"),total_amount:84e3,paid_amount:84e3,status:"paid",items:[{description:"Crushed Stone (10mm)",quantity:30,unit_price:2800,amount:84e3}]}],K=se.reduce((O,$)=>O+($.total_amount-$.paid_amount),0);y(se),D(K)}finally{j(!1)}},_e=()=>{x(null),y([]),D(0)},He=()=>{h(!1),g(null),R()},U=i.filter(G=>G.company_name.toLowerCase().includes(o.toLowerCase())||G.contact_person.toLowerCase().includes(o.toLowerCase())||G.email&&G.email.toLowerCase().includes(o.toLowerCase())||G.phone&&G.phone.includes(o)),ce=_*I,be=ce-I,Oe=U.slice(be,ce),Re=Math.ceil(U.length/I),qe=G=>T(G);return u?e.jsxs("div",{className:"space-y-6",children:[e.jsx("button",{onClick:()=>{h(!1),g(null)},className:"flex items-center text-sm text-cyan-600 hover:text-cyan-700 mb-4",children:" Back to customers"}),e.jsx(Sh,{onSuccess:He,initialData:p})]}):v?e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex justify-between items-center",children:e.jsx("button",{onClick:_e,className:"flex items-center text-sm text-cyan-600 hover:text-cyan-700 mb-4",children:" Back to customers"})}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:v.company_name}),e.jsxs("p",{className:"text-slate-600",children:[v.customer_type,"  ",v.tax_id]}),e.jsxs("div",{className:"mt-4 space-y-2",children:[e.jsxs("div",{className:"flex items-center text-slate-700",children:[e.jsx(Hn,{className:"h-4 w-4 mr-2 text-slate-500"}),v.contact_person]}),e.jsxs("div",{className:"flex items-center text-slate-700",children:[e.jsx(pl,{className:"h-4 w-4 mr-2 text-slate-500"}),v.phone||"N/A"]}),e.jsxs("div",{className:"flex items-center text-slate-700",children:[e.jsx(Qo,{className:"h-4 w-4 mr-2 text-slate-500"}),v.email||"N/A"]}),e.jsxs("div",{className:"flex items-start text-slate-700",children:[e.jsx(jt,{className:"h-4 w-4 mr-2 mt-1 flex-shrink-0 text-slate-500"}),e.jsxs("span",{children:[v.address,e.jsx("br",{}),v.city,v.city&&v.state?", ":"",v.state,e.jsx("br",{}),v.postal_code," ",v.country]})]})]})]}),e.jsxs("div",{className:"bg-slate-50 p-4 rounded-lg min-w-[240px]",children:[e.jsx("h3",{className:"text-sm font-medium text-slate-500 mb-2",children:"Total Balance"}),e.jsxs("div",{className:"text-3xl font-bold text-slate-900",children:["",C.toLocaleString("en-IN")]}),e.jsx("div",{className:"mt-2 text-sm text-slate-500",children:C>0?"Amount Due":"No outstanding balance"}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-slate-200",children:[e.jsx("h3",{className:"text-sm font-medium text-slate-500 mb-2",children:"Payment Terms"}),e.jsx("div",{className:"text-sm text-slate-700",children:v.payment_terms}),e.jsxs("div",{className:"text-sm text-slate-500",children:["Credit Limit: ",v.credit_limit?.toLocaleString("en-IN")||"0"]})]})]})]}),e.jsxs("div",{className:"mt-8",children:[e.jsxs("h3",{className:"text-lg font-semibold text-slate-900 mb-4 flex items-center",children:[e.jsx(rt,{className:"h-5 w-5 mr-2 text-cyan-600"}),"Recent Invoices (Last 10 Days)"]}),b?e.jsx("div",{className:"flex justify-center items-center h-32",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-cyan-500"})}):N.length===0?e.jsx("div",{className:"text-center py-8 bg-slate-50 rounded-lg",children:e.jsx("p",{className:"text-slate-500",children:"No invoices found in the last 10 days"})}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-slate-200",children:[e.jsx("thead",{className:"bg-slate-50",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Invoice #"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Date"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Due Date"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Amount"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Status"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-slate-200",children:N.map(G=>e.jsxs("tr",{className:"hover:bg-slate-50 cursor-pointer",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-cyan-600",children:G.invoice_number}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-500",children:Ms(new Date(G.date),"dd MMM yyyy")}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-500",children:Ms(new Date(G.due_date),"dd MMM yyyy")}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-900",children:["",G.total_amount.toLocaleString("en-IN")]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${G.status==="paid"?"bg-green-100 text-green-800":G.status==="overdue"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:G.status.charAt(0).toUpperCase()+G.status.slice(1)})})]},G.id))})]})})]})]})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between mb-6",children:[e.jsx("h3",{className:"text-xl font-bold text-slate-900",children:"Customer Directory"}),e.jsx("div",{className:"mt-4 md:mt-0",children:e.jsxs("button",{onClick:()=>h(!0),className:"inline-flex items-center px-4 py-2 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-cyan-600 hover:bg-cyan-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-cyan-500",children:[e.jsx(ar,{className:"h-4 w-4 mr-2"}),"Add New Customer"]})})]}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-4 mb-6",children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(jl,{className:"h-5 w-5 text-slate-400"})}),e.jsx("input",{type:"text",placeholder:"Search customers...",value:o,onChange:G=>d(G.target.value),className:"block w-full pl-10 pr-3 py-2 border border-slate-300 rounded-lg bg-white focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-transparent"})]})}),a?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-cyan-500"})}):U.length===0?e.jsxs("div",{className:"text-center py-12 bg-white rounded-xl shadow-sm border border-slate-200",children:[e.jsx(sc,{className:"mx-auto h-12 w-12 text-slate-400"}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-slate-900",children:"No customers found"}),e.jsx("p",{className:"mt-1 text-sm text-slate-500",children:o?"Try a different search term":"Get started by adding a new customer"}),e.jsx("div",{className:"mt-6",children:e.jsxs("button",{type:"button",onClick:()=>h(!0),className:"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-lg text-white bg-cyan-600 hover:bg-cyan-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-cyan-500",children:[e.jsx(ar,{className:"-ml-1 mr-2 h-5 w-5"}),"New Customer"]})})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-white shadow overflow-hidden sm:rounded-lg",children:e.jsx("ul",{className:"divide-y divide-slate-200",children:Oe.map(G=>e.jsx("li",{className:"px-4 py-4 sm:px-6 hover:bg-slate-50",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex-1 min-w-0",onClick:()=>ae(G),children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(Hn,{className:"flex-shrink-0 mr-1.5 h-4 w-4 text-slate-400"}),e.jsx("span",{className:"font-medium",children:G.contact_person})]}),e.jsxs("div",{className:"mt-2 flex items-center text-sm text-slate-500",children:[e.jsx(pl,{className:"flex-shrink-0 mr-1.5 h-4 w-4 text-slate-400"}),G.phone||"N/A"]}),e.jsxs("div",{className:"mt-2 flex items-center text-sm text-slate-500",children:[e.jsx(Qo,{className:"flex-shrink-0 mr-1.5 h-4 w-4 text-slate-400"}),G.email||"N/A"]}),e.jsxs("div",{className:"mt-2 flex items-center text-sm text-slate-500",children:[e.jsx(jt,{className:"flex-shrink-0 mr-1.5 h-4 w-4 text-slate-400"}),G.city,G.city&&G.state?", ":"",G.state]})]}),e.jsxs("div",{className:"ml-4 flex-shrink-0 flex space-x-2",children:[e.jsx("button",{onClick:V=>{V.stopPropagation(),H(G)},className:"p-2 rounded-lg text-cyan-600 hover:bg-cyan-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-cyan-500",title:"Edit",children:e.jsx(lg,{className:"h-5 w-5"})}),e.jsx("button",{onClick:V=>{V.stopPropagation(),F(G.id)},className:"p-2 rounded-lg text-red-600 hover:bg-red-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",title:"Delete",children:e.jsx(gl,{className:"h-5 w-5"})})]})]})},G.id))})}),Re>1&&e.jsxs("nav",{className:"flex items-center justify-between border-t border-slate-200 bg-white px-4 py-3 sm:px-6 rounded-b-lg",children:[e.jsx("div",{className:"hidden sm:block",children:e.jsxs("p",{className:"text-sm text-slate-700",children:["Showing ",e.jsx("span",{className:"font-medium",children:be+1})," to"," ",e.jsx("span",{className:"font-medium",children:Math.min(ce,U.length)})," ","of ",e.jsx("span",{className:"font-medium",children:U.length})," results"]})}),e.jsxs("div",{className:"flex-1 flex justify-between sm:justify-end space-x-2",children:[e.jsx("button",{onClick:()=>qe(_-1),disabled:_===1,className:`relative inline-flex items-center px-4 py-2 border border-slate-300 text-sm font-medium rounded-lg ${_===1?"bg-slate-100 text-slate-400 cursor-not-allowed":"bg-white text-slate-700 hover:bg-slate-50"}`,children:"Previous"}),e.jsx("button",{onClick:()=>qe(_+1),disabled:_===Re,className:`relative inline-flex items-center px-4 py-2 border border-slate-300 text-sm font-medium rounded-lg ${_===Re?"bg-slate-100 text-slate-400 cursor-not-allowed":"bg-white text-slate-700 hover:bg-slate-50"}`,children:"Next"})]})]})]})]})}function zb(){const{session:i,user:r,loading:a}=Ne(),[l,o]=k.useState(window.location.hash.replace("#","")||"dashboard");if(k.useEffect(()=>{const u=()=>{const h=window.location.hash.replace("#","")||"dashboard";console.log("Hash changed to:",h),o(h)};return console.log("Initial hash:",window.location.hash.replace("#","")||"dashboard"),window.addEventListener("hashchange",u),()=>window.removeEventListener("hashchange",u)},[]),k.useEffect(()=>{console.log("Current hash in state:",l)},[l]),a)return e.jsx("div",{className:"min-h-screen bg-slate-900 flex items-center justify-center",children:e.jsx("div",{className:"text-white text-xl",children:"Loading..."})});if(!i||!r)return e.jsx(og,{});const d=()=>{const u=l;switch(console.log("Rendering content for hash:",u),u){case"dashboard":return r.role==="director"?e.jsx(Fm,{}):r.role==="contractor"?e.jsx(dg,{}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-bold text-slate-900",children:["Welcome, ",r.full_name,"!"]}),e.jsxs("p",{className:"text-slate-600 mt-1 capitalize",children:["Role: ",r.role.replace("_"," ")]})]}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-8 text-center",children:e.jsx("p",{className:"text-slate-600",children:"Select a module from the sidebar to get started"})})]});case"drilling":return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Drilling Operations"}),e.jsx("p",{className:"text-slate-600 mt-1",children:"Record and manage drilling activities"})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-slate-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"New Drilling Record"}),e.jsx(Dm,{fallback:e.jsx("div",{className:"text-red-600",children:"Failed to load Drilling Form. Please try again later."}),children:e.jsx(_g,{onSuccess:()=>window.location.reload()})})]}),e.jsxs("div",{className:"mt-8 bg-white rounded-lg shadow-sm border border-slate-200 p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-4",children:"Drilling Details & History"}),e.jsx(Dm,{fallback:e.jsx("div",{className:"text-red-600",children:"Failed to load Drilling History. Please try again later."}),children:e.jsx(kg,{})})]})]});case"mobile":return e.jsx(iv,{});case"sales":return e.jsx(mv,{});case"approvals":return r.role==="director"?(window.location.hash="#dashboard",e.jsx(Fm,{})):e.jsx(hv,{});case"blasting":return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Blasting Operations"}),e.jsx("p",{className:"text-slate-600 mt-1",children:"Record and manage blasting activities"})]}),e.jsx(Sg,{onSuccess:()=>window.location.reload()}),e.jsxs("div",{className:"mt-8",children:[e.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-4",children:"Blasting Details & History"}),e.jsx(Cg,{})]})]});case"loading":return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Breaking/Loading Operations"}),e.jsx("p",{className:"text-slate-600 mt-1",children:"Track material breaking and loading"})]}),e.jsx(Dg,{onSuccess:()=>window.location.reload()}),e.jsxs("div",{className:"mt-8",children:[e.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-4",children:"Breaking/Loading Details & History"}),e.jsx(Og,{})]})]});case"transport":return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Transport Operations"}),e.jsx("p",{className:"text-slate-600 mt-1",children:"Track vehicle and material transport"})]}),e.jsx(Ag,{onSuccess:()=>window.location.reload()}),e.jsxs("div",{className:"mt-8",children:[e.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-4",children:"Transport Details & History"}),e.jsx(Mg,{})]})]});case"attendance":return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Attendance Management"}),e.jsx("p",{className:"text-slate-600 mt-1",children:"Record daily attendance and work hours"})]}),e.jsx(qg,{onSuccess:()=>window.location.reload()}),e.jsxs("div",{className:"mt-8",children:[e.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-4",children:"Attendance Details & History"}),e.jsx(Ug,{})]})]});case"media":return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Photos & Videos"}),e.jsx("p",{className:"text-slate-600 mt-1",children:"Upload and manage site documentation"})]}),e.jsx(Wg,{onSuccess:()=>window.location.reload()}),e.jsxs("div",{className:"mt-8",children:[e.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-4",children:"Media Gallery"}),e.jsx(Hg,{})]})]});case"crusher-production":return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Crusher Production"}),e.jsx("p",{className:"text-slate-600 mt-1",children:"Track crusher operations and output"})]}),e.jsx(Ev,{onSuccess:()=>window.location.reload()}),e.jsxs("div",{className:"mt-8",children:[e.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-4",children:"Production Records"}),e.jsx(Pv,{})]})]});case"eb-reports":return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"EB Reports"}),e.jsx("p",{className:"text-slate-600 mt-1",children:"Manage Electricity Board reports and records"})]}),e.jsx(Dv,{onSuccess:()=>window.location.reload()}),e.jsxs("div",{className:"mt-8",children:[e.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-4",children:"EB Report History"}),e.jsx(Ov,{})]})]});case"customers":return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Customer Management"}),e.jsx("p",{className:"text-slate-600 mt-1",children:"Manage customer relationships and information"})]}),e.jsx(Sh,{onSuccess:()=>window.location.reload()}),e.jsxs("div",{className:"mt-8",children:[e.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-4",children:"Customer Directory"}),e.jsx(Km,{})]})]});case"customer-details":return e.jsx("div",{className:"space-y-6",children:e.jsx(Km,{})});case"inventory":return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Inventory Management"}),e.jsx("p",{className:"text-slate-600 mt-1",children:"Track equipment, tools, and supplies"})]}),e.jsx(Jg,{onSuccess:()=>window.location.reload()}),e.jsxs("div",{className:"mt-8",children:[e.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-4",children:"Current Inventory"}),e.jsx(Xg,{})]})]});case"fuel":return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Fuel Management"}),e.jsx("p",{className:"text-slate-600 mt-1",children:"Track fuel consumption and costs"})]}),e.jsx(tv,{onSuccess:()=>window.location.reload()}),e.jsxs("div",{className:"mt-8",children:[e.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-4",children:"Fuel Records"}),e.jsx(sv,{})]})]});case"safety":return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Safety & Incidents"}),e.jsx("p",{className:"text-slate-600 mt-1",children:"Report and track safety incidents"})]}),e.jsx(av,{onSuccess:()=>window.location.reload()}),e.jsxs("div",{className:"mt-8",children:[e.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-4",children:"Incident Reports"}),e.jsx(lv,{})]})]});case"reports":return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Reports & Analytics"}),e.jsx("p",{className:"text-slate-600 mt-1",children:"Comprehensive reports for all operations"})]}),e.jsx(Cv,{})]});case"new-permit":return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"New Permit"}),e.jsx("p",{className:"text-slate-600 mt-1",children:"Create and submit new permit applications"})]}),e.jsx(fv,{onSuccess:()=>window.location.reload()}),e.jsxs("div",{className:"mt-8",children:[e.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-4",children:"Active Permits"}),e.jsx(xv,{})]})]});case"accounts":return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Accounts"}),e.jsx("p",{className:"text-slate-600 mt-1",children:"Manage invoices, payments, and financial transactions"})]}),e.jsx(pv,{onSuccess:()=>window.location.reload()}),e.jsxs("div",{className:"mt-8",children:[e.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-4",children:"Transaction History"}),e.jsx(gv,{})]})]});case"dispatch-payment":return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Dispatch List"}),e.jsx("p",{className:"text-slate-600 mt-1",children:"Track material dispatch, transportation, and balance materials"})]}),e.jsx(vv,{onSuccess:()=>window.location.reload()}),e.jsxs("div",{className:"mt-8",children:[e.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-4",children:"Dispatch Records"}),e.jsx(bv,{})]})]});case"stock-management":return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Stock Management"}),e.jsx("p",{className:"text-slate-600 mt-1",children:"Production stock and purchase requests"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-4",children:"Production Stock"}),e.jsx(yv,{onSuccess:()=>window.location.reload()})]}),e.jsx(jv,{})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-4",children:"Purchase Requests"}),e.jsx(wv,{onSuccess:()=>window.location.reload()})]}),e.jsx(Nv,{})]})]})]});case"user-management":return e.jsx(Tv,{});case"jcb-operations":return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"JCB Operations"}),e.jsx("p",{className:"text-slate-600 mt-1",children:"Manage JCB operations and maintenance"})]}),e.jsx(Rv,{onSuccess:()=>window.location.hash="jcb-operations-list"})]});case"jcb-operations-list":return e.jsx(qb,{});default:return e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-8 text-center",children:e.jsx("p",{className:"text-slate-600",children:"Page not found"})})}};return e.jsx(cg,{children:d()})}function Wb(){return e.jsx(qp,{children:e.jsx(zb,{})})}L0.createRoot(document.getElementById("root")).render(e.jsx(k.StrictMode,{children:e.jsx(Wb,{})}));
